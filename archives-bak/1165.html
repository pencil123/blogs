
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Python 爬虫模块 &#8211; urllib and urllib2 | 青春部落    </title>
    <meta name="keywords"  content="Python,编程语言,爬虫编程,urllib模块" />
    <meta name="description"  content="Python编程语言中爬虫编程模块URLlib模块说明" />
    <link rel="stylesheet" type="text/css" media="all" href="https://cn-blogs.cn/wp-content/themes/pencilone/style.css" />
    <link rel="profile" href="http://gmpg.org/xfn/11">
    <link rel="pingback" href="https://cn-blogs.cn/xmlrpc.php">
    <link id="favicon" href="/favicon.ico" rel="icon" type="image/x-icon" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="青春部落 &raquo; Python 爬虫模块 &#8211; urllib and urllib2评论Feed" href="https://cn-blogs.cn/archives/1165.html/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/cn-blogs.cn\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.1"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='https://api.w.org/' href='https://cn-blogs.cn/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://cn-blogs.cn/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://cn-blogs.cn/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Cyrus SASL介绍' href='https://cn-blogs.cn/archives/1968.html' />
<link rel='next' title='Beautiful Soup  XML数据解析' href='https://cn-blogs.cn/archives/1181.html' />
<meta name="generator" content="WordPress 4.9.1" />
<link rel="canonical" href="https://cn-blogs.cn/archives/1165.html" />
<link rel='shortlink' href='https://cn-blogs.cn/?p=1165' />
<link rel="alternate" type="application/json+oembed" href="https://cn-blogs.cn/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcn-blogs.cn%2Farchives%2F1165.html" />
<link rel="alternate" type="text/xml+oembed" href="https://cn-blogs.cn/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcn-blogs.cn%2Farchives%2F1165.html&#038;format=xml" />
<link rel="icon" href="https://cn-blogs.cn/wp-content/uploads/2018/03/cropped-logo-32x32.png" sizes="32x32" />
<link rel="icon" href="https://cn-blogs.cn/wp-content/uploads/2018/03/cropped-logo-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://cn-blogs.cn/wp-content/uploads/2018/03/cropped-logo-180x180.png" />
<meta name="msapplication-TileImage" content="https://cn-blogs.cn/wp-content/uploads/2018/03/cropped-logo-270x270.png" />

<meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">


</head>

<body class="post-template-default single single-post postid-1165 single-format-standard">
<header class="navbar">
<div class="container">
    <div class="navbar-brand">
        <img src="/logo.png" width="73" height="88">
        <div>
        <h1 class="title2 is-3 navbar-item">
            <a href="https://cn-blogs.cn/" rel="home">青春部落</a>
        </h1>
        <p class="has-text-right">
            <a href="/">记录生活的足迹</a>
        </p>
        </div>
    </div>
    <div class="navbar-menu is-active">
    <div class="navbar-end">
    <div class="tabs is-right">
    <a class="navbar-item" href="/pages/index.html">索引</a>
    <a class="navbar-item" href="/about">About</a>
    </div>
    </div>
    </div>
</div>
</header>


<main class="container">
        <article class="article margin-top20">

        <!-- 文章分类和上一篇\下一篇 -->
        <div class="box columns">
            <!-- 文章分类 -->
            <div class="column is-two-fifth">
                <div class="categproe-name">分类：</div>
                <ul class="post-categories">
	<li><a href="https://cn-blogs.cn/archives/category/development/python" rel="category tag">Python</a></li></ul>            </div>
            <!-- 文章分类结束 -->

            <!-- 上一篇和下一篇 -->
            <div class="column is-two-fifth is-offset-5">
                
	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://cn-blogs.cn/archives/1968.html" rel="prev">上一篇：Cyrus SASL介绍</a></div><div class="nav-next"><a href="https://cn-blogs.cn/archives/1181.html" rel="next">下一篇：Beautiful Soup  XML数据解析</a></div></div>
	</nav>            </div>
            <!-- 上一篇和下一篇结束 -->
        </div>

        <!-- 文章信息 -->
        <!-- 文章标题 -->
        <div class="title is-3 has-text-centered">
            Python 爬虫模块 &#8211; urllib and urllib2        </div>
        <!-- 文章标题结束 -->

        <!-- 文章作者、发布时间、更新时间 -->
        <div class="subtitle is-5 has-text-centered">
            <span class="entry-author"><a href="https://cn-blogs.cn/archives/author/admin" title="由admin发布" rel="author">admin</a></span>
            <span class="entry-date">2017/08/01</span>
            <span class="update is-hidden">2018-05-28</span>
        </div>
        <!-- 文章作者、发布时间、更新时间结束 -->

        <!-- 文章内容 -->
        <div class="content article-body">
            <div class="content">
                <h4>Python2中的urllib</h4>
<p>Python2中urllib和urllib2模块都做与请求URL相关的操作。在功能上的差别：<br />
<strong>1、urllib提供urlencode方法，而urllib2没有</strong><br />
urlencode方法将mapping对象或者两个元素的元组转换为百分号编码(Percent-encoding)字符串即url编码；可以被urlopen()方法使用。<br />
<code>urlencode({"user":"马云","company":"阿里巴巴"})<br />
'company=%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4&amp;user=%E9%A9%AC%E4%BA%91'</code></p>
<blockquote class="wp-embedded-content" data-secret="AnC6j6RaXr"><p><a href="https://cn-blogs.cn/archives/2718.html">百分号编码(URL编码)</a></p></blockquote>
<p><iframe class="wp-embedded-content" sandbox="allow-scripts" security="restricted" style="position: absolute; clip: rect(1px, 1px, 1px, 1px);" src="https://cn-blogs.cn/archives/2718.html/embed#?secret=AnC6j6RaXr" data-secret="AnC6j6RaXr" width="500" height="282" title="《百分号编码(URL编码)》—青春部落" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe><br />
<strong>2、urllib2.urlopen()方法可以接受request对象或者url。</strong><br />
urllib.urlopen()只能接受url，毕竟urllib模块并没有request类。Request类是一个URL请求的抽象；简化了urllib中对请求的包装。</p>
<h4>Python3 中的urllib</h4>
<p>官网：https://docs.python.org/3.7/library/internet.html<br />
在Python3 中urllib和urllib2都被整合进了urllib模块；urllib模块是收集reqeust,error,parse,robotparser模块的软件包。<br />
<strong>urllib :</strong>是一个收集几个模块来处理URL的软件包：<br />
<strong>urllib.request :</strong> 用于打开和阅读网址<br />
<strong>urllib.error :</strong> 包含urllib.request抛出的异常<br />
<strong>urllib.parse :</strong> 用于解析URL<br />
<strong>urllib.robotparser :</strong>用于解析robots.txt文件</p>
<h4>示例</h4>
<p><code>import urllib<br />
import urllib2<br />
url = 'http://www.someserver.com/cgi-bin/register.cgi'<br />
values = {'name' : 'Michael Foord','location' : 'Northampton','language' : 'Python' }<br />
data = urllib.urlencode(values)<br />
req = urllib2.Request(url, data) #send post<br />
response = urllib2.urlopen(req)<br />
page = response.read()</code></p>
<h4>Request类</h4>
<p><code>class urllib2.Request（url [，data] [，headers] [，origin_req_host] [，unverifiable] ）</code><br />
以下方法描述了所有Request的公共接口，所以必须在子类中重写。</p>
<p><code>Request.add_data（数据）</code><br />
将Request数据设置为数据。除了HTTP处理程序之外，所有的处理程序都会忽略它 &#8211; 而且它应该是一个字节字符串，并且会将请求更改为POST不是GET。</p>
<p><code>Request.get_method（）</code><br />
返回一个指示HTTP请求方法的字符串。这只对HTTP请求有意义，目前总是返回&#8217;GET&#8217;或&#8217;POST&#8217;。</p>
<p><code>Request.has_data（）</code><br />
返回实例是否有非None数据。</p>
<p><code>Request.get_data（）</code><br />
返回实例的数据。</p>
<p><code>Request.add_header（key，val ）</code><br />
向请求添加另一个标头。除了HTTP处理程序之外，所有处理程序都会忽略头文件，并将其添加到发送到服务器的头文件列表中。请注意，不能有多个具有相同名称的头，并且以后的调用将覆盖以前的调用，以防万一键发生冲突。目前，这并不是HTTP功能的损失，因为所有在多次使用时都具有含义的标题具有仅使用一个标题获得相同功能的（标题特定的）方式。</p>
<p><code>Request.add_unredirected_header（key，header ）</code><br />
添加一个头不会被添加到重定向的请求。</p>
<p><code>Request.has_header（header ）</code><br />
返回实例是否具有指定的头（同时检查常规和未重定向）。</p>
<p><code>Request.get_full_url（）</code><br />
返回构造函数中给出的URL。</p>
<p><code>Request.get_type（）</code><br />
返回URL的类型 &#8211; 也称为方案。</p>
<p><code>Request.get_host（）</code><br />
返回要建立连接的主机。</p>
<p><code>Request.get_selector（）</code><br />
返回选择器 &#8211; 发送到服务器的URL部分。</p>
<p><code>Request.get_header（header_name，default = None ）</code><br />
返回给定头的值。如果标题不存在，则返回默认值。</p>
<p><code>Request.header_items（）</code><br />
返回请求头的元组列表（header_name，header_value）。</p>
<p><code>Request.set_proxy（主机，类型）</code><br />
通过连接到代理服务器来准备请求。该主机和类型将取代这些实例，并且该实例的选择将是在构造函数中给出的原始URL。</p>
<p><code>Request.get_origin_req_host（）</code><br />
按照定义返回原始事务的请求主机 RFC 2965。<br />
<code><br />
Request.is_unverifiable（）</code><br />
返回请求是否是无法验证的</p>
<h3>常用类说明</h3>
<h4>urllib2.build_opener([handler, &#8230;])</h4>
<p><code>Return an OpenerDirector instance, which chains the handlers in the order given. handlers can be either instances of BaseHandler, or subclasses of BaseHandler (in which case it must be possible to call the constructor without any parameters). Instances of the following classes will be in front of the handlers, unless the handlers contain them, instances of them or subclasses of them: ProxyHandler (if proxy settings are detected), UnknownHandler, HTTPHandler, HTTPDefaultErrorHandler, HTTPRedirectHandler, FTPHandler, FileHandler, HTTPErrorProcessor.<br />
If the Python installation has SSL support (i.e., if the ssl module can be imported), HTTPSHandler will also be added.<br />
Beginning in Python 2.3, a BaseHandler subclass may also change its handler_order attribute to modify its position in the handlers list.</code></p>
<p>返回一个OpenerDirector实例，它按照给定的顺序链接处理程序。处理程序可以是BaseHandler的实例，也可以是BaseHandler的子类（在这种情况下，必须可以调用没有任何参数的构造函数）。以下类的实例将位于处理程序的前面，除非处理程序包含它们，它们的实例或它们的子类：ProxyHandler（如果检测到代理设置），UnknownHandler，HTTPHandler，HTTPDefaultErrorHandler，HTTPRedirectHandler，FTPHandler，FileHandler，HTTPErrorProcessor。<br />
如果Python安装有SSL支持（即，如果可以导入ssl模块），则还将添加HTTPSHandler。<br />
从Python 2.3开始，一个BaseHandler子类也可以改变其handler_order属性来修改其在处理程序列表中的位置。</p>
<h4>urllib2.install_opener(opener)</h4>
<p><code>Install an OpenerDirector instance as the default global opener. Installing an opener is only necessary if you want urlopen to use that opener; otherwise, simply call OpenerDirector.open() instead of urlopen(). The code does not check for a real OpenerDirector, and any class with the appropriate interface will work.</code></p>
<p>安装OpenerDirector实例作为默认的全局开启程序。只需要安装开瓶器才能使用开瓶器;否则，只需调用OpenerDirector.open（）而不是urlopen（）。代码不检查真正的OpenerDirector，并且具有相应接口的任何类都可以正常工作。<br />
urlib2.install_opener() 会设置urllib2的全局opener。这样后面的使用会很方便，但是不能做更细颗粒度的控制，比如想在程序中使用两个不同的proxy设置等。比较好的做法是不使用install_opener()去更改全局设置，而只是直接调用opener的open方法代替全局的urlopen方法</p>
<h4>class urllib2.Request(url[, data][, headers][, origin_req_host][, unverifiable])</h4>
<p><code>This class is an abstraction of a URL request.<br />
url should be a string containing a valid URL.<br />
data may be a string specifying additional data to send to the server, or None if no such data is needed. Currently HTTP requests are the only ones that use data; the HTTP request will be a POST instead of a GET when the data parameter is provided. data should be a buffer in the standard application/x-www-form-urlencoded format. The urllib.urlencode() function takes a mapping or sequence of 2-tuples and returns a string in this format.<br />
headers should be a dictionary, and will be treated as if add_header() was called with each key and value as arguments. This is often used to “spoof” the User-Agent header value, which is used by a browser to identify itself – some HTTP servers only allow requests coming from common browsers as opposed to scripts. For example, Mozilla Firefox may identify itself as "Mozilla/5.0 (X11; U; Linux i686) Gecko/20071127 Firefox/2.0.0.11", while urllib2‘s default user agent string is "Python-urllib/2.6" (on Python 2.6).<br />
The final two arguments are only of interest for correct handling of third-party HTTP cookies:<br />
origin_req_host should be the request-host of the origin transaction, as defined by RFC 2965. It defaults to cookielib.request_host(self). This is the host name or IP address of the original request that was initiated by the user. For example, if the request is for an image in an HTML document, this should be the request-host of the request for the page containing the image.<br />
unverifiable should indicate whether the request is unverifiable, as defined by RFC 2965. It defaults to False. An unverifiable request is one whose URL the user did not have the option to approve. For example, if the request is for an image in an HTML document, and the user had no option to approve the automatic fetching of the image, this should be true.</code></p>
<p>这个类是一个URL请求的抽象。<br />
url应该是一个包含有效URL的字符串。<br />
数据可以是指定要发送到服务器的附加数据的字符串，如果不需要这样的数据，则为None。目前HTTP请求是唯一使用数据的请求;当提供数据参数时，HTTP请求将是POST而不是GET。数据应该是标准应用程序的缓冲区/ x-www-form-urlencoded格式。 urllib.urlencode（）函数采用2元组的映射或序列，并以此格式返回一个字符串。<br />
标题应该是一个字典，并且将被视为使用每个键和值作为参数调用add_header（）。这通常用于“欺骗”用户代理头值，由浏览器用来标识自身 &#8211; 一些HTTP服务器只允许来自普通浏览器的请求而不是脚本。例如，Mozilla Firefox可能会将自己标识为“Mozilla / 5.0（X11; U; Linux i686）Gecko / 20071127 Firefox / 2.0.0.11”，而urllib2的默认用户代理字符串是“Python-urllib / 2.6” 2.6）。<br />
最后两个参数仅用于正确处理第三方HTTP Cookie：<br />
origin_req_host应该是RFC 2965定义的源事务的请求主机。它默认为cookielib.request_host（self）。这是用户发起的原始请求的主机名或IP地址。例如，如果请求是针对HTML文档中的图像，则应该是包含该图像的页面请求的请求主机。<br />
不可验证的应该指示请求是否是无法验证的，由RFC 2965定义。它默认为False。无法验证的请求是用户无权批准的URL。例如，如果请求是针对HTML文档中的图像，并且用户没有选择批准自动提取图像，则应该是这样。</p>
            </div>
        </div>
        <!-- 文章内容结束 -->
    </article>


</main><!-- .content-area -->

<div class="footer">
    <div class="container">

<div class="has-text-centered">
Copyright©2015-20178 cn-blogs.cn. All Rights Reserved. 鲁ICP备18001334号-2
</div>
    </div>
  </div>

</body>
</html>
