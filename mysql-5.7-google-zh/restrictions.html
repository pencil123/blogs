<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>附录C限制和限制</title>
<link rel="stylesheet" href="./images/mvl.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2">
<link rel="start" href="/mysql-5.7-google-zh/index.html" title="{书名}">
<link rel="up" href="/mysql-5.7-google-zh/restrictions.html" title="">
<link rel="prev" href="/mysql-5.7-google-zh/error-handling.html" title="附录B错误，错误代码和常见问题">
<link rel="next" href="/mysql-5.7-google-zh/indexes.html" title="附录D索引">
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./images/translateelement.css"></head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tbody><tr>
<th colspan="3" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录C限制和限制</font></font></th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="/mysql-5.7-google-zh/error-handling.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a>&nbsp;</td>
<th width="60%" align="center"></th>
<td width="20%" align="right">&nbsp;<a accesskey="n" href="/mysql-5.7-google-zh/indexes.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个</font></font></a></td>
</tr>
</tbody></table>
<hr>
</div>
<div class="appendix">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录C限制和限制</font></font></h1>

</div>

</div>

</div>
<div class="toc">
<p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录</font></font></b></p><dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#stored-program-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.1对存储程序的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#condition-handling-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.2条件处理的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#cursor-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.3服务器端游标的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#subquery-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.4限制子查询</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#view-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.5对视图的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#xa-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.6对XA交易的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#charset-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.7字符集限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#performance-schema-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.8对性能模式的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#pluggable-authentication-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.9对可插入认证的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#limits"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL中的限制</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#joins-limits"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.1连接限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#database-count-limit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.2限制数据库和表的数量</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#table-size-limit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.3桌子尺寸的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#column-count-limit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.4表列数和行大小的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#limits-frm-file"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.5由.frm文件结构提供的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#limits-windows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.6 Windows平台限制</font></font></a></span></dt></dl></dd></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    这里的讨论描述了适用于使用MySQL功能的限制，例如子查询或视图。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="stored-program-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.1对存储程序的限制</font></font></h2>
</div>
</div>
</div>
<a class="indexterm" name="idm140527940963296"></a><a class="indexterm" name="idm140527940961808"></a><a class="indexterm" name="idm140527940960320"></a><a class="indexterm" name="idm140527940958832"></a><a class="indexterm" name="idm140527940957344"></a><a class="indexterm" name="idm140527940955856"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些限制适用于</font></font><a class="xref" href="/mysql-5.7-google-zh/stored-programs-views.html" title="第23章存储程序和视图"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第23章“ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储程序和视图”中</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍的功能
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这里提到的一些限制适用于所有存储的例程; </font><font style="vertical-align: inherit;">即存储过程和存储函数。</font></font><a class="link" href="/mysql-5.7-google-zh/restrictions.html#stored-routines-function-restrictions" title="存储函数的限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储函数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也有一些
       </font><a class="link" href="/mysql-5.7-google-zh/restrictions.html#stored-routines-function-restrictions" title="存储函数的限制"><font style="vertical-align: inherit;">限制，</font></a><font style="vertical-align: inherit;">但不适用于存储过程。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      存储函数的限制也适用于触发器。</font></font><a class="link" href="/mysql-5.7-google-zh/restrictions.html#stored-routines-trigger-restrictions" title="触发器的限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">触发器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也有一些
       </font><a class="link" href="/mysql-5.7-google-zh/restrictions.html#stored-routines-trigger-restrictions" title="触发器的限制"><font style="vertical-align: inherit;">特定的限制</font></a><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      存储过程的限制也适用于</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#do" title="13.2.3 DO语法"><code class="literal">DO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事件计划程序事件定义</font><font style="vertical-align: inherit;">的
       </font><font style="vertical-align: inherit;">子句。</font><font style="vertical-align: inherit;">还有一些
       </font></font><a class="link" href="/mysql-5.7-google-zh/restrictions.html#stored-routines-event-restrictions" title="事件调度程序限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定的事件限制</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<h3><a name="stored-routine-sql-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储例程中不允许的SQL语句</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      存储的例程不能包含任意的SQL语句。</font><font style="vertical-align: inherit;">以下声明是不允许的：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          锁定语句</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#lock-tables" title="13.3.5锁定表和解锁表语法"><code class="literal">LOCK
          TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#lock-tables" title="13.3.5锁定表和解锁表语法"><code class="literal">UNLOCK
          TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#alter-view" title="13.1.10 ALTER VIEW语法"><code class="literal">ALTER VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">LOAD
          TABLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          SQL语句制备（</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#prepare" title="13.5.1 PREPARE语法"><code class="literal">PREPARE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#execute" title="13.5.2 EXECUTE语法"><code class="literal">EXECUTE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE语法"><code class="literal">DEALLOCATE PREPARE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）可以在存储过程中使用，但没有存储功能或触发器。</font><font style="vertical-align: inherit;">因此，存储的函数和触发器不能使用动态SQL（将语句构造为字符串，然后执行它们）。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一般来说，SQL准备语句中不允许的语句在存储的程序中也是不允许的。</font><font style="vertical-align: inherit;">有关作为预处理语句支持的语句列表，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#sql-syntax-prepared-statements" title="13.5准备的SQL语句语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.5节“准备</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好的
           </font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#sql-syntax-prepared-statements" title="13.5准备的SQL语句语法"><font style="vertical-align: inherit;">SQL语句语法”</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例外情况是</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#signal" title="13.6.7.5 SIGNAL语法"><code class="literal">SIGNAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL语法"><code class="literal">RESIGNAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS语法"><code class="literal">GET DIAGNOSTICS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它们不作为准备好的陈述被允许，但是在存储的程序中被允许。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          因为局部变量仅在存储程序执行期间处于作用域中，所以在存储程序中创建的预处理语句中不允许对它们进行引用。</font><font style="vertical-align: inherit;">编写的语句范围是当前会话，而不是存储的程序，因此语句可以在程序结束后执行，此时变量将不再处于范围内。</font><font style="vertical-align: inherit;">例如，</font><font style="vertical-align: inherit;">不能用作准备好的声明。</font><font style="vertical-align: inherit;">这个限制也适用于存储过程和函数参数。</font><font style="vertical-align: inherit;">请参见
           </font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><font style="vertical-align: inherit;">第13.5.1节“PREPARE语法”</font></a><font style="vertical-align: inherit;">。
        </font></font><code class="literal">SELECT ... INTO
          <em class="replaceable"><code>local_var</code></em></code><font style="vertical-align: inherit;"></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#prepare" title="13.5.1 PREPARE语法"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在所有存储的程序（存储过程和函数，触发器和事件）中，解析器将
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#commit" title="13.3.1 START TRANSACTION，COMMIT和ROLLBACK语法"><code class="literal">BEGIN [WORK]</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          视为</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END复合语句句法"><code class="literal">BEGIN ...
          END</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块</font><font style="vertical-align: inherit;">的开始
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要在此上下文中开始交易，请</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#commit" title="13.3.1 START TRANSACTION，COMMIT和ROLLBACK语法"><code class="literal">START
          TRANSACTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<h3><a name="stored-routines-function-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储函数的限制</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      存储的函数中不允许执行以下附加语句或操作。</font><font style="vertical-align: inherit;">它们在存储过程中是允许的，但从存储函数或触发器中调用的存储过程除外。</font><font style="vertical-align: inherit;">例如，如果您
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush" title="13.7.6.3 FLUSH语法"><code class="literal">FLUSH</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在存储过程中使用，则无法从存储的函数或触发器调用该存储过程。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          执行显式或隐式提交或回滚的语句。</font><font style="vertical-align: inherit;">SQL标准并不要求支持这些语句，该标准规定每个DBMS供应商都可以决定是否允许这些语句。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回结果集的语句。</font><font style="vertical-align: inherit;">这包括
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不具有的声明</font><font style="vertical-align: inherit;">条款等语句，如</font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">和
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">函数可以</font><font style="vertical-align: inherit;">使用游标和</font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">处理结果集
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO语法"><font style="vertical-align: inherit;">第13.2.9.1节“SELECT ... INTO语法”</font></a><font style="vertical-align: inherit;">和
           </font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#cursors" title="13.6.6游标"><font style="vertical-align: inherit;">第13.6.6节“光标”</font></a><font style="vertical-align: inherit;">。
        </font></font><code class="literal">INTO
          <em class="replaceable"><code>var_list</code></em></code><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show" title="13.7.5 SHOW语法"><code class="literal">SHOW</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE语法"><code class="literal">CHECK TABLE</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO语法"><code class="literal">SELECT ... INTO
          <em class="replaceable"><code>var_list</code></em></code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#fetch" title="13.6.6.3游标FETCH语法"><code class="literal">FETCH</code></a><font style="vertical-align: inherit;"></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO语法"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#cursors" title="13.6.6游标"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush" title="13.7.6.3 FLUSH语法"><code class="literal">FLUSH</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 声明。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          存储的函数不能递归使用。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          存储的函数或触发器不能修改已调用函数或触发器的语句（用于读取或写入）的表。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果在不同的别名下在存储函数中多次引用临时表，</font><font style="vertical-align: inherit;">
          则会发生错误，即使引用出现在函数内的不同语句中也是如此。
        </font></font><code class="literal">Can't reopen
          table:
          '<em class="replaceable"><code>tbl_name</code></em><code class="literal"></code>'</code><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#handler" title="13.2.4 HANDLER语法"><code class="literal">HANDLER ...
          READ</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 调用存储函数的语句可能导致复制错误并被禁止。
</font></font></p></li></ul>
</div>
<h3><a name="stored-routines-trigger-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">触发器的限制</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于触发器，以下附加限制适用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          触发器不会被外键操作激活。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用基于行的复制时，从站上的触发器不会由源于主站的语句激活。</font><font style="vertical-align: inherit;">使用基于语句的复制时，从属设备上的触发器被激活。</font><font style="vertical-align: inherit;">有关更多信息，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/replication.html#replication-features-triggers" title="16.4.1.35复制和触发器"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第16.4.1.35节“复制和触发器”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#return" title="13.6.5.7 RETURN语法"><code class="literal">RETURN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句在触发器中不被允许，它不能返回值。</font><font style="vertical-align: inherit;">要立即退出触发器，请使用该
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#leave" title="13.6.5.4 LEAVE语法"><code class="literal">LEAVE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库中的</font><font style="vertical-align: inherit;">
          表格不允许触发器
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">他们也没有被允许上
           </font></font><code class="literal">INFORMATION_SCHEMA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">performance_schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表。</font><font style="vertical-align: inherit;">这些表实际上是视图，触发器不允许在视图上使用。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          触发器缓存不检测基础对象的元数据何时发生更改。</font><font style="vertical-align: inherit;">如果触发器使用表并且自触发器加载到缓存后表已更改，则触发器将使用过时的元数据进行操作。
</font></font></p></li></ul>
</div>
<h3><a name="stored-routine-name-conflicts"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名称存储例程中的冲突</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      相同的标识符可能用于例程参数，本地变量和表列。</font><font style="vertical-align: inherit;">而且，可以在嵌套块中使用相同的本地变量名称。</font><font style="vertical-align: inherit;">例如：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE PROCEDURE p（i INT）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
开始</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  DECLARE INT DEFAULT 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  选择我从t;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  开始</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    声明INT DEFAULT 1;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    选择我从t;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  结束;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结束;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在这种情况下，标识符不明确，并应用以下优先规则：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          局部变量优先于常规参数或表格列。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例程参数优先于表列。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          内部块中的局部变量优先于外部块中的局部变量。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      变量优先于表列的行为是非标准的。
</font></font></p>
<h3><a name="stored-routines-replication-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制注意事项</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用存储的例程可能会导致复制问题。</font><font style="vertical-align: inherit;">这个问题将在</font></font><a class="xref" href="/mysql-5.7-google-zh/stored-programs-views.html#stored-programs-logging" title="23.7存储程序的二进制记录"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第23.7节“存储程序的二进制日志记录”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进一步讨论</font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该
       </font><font style="vertical-align: inherit;">
      选项适用于表格，视图和触发器。</font><font style="vertical-align: inherit;">它不适用于存储过程和函数或事件。</font><font style="vertical-align: inherit;">要筛选对后面的对象进行操作的语句，请使用一个或多个
       </font><font style="vertical-align: inherit;">选项。
</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table=<em class="replaceable"><code>db_name.tbl_name</code></em></code></a><font style="vertical-align: inherit;"></font><code class="option">--replicate-*-db</code><font style="vertical-align: inherit;"></font></p>
<h3><a name="stored-routines-debugging-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调试注意事项</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      没有存储的日常调试工具。
</font></font></p>
<h3><a name="stored-routines-standard-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL：2003标准中不支持的语法</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL存储例程语法基于SQL：2003标准。</font><font style="vertical-align: inherit;">目前不支持该标准中的以下项目：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">UNDO</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 处理器
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">FOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 循环
</font></font></p></li></ul>
</div>
<h3><a name="idm140527940864336"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并发注意事项</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      为了防止会话之间的交互问题，当客户端发出语句时，服务器使用可用于执行语句的例程和触发器的快照。</font><font style="vertical-align: inherit;">也就是说，服务器计算在执行语句期间可能使用的过程，函数和触发器的列表，加载它们，然后继续执行语句。</font><font style="vertical-align: inherit;">当语句执行时，它看不到其他会话执行的例程更改。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      为了获得最大的并发性，存储的函数应该尽量减少其副作用; </font><font style="vertical-align: inherit;">特别是，更新已存储函数中的表可以减少该表上的并发操作。</font><font style="vertical-align: inherit;">存储函数在执行之前获取表锁，以避免由于语句执行的顺序与它们出现在日志中的顺序不匹配而导致二进制日志不一致。</font><font style="vertical-align: inherit;">当使用基于语句的二进制日志记录时，会记录调用函数的语句，而不是在函数中执行的语句。</font><font style="vertical-align: inherit;">因此，更新相同基础表的存储函数不会并行执行。</font><font style="vertical-align: inherit;">相比之下，存储过程不会获取表级锁。</font><font style="vertical-align: inherit;">在存储过程中执行的所有语句都写入二进制日志，</font><font style="vertical-align: inherit;">即使是基于语句的二进制日志记录。</font><font style="vertical-align: inherit;">看到
      </font></font><a class="xref" href="/mysql-5.7-google-zh/stored-programs-views.html#stored-programs-logging" title="23.7存储程序的二进制记录"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第23.7节“存储程序的二进制记录”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<h3><a name="stored-routines-event-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事件调度程序限制</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下限制是特定于事件调度程序的：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          事件名称以不区分大小写的方式处理。</font><font style="vertical-align: inherit;">例如，您不能在名称</font></font><code class="literal">anEvent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font><font style="vertical-align: inherit;">相同数据库中有两个事件</font></font><code class="literal">AnEvent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          事件可能不会被存储的例程，触发器或其他事件创建，更改或删除。</font><font style="vertical-align: inherit;">事件也可能不会创建，更改或删除存储的例程或触发器。</font><font style="vertical-align: inherit;">（错误＃16409，错误＃18896）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#lock-tables" title="13.3.5锁定表和解锁表语法"><code class="literal">LOCK TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句生效时，</font><font style="vertical-align: inherit;">禁止对事件的DDL语句
           </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用间隔事件时序</font></font><code class="literal">YEAR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">QUARTER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">MONTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并
           </font></font><code class="literal">YEAR_MONTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在几个月解决; </font><font style="vertical-align: inherit;">那些使用任何其他时间间隔的问题都会在几秒钟内解决 </font><font style="vertical-align: inherit;">没有办法让计划在同一秒发生的事件以给定的顺序执行。</font><font style="vertical-align: inherit;">此外，由于四舍五入，线程应用程序的性质以及创建事件和发出执行事件所需的非零时间长度可能会延迟多达1或2秒。</font><font style="vertical-align: inherit;">但是，
           </font></font><a class="link" href="/mysql-5.7-google-zh/information-schema.html#events-table" title="24.7 INFORMATION_SCHEMA事件表"><code class="literal">INFORMATION_SCHEMA.EVENTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格的
           </font></font><code class="literal">LAST_EXECUTED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列或
           </font></font><code class="literal">mysql.event</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格中显示的时间
          </font></font><code class="literal">last_executed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列总是精确到实际事件执行时间的一秒钟内。</font><font style="vertical-align: inherit;">（参见Bug＃16522。）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          事件正文中包含的语句的每次执行都在一个新的连接中进行; </font><font style="vertical-align: inherit;">因此，这些语句在给定的用户会话中对服务器的语句计数（例如</font></font><code class="literal">Com_select</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">Com_insert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显示）
           </font><font style="vertical-align: inherit;">没有影响</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show-status" title="13.7.5.35 SHOW STATUS语法"><code class="literal">SHOW STATUS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，这些计数</font><font style="vertical-align: inherit;">在全球范围内</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行了</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新。</font><font style="vertical-align: inherit;">（Bug＃16422）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          事件不支持晚于Unix Epoch结束的时间; </font><font style="vertical-align: inherit;">这大约是2038年的开始。事件调度程序明确不允许这样的日期。</font><font style="vertical-align: inherit;">（Bug＃16396）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font><font style="vertical-align: inherit;">
          对存储函数，用户定义的函数</font><font style="vertical-align: inherit;">以及</font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">和
           </font></font><code class="literal">ON SCHEDULE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中的
           </font><font style="vertical-align: inherit;">表的引用</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些引用是不允许的。</font><font style="vertical-align: inherit;">（有关更多信息，请参见错误＃22830。）
</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-event" title="13.1.12创建事件语法"><code class="literal">CREATE EVENT</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT语法"><code class="literal">ALTER EVENT</code></a><font style="vertical-align: inherit;"></font></p></li></ul>
</div>
<p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NDB群集中存储的例程和触发器。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        存储过程，存储函数和触发器均由使用</font></font><a class="link" href="/mysql-5.7-google-zh/mysql-cluster.html" title="第21章MySQL NDB集群7.5和NDB集群7.6"><code class="literal">NDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        存储引擎的</font><font style="vertical-align: inherit;">表支持</font><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">但是，请记住，它们</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在充当Cluster SQL节点的MySQL服务器之间自动传播。</font><font style="vertical-align: inherit;">这是因为以下原因：

</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储引擎</font><font style="vertical-align: inherit;">
              将存储的例程定义保存在</font><font style="vertical-align: inherit;">系统数据库的
               </font><font style="vertical-align: inherit;">表中
               </font><font style="vertical-align: inherit;">，因此不参与群集。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              的</font></font><code class="filename">.TRN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="filename">.TRG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含有触发定义文件不被读取
               </font></font><a class="link" href="/mysql-5.7-google-zh/mysql-cluster.html" title="第21章MySQL NDB集群7.5和NDB集群7.6"><code class="literal">NDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的存储引擎，和群集节点之间不会被复制。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

        与NDB簇表交互的任何存储程序或触发器必须通过运行适当的重新创建
         </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-procedure" title="13.1.16 CREATE PROCEDURE和CREATE FUNCTION语法"><code class="literal">CREATE PROCEDURE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-function" title="13.1.13 CREATE FUNCTION语法"><code class="literal">CREATE FUNCTION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者
         </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-trigger" title="13.1.20 CREATE TRIGGER语法"><code class="literal">CREATE TRIGGER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">说，你希望使用存储程序或触发器集群中参与的每个MySQL服务器上的发言。</font><font style="vertical-align: inherit;">同样，对现有存储例程或触发器的任何更改都必须在所有集群SQL节点上使用</font><font style="vertical-align: inherit;">访问集群的每个MySQL服务器上</font><font style="vertical-align: inherit;">的相应</font></font><code class="literal">ALTER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">DROP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">显式执行
         </font><font style="vertical-align: inherit;">。

</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            千万</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">试图通过将任何解决在前面提到的第一项描述的问题</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库表使用的</font></font><a class="link" href="/mysql-5.7-google-zh/mysql-cluster.html" title="第21章MySQL NDB集群7.5和NDB集群7.6"><code class="literal">NDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储引擎。
            </font><span class="emphasis"><em><font style="vertical-align: inherit;">不支持</font></em></span></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更改</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库中</font><font style="vertical-align: inherit;">的系统表，
            </font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且很可能会产生不良结果。
</font></font></p>
</div>
<p>
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="condition-handling-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.2条件处理的限制</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940813808"></a><a class="indexterm" name="idm140527940812320"></a><p>
      <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#signal" title="13.6.7.5 SIGNAL语法"><code class="literal">SIGNAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL语法"><code class="literal">RESIGNAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS语法"><code class="literal">GET DIAGNOSTICS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不允许作为准备好的陈述。</font><font style="vertical-align: inherit;">例如，这个陈述是无效的：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备stmt1从'信号SQLSTATE“02000”';
</font></font></pre><p>
      <code class="literal">SQLSTATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">课堂</font></font><code class="literal">'04'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中的</font><font style="vertical-align: inherit;">价值观
       </font><font style="vertical-align: inherit;">并未被专门处理。</font><font style="vertical-align: inherit;">它们的处理方式与其他例外情况相同。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在标准SQL中，第一个条件与
       </font></font><code class="literal">SQLSTATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前一个SQL语句的返回值有关。</font><font style="vertical-align: inherit;">在MySQL中，这是不能保证的，所以为了得到主要的错误，你不能这样做：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GET DIAGNOSTICS CONDITION 1 @errno = MYSQL_ERRNO;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      相反，请这样做：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GET DIAGNOSTICS @cno = NUM​​BER;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GET DIAGNOSTICS CONDITION @cno @errno = MYSQL_ERRNO;</font></font><font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="cursor-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.3服务器端游标的限制</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940798864"></a><a class="indexterm" name="idm140527940797408"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      服务器端游标使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">在C API中实现
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">存储例程中的游标使用相同的实现。</font><font style="vertical-align: inherit;">服务器端游标使结果集能够在服务器端生成，但不会传输到客户端，除了客户端请求的那些行。</font><font style="vertical-align: inherit;">例如，如果客户端执行查询但仅对第一行感兴趣，则不传输其余行。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在MySQL中，服务器端游标将物化为内部临时表。</font><font style="vertical-align: inherit;">最初，这是一个</font></font><code class="literal">MEMORY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      表，但被转换为</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当其大小超过了的最小值表
       </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_max_heap_table_size"><code class="literal">max_heap_table_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_tmp_table_size"><code class="literal">tmp_table_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量。</font><font style="vertical-align: inherit;">对于创建用于保存游标结果集的内部临时表，同样适用于其他内部临时表的使用。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/optimization.html#internal-temporary-tables" title="8.4.4在MySQL中使用内部临时表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.4.4节“MySQL中的内部临时表使用”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">实现的一个限制是对于大的结果集，通过游标检索其行可能会很慢。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      游标是只读的; </font><font style="vertical-align: inherit;">你不能使用游标来更新行。
    </font></font></p><p>
      <code class="literal">UPDATE WHERE CURRENT OF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code class="literal">DELETE
      WHERE CURRENT OF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有实现，因为可更新游标不支持。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      游标是不可保持的（在提交之后不保持打开状态）。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      游标是敏感的。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      游标不可滚动。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      游标未被命名。</font><font style="vertical-align: inherit;">语句处理程序充当游标ID。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      每个准备好的语句只能打开一个游标。</font><font style="vertical-align: inherit;">如果你需要几个游标，你必须准备几个语句。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果语句在准备模式下不受支持，则不能使用生成结果集的语句的游标。</font><font style="vertical-align: inherit;">这包括语句，如</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE语法"><code class="literal">CHECK
      TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">HANDLER READ</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show-binlog-events" title="13.7.5.2 SHOW BINLOG EVENTS句法"><code class="literal">SHOW BINLOG EVENTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="subquery-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.4限制子查询</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940778560"></a><a class="indexterm" name="idm140527940777104"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通常，您不能修改表并从子查询中的同一个表中进行选择。</font><font style="vertical-align: inherit;">例如，此限制适用于以下形式的声明：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DELETE FROM t WHERE ...（SELECT ... FROM t ...）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPDATE t ... WHERE col =（SELECT ... FROM t ...）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{INSERT | REPLACE} INTO t（SELECT ... FROM t ...）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例外：如果对于使用派生表的修改表（子句中的子查询</font></font><code class="literal">FROM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）并且该派生表已物化而不是合并到外部查询中</font><font style="vertical-align: inherit;">，则上述禁止不适用
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/optimization.html#derived-table-optimization" title="8.2.2.3优化派生表和视图引用"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.2.2.3节“优化派生表和视图引用”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）示例：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPDATE t ... WHERE col =（SELECT * FROM（SELECT ... FROM t ...）AS dt ...）;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这里派生表的结果被物化为一个临时表，因此</font></font><code class="literal">t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在更新</font></font><code class="literal">t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生</font><font style="vertical-align: inherit;">时已经选择
           </font><font style="vertical-align: inherit;">了相关的行</font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行比较操作只得到部分支持：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于</font><font style="vertical-align: inherit;">，
               </font><font style="vertical-align: inherit;">可以是
               </font><font style="vertical-align: inherit;">-tuple（使用行构造函数语法指定），并且子查询可以返回</font><font style="vertical-align: inherit;">-tuples </font><font style="vertical-align: inherit;">行
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因此允许的语法更具体地表示为
              </font></font><code class="literal"><em class="replaceable"><code>expr</code></em> [NOT] IN
              <em class="replaceable"><code>subquery</code></em></code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>n</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>n</code></em><font style="vertical-align: inherit;"></font><code class="literal"><em class="replaceable"><code>row_constructor</code></em> [NOT]
              IN <em class="replaceable"><code>table_subquery</code></em></code>
            </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              因为</font><font style="vertical-align: inherit;">，
               </font><font style="vertical-align: inherit;">必须是标量值，子查询必须是列子查询; </font><font style="vertical-align: inherit;">它不能返回多列的行。
</font></font><code class="literal"><em class="replaceable"><code>expr</code></em>
              <em class="replaceable"><code>op</code></em> {ALL|ANY|SOME}
              <em class="replaceable"><code>subquery</code></em></code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          换句话说，对于返回</font></font><em class="replaceable"><code>n</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-tuples </font><font style="vertical-align: inherit;">行的子查询
           </font><font style="vertical-align: inherit;">，这是支持的：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><em class="replaceable"><code>expr_1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，...，</font></font><em class="replaceable"><code>expr_n</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）[NOT] IN</font></font><em class="replaceable"><code>table_subquery</code></em>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          但是这不被支持：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><em class="replaceable"><code>expr_1</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，...，</font></font><em class="replaceable"><code>expr_n</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font><em class="replaceable"><code>op</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ALL | ANY | SOME}</font></font><em class="replaceable"><code>subquery</code></em>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          支持行比较
           </font></font><code class="literal">IN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是其他的原因
           </font></font><code class="literal">IN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是通过将其重写为一系列</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#operator_equal"><code class="literal">=</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          比较和</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#operator_and"><code class="literal">AND</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作来实现的。</font><font style="vertical-align: inherit;">这种方法不能用于</font></font><code class="literal">ALL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">ANY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">SOME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          中子查询</font></font><code class="literal">FROM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句不能是相关子查询。</font><font style="vertical-align: inherit;">它们在查询执行过程中整体实现（评估为生成结果集），因此无法对外部查询的每行进行评估。</font><font style="vertical-align: inherit;">优化器延迟实现，直到需要结果为止，这可能允许实现物化。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/optimization.html#derived-table-optimization" title="8.2.2.3优化派生表和视图引用"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.2.2.3节“优化派生表和视图引用”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><code class="literal">LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于某些子查询操作符，</font><font style="vertical-align: inherit;">
          MySQL不支持</font><font style="vertical-align: inherit;">子查询：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SELECT * FROM t1</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;   </font></font><strong class="userinput"><code>WHERE s1 IN (SELECT s2 FROM t2 ORDER BY s1 LIMIT 1);</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1235（42000）：此版本的MySQL尚不支持</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 'LIMIT＆IN / ALL / ANY / SOME subquery'</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL允许子查询引用具有数据修改副作用的存储函数，例如将行插入表中。</font><font style="vertical-align: inherit;">例如，如果</font></font><code class="literal">f()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插入行，以下查询可以修改数据：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT ... WHERE x IN（SELECT f（）...）;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此行为是对SQL标准的扩展。</font><font style="vertical-align: inherit;">在MySQL中，它可能会产生非确定性结果，因为
           </font></font><code class="literal">f()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于给定查询的不同执行，可能会执行不同次数，具体取决于优化器选择如何处理它。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于基于语句或混合格式的复制，这种不确定性的一个含义是这样的查询可以在主服务器及其从服务器上产生不同的结果。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="view-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.5对视图的限制</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940733808"></a><a class="indexterm" name="idm140527940732320"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      视图处理未优化：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          无法在视图上创建索引。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          索引可以用于使用合并算法处理的视图。</font><font style="vertical-align: inherit;">但是，使用可温度算法处理的视图无法利用其基础表上的索引（尽管可以在生成临时表时使用索引）。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在MySQL 5.7.7之前，子查询不能用在</font></font><code class="literal">FROM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">视图</font><font style="vertical-align: inherit;">的
       </font><font style="vertical-align: inherit;">子句中。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有一个通用的原则，你不能修改表并从子查询中的同一个表中选择。</font><font style="vertical-align: inherit;">参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/restrictions.html#subquery-restrictions" title="C.4限制子查询"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第C.4节“对子查询的限制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果从视图中选择表视图进行选择，如果视图从子查询中的表中选择并且视图使用合并算法进行评估，则同样的原则也适用。</font><font style="vertical-align: inherit;">例：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE VIEW v1 AS</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT * FROM t2 WHERE EXISTS（SELECT 1 FROM t1 WHERE t1.a = t2.a）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPDATE t1，v2 SET t1.a = 1 WHERE t1.b = v2.b;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果使用临时表评估视图，则
       </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从视图子查询中的表中进行选择，并仍然在外部查询中修改该表。</font><font style="vertical-align: inherit;">在这种情况下，视图将被存储在一个临时表中，因此您并不真正从子查询中的表中进行选择并且</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font><span class="quote"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同时修改它
       </font><span class="quote"><font style="vertical-align: inherit;">” </font></span><span class="quote"><span class="quote"><font style="vertical-align: inherit;">。</font></span></span><span class="quote"><font style="vertical-align: inherit;">“</font></span><font style="vertical-align: inherit;">（这是你可能希望通过</font></font><code class="literal">ALGORITHM = TEMPTABLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在视图定义中</font><font style="vertical-align: inherit;">指定来强制MySQL使用可临时算法的另一个原因
       </font><font style="vertical-align: inherit;">。）
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您可以使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#drop-table" title="13.1.29 DROP TABLE语法"><code class="literal">DROP TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#alter-table" title="13.1.8 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除或更改视图定义中使用的表。</font><font style="vertical-align: inherit;">从没有警告的结果</font></font><code class="literal">DROP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">ALTER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作，即使该无效的观点。</font><font style="vertical-align: inherit;">相反，当使用视图时会出现错误。</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE语法"><code class="literal">CHECK
      TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于检查已经失效的观点</font></font><code class="literal">DROP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">ALTER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      操作。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      关于可更新性的观点，观点的总体目标是如果任何观点在理论上是可更新的，则它在实践中应该是可更新的。</font><font style="vertical-align: inherit;">MySQL尽可能快。</font><font style="vertical-align: inherit;">许多理论上可更新的视图现在可以更新，但限制仍然存在。</font><font style="vertical-align: inherit;">有关详细信息，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/stored-programs-views.html#view-updatability" title="23.5.3可更新和可插入的视图"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第23.5.3节“可更新和可插入的视图”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><a class="indexterm" name="idm140527940713008"></a><a class="indexterm" name="idm140527940711520"></a><a class="indexterm" name="idm140527940710032"></a><a class="indexterm" name="idm140527940708544"></a><a class="indexterm" name="idm140527940707056"></a><a class="indexterm" name="idm140527940705568"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      目前实施意见存在缺陷。</font><font style="vertical-align: inherit;">如果用户被授予必要创建一个视图（基本权限</font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_select"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特权），该用户将无法调用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show-create-view" title="13.7.5.13 SHOW CREATE VIEW语法"><code class="literal">SHOW CREATE VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该对象上，除非用户也被授予的
       </font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_show-view"><code class="literal">SHOW VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特权。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该缺点可能导致使用</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqldump" title="4.5.4 mysqldump  - 数据库备份程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqldump</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">备份数据库时出现问题
       </font><font style="vertical-align: inherit;">，这可能由于权限不足而失败。</font><font style="vertical-align: inherit;">Bug＃22062中描述了此问题。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      解决该问题的方法是管理员手动授予</font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_show-view"><code class="literal">SHOW VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被授予用户</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">权限</font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因为在创建视图时，MySQL不会隐式</font><font style="vertical-align: inherit;">授予该</font><font style="vertical-align: inherit;">权限</font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      视图没有索引，所以索引提示不适用。</font><font style="vertical-align: inherit;">从视图中选择时不允许使用索引提示。
    </font></font></p><p>
      <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show-create-view" title="13.7.5.13 SHOW CREATE VIEW语法"><code class="literal">SHOW CREATE VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">每列</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">显示视图定义</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果从表达式创建列，则默认别名是表达式文本，该文本可能很长。</font><font style="vertical-align: inherit;">
      在最大列长度为64个字符的情况下（不是最大别名长度为256个字符）检查语句中</font><font style="vertical-align: inherit;">列名</font><font style="vertical-align: inherit;">的别名。</font><font style="vertical-align: inherit;">因此，</font><font style="vertical-align: inherit;">如果任何列别名超过64个字符</font><font style="vertical-align: inherit;">，则从输出创建视图</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在以下情况下，这可能会导致具有太长别名的视图出现问题：
</font></font><code class="literal">AS
      <em class="replaceable"><code>alias_name</code></em></code><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-view" title="13.1.21 CREATE VIEW语法"><code class="literal">CREATE VIEW</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show-create-view" title="13.7.5.13 SHOW CREATE VIEW语法"><code class="literal">SHOW
      CREATE VIEW</code></a><font style="vertical-align: inherit;"></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          视图定义无法复制到强制执行列长度限制的较新的从站。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqldump" title="4.5.4 mysqldump  - 数据库备份程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqldump</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建的转储文件</font><font style="vertical-align: inherit;">无法加载到强制执行列长度限制的服务器中。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      解决任一问题的方法是修改每个有问题的视图定义以使用提供较短列名称的别名。</font><font style="vertical-align: inherit;">然后视图将会正确复制，并且可以在不导致错误的情况下进行转储和重新加载。</font><font style="vertical-align: inherit;">要修改定义，请使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#drop-view" title="13.1.32 DROP VIEW语法"><code class="literal">DROP
      VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">再次删除并创建视图</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-view" title="13.1.21 CREATE VIEW语法"><code class="literal">CREATE VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者使用替换定义
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-view" title="13.1.21 CREATE VIEW语法"><code class="literal">CREATE OR REPLACE
      VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于在转储文件中重新加载视图定义时发生的问题，另一个解决方法是编辑转储文件以修改其
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-view" title="13.1.21 CREATE VIEW语法"><code class="literal">CREATE VIEW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。</font><font style="vertical-align: inherit;">但是，这不会更改原始视图定义，这可能会导致后续转储操作出现问题。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="xa-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.6对XA交易的限制</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940676512"></a><a class="indexterm" name="idm140527940675056"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      XA事务支持仅限于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      存储引擎。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外部XA</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL服务器充当资源管理器，客户端程序充当事务管理器。</font><font style="vertical-align: inherit;">对于
       </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内部XA</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL服务器中的存储引擎充当RM，而服务器本身充当TM。</font><font style="vertical-align: inherit;">内部XA支持受个别存储引擎功能的限制。</font><font style="vertical-align: inherit;">处理涉及多个存储引擎的XA事务需要内部XA。</font><font style="vertical-align: inherit;">内部XA的实现要求存储引擎在表处理程序级别支持两阶段提交，目前这仅适用于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      因为</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#xa-statements" title="13.3.7.1 XA事务SQL语法"><code class="literal">XA
      START</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">JOIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><code class="literal">RESUME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句不受支持。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      因为</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#xa-statements" title="13.3.7.1 XA事务SQL语法"><code class="literal">XA
      END</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code class="literal">SUSPEND [FOR MIGRATE]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款不受支持。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于</font><font style="vertical-align: inherit;">全局事务中的每个XA事务</font></font><em class="replaceable"><code>bqual</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><em class="replaceable"><code>xid</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">部分</font><font style="vertical-align: inherit;">不同是当前MySQL XA实现的限制。</font><font style="vertical-align: inherit;">它不是XA规范的一部分。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在MySQL 5.7.7之前，XA事务与复制不兼容。</font><font style="vertical-align: inherit;">这是因为处于</font></font><code class="literal">PREPARED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态</font><font style="vertical-align: inherit;">的XA事务
       </font><font style="vertical-align: inherit;">将在干净的服务器关闭或客户端断开连接时回滚。</font><font style="vertical-align: inherit;">同样，</font><font style="vertical-align: inherit;">如果服务器异常关闭然后重新启动，但</font><font style="vertical-align: inherit;">处于</font></font><code class="literal">PREPARED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态</font><font style="vertical-align: inherit;">的XA事务</font><font style="vertical-align: inherit;">仍然存在
       </font></font><code class="literal">PREPARED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但事务内容无法写入二进制日志。</font><font style="vertical-align: inherit;">在这两种情况下，XA事务都无法正确复制。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在MySQL 5.7.7及更高版本中，行为发生了变化，XA事务分两部分写入二进制日志。</font><font style="vertical-align: inherit;">何时
       </font></font><code class="literal">XA PREPARE </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发行，交易的第一部分</font></font><code class="literal">XA PREPARE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是使用初始GTID编写的。</font><font style="vertical-align: inherit;">A </font></font><code class="literal">XA_prepare_log_event</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于识别二进制日志中的这些事务。</font><font style="vertical-align: inherit;">当</font></font><code class="literal">XA
      COMMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">XA ROLLBACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发出后，交易的第二部分仅包含</font></font><code class="literal">XA
      COMMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">XA ROLLBACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句使用第二GTID写入。</font><font style="vertical-align: inherit;">请注意，通过标识的交易的初始部分
       </font></font><code class="literal">XA_prepare_log_event</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不一定跟随其</font></font><code class="literal">XA COMMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">XA
      ROLLBACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这可能导致任何两个XA事务的交错二进制日志记录。</font><font style="vertical-align: inherit;">XA事务的两个部分甚至可以出现在不同的二进制日志文件中。</font><font style="vertical-align: inherit;">这意味着状态中的XA事务</font></font><code class="literal">PREPARED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在是持久的，直到</font><font style="vertical-align: inherit;">发布</font><font style="vertical-align: inherit;">显式</font></font><code class="literal">XA COMMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">XA
      ROLLBACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，确保XA事务与复制兼容。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在复制从属设备上，在XA事务准备好之后，它立即与从属应用程序线程分离，并且可以由从属设备上的任何线程提交或回滚。</font><font style="vertical-align: inherit;">这意味着相同的XA事务可以</font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#events-transactions-current-table" title="25.11.7.1 events_transactions_current表"><code class="literal">events_transactions_current</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在不同的线程上以不同的状态</font><font style="vertical-align: inherit;">出现在
       </font><font style="vertical-align: inherit;">表中。</font><font style="vertical-align: inherit;">该
       </font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#events-transactions-current-table" title="25.11.7.1 events_transactions_current表"><code class="literal">events_transactions_current</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表显示线程上最新监视事务事件的当前状态，并且在线程空闲时不会更新此状态。</font><font style="vertical-align: inherit;">因此，XA事务仍然可以在</font></font><code class="literal">PREPARED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原始应用程序线程处于其他线程处理状态后</font><font style="vertical-align: inherit;">显示</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要明确确定仍处于</font></font><code class="literal">PREPARED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态且需要恢复的</font><font style="vertical-align: inherit;">XA事务</font><font style="vertical-align: inherit;">，请使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#xa-statements" title="13.3.7.1 XA事务SQL语法"><code class="literal">XA
      RECOVER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 语句而不是性能模式事务表。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在MySQL 5.7.7及更高版本中使用XA事务存在以下限制：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于二进制日志而言，XA事务不能完全恢复到意外停止状态。</font><font style="vertical-align: inherit;">如果有意外的停顿，而服务器是在执行的中间</font></font><code class="literal">XA
          PREPARE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">XA COMMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">XA
          ROLLBACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或</font></font><code class="literal">XA COMMIT ... ONE
          PHASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句时，服务器可能无法恢复到正确的状态，使服务器和二进制日志中的不一致的状态。</font><font style="vertical-align: inherit;">在这种情况下，二进制日志可能包含未应用的额外XA事务，或者未命中应用的XA事务。</font><font style="vertical-align: inherit;">另外，如果启用了GTID，恢复后
           </font></font><code class="literal">@@GLOBAL.GTID_EXECUTED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能无法正确描述已应用的事务。</font><font style="vertical-align: inherit;">请注意，如果意外停止发生之前</font></font><code class="literal">XA
          PREPARE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，之间</font></font><code class="literal">XA PREPARE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">XA COMMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或</font></font><code class="literal">XA
          ROLLBACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）之后，或之后</font></font><code class="literal">XA COMMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
           </font></font><code class="literal">XA ROLLBACK</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），服务器和二进制日志将被正确恢复并处于一致状态。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果复制筛选器或二进制日志筛选器筛选出由XA事务更新的表，由于XA事务处理为空，复制从属服务器可能会因错误而停止。</font><font style="vertical-align: inherit;">只要由XA事务更新的表未被过滤出来并在每个复制从属服务器上复制，您就可以使用与XA事务一起的过滤器。</font><font style="vertical-align: inherit;">如果应用程序必须在某些服务器上过滤掉的表上使用XA事务，则可以通过向XA事务添加对每个地方复制的表的更新来解决此问题，以便XA事务永远不会为空。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush-tables-with-read-lock"><code class="literal">FLUSH TABLES WITH READ LOCK</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 与XA交易不兼容。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于基于语句的复制，XA事务被认为是不安全的。</font><font style="vertical-align: inherit;">如果在主服务器上以并行方式提交的两个XA事务以相反的顺序在从服务器上准备好，则可能会发生无法安全解决的锁相关性，并且可能会导致从服务器发生死锁并导致复制失败。</font><font style="vertical-align: inherit;">对于单线程或多线程复制从站，可能会出现这种情况。</font><font style="vertical-align: inherit;">何时
           </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_binlog_format"><code class="literal">binlog_format=STATEMENT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置，会为XA事务内的DML语句发出警告。</font><font style="vertical-align: inherit;">当
           </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_binlog_format"><code class="literal">binlog_format=MIXED</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者
           </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_binlog_format"><code class="literal">binlog_format=ROW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被设置时，XA事务内的DML语句使用基于行的复制来记录，并且潜在的问题不存在。
</font></font></p></li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="charset-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.7字符集限制</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940621040"></a><a class="indexterm" name="idm140527940619584"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          标识符存储在</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库表（</font></font><code class="literal">user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等）使用</font></font><code class="literal">utf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但标识符可以包含在基本多文种平面（BMP）中的字符。</font><font style="vertical-align: inherit;">标识符中不允许补充字符。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><code class="literal">ucs2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">utf16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">utf16le</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和</font></font><code class="literal">utf32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字符集有以下限制：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              它们不能用作客户端字符集，这意味着它们不适用于</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET
              NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-character-set" title="13.7.4.2 SET CHARACTER SET语法"><code class="literal">SET CHARACTER
              SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/charset.html#charset-connection" title="10.4连接字符集和排序规则"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.4节“连接字符集和排序规则”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              目前不可能使用
               </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA
              INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加载使用这些字符集的数据文件。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">FULLTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引不能在使用任何这些字符集的列上创建。</font><font style="vertical-align: inherit;">但是，您可以</font></font><code class="literal">IN BOOLEAN MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在没有索引的情况下在列上</font><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">搜索。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用的</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_encrypt"><code class="literal">ENCRYPT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是不建议使用这些字符集，因为底层的系统调用希望以零字节结束的字符串。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#operator_regexp"><code class="literal">REGEXP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#operator_regexp"><code class="literal">RLIKE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在逐个字节的方式运营工作，所以他们没有多字节安全，可能产生与多字节字符集意想不到的效果。</font><font style="vertical-align: inherit;">另外，即使给定的排序规则将它们视为相等，这些运算符也会按字节值比较字符，而重音字符可能不会相等。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.8对性能模式的限制</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940594128"></a><a class="indexterm" name="idm140527940592624"></a><a class="indexterm" name="idm140527940591120"></a><a class="indexterm" name="idm140527940589616"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      性能模式避免使用互斥体来收集或生成数据，因此不能保证一致性，并且结果有时可能不正确。</font></font><code class="literal">performance_schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表中的</font><font style="vertical-align: inherit;">事件值
       </font><font style="vertical-align: inherit;">不确定且不可重复。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果您将事件信息保存在另一个表格中，则不应认为原始事件将在以后可用。</font><font style="vertical-align: inherit;">例如，如果您从</font></font><code class="literal">performance_schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表中</font><font style="vertical-align: inherit;">选择事件
       </font><font style="vertical-align: inherit;">到临时表中，打算稍后将该表与原始表连接起来，则可能没有匹配项。
    </font></font></p><p>
      <a class="link" href="/mysql-5.7-google-zh/programs.html#mysqldump" title="4.5.4 mysqldump  - 数据库备份程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqldump</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code class="literal">BACKUP
      DATABASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">忽略</font></font><code class="literal">performance_schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库中的</font><font style="vertical-align: inherit;">表
      </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在表</font></font><code class="literal">performance_schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的数据库不能被锁定</font></font><code class="literal">LOCK TABLES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，除了
       </font><font style="vertical-align: inherit;">表。
    </font></font><code class="literal">setup_<em class="replaceable"><code>xxx</code></em></code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"></font><code class="literal">performance_schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库中的</font><font style="vertical-align: inherit;">
      表</font><font style="vertical-align: inherit;">不能编入索引。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      引用</font></font><code class="literal">performance_schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库中的</font><font style="vertical-align: inherit;">表的查询的结果
       </font><font style="vertical-align: inherit;">不保存在查询缓存中。
    </font></font></p><p><font style="vertical-align: inherit;"></font><code class="literal">performance_schema</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库中的</font><font style="vertical-align: inherit;">
      表</font><font style="vertical-align: inherit;">不会被复制。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      性能架构</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在嵌入式服务器中</font><font style="vertical-align: inherit;">不可用
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      定时器的类型可能因平台而异。</font><font style="vertical-align: inherit;">该
       </font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#performance-timers-table" title="25.11.16.2 performance_timers表"><code class="literal">performance_timers</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表显示哪些事件计时器可用。</font><font style="vertical-align: inherit;">如果此表中给定定时器名称的值为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则该定时器在您的平台上不受支持。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      适用于存储引擎的工具可能不适用于所有存储引擎。</font><font style="vertical-align: inherit;">每个第三方引擎的仪表是引擎维护者的责任。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="pluggable-authentication-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.9对可插入认证的限制</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940570192"></a><a class="indexterm" name="idm140527940568736"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节的第一部分描述了</font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#pluggable-authentication" title="6.3.9可插入认证"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.3.9节“可插入认证”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述的可插入认证框架适用性的一般限制</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">第二部分描述了第三方连接器开发人员如何确定连接器可以利用可插入身份验证功能的程度以及采取哪些步骤来提高兼容性。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里使用</font><font style="vertical-align: inherit;">
      的术语</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本地认证</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是指针对存储在</font></font><code class="literal">mysql.user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">中的密码的认证
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在实现可插入认证之前，这与旧版MySQL服务器提供的认证方法相同。</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows本地认证</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是指使用已经登录到Windows的用户的凭据进行认证，如Windows本地认证插件（</font><font style="vertical-align: inherit;">以下简称</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows插件</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）所实现的那样。
</font></font></p>
<h3><a name="idm140527940562880"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般可插入的身份验证限制</font></font></h3>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connector / C，Connector / C ++：</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          使用这些连接器的客户端只能通过使用本机认证的帐户连接到服务器。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例外：如果连接器构建为</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          动态（而不是静态）</font><font style="vertical-align: inherit;">链接，则连接器支持可插入身份验证，并且</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果安装该版本，或者连接器从源重新编译为针对当前链接进行链接，则连接器</font><font style="vertical-align: inherit;">将加载当前版本</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/网络：</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用连接</font><span class="bold"><strong><font style="vertical-align: inherit;">器/网络的</font></strong></span><font style="vertical-align: inherit;">客户端可以通过使用本机认证或Windows本机认证的帐户连接到服务器。
        </font></font></p></li><li class="listitem"><p>
          <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/ PHP：</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用此连接器的客户端只能通过使用本地认证的帐户连接到服务器，而使用MySQL的本地驱动程序编译PHP（</font></font><code class="literal">mysqlnd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p></li><li class="listitem"><p>
          <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows本机认证：</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过使用Windows插件的帐户进行连接需要Windows域安装程序。</font><font style="vertical-align: inherit;">没有它，使用NTLM身份验证，然后只有本地连接是可能的; </font><font style="vertical-align: inherit;">也就是说，客户端和服务器必须在同一台计算机上运行。
        </font></font></p></li><li class="listitem"><p>
          <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代理用户：</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代理用户支持在客户端可以通过使用实现代理用户功能的插件（即可以返回与连接用户不同的用户名的插件）进行认证的帐户进行连接的范围内可用。</font><font style="vertical-align: inherit;">例如，PAM和Windows插件支持代理用户。</font><font style="vertical-align: inherit;">该
          </font></font><code class="literal">mysql_native_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
          </font></font><code class="literal">sha256_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">认证插件默认情况下不支持代理的用户，但可以被配置成这样; </font><font style="vertical-align: inherit;">请参阅</font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#proxy-users-server-user-mapping" title="服务器支持代理用户映射"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器支持代理用户映射</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：如果所需的客户端插件可用，复制从服务器不仅可以使用使用本地认证的主帐户，还可以通过使用非本地认证的主帐户进行连接。</font><font style="vertical-align: inherit;">如果插件是内置的
          </font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则默认可用。</font><font style="vertical-align: inherit;">否则，必须将插件安装在从站</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量所</font><font style="vertical-align: inherit;">指定的目录中的从站侧
          </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <span class="bold"><strong><a class="link" href="/mysql-5.7-google-zh/storage-engines.html#federated-storage-engine" title="15.8 FEDERATED存储引擎"><code class="literal">FEDERATED</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表：</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font><a class="link" href="/mysql-5.7-google-zh/storage-engines.html#federated-storage-engine" title="15.8 FEDERATED存储引擎"><code class="literal">FEDERATED</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表只能通过使用本地身份验证的远程服务器上的账户访问远程表。
</font></font></p></li></ul>
</div>
<h3><a name="idm140527940539424"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可插入身份验证和第三方连接器</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      第三方连接器开发人员可以使用以下指导原则来确定连接器是否准备好利用可插入身份验证功能以及采取哪些步骤来提高兼容性：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          现有连接器未进行任何更改使用本地身份验证，使用连接器的客户端只能通过使用本机身份验证的帐户连接到服务器。</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，应该根据服务器的最新版本测试连接器，以验证此类连接是否仍可正常工作。</font></font></em></span>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例外情况：如果连接器</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态（而不是静态）</font><font style="vertical-align: inherit;">链接，则连接器可以使用可插入的身份验证，而不进行任何更改，
           </font><font style="vertical-align: inherit;">并且它会在</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装该版本</font><font style="vertical-align: inherit;">时加载当前版本
           </font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要充分利用可插入身份验证功能，</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基于-based </font><font style="vertical-align: inherit;">的连接器</font><font style="vertical-align: inherit;">应该与当前版本的</font><font style="vertical-align: inherit;">连接</font><font style="vertical-align: inherit;">重新链接
           </font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这使连接器可以支持通过需要客户端插件</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（如PAM身份验证所需的明文插件和Windows本地身份验证所需的Windows插件）的</font><font style="vertical-align: inherit;">帐户进行连接
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">与当前</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接还使连接器能够访问安装在默认MySQL插件目录（通常是由本地服务器的</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">的默认值命名的目录）中安装的客户端插件
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果连接器</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          动态</font><font style="vertical-align: inherit;">链接</font><font style="vertical-align: inherit;">，则必须确保</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在客户端主机上安装</font><font style="vertical-align: inherit;">较新版本，
           </font><font style="vertical-align: inherit;">并且连接器在运行时加载它。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          连接器支持给定身份验证方法的另一种方法是直接在客户端/服务器协议中实现它。</font><font style="vertical-align: inherit;">Connector / Net使用此方法为Windows本机认证提供支持。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果连接器应该能够从与默认插件目录不同的目录加载客户端插件，则它必须实现一些客户端用户指定目录的方法。</font><font style="vertical-align: inherit;">可能性包括一个命令行选项或环境变量，连接器可从中获取目录名称。</font><font style="vertical-align: inherit;">标准的MySQL客户端程序，如</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行工具"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqladmin" title="4.5.2 mysqladmin  - 用于管理MySQL服务器的客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqladmin</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          实现一个</font></font><code class="option">--plugin-dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项。</font><font style="vertical-align: inherit;">另请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-plugin-functions" title="27.8.14 C API客户端插件功能"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.14节“C API客户端插件函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          正如本节前面所述，代理用户对连接器的支持取决于它支持的认证方法是否允许代理用户。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="limits"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL中的限制</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#joins-limits"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.1连接限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#database-count-limit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.2限制数据库和表的数量</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#table-size-limit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.3桌子尺寸的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#column-count-limit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.4表列数和行大小的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#limits-frm-file"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.5由.frm文件结构提供的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/restrictions.html#limits-windows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.6 Windows平台限制</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140527940518384"></a><a class="indexterm" name="idm140527940516896"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节列出MySQL 5.7中的当前限制。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="joins-limits"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.1连接限制</font></font></h3>
</div>
</div>
</div>
<a class="indexterm" name="idm140527940513776"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        可以在单个连接中引用的最大表数为61个。这包括通过将派生表（子查询）和</font></font><code class="literal">FROM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        子句中的</font><font style="vertical-align: inherit;">视图合并</font><font style="vertical-align: inherit;">到外部查询块中来处理连接（请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/optimization.html#derived-table-optimization" title="8.2.2.3优化派生表和视图引用"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.2.2.3节“优化派生表和查看参考文献“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">它也适用于视图定义中可以引用的表的数量。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="database-count-limit"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.2限制数据库和表的数量</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940508784"></a><a class="indexterm" name="idm140527940507312"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL对数据库的数量没有限制。</font><font style="vertical-align: inherit;">底层文件系统可能对目录数量有限制。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL对表的数量没有限制。</font><font style="vertical-align: inherit;">底层文件系统可能对表示表的文件数量有限制。</font><font style="vertical-align: inherit;">单独的存储引擎可能会强加引擎特定的约束。</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许高达40亿张桌子。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="table-size-limit"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.3桌子尺寸的限制</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940502640"></a><a class="indexterm" name="idm140527940501152"></a><a class="indexterm" name="idm140527940499664"></a><a class="indexterm" name="idm140527940498592"></a><a class="indexterm" name="idm140527940497104"></a><a class="indexterm" name="idm140527940495616"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL数据库的有效最大表大小通常取决于操作系统对文件大小的限制，而不是MySQL的内部限制。</font><font style="vertical-align: inherit;">有关操作系统文件大小限制的最新信息，请参阅特定于您的操作系统的文档。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        Windows用户请注意，FAT和VFAT（FAT32）
         </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适合用于MySQL的生产环境。</font><font style="vertical-align: inherit;">改用NTFS。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果遇到全表错误，可能有以下几种原因：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            磁盘可能已满。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            您正在使用</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格并在</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表空间文件中</font><font style="vertical-align: inherit;">耗尽了</font><font style="vertical-align: inherit;">空间。</font><font style="vertical-align: inherit;">最大表空间大小也是表的最大大小。</font><font style="vertical-align: inherit;">有关表空间大小限制，请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#innodb-restrictions" title="14.8.1.7 InnoDB表的限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第14.8.1.7节“InnoDB表限制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            通常，对于大于1TB的表，建议将表分区为多个表空间文件。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            您遇到操作系统文件大小限制。</font><font style="vertical-align: inherit;">例如，您正在</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作系统上</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">表，该表支持的文件最大只有2GB，并且您已达到数据文件或索引文件的限制。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            您正在使用</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格，表格所需的空间超出了内部指针大小所允许的范围。</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许数据和索引文件在默认情况下增长到256TB，但是此限制可以更改为最大允许大小65,536TB（256 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -  1字节）。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果您需要一个</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大于默认限制</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">表，并且您的操作系统支持大文件，则该</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-table" title="13.1.18 CREATE TABLE语法"><code class="literal">CREATE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            语句支持</font></font><code class="literal">AVG_ROW_LENGTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><code class="literal">MAX_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#create-table" title="13.1.18 CREATE TABLE语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.1.18节“CREATE TABLE语法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">服务器使用这些选项来确定要允许的表的大小。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果指针大小对于现有表格太小，则可以更改选项</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#alter-table" title="13.1.8 ALTER TABLE语法"><code class="literal">ALTER
            TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以增加表格的最大允许大小。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#alter-table" title="13.1.8 ALTER TABLE语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.1.8节“ALTER TABLE语法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER TABLE </font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MAX_ROWS = 1000000000 AVG_ROW_LENGTH = </font></font><em class="replaceable"><code>nnn</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            您必须</font></font><code class="literal">AVG_ROW_LENGTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅</font><font style="vertical-align: inherit;">指定</font><font style="vertical-align: inherit;">带有</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列的</font><font style="vertical-align: inherit;">表格</font><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">在这种情况下，MySQL无法仅根据行数来优化所需的空间。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要更改</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">的默认大小限制
             </font><font style="vertical-align: inherit;">，请设置
             </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_myisam_data_pointer_size"><code class="literal">myisam_data_pointer_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它设置用于内部行指针的字节数。</font><font style="vertical-align: inherit;">如果不指定</font></font><code class="literal">MAX_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            选项，</font><font style="vertical-align: inherit;">则该值用于设置新表的指针大小</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">值
             </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_myisam_data_pointer_size"><code class="literal">myisam_data_pointer_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            可以从2到7.值为4允许表格高达4GB; </font><font style="vertical-align: inherit;">值为6允许表格高达256TB。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            您可以使用以下语句检查最大数据和索引大小：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHOW TABLE STATUS FROM </font></font><em class="replaceable"><code>db_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LIKE' </font></font><em class="replaceable"><code>tbl_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">';
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            你也可以使用</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#myisamchk" title="4.6.3 myisamchk  -  MyISAM表维护实用程序"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisamchk -dv / path / to / table-index-file</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#show" title="13.7.5 SHOW语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.7.5节“SHOW语法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#myisamchk" title="4.6.3 myisamchk  -  MyISAM表维护实用程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.6.3节“ </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisamchk</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -MyISAM表维护实用程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            其他解决</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格</font><font style="vertical-align: inherit;">文件大小限制的
             </font><font style="vertical-align: inherit;">方法如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果您的大表只读，您可以使用
                 </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#myisampack" title="4.6.5 myisampack  - 生成压缩的只读MyISAM表"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisampack</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来压缩它。
                </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#myisampack" title="4.6.5 myisampack  - 生成压缩的只读MyISAM表"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisampack</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常会压缩一张桌子至少50％，所以实际上可以有更大的桌子。</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#myisampack" title="4.6.5 myisampack  - 生成压缩的只读MyISAM表"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisampack</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还可以将多个表合并到一个表中。</font><font style="vertical-align: inherit;">请参见
                 </font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#myisampack" title="4.6.5 myisampack  - 生成压缩的只读MyISAM表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.6.5节“ </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myisampack</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 生成压缩的只读MyISAM表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
              </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                MySQL包含一个</font></font><code class="literal">MERGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库，使您能够处理</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有与单个</font></font><code class="literal">MERGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">相同结构</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">的集合
                 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/storage-engines.html#merge-storage-engine" title="15.7 MERGE存储引擎"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第15.7节“MERGE存储引擎”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            您正在使用</font></font><code class="literal">MEMORY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            （</font></font><code class="literal">HEAP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）存储引擎; </font><font style="vertical-align: inherit;">在这种情况下，您需要增加</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_max_heap_table_size"><code class="literal">max_heap_table_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">的值
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/server-administration.html#server-system-variables" title="5.1.5服务器系统变量"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.5节“服务器系统变量”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="column-count-limit"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.4表列数和行大小的限制</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940443104"></a><a class="indexterm" name="idm140527940441632"></a><a class="indexterm" name="idm140527940440144"></a><a class="indexterm" name="idm140527940438656"></a>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="column-count-limits"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列数限制</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL对每个表有4096列的硬限制，但对于给定的表，有效最大值可能更小。</font><font style="vertical-align: inherit;">确切的列限制取决于几个因素：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              表的最大行大小限制了列的数量（以及可能的大小），因为所有列的总长度不能超过此大小。</font><font style="vertical-align: inherit;">请参阅
               </font></font><a class="xref" href="/mysql-5.7-google-zh/restrictions.html#row-size-limits" title="行大小限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行大小限制</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              各个列的存储需求限制了适合给定最大行大小的列数。</font><font style="vertical-align: inherit;">某些数据类型的存储要求取决于诸如存储引擎，存储格式和字符集等因素。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/data-types.html#storage-requirements" title="11.8数据类型存储要求"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第11.8节“数据类型存储要求”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              存储引擎可能施加限制表列数的其他限制。</font><font style="vertical-align: inherit;">例如，
               </font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html" title="第14章InnoDB存储引擎"><code class="literal">InnoDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个表格有1017列的限制。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#innodb-restrictions" title="14.8.1.7 InnoDB表的限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第14.8.1.7节“InnoDB表限制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关其他存储引擎的信息，请参阅
               </font></font><a class="xref" href="/mysql-5.7-google-zh/storage-engines.html" title="第15章备用存储引擎"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第15章，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">备用存储引擎</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              每个表都有一个</font></font><code class="filename">.frm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含表定义</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">文件。</font><font style="vertical-align: inherit;">该定义以可能影响表中允许的列数的方式影响此文件的内容。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/restrictions.html#limits-frm-file" title="C.10.5由.frm文件结构提供的限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第C.10.5节“由.frm文件结构实施的限制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="row-size-limits"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行大小限制</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定表的最大行大小由以下几个因素决定：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              即使存储引擎能够支持更大的行，MySQL表格的内部表示的最大行大小限制为65,535字节。
              </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列仅向行大小限制提供9到12个字节，因为它们的内容与行的其余部分分开存储。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于4KB，8KB，16KB和32KB </font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置</font><font style="vertical-align: inherit;">，适用于本地存储在数据库页面内的数据</font><font style="vertical-align: inherit;">
              的</font><font style="vertical-align: inherit;">表</font><font style="vertical-align: inherit;">的最大行大小</font><font style="vertical-align: inherit;">略小于半页
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，对于默认的16KB </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">页面大小</font><font style="vertical-align: inherit;">，最大行大小略小于8KB
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于64KB页面，最大行大小略小于16KB。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#innodb-restrictions" title="14.8.1.7 InnoDB表的限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第14.8.1.7节“InnoDB表限制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果包含
               </font></font><a class="link" href="/mysql-5.7-google-zh/glossary.html#glos_variable_length_type" title="可变长度类型"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可变长度列</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              行</font><font style="vertical-align: inherit;">超过</font><font style="vertical-align: inherit;">最大行大小，则</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择可变长度列作为外部离页存储，直到行符合</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              行大小限制。</font><font style="vertical-align: inherit;">存储在页外的可变长度列本地存储的数据量因行格式而异。</font><font style="vertical-align: inherit;">有关更多信息，请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#innodb-row-format" title="14.11 InnoDB行存储和行格式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第14.11节“InnoDB行存储和行格式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不同的存储格式使用不同数量的页面标题和预告片数据，这会影响可用于存储行的存储量。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  有关</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行格式的</font><font style="vertical-align: inherit;">信息</font><font style="vertical-align: inherit;">，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#innodb-row-format" title="14.11 InnoDB行存储和行格式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第14.11节“InnoDB行存储和行格式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#innodb-physical-record" title="14.8.1.2 InnoDB表的物理行结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第14.8.1.2节“InnoDB表的物理行结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  有关</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  存储格式的</font><font style="vertical-align: inherit;">信息</font><font style="vertical-align: inherit;">，请参见
                   </font></font><a class="xref" href="/mysql-5.7-google-zh/storage-engines.html#myisam-table-formats" title="15.2.3 MyISAM表格存储格式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第15.2.3节“MyISAM表格存储格式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
</li></ul>
</div>
<h5><a name="idm140527940404160"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行大小限制示例</font></font></h5>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              的65,535字节MySQL的最大行大小限制证明在下面</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              和</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实施例。</font><font style="vertical-align: inherit;">尽管存储引擎可能支持更大的行，但无论存储引擎如何，都会强制实施限制。
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (a VARCHAR(10000), b VARCHAR(10000),</code></strong>
       <strong class="userinput"><code>c VARCHAR(10000), d VARCHAR(10000), e VARCHAR(10000),</code></strong>
       <strong class="userinput"><code>f VARCHAR(10000), g VARCHAR(6000)) ENGINE=InnoDB CHARACTER SET latin1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1118（42000）：行大小太大。</font><font style="vertical-align: inherit;">所使用的最大行大小</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不包括BLOB的表类型是65535.这包括存储开销， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
检查手册。</font><font style="vertical-align: inherit;">您必须将某些列更改为TEXT或BLOB</font></font><font></font>
</pre><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (a VARCHAR(10000), b VARCHAR(10000),</code></strong>
       <strong class="userinput"><code>c VARCHAR(10000), d VARCHAR(10000), e VARCHAR(10000),</code></strong>
       <strong class="userinput"><code>f VARCHAR(10000), g VARCHAR(6000)) ENGINE=MyISAM CHARACTER SET latin1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1118（42000）：行大小太大。</font><font style="vertical-align: inherit;">所使用的最大行大小</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不包括BLOB的表类型是65535.这包括存储开销， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
检查手册。</font><font style="vertical-align: inherit;">您必须将某些列更改为TEXT或BLOB</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在下面的</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例子中，改变柱</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              避免了65535字节的行大小限制，并且允许成功，因为操作
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列仅有助于朝向行大小9至12个字节。
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (a VARCHAR(10000), b VARCHAR(10000),</code></strong>
       <strong class="userinput"><code>c VARCHAR(10000), d VARCHAR(10000), e VARCHAR(10000),</code></strong>
       <strong class="userinput"><code>f VARCHAR(10000), g TEXT(6000)) ENGINE=MyISAM CHARACTER SET latin1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.02秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              操作对于</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              表</font><font style="vertical-align: inherit;">成功，</font><font style="vertical-align: inherit;">因为更改列以
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">避免MySQL 65,535字节的行大小限制，并且</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              可变长度列的离页存储避免了
               </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行大小限制。
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t (a VARCHAR(10000), b VARCHAR(10000),</code></strong>
       <strong class="userinput"><code>c VARCHAR(10000), d VARCHAR(10000), e VARCHAR(10000),</code></strong>
       <strong class="userinput"><code>f VARCHAR(10000), g TEXT(6000)) ENGINE=InnoDB CHARACTER SET latin1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.02秒）</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              可变长度列的存储包括长度字节，这些字节是按行大小计算的。</font><font style="vertical-align: inherit;">例如，一
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR(255)
              CHARACTER SET utf8mb3</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列需要两个字节来存储该值的长度，因此每个值最多可能需要767个字节。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              创建表的语句</font></font><code class="literal">t1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              成功，因为这些列需要32,765 + 2个字节和32,766 + 2个字节，其最大行数为65,535个字节：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t1</code></strong>
       <strong class="userinput"><code>(c1 VARCHAR(32765) NOT NULL, c2 VARCHAR(32766) NOT NULL)</code></strong>
       <strong class="userinput"><code>ENGINE = InnoDB CHARACTER SET latin1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.02秒）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              创建表的语句</font></font><code class="literal">t2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">失败，因为尽管列长度在65,535字节的最大长度内，但需要两个附加字节来记录长度，这会导致行大小超过65,535字节：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t2</code></strong>
       <strong class="userinput"><code>(c1 VARCHAR(65535) NOT NULL)</code></strong>
       <strong class="userinput"><code>ENGINE = InnoDB CHARACTER SET latin1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1118（42000）：行大小太大。</font><font style="vertical-align: inherit;">所使用的最大行大小</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不包括BLOB的表类型是65535.这包括存储开销， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
检查手册。</font><font style="vertical-align: inherit;">您必须将某些列更改为TEXT或BLOB</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              将列长度减少到65,533或更少可以使语句成功。
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t2</code></strong>
       <strong class="userinput"><code>(c1 VARCHAR(65533) NOT NULL)</code></strong>
       <strong class="userinput"><code>ENGINE = InnoDB CHARACTER SET latin1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
查询OK，0行受影响（0.01秒）</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于</font></font><a class="link" href="/mysql-5.7-google-zh/storage-engines.html#myisam-storage-engine" title="15.2 MyISAM存储引擎"><code class="literal">MyISAM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格，
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列需要额外的空间来记录它们的值是否为
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              列需要额外一位，四舍五入到最接近的字节。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              创建表的语句</font></font><code class="literal">t3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">失败，因为</font><font style="vertical-align: inherit;">除了可变长度列长度字节所需的空间外，还</font></font><a class="link" href="/mysql-5.7-google-zh/storage-engines.html#myisam-storage-engine" title="15.2 MyISAM存储引擎"><code class="literal">MyISAM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列的空间，导致行大小超过65,535字节：
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t3</code></strong>
       <strong class="userinput"><code>(c1 VARCHAR(32765) NULL, c2 VARCHAR(32766) NULL)</code></strong>
       <strong class="userinput"><code>ENGINE = MyISAM CHARACTER SET latin1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1118（42000）：行大小太大。</font><font style="vertical-align: inherit;">所使用的最大行大小</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不包括BLOB的表类型是65535.这包括存储开销， </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
检查手册。</font><font style="vertical-align: inherit;">您必须将某些列更改为TEXT或BLOB</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              有关</font><font style="vertical-align: inherit;">列存储的</font><font style="vertical-align: inherit;">信息</font><font style="vertical-align: inherit;">，请参见
               </font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#innodb-physical-record" title="14.8.1.2 InnoDB表的物理行结构"><font style="vertical-align: inherit;">第14.8.1.2节“InnoDB表的物理行结构”</font></a><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html" title="第14章InnoDB存储引擎"><code class="literal">InnoDB</code></a>
              <code class="literal">NULL</code><font style="vertical-align: inherit;"></font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#innodb-physical-record" title="14.8.1.2 InnoDB表的物理行结构"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
              <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于4KB，8KB，16KB和32KB </font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置，</font><font style="vertical-align: inherit;">将行大小（对于本地存储在数据库页内的数据）限制为稍微小于数据库页的一半</font><font style="vertical-align: inherit;">，并且对于64KB页</font><font style="vertical-align: inherit;">将行大小限制为
               </font><font style="vertical-align: inherit;">小于16KB。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              创建表的语句</font></font><code class="literal">t4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">失败，因为定义的列超过了16KB </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">页</font><font style="vertical-align: inherit;">的行大小限制</font><font style="vertical-align: inherit;">。
            </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CREATE TABLE t4 (</code></strong>
       <strong class="userinput"><code>c1 CHAR(255),c2 CHAR(255),c3 CHAR(255),</code></strong>
       <strong class="userinput"><code>c4 CHAR(255),c5 CHAR(255),c6 CHAR(255),</code></strong>
       <strong class="userinput"><code>c7 CHAR(255),c8 CHAR(255),c9 CHAR(255),</code></strong>
       <strong class="userinput"><code>c10 CHAR(255),c11 CHAR(255),c12 CHAR(255),</code></strong>
       <strong class="userinput"><code>c13 CHAR(255),c14 CHAR(255),c15 CHAR(255),</code></strong>
       <strong class="userinput"><code>c16 CHAR(255),c17 CHAR(255),c18 CHAR(255),</code></strong>
       <strong class="userinput"><code>c19 CHAR(255),c20 CHAR(255),c21 CHAR(255),</code></strong>
       <strong class="userinput"><code>c22 CHAR(255),c23 CHAR(255),c24 CHAR(255),</code></strong>
       <strong class="userinput"><code>c25 CHAR(255),c26 CHAR(255),c27 CHAR(255),</code></strong>
       <strong class="userinput"><code>c28 CHAR(255),c29 CHAR(255),c30 CHAR(255),</code></strong>
       <strong class="userinput"><code>c31 CHAR(255),c32 CHAR(255),c33 CHAR(255)</code></strong>
       <strong class="userinput"><code>) ENGINE=InnoDB ROW_FORMAT=COMPACT DEFAULT CHARSET latin1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1118（42000）：行大小过大（&gt; 8126）。</font><font style="vertical-align: inherit;">将某些列更改为TEXT或BLOB或正在使用</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ROW_FORMAT = DYNAMIC或ROW_FORMAT = COMPRESSED可能会有帮助。</font><font style="vertical-align: inherit;">在当前行格式中，768的BLOB前缀</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
字节以内联方式存储。</font></font><font></font>
</pre></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="limits-frm-file"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.5由.frm文件结构提供的限制</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940332560"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        每个表都有一个</font></font><code class="filename">.frm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含表定义</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">文件。</font><font style="vertical-align: inherit;">服务器使用以下表达式检查存储在文件中的一些表信息，上限为64KB：
      </font></font></p><pre data-lang="clike" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if（info_length +（ulong）create_fields.elements * FCOMP + 288 +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    n_length + int_length + com_length&gt; 65535L || </font><font style="vertical-align: inherit;">int_count&gt; 255）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        根据</font></font><code class="filename">.frm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式检查</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">文件中</font><font style="vertical-align: inherit;">存储的信息部分
         </font><font style="vertical-align: inherit;">不能超过64KB限制，因此如果表定义达到此大小，则不能再添加更多列。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        表达中的相关因素是：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">info_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">屏幕</font></font></span><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所需的空间
             </font><span class="quote"><span class="quote"><font style="vertical-align: inherit;">。</font></span></span><span class="quote"><font style="vertical-align: inherit;">“</font></span><font style="vertical-align: inherit;">这与MySQL的Unireg遗产有关。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">create_fields.elements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 是列的数量。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">FCOMP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 是17。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">n_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 是所有列名称的总长度，包括每个名称一个字节作为分隔符。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">int_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与列的值</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列有关。</font><font style="vertical-align: inherit;">在这种情况下，
             </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并不意味着</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数”。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这意味着</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‘ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">间隔</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">， ’</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">共同指的是术语</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">int_count</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是唯一</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义</font><font style="vertical-align: inherit;">的数量
             </font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">com_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 是列注释的总长度。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        刚刚描述的表达式对允许的表定义有几点含义：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用长列名可以减少列的最大数量，包括列
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列，或使用列注释。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            一个表可以有不超过255个唯一
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义。</font><font style="vertical-align: inherit;">具有相同元素列表的列在本文中被认为是相同的。</font><font style="vertical-align: inherit;">例如，如果一个表格包含这两列，则它们会作为一个（而不是两个）朝向此限制计数，因为这些定义是相同的：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e1 ENUM（'a'，'b'，'c'）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e2 ENUM（'a'，'b'，'c'）</font></font><font></font>
</pre></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            唯一元素名称</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义</font><font style="vertical-align: inherit;">中元素名称长度的总和
             </font><font style="vertical-align: inherit;">计算为64KB限制，因此虽然给定</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            列</font><font style="vertical-align: inherit;">中元素数量的理论限制</font><font style="vertical-align: inherit;">是65,535，但实际限制小于3000。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="limits-windows"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.10.6 Windows平台限制</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527940292080"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下限制适用于在Windows平台上使用MySQL：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进程内存</font></font></strong></span>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在Windows 32位平台上，默认情况下不可能在单个进程中使用超过2GB的RAM，包括MySQL。</font><font style="vertical-align: inherit;">这是因为Windows 32位的物理地址限制为4GB，而Windows内的默认设置是在内核（2GB）和用户/应用程序（2GB）之间拆分虚拟地址空间。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            某些版本的Windows具有启动时间设置，通过减少内核应用程序来启用更大的应用程序。</font><font style="vertical-align: inherit;">或者，要使用2GB以上，请使用64位版本的Windows。
          </font></font></p></li><li class="listitem"><p>
            <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件系统别名</font></font></strong></span>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格时，不能使用Windows内的别名链接到另一个卷上的数据文件，然后链接回主MySQL
             </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#option_mysqld_datadir"><code class="option">datadir</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位置。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            该工具通常用于将数据和索引文件移动到RAID或其他快速解决方案，同时将主</font></font><code class="filename">.frm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font><font style="vertical-align: inherit;">保留在
             </font><font style="vertical-align: inherit;">使用该</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#option_mysqld_datadir"><code class="option">datadir</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">配置的默认数据目录中
             </font><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有限的端口数量</font></font></strong></span>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            Windows系统有大约4,000个端口可用于客户端连接，并且在端口连接关闭后，需要2到4分钟才能重新使用端口。</font><font style="vertical-align: inherit;">在客户端以高速率连接到服务器和从服务器断开连接的情况下，在关闭端口再次可用之前，所有可用端口都可能用完。</font><font style="vertical-align: inherit;">如果发生这种情况，即使MySQL服务器正在运行，它似乎没有响应。</font><font style="vertical-align: inherit;">端口也可以被运行在机器上的其他应用程序使用，在这种情况下，MySQL可用的端口数量较少。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关此问题的更多信息，请参阅
             </font></font><a class="ulink" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;196271" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://support.microsoft.com/default.aspx?scid=kb;en-us;196271</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <span class="bold"><strong><code class="literal">DATA DIRECTORY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 和
            </font></font><code class="literal">INDEX DIRECTORY</code></strong></span>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在</font></font><code class="literal">DATA DIRECTORY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对选项
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-table" title="13.1.18 CREATE TABLE语法"><code class="literal">CREATE TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅对支持Windows </font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表，如在</font></font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#tablespace-placing" title="14.7.5在数据目录之外创建文件每表的表空间"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第14.7.5，“创建文件的每表的表空间之外的数据目录”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于
             </font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和其他存储引擎，
             </font><font style="vertical-align: inherit;">Windows和任何其他平台上无效的</font><font style="vertical-align: inherit;">
            调用</font><font style="vertical-align: inherit;">会忽略</font></font><code class="literal">DATA DIRECTORY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">INDEX
            DIRECTORY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择</font><font style="vertical-align: inherit;">。
          </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-table" title="13.1.18 CREATE TABLE语法"><code class="literal">CREATE
            TABLE</code></a><font style="vertical-align: inherit;"></font><code class="literal">realpath()</code><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
            <span class="bold"><strong><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#drop-database" title="13.1.22 DROP DATABASE语法"><code class="literal">DROP
            DATABASE</code></a></strong></span>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            您不能删除其他会话正在使用的数据库。
          </font></font></p></li><li class="listitem"><p>
            <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不区分大小写的名称</font></font></strong></span>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            Windows上的文件名不区分大小写，所以MySQL数据库和表名在Windows上也不区分大小写。</font><font style="vertical-align: inherit;">唯一的限制是数据库和表名必须在给定语句中使用相同的大小写来指定。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/language-structure.html#identifier-case-sensitivity" title="9.2.2标识符大小写敏感性"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9.2.2节“标识符大小写敏感性”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录和文件名称</font></font></strong></span>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在Windows上，MySQL服务器仅支持与当前ANSI代码页兼容的目录和文件名。</font><font style="vertical-align: inherit;">例如，以下日语目录名称在西方语言环境（代码页1252）中不起作用：
          </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DATADIR = “C：/私たちのプロジェクトのデータ”
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            SQL语句中引用的目录和文件名称也适用相同的限制，例如数据文件路径名称</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA
            INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code class="literal">\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">路径名分隔符</font></font></strong></span>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            Windows中的路径名组件由</font></font><code class="literal">\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符</font><font style="vertical-align: inherit;">分隔
             </font><font style="vertical-align: inherit;">，这也是MySQL中的转义字符。</font><font style="vertical-align: inherit;">如果您正在使用
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA
            INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO语法"><code class="literal">SELECT ... INTO
            OUTFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则使用带有</font></font><code class="literal">/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符的</font><font style="vertical-align: inherit;">Unix样式文件名称
             </font><font style="vertical-align: inherit;">：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>LOAD DATA INFILE 'C:/tmp/skr.txt' INTO TABLE skr;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT * INTO OUTFILE 'C:/tmp/skr.txt' FROM skr;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            或者，您必须加倍</font></font><code class="literal">\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            字符：
          </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>LOAD DATA INFILE 'C:\\tmp\\skr.txt' INTO TABLE skr;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SELECT * INTO OUTFILE 'C:\\tmp\\skr.txt' FROM skr;</code></strong>
</pre></li><li class="listitem"><p>
            <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管道问题</font></font></strong></span>
          </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            管道在Windows命令行提示下无法可靠运行。</font><font style="vertical-align: inherit;">如果管道包含字符
             </font></font><code class="literal">^Z</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font><code class="literal">CHAR(24)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，Windows认为它遇到文件结束并中止程序。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            当您尝试应用二进制日志时，这主要是一个问题，如下所示：
          </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C：\&gt; </font></font><strong class="userinput"><code>mysqlbinlog <em class="replaceable"><code>binary_log_file</code></em> | mysql --user=root</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果您在应用日志时遇到问题并怀疑它是由于</font></font><code class="literal">^Z</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/
             </font></font><code class="literal">CHAR(24)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符引起的，则可以使用以下解决方法：
          </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C：\&gt; </font><font style="vertical-align: inherit;">
C：\&gt;</font></font><strong class="userinput"><code>mysqlbinlog <em class="replaceable"><code>binary_log_file</code></em> --result-file=/tmp/bin.sql</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>mysql --user=root --execute "source /tmp/bin.sql"</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            后一个命令也可用于可靠地读取任何可能包含二进制数据的SQL文件。
</font></font></p></li></ul>
</div>

</div>

</div>

</div>
<div class="copyright-footer">

</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tbody><tr>
<td width="40%" align="left"><a accesskey="p" href="/mysql-5.7-google-zh/error-handling.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a></td>
<td width="20%" align="center"><a accesskey="u" href="/mysql-5.7-google-zh/restrictions.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向上</font></font></a></td>
<td width="40%" align="right">&nbsp;<a accesskey="n" href="/mysql-5.7-google-zh/indexes.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个</font></font></a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录B错误，错误代码和常见问题</font></font></td>
<td width="20%" align="center"><a accesskey="h" href="/mysql-5.7-google-zh/index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">家</font></font></a></td>
<td width="40%" align="right" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录D索引</font></font></td>
</tr>
</tbody></table>
</div><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./images/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>


<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>