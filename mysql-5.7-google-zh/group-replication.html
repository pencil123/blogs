<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0066)/mysql-5.7-google-zh/group-replication.html -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>第17章组复制</title>
<link rel="stylesheet" href="./images/mvl.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2">
<link rel="start" href="/mysql-5.7-google-zh/index.html" title="{书名}">
<link rel="up" href="/mysql-5.7-google-zh/group-replication.html" title="">
<link rel="prev" href="/mysql-5.7-google-zh/replication.html" title="第16章复制">
<link rel="next" href="/mysql-5.7-google-zh/mysql-shell.html" title="第18章MySQL Shell用户指南">
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./images/translateelement.css"></head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tbody><tr>
<th colspan="3" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17章组复制</font></font></th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="/mysql-5.7-google-zh/replication.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a>&nbsp;</td>
<th width="60%" align="center"></th>
<td width="20%" align="right">&nbsp;<a accesskey="n" href="/mysql-5.7-google-zh/mysql-shell.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个</font></font></a></td>
</tr>
</tbody></table>
<hr>
</div>
<div class="chapter">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="group-replication"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17章组复制</font></font></h1>

</div>

</div>

</div>
<div class="toc">
<p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录</font></font></b></p><dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-background"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1组复制背景</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-technologies"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.1复制技术</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-use-cases"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.2组复制用例</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-details"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.3组复制详细信息</font></font></a></span></dt></dl></dd><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-getting-started"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2入门</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-deploying-in-single-primary-mode"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1以单主模式部署组复制</font></font></a></span></dt></dl></dd><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-monitoring"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3监视组复制</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-group-member-stats"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.1 Replication_group_member_stats</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-group-members"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.2 Replication_group_members</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-connection-status"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.3 Replication_connection_status</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-applier-status"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.4 Replication_applier_status</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-server-states"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.5组复制服务器状态</font></font></a></span></dt></dl></dd><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-operations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4组复制操作</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-deploying-in-multi-primary-or-single-primary-mode"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.1以多主或单主模式部署</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-tuning-recovery"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.2调整恢复</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-network-partitioning"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.3网络分区</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-enterprise-backup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.4使用MySQL企业备份与组复制</font></font></a></span></dt></dl></dd><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-security"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5组复制安全性</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-ip-address-whitelisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5.1 IP地址白名单</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-secure-socket-layer-support-ssl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5.2安全套接字层支持（SSL）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-virtual-private-networks-vpn"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5.3虚拟专用网络（VPN）</font></font></a></span></dt></dl></dd><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-options"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.6组复制系统变量</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-requirements-and-limitations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.7要求和限制</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-requirements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.7.1组复制要求</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-limitations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.7.2组复制限制</font></font></a></span></dt></dl></dd><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-frequently-asked-questions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.8常见问题</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-technical-details"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9组复制技术细节</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-plugin-architecture"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.1组复制插件体系结构</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-the-group"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.2集团</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-data-manipulation-statements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.3数据操作语句</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-data-definition-statements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.4数据定义语句</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-distributed-recovery"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5分布式恢复</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-observability"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.6可观察性</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-performance"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7组复制性能</font></font></a></span></dt></dl></dd></dl>
</div>
<a class="indexterm" name="idm140528024671904"></a><a class="indexterm" name="idm140528024670832"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本章介绍MySQL组复制以及如何安装，配置和监视组。</font><font style="vertical-align: inherit;">MySQL组复制是一个MySQL服务器插件，使您能够创建弹性，高可用性，容错复制拓扑。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    组可以自动初选方式在单主模式下运行，其中只有一台服务器一次接受更新。</font><font style="vertical-align: inherit;">或者，对于更高级的用户，可以将多个组以多主模式进行部署，即所有服务器都可以接受更新，即使它们是同时发布的。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    有一个内置的组成员资格服务，可以在任何给定的时间点保持组的视图一致并可供所有服务器使用。</font><font style="vertical-align: inherit;">服务器可以离开并加入组，并且相应地更新视图。</font><font style="vertical-align: inherit;">有时服务器可能会意外离开组，在这种情况下，故障检测机制会检测到此情况并通知组该视图已更改。</font><font style="vertical-align: inherit;">这全是自动的。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本章结构如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-background" title="17.1组复制背景"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.1节“组复制背景”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍了组以及组复制的工作原理。
      </font></font></p></li><li class="listitem"><p>
        <a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-getting-started" title="17.2入门"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.2节“入门”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解释了如何配置多个MySQL服务器实例来创建一个组。
      </font></font></p></li><li class="listitem"><p>
        <a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-monitoring" title="17.3监视组复制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.3节“监控组复制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍了如何监控一个组。
      </font></font></p></li><li class="listitem"><p>
        <a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-security" title="17.5组复制安全性"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.5节“组复制安全性”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍了如何保护组。
      </font></font></p></li><li class="listitem"><p>
        <a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-technical-details" title="17.9组复制技术细节"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.9节“组复制技术细节”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供了有关组复制工作原理的深入信息。
</font></font></p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-replication-background"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1组复制背景</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-technologies"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.1复制技术</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-use-cases"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.2组复制用例</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-details"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.3组复制详细信息</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本节提供有关MySQL组复制的背景信息。

    
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    创建容错系统的最常见方法是采用冗余组件，换句话说，组件可以被删除，系统应该继续按预期运行。</font><font style="vertical-align: inherit;">这产生了一系列挑战，将这些系统的复杂性提高到了完全不同的水平。</font><font style="vertical-align: inherit;">具体来说，复制数据库必须处理这样的事实，即他们需要维护和管理多个服务器而不是一个服务器。</font><font style="vertical-align: inherit;">而且，随着服务器一起合作创建组，还必须处理其他几个经典的分布式系统问题，例如网络分区或分裂脑场景。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    因此，最大的挑战是将数据库和数据复制的逻辑融合为以一致和简单的方式协调多台服务器的逻辑。</font><font style="vertical-align: inherit;">换句话说，要让多个服务器同意系统的状态以及系统每次更改的数据。</font><font style="vertical-align: inherit;">这可以概括为让服务器在每个数据库状态转换上达成一致，以便它们都作为一个单一数据库来进行，或者它们最终趋于一致。</font><font style="vertical-align: inherit;">这意味着他们需要作为（分布式）状态机运行。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL组复制通过服务器之间的强大协调来提供分布式状态机复制。</font><font style="vertical-align: inherit;">当服务器是同一组的一部分时，服务器自动进行自我调整。</font><font style="vertical-align: inherit;">该组可以在具有自动初选的单主模式下运行，其中只有一台服务器一次接受更新。</font><font style="vertical-align: inherit;">或者，对于更高级的用户，该组可以以多主模式进行部署，即所有服务器都可以接受更新，即使它们是同时发布的。</font><font style="vertical-align: inherit;">这种能力是以应用程序必须解决这种部署带来的限制为代价的。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    有一个内置的组成员资格服务，可以在任何给定的时间点保持组的视图一致并可供所有服务器使用。</font><font style="vertical-align: inherit;">服务器可以离开并加入组，并且相应地更新视图。</font><font style="vertical-align: inherit;">有时服务器可能会意外离开组，在这种情况下，故障检测机制会检测到此情况并通知组该视图已更改。</font><font style="vertical-align: inherit;">这全是自动的。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    对于要交易的交易，小组的大部分必须就全球交易顺序中的给定交易的顺序达成一致。</font><font style="vertical-align: inherit;">决定提交或中止交易是由每台服务器单独完成的，但所有服务器都做出相同的决定。</font><font style="vertical-align: inherit;">如果存在网络分区，导致成员无法达成一致的分割，则在解决此问题之前系统不会继续进行。</font><font style="vertical-align: inherit;">因此，还有一个内置的自动分裂脑保护机制。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    所有这些都由提供的群组通信系统（GCS）协议提供支持。</font><font style="vertical-align: inherit;">这些提供了故障检测机制，组成员资格服务以及安全且完全有序的消息传递。</font><font style="vertical-align: inherit;">所有这些属性都是创建一个系统的关键，它可以确保数据在整个服务器组中持续复制。</font><font style="vertical-align: inherit;">该技术的核心是Paxos算法的实现。</font><font style="vertical-align: inherit;">它充当群组通信引擎。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-replication-technologies"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.1复制技术</font></font></h3>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-primary-secondary-replication"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.1.1主 - 次复制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-summary"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.1.2组复制</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在深入了解MySQL组复制的细节之前，本节介绍一些背景概念和事情工作的概述。</font><font style="vertical-align: inherit;">这提供了一些上下文来帮助理解组复制所需的内容以及经典异步MySQL复制和组复制之间的区别。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-primary-secondary-replication"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.1.1主 - 次复制</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        传统的MySQL复制提供了一种简单的主 - 辅助复制方法。</font><font style="vertical-align: inherit;">有一个主（主），有一个或多个副（奴隶）。</font><font style="vertical-align: inherit;">主要执行事务，提交它们，然后它们稍后（因此异步）发送到辅助节点，以重新执行（在基于语句的复制中）或应用（在基于行的复制中）。</font><font style="vertical-align: inherit;">它是一个无共享系统，所有服务器默认都有完整的数据副本。
</font></font></p>
<div class="figure">
<a name="idm140528024645232"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.1 MySQL异步复制</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/async-replication-diagram.png" width="911" height="315" alt="执行主站接收的事务，写入二进制日志，然后提交，并将响应发送到客户端应用程序。 在提交发生在主设备上之前，来自二进制日志的记录被发送到从设备1和从设备2的中继日志。 在每个从站上，应用事务，写入从站的二进制日志，并提交。 主设备上的提交和从设备上的提交全都是独立的和异步的。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        还有半同步复制，它向协议添加了一个同步步骤。</font><font style="vertical-align: inherit;">这意味着小学在提交时等待辅助小组确认它已</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">收到</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">交易。</font><font style="vertical-align: inherit;">只有这样主才能恢复提交操作。
</font></font></p>
<div class="figure">
<a name="idm140528024636992"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.2 MySQL半同步复制</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/semisync-replication-diagram.png" width="911" height="316" alt="主站收到的事务被执行并写入二进制日志。 来自二进制日志的记录被发送到从站1和从站2上的中继日志。然后主站等待来自从站的确认。 当两个从服务器都返回确认时，主服务器提交事务，并将响应发送到客户端应用程序。 在每个从设备返回确认后，它将应用该事务，将其写入二进制日志并提交。 主服务器上的提交取决于来自从服务器的确认，但从服务器上的提交是相互独立的并且来自主服务器上的提交。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在上面的两张图片中，您可以看到经典的异步MySQL复制协议（及其半同步变体）的图表。</font><font style="vertical-align: inherit;">对角箭头表示服务器之间交换的消息或服务器与客户端应用程序之间交换的消息。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-summary"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.1.2组复制</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        组复制是一种可用于实现容错系统的技术。</font><font style="vertical-align: inherit;">复制组是一组通过消息传递彼此交互的服务器。</font><font style="vertical-align: inherit;">通信层提供一系列保证，例如原子消息和全部订单消息传递。</font><font style="vertical-align: inherit;">这些非常强大的属性可以转化为非常有用的抽象，从而可以构建更高级的数据库复制解决方案。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL组复制建立在这些属性和抽象的基础之上，并在任何地方实现复制主复制协议。</font><font style="vertical-align: inherit;">实质上，复制组由多个服务器组成，并且组中的每个服务器可以独立执行事务。</font><font style="vertical-align: inherit;">但是，所有读写（RW）事务都必须经过该组的批准后才能提交。</font><font style="vertical-align: inherit;">只读（RO）事务在组内不需要协调，因此立即提交。</font><font style="vertical-align: inherit;">换句话说，对于任何RW事务，组需要决定它是否提交，因此提交操作不是来自始发服务器的单方面决定。</font><font style="vertical-align: inherit;">准确地说，当事务准备在源服务器上提交时，</font><font style="vertical-align: inherit;">服务器以原子方式广播写入值（已更改的行）和对应的写入集（已更新的行的唯一标识符）。</font><font style="vertical-align: inherit;">然后为该交易建立全球总订单。</font><font style="vertical-align: inherit;">最终，这意味着所有服务器以相同的顺序接收相同的一组事务。</font><font style="vertical-align: inherit;">因此，所有服务器都以相同顺序应用相同的一组更改，因此它们在组内保持一致。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        但是，在不同服务器上同时执行的事务之间可能会有冲突。</font><font style="vertical-align: inherit;">通过在称为</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">认证</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的过程中检查两个不同和并发事务的写入集来检测这种冲突
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果在不同服务器上执行的两个并发事务更新同一行，则会有冲突。</font><font style="vertical-align: inherit;">解决过程指出，先订购的事务在所有服务器上提交，而事务订购第二次中止，因此在源服务器上回滚并由组中的其他服务器丢弃。</font><font style="vertical-align: inherit;">这实际上是一个分布式的第一次提交胜利规则。
</font></font></p>
<div class="figure">
<a name="idm140528024623440"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.3 MySQL组复制协议</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-replication-diagram.png" width="898" height="375" alt="主机1收到的交易被执行。 然后，主人1向复制组发送消息，由自己，主人2和主人3组成。当所有三个成员达成共识时，他们证明交易。 然后，主机1将事务写入其二进制日志，提交它并向客户机应用程序发送响应。 主机2和3将事务写入其中继日志，然后应用它，将其写入二进制日志并提交。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        最后，组复制是一种无共享复制方案，每个服务器都有自己的完整数据副本。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        上图描述了MySQL组复制协议，并将其与MySQL复制（甚至是MySQL半同步复制）进行比较，您可以看到一些差异。</font><font style="vertical-align: inherit;">请注意，为清晰起见，此图中缺少一些基本共识和Paxos相关消息。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-use-cases"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.2组复制用例</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-examples-of-use-case-scenarios"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.2.1用例场景示例</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制使您能够通过在整个服务器组中复制系统状态来创建具有冗余的容错系统。</font><font style="vertical-align: inherit;">因此，即使某些服务器发生故障，只要不是全部或大部分，系统仍然可用，并且所有服务器的性能或可扩展性都会降低，但它仍然可用。</font><font style="vertical-align: inherit;">服务器故障是孤立的和独立的。</font><font style="vertical-align: inherit;">它们由组员成员服务进行跟踪，该服务依赖于分布式故障检测器，可以在任何服务器离开组时自动或由于意外停止而发出信号。</font><font style="vertical-align: inherit;">有一个分布式恢复过程来确保当服务器加入组时，它们会自动更新。</font><font style="vertical-align: inherit;">不需要服务器故障转移，</font><font style="vertical-align: inherit;">并且多主机更新无处不在性能确保即使在单个服务器出现故障时也不会阻止更新。</font><font style="vertical-align: inherit;">因此，MySQL组复制保证数据库服务持续可用。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      理解尽管数据库服务可用，但在发生服务器崩溃时，必须将与之连接的所有客户端重定向或故障转移到其他服务器，这一点很重要。</font><font style="vertical-align: inherit;">这不是Group Replication尝试解决的问题。</font><font style="vertical-align: inherit;">连接器，负载平衡器，路由器或某种形式的中间件更适合处理此问题。

      
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      总而言之，MySQL组复制提供了高度可用，高弹性，可靠的MySQL服务。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-examples-of-use-case-scenarios"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.2.1用例场景示例</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下示例是组复制的典型用例。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">弹性复制</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 需要非常流畅的复制基础架构的环境，其中服务器的数量必须动态增长或减少，并且尽可能少的副作用。</font><font style="vertical-align: inherit;">例如，云的数据库服务。
          </font></font></p></li><li class="listitem"><p>
            <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高度可用的碎片</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -</font><span class="emphasis"><em><font style="vertical-align: inherit;">碎片</font></em></span><font style="vertical-align: inherit;">是实现写入扩展的流行方法。</font><font style="vertical-align: inherit;">使用MySQL组复制实现高度可用的分片，其中每个分片映射到复制组。
          </font></font></p></li><li class="listitem"><p>
            <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主 - 从复制的替代方案</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
            - 在某些情况下，使用单个主服务器使其成为单一争用点。</font><font style="vertical-align: inherit;">在某些情况下，写入整个组可能会证明更具可扩展性。

            
          </font></font></p></li><li class="listitem"><p>
            <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自治系统</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 此外，您可以纯粹为复制协议中内置的自动化部署MySQL组复制（本节和以前的章节已经介绍过）。

            
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-details"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.3组复制详细信息</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-failure-detection"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.3.1故障检测</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-group-membership"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.3.2组成员</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-fault-tolerance"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.3.3容错</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍有关组复制构建的一些服务的详细信息。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-failure-detection"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.3.1故障检测</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        提供了一个故障检测机制，能够查找并报告哪些服务器处于静默状态，并因此被假定为死机。</font><font style="vertical-align: inherit;">在高层次上，故障检测器是一种分布式服务，提供有关哪些服务器可能已经死亡（怀疑）的信息。</font><font style="vertical-align: inherit;">稍后如果该小组同意怀疑可能是真的，那么该小组决定给定的服务器确实失败。</font><font style="vertical-align: inherit;">这意味着该组中的其余成员会采取协调决定排除特定成员。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        服务器静音时会触发怀疑。</font><font style="vertical-align: inherit;">当服务器A在给定的时间内没有收到来自服务器B的消息时，会发生超时并引发怀疑。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果一个服务器与其他组织隔离开来，那么它怀疑所有其他服务器都失败了。</font><font style="vertical-align: inherit;">由于无法与团队达成协议（因为无法达到法定人数），其猜疑没有后果。</font><font style="vertical-align: inherit;">当以这种方式将服务器与组隔离时，它无法执行任何本地事务。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-group-membership"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.3.2组成员</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL组复制依赖于组成员资格服务。</font><font style="vertical-align: inherit;">这是内置到插件。</font><font style="vertical-align: inherit;">它定义了哪些服务器在线并参与到组中。</font><font style="vertical-align: inherit;">在线服务器列表通常被称为</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">视图</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因此，该组中的每个服务器都具有一致的视图，即哪些成员是在特定时刻积极参与该组的成员。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        服务器不仅要同意事务提交，还​​要同意当前的观点。</font><font style="vertical-align: inherit;">因此，如果服务器同意新服务器成为该组的一部分，则该组本身将被重新配置为将该服务器集成在其中，从而触发视图更改。</font><font style="vertical-align: inherit;">如果服务器自愿离开组，则会发生相反的情况，则组会动态重新排列其配置，并触发视图更改。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        注意，当一个成员自愿离开时，它首先启动一个动态组重新配置。</font><font style="vertical-align: inherit;">这会触发一个过程，所有成员必须在没有离开服务器的情况下就新视图达成一致。</font><font style="vertical-align: inherit;">然而，如果一个成员不由自主地（例如意外停止或者网络连接断开）离开，那么故障检测机制就意识到了这一点，并且提出了一个组的重新配置，这个没有失败的成员。</font><font style="vertical-align: inherit;">如前所述，这需要该组中大多数服务器的同意。</font><font style="vertical-align: inherit;">如果该组无法达成协议（例如，它以不会使大多数服务器联机的方式进行分区），</font><font style="vertical-align: inherit;">那么系统无法动态地改变配置，因此阻止了裂脑情况。</font><font style="vertical-align: inherit;">最终，这意味着管理员需要介入并修复此问题。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-fault-tolerance"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.1.3.3容错</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL组复制建立在Paxos分布式算法的实现上，以提供服务器之间的分布式协调。</font><font style="vertical-align: inherit;">因此，它需要大多数服务器处于活动状态才能达到法定人数，从而做出决定。</font><font style="vertical-align: inherit;">这直接影响了系统可以承受的故障次数，而不会影响其自身及其整体功能。</font></font><code class="literal">f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        那么</font><font style="vertical-align: inherit;">容忍</font><font style="vertical-align: inherit;">失败</font><font style="vertical-align: inherit;">所需的服务器数量（n）</font><font style="vertical-align: inherit;">就是这样</font></font><code class="literal">n = 2 x f + 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        实际上，这意味着要容忍一次失败，组中必须有三台服务器。</font><font style="vertical-align: inherit;">因此，如果一台服务器出现故障，仍然有两台服务器形成大多数（三分之二），并允许系统自动继续制定决策并取得进展。</font><font style="vertical-align: inherit;">但是，如果第二台服务器</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不由自主地</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生故障
         </font><font style="vertical-align: inherit;">，则该组（剩下一台服务器）将被阻塞，因为没有多数人可以做出决定。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下是说明上述公式的小表。
</font></font></p>
<div class="informaltable">
<table summary="Relationship between replication group size, the number of servers that constitute a majority, and the number of instant failures that can be tolerated."><colgroup><col width="0.23%"><col width="0.18%"><col width="0.59%"></colgroup><thead><tr>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                组大小
              </font></font></p></th>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                多数
              </font></font></p></th>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                即时故障容忍
              </font></font></p></th>
          </tr></thead><tbody><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                1
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                1
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                0
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                2
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                2
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                0
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                3
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                2
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                1
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                4
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                3
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                1
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                五
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                3
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                2
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                6
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                4
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                2
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                7
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                4
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                3
              </font></font></p></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        下一章将介绍组复制的技术方面。

        
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-replication-getting-started"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2入门</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-deploying-in-single-primary-mode"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1以单主模式部署组复制</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL组复制作为MySQL服务器的插件提供，组中的每个服务器都需要配置和安装插件。</font><font style="vertical-align: inherit;">本节提供详细的教程，介绍创建至少具有三台服务器的复制组所需的步骤。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-deploying-in-single-primary-mode"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1以单主模式部署组复制</font></font></h3>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-getting-started-deploying-instances"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.1部署实例以进行组复制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-configuring-instances"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.2为组复制配置实例</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-user-credentials"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.3用户凭证</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-launching"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.4启动组复制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-adding-instances"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.5将实例添加到组中</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组中的每个服务器实例都可以在独立的物理机器上运行，也可以在同一台机器上运行。</font><font style="vertical-align: inherit;">本节介绍如何在一台物理机上创建包含三个MySQL服务器实例的复制组。</font><font style="vertical-align: inherit;">这意味着需要三个数据目录，每个服务器实例一个，并且需要独立配置每个实例。
</font></font></p>
<div class="figure">
<a name="idm140528024544560"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.4组架构</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-3-server-group.png" width="312" height="332" alt="三个服务器实例S1，S2和S3作为互连组部署，客户端与每个服务器实例进行通信。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本教程介绍了如何使用组复制插件获取和部署MySQL服务器，如何在创建组之前配置每个服务器实例，以及如何使用性能模式监视来验证所有内容是否正常工作。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-getting-started-deploying-instances"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.1部署实例以进行组复制</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        第一步是部署三个MySQL服务器实例。</font><font style="vertical-align: inherit;">组复制是MySQL Server 5.7.17及更高版本提供的内置MySQL插件。</font><font style="vertical-align: inherit;">有关MySQL插件的更多背景信息，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/server-administration.html#server-plugins" title="5.5 MySQL服务器插件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.5节“MySQL服务器插件”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此过程假定已将MySQL服务器下载并解压到名为的目录中</font></font><code class="literal">mysql-5.7</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以下过程使用一台物理机器，因此每个MySQL服务器实例都需要该实例的特定数据目录。</font><font style="vertical-align: inherit;">在名为的目录中创建数据目录</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并初始化每个</font><font style="vertical-align: inherit;">目录
         </font><font style="vertical-align: inherit;">。
      </font></font></p><pre data-lang="terminal" class="programlisting"><strong class="userinput"><code>mkdir data</code></strong>
<strong class="userinput"><code>mysql-5.7/bin/mysqld --initialize-insecure --basedir=$PWD/mysql-5.7 --datadir=$PWD/data/s1</code></strong>
<strong class="userinput"><code>mysql-5.7/bin/mysqld --initialize-insecure --basedir=$PWD/mysql-5.7 --datadir=$PWD/data/s2</code></strong>
<strong class="userinput"><code>mysql-5.7/bin/mysqld --initialize-insecure --basedir=$PWD/mysql-5.7 --datadir=$PWD/data/s3</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        里面</font></font><code class="literal">data/s1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">data/s2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><code class="literal">data/s3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个初始化的数据目录，包含了MySQL系统数据库和相关表等等。</font><font style="vertical-align: inherit;">要了解更多关于初始化过程的信息，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/installing.html#data-directory-initialization-mysqld" title="2.10.1.1使用mysqld手动初始化数据目录"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.10.1.1节“使用mysqld手动初始化数据目录”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          不要</font></font><code class="literal">--initialize-insecure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在生产环境中</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">，它只是用来简化教程。</font><font style="vertical-align: inherit;">有关安全设置的更多信息，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-security" title="17.5组复制安全性"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.5节“组复制安全性”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-configuring-instances"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.2为组复制配置实例</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节介绍您希望用于组复制的MySQL服务器实例所需的配置设置。</font><font style="vertical-align: inherit;">有关背景信息，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-limitations" title="17.7.2组复制限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.7.2节“组复制限制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="group-replication-server-settings"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组Replication Server设置</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要安装和使用组复制插件，您必须正确配置MySQL服务器实例。</font><font style="vertical-align: inherit;">建议将配置存储在实例的配置文件中。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多信息</font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#option-files" title="4.2.6使用选项文件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font><a class="xref" href="/mysql-5.7-google-zh/programs.html#option-files" title="4.2.6使用选项文件"><font style="vertical-align: inherit;">第4.2.6节“使用选项文件”</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">除非另有说明，否则接下来是组中的第一个实例的配置，</font><font style="vertical-align: inherit;">在本过程中</font><font style="vertical-align: inherit;">称为</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s1</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以下部分显示了示例服务器配置。
        </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的[mysqld]</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃服务器配置</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DATADIR = &lt;full_path_to_data&gt; /数据/ S1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BASEDIR = &lt;full_path_to_bin&gt; /mysql-5.7/</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
端口= 24801</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
插座= &lt;full_path_to_sock_dir&gt; /s1.sock</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些设置将MySQL服务器配置为使用之前创建的数据目录以及服务器应打开的端口并开始监听传入连接。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用非默认端口24801是因为在本教程中，三个服务器实例使用相同的主机名。</font><font style="vertical-align: inherit;">在使用三台不同机器的设置中，这不是必需的。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          组复制取决于成员之间的网络连接，这意味着每个成员必须能够解析所有其他成员的网络地址。</font><font style="vertical-align: inherit;">例如，在本教程中，所有三个实例都在一台机器上运行，因此为了确保成员可以相互联系，您可以将一行添加到选项文件中，例如
           </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_report_host"><code class="literal">report_host=127.0.0.1</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="group-replication-configure-replication-framework"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制框架</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下设置根据MySQL组复制要求配置复制。
        </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SERVER_ID = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gtid_mode = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
enforce_gtid_consistency = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
master_info_repository =表</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
relay_log_info_repository =表</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
binlog_checksum = NONE</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_slave_updates = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_bin =二进制日志</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
binlog_format = ROW</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些设置将服务器配置为使用唯一标识号1来启用全局事务标识，并将复制元数据存储在系统表中而不是文件中。</font><font style="vertical-align: inherit;">另外，它指示服务器打开二进制日志记录，使用基于行的格式并禁用二进制日志事件校验和。</font><font style="vertical-align: inherit;">有关更多详细信息，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-requirements" title="17.7.1组复制要求"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.7.1节“组复制要求”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="group-replication-configure-plugin"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组复制设置</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此时，该</font></font><code class="filename">my.cnf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件确保服务器已配置，并被指示在给定配置下实例化复制基础结构。</font><font style="vertical-align: inherit;">以下部分为服务器配置组复制设置。
        </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transaction_write_set_extraction = XXHASH64</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
松group_replication_group_name = “AAAAAAAAAAAA-AAAAAAAA-AAAAAAAAAAAA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
松group_replication_start_on_boot =关</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
loose-group_replication_local_address =“127.0.0.1:24901”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
loose-group_replication_group_seeds =“127.0.0.1:24901,127.0.0.1:24902,127.0.0.1:24903”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
松group_replication_bootstrap_group =关</font></font><font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"></font><code class="literal">loose-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于上述</font></font><code class="literal">group_replication</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">
            的</font><font style="vertical-align: inherit;">前缀
             </font><font style="vertical-align: inherit;">指示服务器在服务器启动时尚未加载组复制插件时继续启动。
</font></font></p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              配置会
               </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_transaction_write_set_extraction"><code class="literal">transaction_write_set_extraction</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指示服务器为每个事务处理它必须收集写入集并使用</font></font><code class="literal">XXHASH64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">散列算法</font><font style="vertical-align: inherit;">将其编码为
               </font><font style="vertical-align: inherit;">散列。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              配置
               </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_group_name"><code class="literal">group_replication_group_name</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              告诉插件它正在加入或创建的组被命名为“aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa”。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              配置
               </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_start_on_boot"><code class="literal">group_replication_start_on_boot</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指示插件在服务器启动时不自动启动操作。</font><font style="vertical-align: inherit;">这在设置组复制时很重要，因为它可以确保您可以在手动启动插件之前配置服务器。</font><font style="vertical-align: inherit;">成员配置完成后，您可以将其设置
               </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_start_on_boot"><code class="literal">group_replication_start_on_boot</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为开启，以便在服务器引导时自动启动组复制。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              配置
               </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              通知插件使用网络地址127.0.0.1和端口24901与组中的其他成员进行内部通信。
</font></font></p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                组复制将此地址用于使用XCom的内部成员到成员连接。</font><font style="vertical-align: inherit;">该地址必须与用于SQL的主机名和端口不同，并且不得用于客户端应用程序。</font><font style="vertical-align: inherit;">在运行组复制时，它必须保留用于组成员之间的内部通信。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              由所有组成员</font><font style="vertical-align: inherit;">
              配置的网络地址
               </font><font style="vertical-align: inherit;">必须是可解析的。</font><font style="vertical-align: inherit;">例如，如果每个服务器实例位于具有固定网络地址的不同计算机上，则可以使用计算机的IP，例如10.0.0.1。</font><font style="vertical-align: inherit;">如果使用主机名，则必须使用完全限定的名称，并确保可通过DNS，正确配置的</font></font><code class="literal">/etc/hosts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              文件或其他名称解析进程</font><font style="vertical-align: inherit;">解析它</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">建议的端口为
               </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              33061.在本教程中，我们使用在一台机器上运行的三个服务器实例，因此端口24901至24903用于内部通信网络地址。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              配置
               </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_group_seeds"><code class="literal">group_replication_group_seeds</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置新成员用于建立其与组的连接的组成员的主机名和端口。</font><font style="vertical-align: inherit;">这些成员被称为种子成员。</font><font style="vertical-align: inherit;">连接建立后，组成员资格信息将列在
               </font></font><code class="literal">performance_schema.replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通常
               </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_group_seeds"><code class="literal">group_replication_group_seeds</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              列表包含</font></font><code class="literal">hostname:port</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个组成员的列表
               </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但这不是强制性的，并且可以选择组成员的子集作为种子。
</font></font></p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                该</font></font><code class="literal">hostname:port</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列在
                 </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_group_seeds"><code class="literal">group_replication_group_seeds</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                是种子构件的内部网络地址，由被配置
                 </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                ，而不是SQL </font></font><code class="literal">hostname:port</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于客户端连接，并且例如在显示
                 </font></font><code class="literal">performance_schema.replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                表中。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              启动组的服务器不使用此选项，因为它是初始服务器，因此它负责引导组。</font><font style="vertical-align: inherit;">换句话说，服务器上引导组的任何现有数据都被用作下一个加入成员的数据。</font><font style="vertical-align: inherit;">第二台服务器加入时要求组中的唯一成员加入，第二台服务器上的任何缺失数据将从引导成员上的授权人数据复制，然后该组进行扩展。</font><font style="vertical-align: inherit;">第三个服务器加入可以要求这两者中的任何一个加入，数据同步到新成员，然后该组再次扩展。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                在同时加入多个服务器时，请确保它们指向已在组中的种子成员。</font><font style="vertical-align: inherit;">请勿将也加入该组的成员用作种子，因为他们在联系时可能尚未加入该组。
              </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                首先启动引导成员并让它创建组是一个好习惯。</font><font style="vertical-align: inherit;">然后使其成为正在加入的其他成员的种子成员。</font><font style="vertical-align: inherit;">这可以确保在加入其他成员时形成一个组。
              </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                不支持创建一个组并同时加入多个成员。</font><font style="vertical-align: inherit;">它可能会起作用，但有可能是操作竞赛，然后加入团队的行为最终会出现错误或暂停。
</font></font></p>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              配置
               </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_bootstrap_group"><code class="literal">group_replication_bootstrap_group</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指示插件是否引导组。
</font></font></p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                此选项只能在任何时间在一个服务器实例上使用，通常是在您首次引导组时（或者整个组被关闭并重新备份）。</font><font style="vertical-align: inherit;">如果多次引导组，例如当多个服务器实例设置了此选项时，则可以创建一个人工分裂大脑方案，其中存在两个具有相同名称的不同组。</font><font style="vertical-align: inherit;">第一个服务器实例联机后禁用此选项。
</font></font></p>
</div>
</li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          组中所有服务器的配置非常相似。</font><font style="vertical-align: inherit;">您需要更改有关每个服务器的细节（例如</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_server_id"><code class="literal">server_id</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_datadir"><code class="literal">datadir</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">这将在本教程的后面进行说明。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-user-credentials"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.3用户凭证</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        组复制使用异步复制协议实现
         </font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-distributed-recovery" title="17.9.5分布式恢复"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.9.5节“分布式恢复”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，在将组成员加入组之前同步组成员。</font><font style="vertical-align: inherit;">分布式恢复过程依赖于一个复制通道</font></font><code class="literal">group_replication_recovery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该</font><font style="vertical-align: inherit;">通道</font><font style="vertical-align: inherit;">用于将捐助者成员的事务转移给加入该组的成员。</font><font style="vertical-align: inherit;">因此，您需要使用正确的权限设置复制用户，以便组复制可以建立直接的成员到成员恢复复制通道。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用选项文件启动服务器：
      </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-5.7 / bin / mysqld --defaults-file = data / s1 / s1.cnf</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        用</font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_replication-slave"><code class="literal">REPLICATION-SLAVE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限</font><font style="vertical-align: inherit;">创建一个MySQL用户
         </font><font style="vertical-align: inherit;">。</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该在二进制日志中捕获</font><font style="vertical-align: inherit;">此进程</font><font style="vertical-align: inherit;">，以避免更改传播到其他服务器实例。</font><font style="vertical-align: inherit;">连接到服务器s1并发出以下语句：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET SQL_LOG_BIN=0;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在下面的例子中，显示了</font></font><em class="replaceable"><code>rpl_user</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带有密码
         </font><font style="vertical-align: inherit;">的用户
         </font></font><em class="replaceable"><code>password</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">配置服务器时，请使用合适的用户名和密码。</font><font style="vertical-align: inherit;">一旦创建用户，二进制日志就会再次启用。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>CREATE USER <em class="replaceable"><code>rpl_user</code></em>@'%' IDENTIFIED BY '<em class="replaceable"><code>password</code></em>';</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>GRANT REPLICATION SLAVE ON *.* TO <em class="replaceable"><code>rpl_user</code></em>@'%';</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>FLUSH PRIVILEGES;</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>SET SQL_LOG_BIN=1;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        用户配置完成后，使用该
         </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#change-master-to" title="13.4.2.1将主设备更改为语法"><code class="literal">CHANGE MASTER TO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句将服务器配置为</font></font><code class="literal">group_replication_recovery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在下次需要从其他成员恢复其状态时</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">复制通道的</font><font style="vertical-align: inherit;">给定凭据
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">发出以下内容，</font></font><em class="replaceable"><code>rpl_user</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
         </font><font style="vertical-align: inherit;">替换
         </font></font><em class="replaceable"><code>password</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建用户时使用的值。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>CHANGE MASTER TO MASTER_USER='<em class="replaceable"><code>rpl_user</code></em>', MASTER_PASSWORD='<em class="replaceable"><code>password</code></em>' \\<font></font>
		      FOR CHANNEL 'group_replication_recovery';</code></strong>
      </pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        分布式恢复是加入组的服务器采取的第一步，并且与组成员没有相同的事务集。</font><font style="vertical-align: inherit;">如果这些凭证没有为</font></font><code class="literal">group_replication_recovery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        复制通道</font><font style="vertical-align: inherit;">正确设置，</font><font style="vertical-align: inherit;">并且</font></font><code class="literal">rpl_user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如图所示，则服务器无法连接到授权成员并运行分布式恢复过程以获得与其他组成员的同步，因此最终无法加入该组。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        同样，如果服务器无法通过服务器正确识别其他成员</font></font><code class="literal">hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，恢复过程可能会失败。</font><font style="vertical-align: inherit;">建议运行MySQL的操作系统具有正确配置的唯一性
         </font></font><code class="literal">hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，使用DNS或本地设置。</font><font style="vertical-align: inherit;">这</font></font><code class="literal">hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以</font></font><code class="literal">Member_host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#replication-group-members-table" title="25.11.11.7 replication_group_members表"><code class="literal">performance_schema.replication_group_members</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        表格</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">列中
         </font><font style="vertical-align: inherit;">验证
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果多个组成员</font></font><code class="literal">hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将由操作系统设置</font><font style="vertical-align: inherit;">的缺省值进行外部化
         </font><font style="vertical-align: inherit;">，则成员可能不会解析到正确的成员地址，也无法加入组。</font><font style="vertical-align: inherit;">在这种情况下，用于</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_report_host"><code class="literal">report_host</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置</font></font><code class="literal">hostname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个服务器</font><font style="vertical-align: inherit;">的独特</font><font style="vertical-align: inherit;">外部化。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-launching"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.4启动组复制</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        一旦配置并启动了服务器s1，请安装组复制插件。</font><font style="vertical-align: inherit;">连接到服务器并发出以下命令：
      </font></font></p><pre data-lang="sql" class="programlisting"><strong class="userinput"><code>INSTALL PLUGIN group_replication SONAME 'group_replication.so';</code></strong></pre>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">mysql.session</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户必须存在，你可以加载组复制。
          </font></font><code class="literal">mysql.session</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被添加到MySQL版本5.7.19中。</font><font style="vertical-align: inherit;">如果您的数据字典是使用较早版本初始化的，则必须运行
           </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-upgrade" title="4.4.7 mysql_upgrade  - 检查并升级MySQL表"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_upgrade</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">过程。</font><font style="vertical-align: inherit;">如果未运行升级，则组复制将无法启动，并显示错误消息</font></font><span class="errortext"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试使用以下用户访问服务器时发生错误：mysql.session@localhost。</font><font style="vertical-align: inherit;">确保用户存在于服务器中，并且在服务器更新后运行mysql_upgrade。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要检查插件是否安装成功，请发出
         </font></font><code class="literal">SHOW PLUGINS;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并检查输出。</font><font style="vertical-align: inherit;">它应该显示这样的内容：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SHOW PLUGINS;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---------------------------- + ---------- + --------- ----------- + ---------------------- + ------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">名称| </font><font style="vertical-align: inherit;">状态| </font><font style="vertical-align: inherit;">类型| </font><font style="vertical-align: inherit;">图书馆| </font><font style="vertical-align: inherit;">许可证|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---------------------------- + ---------- + --------- ----------- + ---------------------- + ------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog | </font><font style="vertical-align: inherit;">ACTIVE | </font><font style="vertical-align: inherit;">存储引擎| </font><font style="vertical-align: inherit;">NULL | </font><font style="vertical-align: inherit;">PROPRIETARY |</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（......）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication | </font><font style="vertical-align: inherit;">ACTIVE | </font><font style="vertical-align: inherit;">GROUP REPLICATION | </font><font style="vertical-align: inherit;">group_replication.so | </font><font style="vertical-align: inherit;">PROPRIETARY |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---------------------------- + ---------- + --------- ----------- + ---------------------- + ------------- +</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要启动组，请指示服务器s1引导组，然后启动组复制。</font><font style="vertical-align: inherit;">此引导程序只能由单个服务器完成，该服务器仅启动该组并且仅启动一次。</font><font style="vertical-align: inherit;">这就是为什么bootstrap配置选项的值未保存在配置文件中的原因。</font><font style="vertical-align: inherit;">如果它保存在配置文件中，则在重新启动时服务器将自动引导具有相同名称的第二个组。</font><font style="vertical-align: inherit;">这将导致两个具有相同名称的不同组。</font><font style="vertical-align: inherit;">同样的推理适用于停止并重新启动该选项设置为</font></font><code class="literal">ON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET GLOBAL group_replication_bootstrap_group = ON;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
START GROUP_REPLICATION;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET GLOBAL group_replication_bootstrap_group = OFF;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#start-group-replication" title="13.4.3.1 START GROUP_REPLICATION语法"><code class="literal">START GROUP_REPLICATION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        声明</font><font style="vertical-align: inherit;">
        一旦</font><font style="vertical-align: inherit;">返回，该组已启动。</font><font style="vertical-align: inherit;">您可以检查该组是否已创建，并且该组中有一个成员：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM performance_schema.replication_group_members;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ----------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CHANNEL_NAME | </font><font style="vertical-align: inherit;">MEMBER_ID | </font><font style="vertical-align: inherit;">MEMBER_HOST | </font><font style="vertical-align: inherit;">MEMBER_PORT | </font><font style="vertical-align: inherit;">MEMBER_STATE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ----------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">ce9be252-2b71-11e6-b8f4-00212844f856 | </font><font style="vertical-align: inherit;">myhost | </font><font style="vertical-align: inherit;">24801 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ----------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该表中的信息确认组中有一名具有唯一标识符的成员
         </font></font><code class="literal">ce9be252-2b71-11e6-b8f4-00212844f856</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它正在</font></font><code class="literal">ONLINE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且正在</font></font><code class="literal">myhost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        监听端口上的客户端连接
         </font></font><code class="literal">24801</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        为了演示服务器确实在一个组中并且它能够处理负载，请创建一个表并向其中添加一些内容。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>CREATE DATABASE test;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>USE test;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>CREATE TABLE t1 (c1 INT PRIMARY KEY, c2 TEXT NOT NULL);</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>INSERT INTO t1 VALUES (1, 'Luis');</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        检查表</font></font><code class="literal">t1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和二进制日志的内容。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM t1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---- + ------ +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c1 | </font><font style="vertical-align: inherit;">c2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---- + ------ +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">路易斯|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---- + ------ +</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW BINLOG EVENTS;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------- + ----- + ---------------- + ---------- -  + ------------- + ---------------------------------- ---------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">Log_name | </font><font style="vertical-align: inherit;">Pos | </font><font style="vertical-align: inherit;">Event_type | </font><font style="vertical-align: inherit;">Server_id | </font><font style="vertical-align: inherit;">End_log_pos | </font><font style="vertical-align: inherit;">信息|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------- + ----- + ---------------- + ---------- -  + ------------- + ---------------------------------- ---------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">Format_desc | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">123 | </font><font style="vertical-align: inherit;">Server ver：5.7.19-gr080-log，Binlog ver：4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">123 | </font><font style="vertical-align: inherit;">Previous_gtids | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">211 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：1'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">211 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">270 | </font><font style="vertical-align: inherit;">BEGIN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">270 | </font><font style="vertical-align: inherit;">View_change | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">369 | </font><font style="vertical-align: inherit;">view_id = 14724817264259180：1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">369 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">434 | </font><font style="vertical-align: inherit;">COMMIT |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">434 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">495 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：2'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">495 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">585 | </font><font style="vertical-align: inherit;">CREATE DATABASE测试|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">585 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">646 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：3'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">646 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">770 | </font><font style="vertical-align: inherit;">使用`test`; </font><font style="vertical-align: inherit;">CREATE TABLE t1（c1 INT PRIMARY KEY，c2 TEXT NOT NULL）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">770 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">831 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：4'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">831 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">899 | </font><font style="vertical-align: inherit;">BEGIN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">899 | </font><font style="vertical-align: inherit;">Table_map | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">942 | </font><font style="vertical-align: inherit;">table_id：108（test.t1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">942 | </font><font style="vertical-align: inherit;">Write_rows | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">984 | </font><font style="vertical-align: inherit;">table_id：108个标志：STMT_END_F |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">984 | </font><font style="vertical-align: inherit;">Xid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1011 | </font><font style="vertical-align: inherit;">COMMIT / * xid = 38 * / |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------- + ----- + ---------------- + ---------- -  + ------------- + ---------------------------------- ---------------------------------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如上所示，创建了数据库和表对象，并将相应的DDL语句写入二进制日志。</font><font style="vertical-align: inherit;">此外，数据被插入到表中并写入二进制日志。</font><font style="vertical-align: inherit;">二进制日志条目的重要性在以下部分中进行说明，因为新成员试图赶上并成为联机时，组的增长和分布式恢复被执行。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-adding-instances"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.5将实例添加到组中</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        此时，该组中有一个成员，即服务器s1，其中包含一些数据。</font><font style="vertical-align: inherit;">现在可以通过添加之前配置的其他两台服务器来扩展组。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="group-replication-adding-a-second-instance"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.5.1添加第二个实例</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了添加第二个实例，服务器s2，首先为它创建配置文件。</font><font style="vertical-align: inherit;">该配置与用于服务器s1的配置类似，除了数据目录的位置，s2将要监听的端口或其他端口之外
           </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_server_id"><code class="literal">server_id</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些不同的行在下面的清单中突出显示。
        </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的[mysqld]</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃服务器配置</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DATADIR = &lt;full_path_to_data&gt; /数据/ S2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BASEDIR = &lt;full_path_to_bin&gt; /mysql-5.7/</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
端口= 24802</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
插座= &lt;full_path_to_sock_dir&gt; /s2.sock</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃复制配置参数</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SERVER_ID = 2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gtid_mode = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
enforce_gtid_consistency = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
master_info_repository =表</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
relay_log_info_repository =表</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
binlog_checksum = NONE</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_slave_updates = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_bin =二进制日志</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
binlog_format = ROW</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃组复制配置</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
transaction_write_set_extraction = XXHASH64</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
松group_replication_group_name = “AAAAAAAAAAAA-AAAAAAAA-AAAAAAAAAAAA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
松group_replication_start_on_boot =关</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
loose-group_replication_local_address =“127.0.0.1:24902”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
loose-group_replication_group_seeds =“127.0.0.1:24901,127.0.0.1:24902,127.0.0.1:24903”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
loose-group_replication_bootstrap_group = off</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与服务器s1的过程类似，使用选项文件启动服务器。
        </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-5.7 / bin / mysqld --defaults-file = data / s2 / s2.cnf</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          然后按如下配置恢复凭证。</font><font style="vertical-align: inherit;">这些命令与设置服务器s1时使用的命令相同，因为用户在组内共享。</font><font style="vertical-align: inherit;">在s2上发布以下声明。
        </font></font></p><pre data-lang="sql" class="programlisting"><strong class="userinput"><code>SET SQL_LOG_BIN=0;</code></strong>
<strong class="userinput"><code>CREATE USER <em class="replaceable"><code>rpl_user</code></em>@'%' IDENTIFIED BY '<em class="replaceable"><code>password</code></em>';</code></strong>
<strong class="userinput"><code>GRANT REPLICATION SLAVE ON *.* TO <em class="replaceable"><code>rpl_user</code></em>@'%';</code></strong>
<strong class="userinput"><code>SET SQL_LOG_BIN=1;</code></strong>
<strong class="userinput"><code>CHANGE MASTER TO MASTER_USER='<em class="replaceable"><code>rpl_user</code></em>', MASTER_PASSWORD='<em class="replaceable"><code>password</code></em>' \\<font></font>
	FOR CHANNEL 'group_replication_recovery';<font></font>
</code></strong></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          安装组复制插件并开始将服务器加入组的过程。</font><font style="vertical-align: inherit;">以下示例以与部署服务器s1时所用的相同方式安装插件。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; INSTALL PLUGIN group_replication SONAME'group_replication.so';
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将服务器s2添加到组中。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; START GROUP_REPLICATION;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与以前的步骤与在s1上执行的步骤相同，这里有一点不同之处在于，</font><font style="vertical-align: inherit;">在启动组复制之前</font><font style="vertical-align: inherit;">您
           </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发出问题</font></font><code class="literal">SET GLOBAL
          group_replication_bootstrap_group=ON;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因为该组已由服务器s1创建并引导。</font><font style="vertical-align: inherit;">此时服务器s2只需要添加到已经存在的组中。
</font></font></p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小费
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            当组复制启动成功并且服务器加入组时，它将检查
             </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量。</font><font style="vertical-align: inherit;">通过</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在成员的配置文件中</font><font style="vertical-align: inherit;">设置</font><font style="vertical-align: inherit;">为ON，可以确保由于任何原因启动组复制时发生故障的服务器不接受事务。</font><font style="vertical-align: inherit;">如果服务器应作为读写实例加入群组，例如作为单主群组中的主群组或多主群组的成员，则当
             </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量设置为ON时，则在加入时将其设置为OFF群组。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">performance_schema.replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          再次</font><font style="vertical-align: inherit;">
          检查
           </font><font style="vertical-align: inherit;">表格显示</font><font style="vertical-align: inherit;">组</font><font style="vertical-align: inherit;">中现在有两台
           </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ONLINE</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM performance_schema.replication_group_members;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ----------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CHANNEL_NAME | </font><font style="vertical-align: inherit;">MEMBER_ID | </font><font style="vertical-align: inherit;">MEMBER_HOST | </font><font style="vertical-align: inherit;">MEMBER_PORT | </font><font style="vertical-align: inherit;">MEMBER_STATE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ----------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">395409e1-6dfa-11e6-970b-00212844f856 | </font><font style="vertical-align: inherit;">myhost | </font><font style="vertical-align: inherit;">24801 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">ac39f1e6-6dfa-11e6-a69d-00212844f856 | </font><font style="vertical-align: inherit;">myhost | </font><font style="vertical-align: inherit;">24802 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ----------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由于服务器s2也被标记为ONLINE，它必须已经自动跟踪服务器s1。</font><font style="vertical-align: inherit;">验证它是否确实与服务器s1同步，如下所示。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SHOW DATABASES LIKE 'test';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">数据库（测试）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">测试|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------- +</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM test.t1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---- + ------ +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c1 | </font><font style="vertical-align: inherit;">c2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---- + ------ +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">路易斯|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---- + ------ +</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW BINLOG EVENTS;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------- + ------ + ---------------- + --------- -  + ------------- + --------------------------------- ----------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">Log_name | </font><font style="vertical-align: inherit;">Pos | </font><font style="vertical-align: inherit;">Event_type | </font><font style="vertical-align: inherit;">Server_id | </font><font style="vertical-align: inherit;">End_log_pos | </font><font style="vertical-align: inherit;">信息|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------- + ------ + ---------------- + --------- -  + ------------- + --------------------------------- ----------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">Format_desc | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">123 | </font><font style="vertical-align: inherit;">Server ver：5.7.17-log，Binlog ver：4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">123 | </font><font style="vertical-align: inherit;">Previous_gtids | </font><font style="vertical-align: inherit;">2 | </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">211 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：1'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">211 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">270 | </font><font style="vertical-align: inherit;">BEGIN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">270 | </font><font style="vertical-align: inherit;">View_change | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">369 | </font><font style="vertical-align: inherit;">view_id = 14724832985483517：1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">369 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">434 | </font><font style="vertical-align: inherit;">COMMIT |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">434 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">495 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：2'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">495 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">585 | </font><font style="vertical-align: inherit;">CREATE DATABASE测试|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">585 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">646 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：3'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">646 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">770 | </font><font style="vertical-align: inherit;">使用`test`; </font><font style="vertical-align: inherit;">CREATE TABLE t1（c1 INT PRIMARY KEY，c2 TEXT NOT NULL）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">770 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">831 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：4'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">831 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">890 | </font><font style="vertical-align: inherit;">BEGIN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">890 | </font><font style="vertical-align: inherit;">Table_map | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">933 | </font><font style="vertical-align: inherit;">table_id：108（test.t1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">933 | </font><font style="vertical-align: inherit;">Write_rows | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">975 | </font><font style="vertical-align: inherit;">table_id：108个标志：STMT_END_F |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">975 | </font><font style="vertical-align: inherit;">Xid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1002 | </font><font style="vertical-align: inherit;">COMMIT / * xid = 30 * / |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1002 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1063 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：5'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1063 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1122 | </font><font style="vertical-align: inherit;">BEGIN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1122 | </font><font style="vertical-align: inherit;">View_change | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1261 | </font><font style="vertical-align: inherit;">view_id = 14724832985483517：2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1261 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1326 | </font><font style="vertical-align: inherit;">COMMIT |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------- + ------ + ---------------- + --------- -  + ------------- + --------------------------------- ----------------------------------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如上所示，第二台服务器已被添加到组中，并自动从服务器s1复制了更改。</font><font style="vertical-align: inherit;">根据分布式恢复过程，这意味着刚刚加入组之后并且在即将宣布联机之前，服务器s2已自动连接到服务器s1并从中提取缺失的数据。</font><font style="vertical-align: inherit;">换句话说，它将事务从它缺少的s1的二进制日志复制到它加入组的时间点。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="group-replication-adding-additional-instances"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.2.1.5.2添加附加实例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          向组添加额外的实例与添加第二个服务器的步骤基本相同，不同之处在于必须更改配置，因为它必须用于服务器s2。</font><font style="vertical-align: inherit;">总结所需的命令：
        </font></font></p><p>
          <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.创建配置文件</font></font></em></span>
        </p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的[mysqld]</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃服务器配置</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DATADIR = &lt;full_path_to_data&gt; /数据/ S3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BASEDIR = &lt;full_path_to_bin&gt; /mysql-5.7/</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
端口24803 =</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
插座= &lt;full_path_to_sock_dir&gt; /s3.sock</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃复制配置参数</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SERVER_ID = 3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gtid_mode = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
enforce_gtid_consistency = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
master_info_repository =表</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
relay_log_info_repository =表</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
binlog_checksum = NONE</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_slave_updates = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
log_bin =二进制日志</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
binlog_format = ROW</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃组复制配置</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
transaction_write_set_extraction = XXHASH64</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
松group_replication_group_name = “AAAAAAAAAAAA-AAAAAAAA-AAAAAAAAAAAA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
松group_replication_start_on_boot =关</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
loose-group_replication_local_address =“127.0.0.1:24903”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
loose-group_replication_group_seeds =“127.0.0.1:24901,127.0.0.1:24902,127.0.0.1:24903”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
loose-group_replication_bootstrap_group = off</font></font><font></font>
</pre><p>
          <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.启动服务器</font></font></em></span>
        </p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-5.7 / bin / mysqld --defaults-file = data / s3 / s3.cnf</font></font></pre><p>
          <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.为group_replication_recovery通道配置恢复凭据。</font></font></em></span>
        </p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SET SQL_LOG_BIN = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CREATE USER </font></font><em class="replaceable"><code>rpl_user</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@'％';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRANT REPLICATION SLAVE ON *。* TO </font></font><em class="replaceable"><code>rpl_user</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@'％'IDENTIFIED BY' </font></font><em class="replaceable"><code>password</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FLUSH PRIVILEGES;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET SQL_LOG_BIN = 1;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将MASTER_ MASTER MASTER_USER更改为' </font></font><em class="replaceable"><code>rpl_user</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'，MASTER_PASSWORD =' </font></font><em class="replaceable"><code>password</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'\\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FOR CHANNEL'group_replication_recovery';</font></font></pre><p>
          <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.安装组复制插件并启动它。</font></font></em></span>
        </p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INSTALL PLUGIN group_replication SONAME'group_replication.so';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
START GROUP_REPLICATION;</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此时，服务器s3已启动并正在运行，已加入该组并赶上组中的其他服务器。</font></font><code class="literal">performance_schema.replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          再次</font><font style="vertical-align: inherit;">咨询
           </font><font style="vertical-align: inherit;">表格证实了这种情况。
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; SELECT * FROM performance_schema.replication_group_members;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ----------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CHANNEL_NAME | </font><font style="vertical-align: inherit;">MEMBER_ID | </font><font style="vertical-align: inherit;">MEMBER_HOST | </font><font style="vertical-align: inherit;">MEMBER_PORT | </font><font style="vertical-align: inherit;">MEMBER_STATE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ----------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">395409e1-6dfa-11e6-970b-00212844f856 | </font><font style="vertical-align: inherit;">myhost | </font><font style="vertical-align: inherit;">24801 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">7eb217ff-6df3-11e6-966c-00212844f856 | </font><font style="vertical-align: inherit;">myhost | </font><font style="vertical-align: inherit;">24803 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">ac39f1e6-6dfa-11e6-a69d-00212844f856 | </font><font style="vertical-align: inherit;">myhost | </font><font style="vertical-align: inherit;">24802 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ----------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在服务器s2或服务器s1上发出相同的查询会得到相同的结果。</font><font style="vertical-align: inherit;">此外，您可以验证服务器s3是否也赶上了：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SHOW DATABASES LIKE 'test';</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">数据库（测试）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">测试|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------- +</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM test.t1;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---- + ------ +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">c1 | </font><font style="vertical-align: inherit;">c2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---- + ------ +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">路易斯|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ---- + ------ +</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MySQL的&gt; </font></font><strong class="userinput"><code>SHOW BINLOG EVENTS;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------- + ------ + ---------------- + --------- -  + ------------- + --------------------------------- ----------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">Log_name | </font><font style="vertical-align: inherit;">Pos | </font><font style="vertical-align: inherit;">Event_type | </font><font style="vertical-align: inherit;">Server_id | </font><font style="vertical-align: inherit;">End_log_pos | </font><font style="vertical-align: inherit;">信息|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------- + ------ + ---------------- + --------- -  + ------------- + --------------------------------- ----------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">4 | </font><font style="vertical-align: inherit;">Format_desc | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">123 | </font><font style="vertical-align: inherit;">Server ver：5.7.17-log，Binlog ver：4 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">123 | </font><font style="vertical-align: inherit;">Previous_gtids | </font><font style="vertical-align: inherit;">3 | </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">150 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">211 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：1'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">211 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">270 | </font><font style="vertical-align: inherit;">BEGIN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">270 | </font><font style="vertical-align: inherit;">View_change | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">369 | </font><font style="vertical-align: inherit;">view_id = 14724832985483517：1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">369 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">434 | </font><font style="vertical-align: inherit;">COMMIT |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">434 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">495 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：2'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">495 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">585 | </font><font style="vertical-align: inherit;">CREATE DATABASE测试|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">585 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">646 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：3'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">646 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">770 | </font><font style="vertical-align: inherit;">使用`test`; </font><font style="vertical-align: inherit;">CREATE TABLE t1（c1 INT PRIMARY KEY，c2 TEXT NOT NULL）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">770 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">831 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：4'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">831 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">890 | </font><font style="vertical-align: inherit;">BEGIN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">890 | </font><font style="vertical-align: inherit;">Table_map | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">933 | </font><font style="vertical-align: inherit;">table_id：108（test.t1）|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">933 | </font><font style="vertical-align: inherit;">Write_rows | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">975 | </font><font style="vertical-align: inherit;">table_id：108个标志：STMT_END_F |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">975 | </font><font style="vertical-align: inherit;">Xid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1002 | </font><font style="vertical-align: inherit;">COMMIT / * xid = 29 * / |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1002 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1063 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：5'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1063 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1122 | </font><font style="vertical-align: inherit;">BEGIN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1122 | </font><font style="vertical-align: inherit;">View_change | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1261 | </font><font style="vertical-align: inherit;">view_id = 14724832985483517：2 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1261 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1326 | </font><font style="vertical-align: inherit;">COMMIT |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1326 | </font><font style="vertical-align: inherit;">Gtid | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1387 | </font><font style="vertical-align: inherit;">SET @@ SESSION.GTID_NEXT ='aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa：6'|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1387 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1446 | </font><font style="vertical-align: inherit;">BEGIN |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1446 | </font><font style="vertical-align: inherit;">View_change | </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1585 | </font><font style="vertical-align: inherit;">view_id = 14724832985483517：3 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">binlog.000001 | </font><font style="vertical-align: inherit;">1585 | </font><font style="vertical-align: inherit;">查询| </font><font style="vertical-align: inherit;">1 | </font><font style="vertical-align: inherit;">1650 | </font><font style="vertical-align: inherit;">COMMIT |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------- + ------ + ---------------- + --------- -  + ------------- + --------------------------------- ----------------------------------- +</font></font><font></font>
</pre>
</div>

</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-replication-monitoring"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3监视组复制</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-group-member-stats"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.1 Replication_group_member_stats</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-group-members"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.2 Replication_group_members</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-connection-status"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.3 Replication_connection_status</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-replication-applier-status"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.4 Replication_applier_status</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-server-states"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.5组复制服务器状态</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    假定性能模式已启用，请使用Perfomance模式表来监视组复制。</font><font style="vertical-align: inherit;">组复制添加下列表格：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <code class="literal">performance_schema.replication_group_member_stats</code>
      </p></li><li class="listitem"><p>
        <code class="literal">performance_schema.replication_group_members</code>
</p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    这些性能架构复制表还显示有关组复制的信息：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <code class="literal">performance_schema.replication_connection_status</code>
      </p></li><li class="listitem"><p>
        <code class="literal">performance_schema.replication_applier_status</code>
</p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    由组复制插件创建的复制通道名为：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <code class="literal">group_replication_recovery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  - 此通道用于与分布式恢复阶段相关的复制更改。
      </font></font></p></li><li class="listitem"><p>
        <code class="literal">group_replication_applier</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 此通道用于来自组的输入更改。</font><font style="vertical-align: inherit;">这是用于应用直接来自组的交易的渠道。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    以下各节介绍每个表中可用的信息。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-replication-group-member-stats"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.1 Replication_group_member_stats</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      复制组中的每个成员都会验证并应用该组收到的事务。</font><font style="vertical-align: inherit;">关于认证者和申请者程序的统计数据对于理解申请者队列的增长情况，找到了多少冲突，检查了多少交易，到哪些地方执行哪些交易等都很有用。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该
       </font></font><code class="literal">performance_schema.replication_group_member_stats</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      表提供了与认证过程有关的信息。</font><font style="vertical-align: inherit;">信息在作为复制组成员的所有服务器实例之间共享，因此可以从任何成员查询所有组成员的信息。
</font></font></p>
<div class="table">
<a name="idm140528024302064"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表17.1 replication_group_member_stats</font></font></b></p>
<div class="table-contents">
<table><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              领域
            </font></font></p></th>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              描述
            </font></font></p></th>
        </tr></thead><tbody><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              CHANNEL_NAME
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组复制通道的名称。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              会员ID
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              成员服务器UUID。</font><font style="vertical-align: inherit;">这对该组中的每个成员都有不同的价值。</font><font style="vertical-align: inherit;">这也是一个关键，因为它对每个成员都是独一无二的。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Count_transactions_in_queue
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              冲突检测检查队列中的事务数。</font><font style="vertical-align: inherit;">一旦交易检查了冲突，如果他们通过支票，他们也排队等待应用。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Count_transactions_checked
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              已检查冲突的事务数量。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Count_conflicts_detected
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              未通过冲突检测检查的事务数量。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Count_transactions_rows_validating
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              冲突检测数据库的当前大小（每项交易都通过认证）。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Transactions_committed_all_members
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              已在复制组的所有成员上成功提交的事务。</font><font style="vertical-align: inherit;">这是以固定的时间间隔更新的。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Last_conflict_free_transaction
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              已检查最后一个无冲突事务的事务标识符。
            </font></font></p></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些字段对于监控组中连接的成员的性能很重要。</font><font style="vertical-align: inherit;">例如，假设组中的一个成员被延迟，并且无法跟上该组的其他成员。</font><font style="vertical-align: inherit;">在这种情况下，您可能会在队列中看到大量事务。</font><font style="vertical-align: inherit;">根据这些信息，您可以决定从该组中删除该成员，或延迟处理该组其他成员的事务处理，以减少排队事务的数量。</font><font style="vertical-align: inherit;">这些信息还可以帮助您决定如何调整组复制插件的流量控制。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-replication-group-members"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.2 Replication_group_members</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      此表用于监视当前视图中跟踪的不同服务器实例的状态，或者换句话说，该表是组的一部分，并且由会员服务跟踪。
</font></font></p>
<div class="table">
<a name="idm140528024269968"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表17.2 replication_group_members</font></font></b></p>
<div class="table-contents">
<table><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              领域
            </font></font></p></th>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              描述
            </font></font></p></th>
        </tr></thead><tbody><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              CHANNEL_NAME
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组复制通道的名称。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              会员ID
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              成员服务器UUID。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Member_host
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组成员的网络地址。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Member_port
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组成员正在侦听的MySQL连接端口。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Member_state
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组成员的当前状态（其可以是
               </font></font><code class="literal">ONLINE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">RECOVERING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">OFFLINE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              或</font></font><code class="literal">UNREACHABLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
            </font></font></p></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关该</font></font><code class="literal">Member_host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      值及其对分布式恢复过程的影响的</font><font style="vertical-align: inherit;">更多信息</font><font style="vertical-align: inherit;">，请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-user-credentials" title="17.2.1.3用户凭证"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.2.1.3节“用户凭证”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-replication-connection-status"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.3 Replication_connection_status</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      连接到组时，此表中的某些字段显示有关组复制的信息。</font><font style="vertical-align: inherit;">例如，从组中收到并在应用程序队列中排队的事务（中继日志）。
</font></font></p>
<div class="table">
<a name="idm140528024242624"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表17.3 replication_connection_status</font></font></b></p>
<div class="table-contents">
<table><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              领域
            </font></font></p></th>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              描述
            </font></font></p></th>
        </tr></thead><tbody><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              CHANNEL_NAME
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组复制通道的名称。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              团队名字
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              显示组的名称的值。</font><font style="vertical-align: inherit;">它始终是一个有效的UUID。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Source_UUID
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              显示组的标识符。</font><font style="vertical-align: inherit;">它与组名相似，它用作组复制期间生成的所有事务的UUID。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Service_state
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              显示该成员是否是该组的一部分。</font><font style="vertical-align: inherit;">服务状态的可能值可以是{ON，OFF和CONNECTING};
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Received_transaction_set
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该组成员已收到此GTID集合中的交易。
            </font></font></p></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-replication-applier-status"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.4 Replication_applier_status</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      也可以使用常规replication_applier_status表来观察组复制相关通道和线程的状态。</font><font style="vertical-align: inherit;">如果应用事务的工作线程有很多不同，那么worker表也可以用来监视每个工作线程正在做什么。
</font></font></p>
<div class="table">
<a name="idm140528024220512"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表17.4 replication_applier_status</font></font></b></p>
<div class="table-contents">
<table><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              领域
            </font></font></p></th>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              描述
            </font></font></p></th>
        </tr></thead><tbody><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              CHANNEL_NAME
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组复制通道的名称。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Service_state
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              显示应用程序服务是打开还是关闭。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Remaining_delay
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              显示是否配置了一些施加延迟。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Count_transactions_retries
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              应用交易时执行的重试次数。
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Received_transaction_set
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该组成员已收到此GTID集合中的交易。
            </font></font></p></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-server-states"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.3.5组复制服务器状态</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每当有视图更改时，</font><font style="vertical-align: inherit;">
      该表</font><font style="vertical-align: inherit;">就会更新，例如当组的配置动态更改时。</font><font style="vertical-align: inherit;">在这一点上，服务器交换一些元数据来同步自己并继续合作。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      服务器实例可以有多种状态。如果服务器正常通信，所有服务器都报告相同的状态。</font><font style="vertical-align: inherit;">但是，如果有网络分区或服务器离开组，则可能会报告不同的信息，具体取决于查询哪个服务器。</font><font style="vertical-align: inherit;">请注意，如果服务器已经离开组，那么显然它不能报告有关其他服务器状态的更新信息。</font><font style="vertical-align: inherit;">如果存在分区，从而导致法定人数丢失，则服务器无法彼此协调。</font><font style="vertical-align: inherit;">因此，他们无法猜测不同服务器的状态。</font><font style="vertical-align: inherit;">因此，不要猜测他们的状态，而是报告某些服务器无法访问。
</font></font></p>
<div class="table">
<a name="idm140528024196112"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表17.5服务器状态</font></font></b></p>
<div class="table-contents">
<table><colgroup><col width="38%"><col width="50%"><col width="12%"></colgroup><thead><tr>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              领域
            </font></font></p></th>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              描述
            </font></font></p></th>
          <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组同步
            </font></font></p></th>
        </tr></thead><tbody><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              线上
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该成员已准备好充当全功能组成员，这意味着客户端可以连接并开始执行事务。
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              是
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              RECOVERING
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该成员正在成为该组织的一名积极成员，目前正在经历恢复过程，从捐助者处接收国家信息。
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              没有
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              离线
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该插件已加载，但该成员不属于任何组。
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              没有
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              错误
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              成员的状态。</font><font style="vertical-align: inherit;">每当恢复阶段出现错误或应用更改时，服务器都会进入此状态。
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              没有
            </font></font></p></td>
        </tr><tr>
          <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              UNREACHABLE
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              只要本地故障检测器怀疑给定的服务器不可达，因为它可能已经崩溃或不自觉地断开连接，它就会将服务器的状态显示为“无法访问”。
            </font></font></p></td>
          <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              没有
            </font></font></p></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        一旦一个实例进入</font></font><code class="literal">ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态，该
         </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项被设置为</font></font><code class="literal">ON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要离开</font></font><code class="literal">ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        状态，您必须手动配置实例
         </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=OFF</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      请注意，组复制</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
      同步的，但最终是同步的。</font><font style="vertical-align: inherit;">更确切地说，交易按照相同的顺序传递给所有组成员，但是他们的执行不同步，这意味着在交易被接受后，每个成员都按自己的步调进行交易。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-replication-operations"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4组复制操作</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-deploying-in-multi-primary-or-single-primary-mode"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.1以多主或单主模式部署</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-tuning-recovery"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.2调整恢复</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-network-partitioning"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.3网络分区</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-enterprise-backup"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.4使用MySQL企业备份与组复制</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本节介绍部署组复制的不同模式，说明管理组的常用操作并提供有关如何调整组的信息。</font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-deploying-in-multi-primary-or-single-primary-mode"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.1以多主或单主模式部署</font></font></h3>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-single-primary-mode"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.1.1单主模式</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-multi-primary-mode"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.1.2多主模式</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-find-primary"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.1.3查找小学</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制按以下不同模式运行：

</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            单主模式
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            多主模式
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

      默认模式是单主。</font><font style="vertical-align: inherit;">不可能让组中的成员部署在不同的模式下，例如一个以多主模式配置，另一个以单主模式配置。</font><font style="vertical-align: inherit;">要在模式之间切换，组而不是服务器，需要使用不同的操作配置重新启动。</font><font style="vertical-align: inherit;">无论部署模式如何，组复制都不处理客户端故障切换，它必须由应用程序本身，连接器或中间件框架（如代理或路由器）处理。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在多主模式下部署时，将检查语句以确保它们与模式兼容。</font><font style="vertical-align: inherit;">以多主模式部署组复制时进行以下检查：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果一个事务在SERIALIZABLE隔离级别下执行，那么当它与组自身同步时，它的提交失败。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果事务针对具有级联约束的外键的表执行，那么事务在与组自动同步时无法提交。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这些检查可以通过设置选项来禁用
       </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_enforce_update_everywhere_checks"><code class="literal">group_replication_enforce_update_everywhere_checks</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      到</font></font><code class="literal">FALSE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在单主模式下部署时，此选项</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置为
       </font></font><code class="literal">FALSE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-single-primary-mode"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.1.1单主模式</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在此模式下，该组具有一个设置为读写模式的单主服务器。</font><font style="vertical-align: inherit;">组中的所有其他成员都设置为只读模式（带
         </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_super_read_only"><code class="literal">super-read-only=ON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

        

        ）。</font><font style="vertical-align: inherit;">这是自动发生的。</font><font style="vertical-align: inherit;">主服务器通常是引导组的第一台服务器，加入的所有其他服务器都会自动了解主服务器并设置为只读。
</font></font></p>
<div class="figure">
<a name="idm140528024143520"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.5新的主要选举</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/single-primary-election.png" width="948" height="327" alt="五个服务器实例S1，S2，S3，S4和S5作为互连组部署。 服务器S1是主要的。 写客户端与服务器S1通信，读客户端与服务器S4通信。 服务器S1然后失败，中断与写客户端的通信。 然后，服务器S2接管为新的主服务器，写客户端现在与服务器S2通信。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在单主模式下，部分以多主模式部署的检查被禁用，因为系统强制只有一台服务器写入组。</font><font style="vertical-align: inherit;">例如，对具有级联外键的表的更改是允许的，但在多主模式下它们不是。</font><font style="vertical-align: inherit;">在主要成员失败后，自动主要选举机制选择下一个主要成员。</font><font style="vertical-align: inherit;">选择下一个主节点的方法取决于服务器的
         </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量和
         </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_member_weight"><code class="literal">group_replication_member_weight</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        变量。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果主要成员离开单一主要组，则执行选举并从组中剩余的服务器中选择新的主要成员。</font><font style="vertical-align: inherit;">这次选举是通过查看新视图来执行的，并根据其价值排序潜在的新初选
         </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_member_weight"><code class="literal">group_replication_member_weight</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">假设组正在运行所有成员运行相同的MySQL版本，那么具有最高值的成员将
         </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_member_weight"><code class="literal">group_replication_member_weight</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        被选为新的主要成员。</font><font style="vertical-align: inherit;">如果多台服务器具有相同
         </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_member_weight"><code class="literal">group_replication_member_weight</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的服务器，则会根据服务器的优先级对服务器进行优先级排序
        </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按字典顺序排列，并选择第一个。</font><font style="vertical-align: inherit;">一旦选择了新的小学，它会自动设置为读写，而其他辅助小组仍然是辅助小组，并且因此是只读的。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果该组正在与运行不同版本MySQL的成员一起运行，那么选举过程可能会受到影响。</font><font style="vertical-align: inherit;">例如，如果任何成员不支持
         </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_member_weight"><code class="literal">group_replication_member_weight</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则主要根据</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自较低主要版本的成员的顺序来</font><font style="vertical-align: inherit;">选择
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">或者，如果运行不同MySQL版本的所有成员都支持
         </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_member_weight"><code class="literal">group_replication_member_weight</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则主要根据</font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_member_weight"><code class="literal">group_replication_member_weight</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        较低主要版本的成员</font><font style="vertical-align: inherit;">来选择
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在重新路由客户端应用程序之前，等待新主节点应用其复制相关的中继日志是一种很好的做法。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-multi-primary-mode"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.1.2多主模式</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在多主模式下，没有一个主要的概念。</font><font style="vertical-align: inherit;">由于没有服务器扮演任何特殊角色，因此无需参与选举程序。
</font></font></p>
<div class="figure">
<a name="idm140528024118832"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.6客户端故障转移</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/multi-primary.png" width="948" height="327" alt="五个服务器实例S1，S2，S3，S4和S5作为互连组部署。 所有的服务器都是初选。 写客户端与服务器S1和S2通信，读客户端与服务器S4通信。 然后，服务器S1发生故障，中断与其写客户端的通信。 该客户端重新连接到服务器S3。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        加入组时，所有服务器都设置为读写模式。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-find-primary"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.1.3查找小学</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下示例显示如何找出当以单主模式部署时哪个服务器当前是主服务器。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT VARIABLE_VALUE FROM performance_schema.global_status WHERE VARIABLE_NAME= 'group_replication_primary_member';</code></strong>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-tuning-recovery"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.2调整恢复</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      每当新成员加入复制组时，它都会连接到合适的授权者，并提取它已遗漏的数据，直到它宣布联机为止。</font><font style="vertical-align: inherit;">组复制中的这个关键组件是容错和可配置的。</font><font style="vertical-align: inherit;">以下部分介绍恢复如何工作以及如何调整设置
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="group-replication-donor-selection"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">捐助者选择</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        从该组中现有的在线成员中选择一个随机捐赠者。</font><font style="vertical-align: inherit;">通过这种方式，当多个成员进入该组时，相同服务器很有可能不会被选择多次。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果与选定捐赠者的连接失败，则会自动尝试新的连接给新的候选捐赠者。</font><font style="vertical-align: inherit;">一旦达到连接重试限制，恢复过程就会以错误结束。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在当前的观点中，从在线成员列表中随机挑选一位捐赠者。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="group-replication-enhanced-automatic-donor-switchover"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">增强的自动施主切换</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        整体复苏的另一个主要关注点是确保它能够应对失败。</font><font style="vertical-align: inherit;">因此，组复制提供了强大的错误检测机制。</font><font style="vertical-align: inherit;">在早期版本的组复制中，当联系捐助者时，恢复只能检测由于身份验证问题或其他问题导致的连接错误。</font><font style="vertical-align: inherit;">对这种有问题的情况的反应是切换到新的捐助者，因此尝试向另一成员进行新的连接尝试。

        
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        此行为已扩展到还涵盖其他故障情况：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="emphasis"><em><font style="vertical-align: inherit;"></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">清除</font><span class="emphasis"><em><font style="vertical-align: inherit;">数据方案</font></em></span><font style="vertical-align: inherit;"> - 如果所选捐助者包含恢复过程所需的一些清除数据，则会发生错误。</font><font style="vertical-align: inherit;">恢复检测到此错误，并选择新的捐助者。
          </font></font></p></li><li class="listitem"><p>
            <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重复数据</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 如果加入组的服务器已经包含一些数据，这些数据在恢复期间与来自所选捐助者的数据发生冲突，则会发生错误。</font><font style="vertical-align: inherit;">这可能是由加入该组的服务器中存在一些错误的事务引起的。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有人可能会认为恢复会失败，而不是转换到另一个捐助者身上，但在异构群体中，其他成员有可能共享冲突交易，而其他成员则不会。</font><font style="vertical-align: inherit;">出于这个原因，错误时，恢复从组中选择另一个捐助者。
          </font></font></p></li><li class="listitem"><p>
            <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他错误</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 如果任何恢复线程失败（接收器或施加器线程失败），则会发生错误，恢复切换到新的捐助者。
</font></font></p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果出现一些持续性故障或甚至瞬间故障恢复，则自动重试连接到相同或新的捐助者。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="group-replication-donor-connection-retries"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">捐助者连接重试</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        恢复数据传输依赖于二进制日志和现有的MySQL复制框架，因此一些瞬态错误可能会在接收器或应用程序线程中导致错误。</font><font style="vertical-align: inherit;">在这种情况下，捐助者切换过程具有重试功能，类似于在常规复制中发现的功能。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="group-replication-number-of-attempts"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试次数</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        尝试从捐赠者池连接捐赠者时，加入该组的服务器的尝试次数为10.这是通过</font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_retry_count"><code class="literal">group_replication_recovery_retry_count</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        插件变量进行</font><font style="vertical-align: inherit;">配置的
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以下命令将连接捐助者的最大尝试次数设置为10。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET GLOBAL group_replication_recovery_retry_count= 10;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        请注意，这说明加入该组的服务器连接到每个合适捐助者的全球尝试次数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="group-replication-sleep-routines"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">睡眠例程</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该
         </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_reconnect_interval"><code class="literal">group_replication_recovery_reconnect_interval</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        插件变量定义的恢复过程应该需要多少时间供体的连接尝试之间睡觉。</font><font style="vertical-align: inherit;">此变量的默认设置为60秒，您可以动态更改此值。</font><font style="vertical-align: inherit;">以下命令将恢复提供程序连接重试间隔设置为120秒。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET GLOBAL group_replication_recovery_reconnect_interval= 120;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        但是请注意，每次施主连接尝试后恢复都不会进入休眠状态。</font><font style="vertical-align: inherit;">由于加入组的服务器连接到不同的服务器而不是一次又一次地连接到同一服务器，因此可以认为影响服务器A的问题不会影响服务器B.因此，恢复只会在其全部通过时才会挂起可能的捐助者。</font><font style="vertical-align: inherit;">一旦加入该组的服务器尝试连接到该组中的所有合适的捐助者并且没有剩余的捐献者，则恢复进程会睡眠该</font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_reconnect_interval"><code class="literal">group_replication_recovery_reconnect_interval</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        变量</font><font style="vertical-align: inherit;">配置的秒数
         </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-network-partitioning"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.3网络分区</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      只要需要复制的变更发生，小组就需要达成共识。</font><font style="vertical-align: inherit;">常规交易就是这种情况，但对于组员更改和一些保持组一致的内部消息传递也是必需的。</font><font style="vertical-align: inherit;">共识需要大多数小组成员就特定决定达成一致。</font><font style="vertical-align: inherit;">当大多数小组成员失去时，小组无法取得进展并阻止，因为它无法确保多数或法定人数。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      当存在多个非自愿性故障时，法定人数可能会丢失，导致大部分服务器突然从组中移除。</font><font style="vertical-align: inherit;">例如，在一组5台服务器中，如果其中3台服务器立刻变为沉默，则大多数服务器都会受到影响，因此无法达到法定人数。</font><font style="vertical-align: inherit;">事实上，剩下的两个不能确定其他3台服务器是否崩溃，或者网络分区是否单独隔离了这两台服务器，因此该组无法自动重新配置。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      另一方面，如果服务器自愿退出组，它们会指示组重新组态它自己。</font><font style="vertical-align: inherit;">实际上，这意味着一台正在离开的服务器告诉别人它将要离开。</font><font style="vertical-align: inherit;">这意味着其他成员可以正确地重新配置该组，保持成员资格的一致性，并重新计算大多数成员。</font><font style="vertical-align: inherit;">例如，在上面的场景中，3台服务器立即离开，如果3台离开的服务器一个接一个地警告群组他们将要离开，那么会员可以自己调整从5到2，并且在相同的时间，保证法定人数。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        法定人数的丧失本身就是不良计划的副作用。</font><font style="vertical-align: inherit;">计划预期失败次数的团队规模（无论它们是否连续，一次发生或偶尔发生）。

        
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下部分说明如果系统分区的方式不会由组中的服务器自动实现法定人数时应执行的操作。
</font></font></p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小费
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在多数人损失后重新配置之后，已从组中排除的主要组可能包含未包含在新组中的额外事务。</font><font style="vertical-align: inherit;">如果发生这种情况，尝试从组中加回被排除的成员会导致消息错误。</font></font><span class="errortext"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该成员比在组中存在的成员执行的事务数多。</font></font></span>
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="group-replication-detecting-partitions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测分区</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在</font></font><code class="literal">replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能模式表显示每个服务器在从该服务器的角度来看，当前视图状态。</font><font style="vertical-align: inherit;">系统大多数时间没有进入分区，因此表中显示的信息在组中的所有服务器上都是一致的。</font><font style="vertical-align: inherit;">换句话说，该表中的每个服务器的状态在所有当前视图中都是一致的。</font><font style="vertical-align: inherit;">但是，如果存在网络分区并且法定数量丢失，那么该表将显示</font></font><code class="literal">UNREACHABLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无法联系的那些服务器</font><font style="vertical-align: inherit;">的状态</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此信息由内置在组复制中的本地故障检测器导出。
</font></font></p>
<div class="figure">
<a name="idm140528024066240"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.7失去法定人数</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-majority-lost.png" width="265" height="417" alt="将五个服务器实例S1，S2，S3，S4和S5部署为互连组，这是一个稳定的组。 当三台服务器S3，S4和S5出现故障时，大多数服务器都会丢失，而且该组无法进行干预。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要了解这种类型的网络分区，以下部分描述了最初有5台服务器正确协同工作的情况，并且一旦只有2台服务器联机后，组中发生的更改就会发生。</font><font style="vertical-align: inherit;">该图描绘了该情景。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        因此，我们假设有一个包含这5台服务器的组：

        
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            具有成员标识符的服务器s1
            </font></font><code class="literal">199b2df7-4aaf-11e6-bb16-28b2bd168d07</code>
          </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            具有成员标识符的服务器s2
            </font></font><code class="literal">199bb88e-4aaf-11e6-babe-28b2bd168d07</code>
          </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            具有成员标识符的服务器s3
            </font></font><code class="literal">1999b9fb-4aaf-11e6-bb54-28b2bd168d07</code>
          </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            带有成员标识符的服务器s4
            </font></font><code class="literal">19ab72fc-4aaf-11e6-bb51-28b2bd168d07</code>
          </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            具有成员标识符的服务器s5
            </font></font><code class="literal">19b33846-4aaf-11e6-ba81-28b2bd168d07</code>
</p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        最初，小组运行良好，服务器彼此愉快地进行通信。</font><font style="vertical-align: inherit;">您可以通过登录到s1并查看其</font></font><code class="literal">replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能架构表</font><font style="vertical-align: inherit;">来验证此情况
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM performance_schema.replication_group_members;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CHANNEL_NAME | </font><font style="vertical-align: inherit;">MEMBER_ID | </font><font style="vertical-align: inherit;">MEMBER_HOST | </font><font style="vertical-align: inherit;">MEMBER_PORT | </font><font style="vertical-align: inherit;">MEMBER_STATE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">1999b9fb-4aaf-11e6-bb54-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13002 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">199b2df7-4aaf-11e6-bb16-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13001 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">199bb88e-4aaf-11e6-babe-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13000 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">19ab72fc-4aaf-11e6-bb51-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13003 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">19b33846-4aaf-11e6-ba81-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13004 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        然而，不久之后就出现了灾难性故障，服务器s3，s4和s5意外停止。</font><font style="vertical-align: inherit;">在此之后几秒钟，再次</font></font><code class="literal">replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看s1 </font><font style="vertical-align: inherit;">上的
         </font><font style="vertical-align: inherit;">表格表明它仍然在线，但其他几个成员不在。</font><font style="vertical-align: inherit;">事实上，如下所示，他们被标记为
         </font></font><code class="literal">UNREACHABLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此外，该系统无法重新配置自己来改变成员资格，因为大多数人都失去了。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM performance_schema.replication_group_members;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CHANNEL_NAME | </font><font style="vertical-align: inherit;">MEMBER_ID | </font><font style="vertical-align: inherit;">MEMBER_HOST | </font><font style="vertical-align: inherit;">MEMBER_PORT | </font><font style="vertical-align: inherit;">MEMBER_STATE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">1999b9fb-4aaf-11e6-bb54-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13002 | </font><font style="vertical-align: inherit;">UNREACHABLE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">199b2df7-4aaf-11e6-bb16-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13001 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">199bb88e-4aaf-11e6-babe-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13000 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">19ab72fc-4aaf-11e6-bb51-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13003 | </font><font style="vertical-align: inherit;">UNREACHABLE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">19b33846-4aaf-11e6-ba81-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13004 | </font><font style="vertical-align: inherit;">UNREACHABLE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该表显示s1现在处于无需外部干预而无法进展的组中，因为大多数服务器无法访问。</font><font style="vertical-align: inherit;">在这种特殊情况下，需要重新设置组成员列表以允许系统继续进行，这在本节中进行了解释。</font><font style="vertical-align: inherit;">或者，您也可以选择停止s1和s2上的组复制（或完全停止s1和s2），找出s3，s4和s5发生的情况，然后重新启动组复制（或服务器）。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="group-replication-unblocking-a-partition"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解除阻止分区</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        组复制使您能够通过强制执行特定配置来重置组成员列表。</font><font style="vertical-align: inherit;">例如，在上面的情况中，在s1和s2是唯一在线服务器的情况下，您可以选择强制只包含s1和s2的成员资格配置。</font><font style="vertical-align: inherit;">这需要检查一些关于s1和s2的信息，然后使用该
         </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_force_members"><code class="literal">group_replication_force_members</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        变量。
</font></font></p>
<div class="figure">
<a name="idm140528024035520"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.8强制新成员</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-majority-lost-to-stable-group.png" width="266" height="414" alt="一个组中的三台服务器S3，S4和S5发生故障，所以大多数服务器都丢失了，而且该组不能再进行干预。 通过下文所述的干预措施，S1和S2可以自行形成一个稳定的组。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        假设你已经回到了s1和s2是组中剩下的唯一服务器的情况。</font><font style="vertical-align: inherit;">服务器s3，s4和s5已经意外离开组。</font><font style="vertical-align: inherit;">要使服务器s1和s2继续，您需要强制仅包含s1和s2的成员资格配置。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此程序使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_force_members"><code class="literal">group_replication_force_members</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          并应被视为最后的解决办法。</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常谨慎地使用</font><font style="vertical-align: inherit;">它
           </font><font style="vertical-align: inherit;">，并且只能用于超出法定人数的损失。</font><font style="vertical-align: inherit;">如果被滥用，它可能会创建一个人造裂脑场景或完全阻止整个系统。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        回想一下，系统被阻塞，当前配置如下（由s1上的本地故障检测器感知）：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM performance_schema.replication_group_members;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CHANNEL_NAME | </font><font style="vertical-align: inherit;">MEMBER_ID | </font><font style="vertical-align: inherit;">MEMBER_HOST | </font><font style="vertical-align: inherit;">MEMBER_PORT | </font><font style="vertical-align: inherit;">MEMBER_STATE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">1999b9fb-4aaf-11e6-bb54-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13002 | </font><font style="vertical-align: inherit;">UNREACHABLE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">199b2df7-4aaf-11e6-bb16-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13001 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">199bb88e-4aaf-11e6-babe-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13000 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">19ab72fc-4aaf-11e6-bb51-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13003 | </font><font style="vertical-align: inherit;">UNREACHABLE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">19b33846-4aaf-11e6-ba81-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13004 | </font><font style="vertical-align: inherit;">UNREACHABLE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        首先要做的是检查s1和s2的对等体地址（组通信标识符）。</font><font style="vertical-align: inherit;">登录到s1和s2并获取如下信息。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @@group_replication_local_address;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@@ group_replication_local_address |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">127.0.0.1:10000 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------------------------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        然后登录到s2并执行相同的操作：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT @@group_replication_local_address;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">@@ group_replication_local_address |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">127.0.0.1:10001 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------------------------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        一旦知道了s1（</font></font><code class="literal">127.0.0.1:10000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）和s2（</font></font><code class="literal">127.0.0.1:10001</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">的组通信地址</font><font style="vertical-align: inherit;">，就可以在两台服务器之一上使用它来注入一个新的成员资格配置，从而覆盖掉现有法定配置丢失的配置。</font><font style="vertical-align: inherit;">要在s1上做到这一点：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET GLOBAL group_replication_force_members="</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">127.0.0.1:10000,127.0.0.1:10001“;
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这通过强制不同的配置来解除阻塞。</font><font style="vertical-align: inherit;">检查</font></font><code class="literal">replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s1和s2以验证此更改后的组成员资格。</font><font style="vertical-align: inherit;">首先在S1上。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM performance_schema.replication_group_members;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CHANNEL_NAME | </font><font style="vertical-align: inherit;">MEMBER_ID | </font><font style="vertical-align: inherit;">MEMBER_HOST | </font><font style="vertical-align: inherit;">MEMBER_PORT | </font><font style="vertical-align: inherit;">MEMBER_STATE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">b5ffe505-4ab6-11e6-b04b-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13000 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">b60907e7-4ab6-11e6-afb7-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13001 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        然后在S2上。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * FROM performance_schema.replication_group_members;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">CHANNEL_NAME | </font><font style="vertical-align: inherit;">MEMBER_ID | </font><font style="vertical-align: inherit;">MEMBER_HOST | </font><font style="vertical-align: inherit;">MEMBER_PORT | </font><font style="vertical-align: inherit;">MEMBER_STATE |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">b5ffe505-4ab6-11e6-b04b-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13000 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">group_replication_applier | </font><font style="vertical-align: inherit;">b60907e7-4ab6-11e6-afb7-28b2bd168d07 | </font><font style="vertical-align: inherit;">127.0.0.1 | </font><font style="vertical-align: inherit;">13001 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ --------------------------- + --------------------- ----------------- + ------------- ------------- + + ---- ---------- +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        强制进行新的成员资格配置时，确保任何服务器将被强制退出组，确实已停止。</font><font style="vertical-align: inherit;">在上面描述的场景中，如果s3，s4和s5不是真正无法访问，而是处于联机状态，则它们可能已经形成了自己的功能分区（它们是3分之5，因此它们占多数）。</font><font style="vertical-align: inherit;">在这种情况下，强制使用s1和s2的组员列表可能会造成人为的裂脑情况。</font><font style="vertical-align: inherit;">因此，在强制进行新的成员资格配置之前，确保排除的服务器确实已关闭，如果不是，请在继续之前将其关闭。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-enterprise-backup"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.4.4使用MySQL企业备份与组复制</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍如何使用MySQL Enterprise Backup备份和随后恢复组复制成员; </font><font style="vertical-align: inherit;">可以使用相同的技术将新成员快速添加到组中。</font><font style="vertical-align: inherit;">通常，备份组复制成员与备份独立MySQL实例没有区别。</font><font style="vertical-align: inherit;">建议的过程是使用MySQL企业备份映像备份和后续恢复，有关更多信息，请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/mysql-enterprise-backup/4.1/en/backup-commands-backup.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">备份操作</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      所需的步骤可以概括为：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用MySQL Enterprise Backup通过简单的时间戳创建源服务器实例的备份。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将备份复制到目标服务器实例。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用MySQL Enterprise Backup将备份恢复到目标服务器实例。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下过程演示了此过程。</font><font style="vertical-align: inherit;">考虑以下组：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SELECT * member_host, member_port, member_state FROM performance_schema.replication_group_members;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ------------- ------------- + -------------- + +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">member_host | </font><font style="vertical-align: inherit;">member_port | </font><font style="vertical-align: inherit;">member_state |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ------------- ------------- + -------------- + +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">node1 | </font><font style="vertical-align: inherit;">3306 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">node2 | </font><font style="vertical-align: inherit;">3306 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">node3 | </font><font style="vertical-align: inherit;">3306 | </font><font style="vertical-align: inherit;">在线|</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ------------- ------------- + -------------- + +</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在这个例子中，该组在单主模式下操作，并且主组成员是</font></font><code class="literal">node1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这意味着</font></font><code class="literal">node2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且</font></font><code class="literal">node3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是辅助节点，以只读模式（</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）运行。</font><font style="vertical-align: inherit;">使用MySQL企业备份，</font></font><code class="literal">node2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通过发布</font><font style="vertical-align: inherit;">最近的备份</font><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="terminal" class="programlisting"><strong class="userinput"><code>mysqlbackup --defaults-file=/etc/my.cnf --backup-image=/backups/my.mbi_`date +%d%m_%H%M` / <font></font>
		      --backup-dir=/backups/backup_'date +%d%m_%H%M' --user=root -pmYsecr3t /<font></font>
		      --host=127.0.0.1 --no-history-logging backup-to-image</code></strong></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用该</font></font><code class="option">--no-history-logging</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项是
       </font></font><code class="literal">node2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为它是次要的，因为它是只读的，所以MySQL Enterprise Backup无法将状态和元数据表写入实例。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      假设主要成员</font></font><code class="literal">node1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遭遇不可调和的腐败。</font><font style="vertical-align: inherit;">经过一段时间后，服务器实例被重建，但成员上的所有数据都丢失了。</font><font style="vertical-align: inherit;">成员的最新备份</font></font><code class="literal">node2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      可用于重建</font></font><code class="literal">node1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这需要将备份文件复制</font></font><code class="literal">node2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到
       </font></font><code class="literal">node1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后使用MySQL Enterprise Backup将备份恢复到</font></font><code class="literal">node1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您复制备份文件的确切方式取决于您可以使用的操作系统和工具。</font><font style="vertical-align: inherit;">在这个例子中，我们假设Linux服务器并使用SCP在服务器之间复制文件：
    </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">node2 / backups＃ </font></font><strong class="userinput"><code>scp my.mbi_2206_1429 node1:/backups</code></strong></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在这种情况下连接到目标服务器，
       </font></font><code class="literal">node1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并通过发出以下命令使用MySQL Enterprise Backup恢复备份：
    </font></font></p><pre data-lang="terminal" class="programlisting"><strong class="userinput"><code>mysqlbackup --defaults-file=/etc/my.cnf --backup-image=/backups/`ls -1rt /backups|tail /<font></font>
		      -n 1` --backup-dir=/tmp/restore_`date +%d%m_%H%M` copy-back-and-apply-log</code></strong></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      备份被恢复到目标服务器。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果您的组正在使用多主模式，则必须格外小心，以防止在MySQL Enterprise Backup恢复阶段和组复制恢复阶段写入数据库。</font><font style="vertical-align: inherit;">根据客户端访问群组的方式，即使在网络上访问新加入的实例时，DML也有可能执行，即使在重新加入群组之前应用二进制日志之前也是如此。</font><font style="vertical-align: inherit;">为避免这种情况，请使用以下方法配置成员的选项文件
    </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group_replication_start_on_boot = OFF</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
super_read_only = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
event_scheduler = OFF</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这可确保在引导时不启动组复制，成员默认为只读，并且在成员在恢复阶段追上该组时，关闭event_scheduler。</font><font style="vertical-align: inherit;">必须在客户端上配置足够的错误处理，以确认它们在此期间暂时无法执行DML。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      启动服务器实例并连接一个SQL客户端。</font><font style="vertical-align: inherit;">还原的备份具有旧的二进制日志文件和特定于已备份实例的相关元数据。</font><font style="vertical-align: inherit;">重置所有这个问题：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>RESET MASTER;</code></strong></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在这种情况下，恢复的备份具有与源实例关联的中继日志文件</font></font><code class="literal">node2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因此，通过发出以下命令来重置所有复制通道的日志，元数据和配置：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>RESET SLAVE ALL;</code></strong></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      为使恢复的实例能够使用组复制的内置分布式恢复自动恢复（请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-distributed-recovery" title="17.9.5分布式恢复"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.9.5节“分布式恢复”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），请配置该</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      变量。</font><font style="vertical-align: inherit;">MySQL Enterprise Backup备份</font></font><code class="literal">node2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含</font></font><code class="filename">backup_gtid_executed.sql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件，通常位于路径中
       </font></font><code class="filename"><em class="replaceable"><code>datadir</code></em>/meta/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中包含配置所需的信息
       </font></font><code class="literal">node1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">禁用二进制日志记录，然后</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过发出</font><font style="vertical-align: inherit;">以下命令使用此文件配置
       </font><font style="vertical-align: inherit;">变量：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font></font><strong class="userinput"><code>SET SQL_LOG_BIN=OFF;</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>SOURCE <em class="replaceable"><code>datadir</code></em>/meta/backup_gtid_executed.sql</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>SET SQL_LOG_BIN=ON;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      配置</font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-user-credentials" title="17.2.1.3用户凭证"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.2.1.3节“用户凭证”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
      并启动组复制，例如：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; </font><font style="vertical-align: inherit;">
mysql&gt;</font></font><strong class="userinput"><code>CHANGE MASTER TO MASTER_USER='<em class="replaceable"><code>rpl_user</code></em>', MASTER_PASSWORD='<em class="replaceable"><code>password</code></em>' / <font></font>
		FOR CHANNEL 'group_replication_recovery';</code></strong><font style="vertical-align: inherit;"></font><strong class="userinput"><code>START GROUP_REPLICATION; </code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      实例尝试加入组，从正确的位置执行恢复的二进制日志。</font><font style="vertical-align: inherit;">一旦实例获得与该组的同步，它将作为辅助进行加入
       </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">重置还原期间进行的临时配置更改。</font><font style="vertical-align: inherit;">在运行过程中重新启用事件调度程序：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SET global event_scheduler=ON;</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在实例的选项文件中编辑以下系统变量：
    </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group_replication_start_on_boot = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
super_read_only = ON</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
event_scheduler = ON</font></font></pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-replication-security"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5组复制安全性</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-ip-address-whitelisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5.1 IP地址白名单</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-secure-socket-layer-support-ssl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5.2安全套接字层支持（SSL）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-virtual-private-networks-vpn"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5.3虚拟专用网络（VPN）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本节介绍如何确保组的安全，保护组成员之间的连接，或者使用地址白名单建立安全边界。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-ip-address-whitelisting"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5.1 IP地址白名单</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制插件有一个配置选项，用于确定可以接受来自哪个主机的传入组通信连接。</font><font style="vertical-align: inherit;">这个选项被调用
       </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_ip_whitelist"><code class="literal">group_replication_ip_whitelist</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果您在服务器s1上设置此选项，则当服务器s2与s1建立连接以进行群组通信时，s1首先会在接受来自s2的连接之前检查白名单。</font><font style="vertical-align: inherit;">如果s2在白名单中，则s1接受连接，否则s1拒绝s2的连接尝试。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果您没有明确指定白名单，则服务器会自动将白名单设置为服务器具有接口的专用网络。</font><font style="vertical-align: inherit;">这意味着即使服务器具有公共IP上的接口，也不会默认允许来自外部主机的连接。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      只要IP白名单设置为AUTOMATIC，就会在错误日志中添加一个条目，类似于：
    </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2017-10-07T06：40：49.320686Z 4 [注]插件group_replication报告：'[GCS]自动将IP范围192.0.2.21/24,198.51.100.44,203.0.113.0/24,127.0.0.1/32添加到白名单'</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通过手动设置允许使用组通信连接的主机列表，可以进一步提高组的安全性。</font><font style="vertical-align: inherit;">您可以任意组合指定主机名（来自MySQL 5.7.21），简单IP地址或CIDR表示法。</font><font style="vertical-align: inherit;">逗号必须分隔每个条目。</font><font style="vertical-align: inherit;">例如：
    </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; STOP GROUP_REPLICATION;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; SET GLOBAL group_replication_ip_whitelist =“192.0.2.21/24,198.51.100.44,203.0.113.0/24,example.org,www.example.com/24”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; START GROUP_REPLICATION;</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本地主机IP地址（127.0.0.1）始终添加到白名单。</font><font style="vertical-align: inherit;">如果不明确，则隐式地自动添加。</font><font style="vertical-align: inherit;">IPv6地址和解析为IPv6地址的主机名称不受支持。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于主机名称，名称解析仅在另一个服务器发出连接请求时才会发生。</font><font style="vertical-align: inherit;">无法解析的主机名不会被视为白名单验证，并且会向错误日志中写入警告消息。</font><font style="vertical-align: inherit;">对已解析的主机名执行前向确认的反向DNS（FCrDNS）验证。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        主机名本来就不如白名单中的IP地址安全。</font><font style="vertical-align: inherit;">FCrDNS验证提供了良好的保护级别，但可能因某些类型的攻击而受到影响。</font><font style="vertical-align: inherit;">仅在严格需要时才在白名单中指定主机名称，并确保用于名称解析的所有组件（如DNS服务器）均受您的控制。</font><font style="vertical-align: inherit;">您还可以使用hosts文件在本地实施名称解析，以避免使用外部组件。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要加入复制组，服务器只需将它加入组请求的种子成员列入白名单。</font><font style="vertical-align: inherit;">通常，这将成为复制组的引导成员，但它可以是由。所列出的任何服务器
      </font></font><code class="literal">--loose-group_replication_group_seeds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在加入组的服务器的配置中选项。</font><font style="vertical-align: inherit;">但是，请注意，当重新配置复制组时，组成员将重新建立它们之间的连接。</font><font style="vertical-align: inherit;">如果某个组成员仅在重新配置后不再属于复制组的一部分的服务器列入白名单，则无法重新连接到复制组中未列入白名单的其他服务器。</font><font style="vertical-align: inherit;">为了完全避免这种情况，请为属于复制组成员的所有服务器指定相同的白名单。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        根据您的安全要求，可以在不同的组成员上配置不同的白名单，例如，为了将不同的子网分开。</font><font style="vertical-align: inherit;">如果您需要配置不同的白名单以满足您的安全要求，请确保复制组中的白名单之间有足够的重叠，以最大限度地提高服务器在缺少其原始种子成员的情况下能够重新连接的可能性。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-secure-socket-layer-support-ssl"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5.2安全套接字层支持（SSL）</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL组复制支持MySQL服务器的OpenSSL和yaSSL版本。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组通信连接以及恢复连接使用SSL进行保护。</font><font style="vertical-align: inherit;">以下各节介绍如何配置连接。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="group-replication-configuring-ssl-for-recovery"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置SSL进行恢复</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        通过常规异步复制连接执行恢复。</font><font style="vertical-align: inherit;">一旦选择了授权者，加入该组的服务器就建立一个异步复制连接。</font><font style="vertical-align: inherit;">这全是自动的。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        但是，需要SSL连接的用户必须在加入组的服务器连接到捐助者之前创建。</font><font style="vertical-align: inherit;">通常情况下，这是在配置服务器加入组时设置的。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">施主&gt; SET SQL_LOG_BIN = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
授权人&gt; CREATE USER'rec_ssl_user'@'％'REQUIRE SSL;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
捐助者&gt;授予复制奴隶ON *。* TO'rec_ssl_user'@'％';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
施主&gt; SET SQL_LOG_BIN = 1;</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        假设组中的所有服务器都有一个复制用户设置为使用SSL，那么您将连接组的服务器配置为在连接到捐助者时使用这些凭据。</font><font style="vertical-align: inherit;">这是根据为组复制插件提供的SSL选项的值完成的。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new_member&gt; SET GLOBAL group_replication_recovery_use_ssl = 1;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
new_member&gt; SET GLOBAL group_replication_recovery_ssl_ca ='... / cacert.pem';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
new_member&gt; SET GLOBAL group_replication_recovery_ssl_cert ='... / client-cert.pem';</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
new_member&gt; SET GLOBAL group_replication_recovery_ssl_key ='... / client-key.pem';</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        通过将恢复通道配置为使用需要SSL连接的用户的凭据。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new_member&gt; CHANGE MASTER TO MASTER_USER =“rec_ssl_user”FOR CHANNEL“group_replication_recovery”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
new_member&gt; START GROUP_REPLICATION;</font></font></pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="group-replication-configuring-ssl-for-group-communication"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为组通信配置SSL</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        安全套接字可用于在组中的成员之间建立通信。</font><font style="vertical-align: inherit;">这个配置取决于服务器的SSL配置。</font><font style="vertical-align: inherit;">因此，如果服务器配置了SSL，组复制插件也配置了SSL。</font><font style="vertical-align: inherit;">有关配置服务器SSL选项的更多信息，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#encrypted-connection-options" title="6.4.2加密连接的命令选项"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.4.2节“加密连接的命令选项”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">下表中显示了配置组复制的选项。
</font></font></p>
<div class="table">
<a name="idm140528023922176"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表17.6 SSL选项</font></font></b></p>
<div class="table-contents">
<table summary="Lists the server configuration options for SSL and describes their effect on the configuration of the Group Replication plugin for SSL."><colgroup><col width="0.43%"><col width="0.57%"></colgroup><thead><tr>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                服务器配置
              </font></font></p></th>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                插件配置说明
              </font></font></p></th>
          </tr></thead><tbody><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                ssl_key
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                密钥文件的路径。</font><font style="vertical-align: inherit;">用作客户端和服务器证书。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                ssl_cert
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                证书文件的路径。</font><font style="vertical-align: inherit;">用作客户端和服务器证书。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                ssl_ca
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                带有SSL证书的文件路径是可信的。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                ssl_capath
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                包含受信任SSL证书颁发机构证书的目录路径。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                ssl_crl
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                包含证书吊销列表的文件的路径。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                ssl_crlpath
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                包含已撤销证书列表的目录的路径。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                ssl_cipher
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                允许在通过连接加密数据时使用的密码。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                tls_version
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                安全通信将使用此版本及其协议。
              </font></font></p></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这些选项是组服务器配置所依赖的MySQL服务器配置选项。</font><font style="vertical-align: inherit;">此外还有以下组复制特定选项来在插件本身上配置SSL。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_ssl_mode"><code class="literal">group_replication_ssl_mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            - 指定组复制成员之间连接的安全状态。
</font></font></p></li></ul>
</div>

<div class="table">
<a name="idm140528023890288"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表17.7 group_replication_ssl_mode配置值</font></font></b></p>
<div class="table-contents">
<table summary="Lists the possible values for group_replication_ssl_mode and describes their effect on how replication group members connect to each other."><colgroup><col width="0.43%"><col width="0.57%"></colgroup><thead><tr>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                值
              </font></font></p></th>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                描述
              </font></font></p></th>
          </tr></thead><tbody><tr>
            <td scope="row"><p>
                <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用</font></font></em></span>
              </p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                建立一个未加密的连接（</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                需要
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                如果服务器支持安全连接，请建立安全连接。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                VERIFY_CA
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                与所需要的一样，但还要根据配置的证书颁发机构（CA）证书验证服务器TLS证书。
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                VERIFY_IDENTITY
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                与VERIFY_CA类似，但还要验证服务器证书是否与尝试连接的主机相匹配。
              </font></font></p></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以下示例显示了用于在服务器上配置SSL的示例my.cnf文件部分以及如何为组复制激活它。
      </font></font></p><pre data-lang="ini" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的[mysqld]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ssl_ca =“cacert.pem”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ssl_capath =“/.../ca_directory”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ssl_cert =“server-cert.pem”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ssl_cipher =“DHE-RSA-AEs256-SHA”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ssl_crl =“crl-server-revoked.crl”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ssl_crlpath =“/.../crl_directory”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ssl_key =“server-key.pem”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
group_replication_ssl_mode = REQUIRED</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        列出的唯一插件特定配置选项是
         </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_ssl_mode"><code class="literal">group_replication_ssl_mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此选项通过使用</font></font><code class="literal">ssl_*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供给服务器</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">配置SSL框架来激活组成员之间的SSL通信
         </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-virtual-private-networks-vpn"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.5.3虚拟专用网络（VPN）</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      

      没有什么能够防止组复制在虚拟专用网络上运行。</font><font style="vertical-align: inherit;">它的核心就是依靠IPv4套接字在服务器之间建立连接，以便在它们之间传播消息。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-replication-options"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.6组复制系统变量</font></font></h2>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    这些是特定于组复制插件的系统变量。</font><font style="vertical-align: inherit;">每个配置选项都以“group_replication”作为前缀。
</font></font></p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      尽管大多数变量都被描述为动态的，并且可以在服务器运行时进行更改，但大多数更改仅在重新启动组复制插件后才会生效。</font><font style="vertical-align: inherit;">在本节中特别指出可以在不需要重新启动插件的情况下更改的变量。
</font></font></p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="sysvar_group_replication_allow_local_disjoint_gtids_join"></a>
        <a class="indexterm" name="idm140528023860064"></a>

        <a class="indexterm" name="idm140528023859024"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_allow_local_disjoint_gtids_join"><code class="literal">group_replication_allow_local_disjoint_gtids_join</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_allow_local_disjoint_gtids_join"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-allow-local-disjoint-gtids-join=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">弃用</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21年7月5日</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_allow_local_disjoint_gtids_join">group_replication_allow_local_disjoint_gtids_join</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">OFF</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在版本5.7.21中弃用并计划在未来的版本中删除。</font><font style="vertical-align: inherit;">即使组中没有事务，也允许当前服务器加入组。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          启用此选项时请小心，因为不正确的用法可能会导致组中的不一致。
</font></font></p>
</div>
</li><li class="listitem"><p><a name="sysvar_group_replication_allow_local_lower_version_join"></a>
        <a class="indexterm" name="idm140528023824032"></a>

        <a class="indexterm" name="idm140528023822992"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_allow_local_lower_version_join"><code class="literal">group_replication_allow_local_lower_version_join</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_allow_local_lower_version_join"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-allow-local-lower-version-join=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_allow_local_lower_version_join">group_replication_allow_local_lower_version_join</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">OFF</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        即使插件版本低于组，也允许当前服务器加入组。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_auto_increment_increment"></a>
        <a class="indexterm" name="idm140528023791824"></a>

        <a class="indexterm" name="idm140528023790704"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_auto_increment_increment"><code class="literal">group_replication_auto_increment_increment</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_auto_increment_increment"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-auto-increment-increment=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_auto_increment_increment">group_replication_auto_increment_increment</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">7</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低限度</font></font></strong></span></td>
<td><code class="literal">1</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span></td>
<td><code class="literal">65535</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        确定在此服务器实例上执行的事务的连续列值之间的时间间隔。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_bootstrap_group"></a>
        <a class="indexterm" name="idm140528023753472"></a>

        <a class="indexterm" name="idm140528023752432"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_bootstrap_group"><code class="literal">group_replication_bootstrap_group</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_bootstrap_group"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-bootstrap-group=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_bootstrap_group">group_replication_bootstrap_group</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">OFF</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        配置此服务器以引导组。</font><font style="vertical-align: inherit;">该选项只能在一台服务器上设置，并且只能在首次启动组或重新启动整个组时进行。</font><font style="vertical-align: inherit;">组引导完成后，将此选项设置为
         </font></font><code class="literal">OFF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它应该被设置为
         </font></font><code class="literal">OFF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态和配置文件。</font><font style="vertical-align: inherit;">启动两台服务器或在组运行时使用此选项重新启动一台服务器可能会导致人为分裂大脑情况，其中两个具有相同名称的独立组被引导。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_components_stop_timeout"></a>
        <a class="indexterm" name="idm140528023719520"></a>

        <a class="indexterm" name="idm140528023718400"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_components_stop_timeout"><code class="literal">group_replication_components_stop_timeout</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_components_stop_timeout"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-components-stop-timeout=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_components_stop_timeout">group_replication_components_stop_timeout</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">31536000</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        超时（以秒为单位），组复制在关闭时等待每个组件。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_compression_threshold"></a>
        <a class="indexterm" name="idm140528023687280"></a>

        <a class="indexterm" name="idm140528023686240"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_compression_threshold"><code class="literal">group_replication_compression_threshold</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_compression_threshold"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-compression-threshold=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_compression_threshold">group_replication_compression_threshold</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">1000000</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低限度</font></font></strong></span></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span></td>
<td><code class="literal">4294967296</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        高于（LZ4）压缩的字节数值。</font><font style="vertical-align: inherit;">设置为零时，禁用压缩。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_enforce_update_everywhere_checks"></a>
        <a class="indexterm" name="idm140528023648928"></a>

        <a class="indexterm" name="idm140528023647888"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_enforce_update_everywhere_checks"><code class="literal">group_replication_enforce_update_everywhere_checks</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_enforce_update_everywhere_checks"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-enforce-update-everywhere-checks=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_enforce_update_everywhere_checks">group_replication_enforce_update_everywhere_checks</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">OFF</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在任何地方启用或禁用多主更新的严格一致性检查。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_flow_control_applier_threshold"></a>
        <a class="indexterm" name="idm140528023616592"></a>

        <a class="indexterm" name="idm140528023615552"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_flow_control_applier_threshold"><code class="literal">group_replication_flow_control_applier_threshold</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_flow_control_applier_threshold"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-flow-control-applier-threshold=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_flow_control_applier_threshold">group_replication_flow_control_applier_threshold</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">25000</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低限度</font></font></strong></span></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span></td>
<td><code class="literal">2147483648</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        指定应用程序队列中等待触发流量控制的事务数。</font><font style="vertical-align: inherit;">此变量可以在不重置组复制的情况下进行更改。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_flow_control_certifier_threshold"></a>
        <a class="indexterm" name="idm140528023578160"></a>

        <a class="indexterm" name="idm140528023577120"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_flow_control_certifier_threshold"><code class="literal">group_replication_flow_control_certifier_threshold</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_flow_control_certifier_threshold"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-flow-control-certifier-threshold=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_flow_control_certifier_threshold">group_replication_flow_control_certifier_threshold</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">25000</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低限度</font></font></strong></span></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span></td>
<td><code class="literal">2147483648</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        指定触发流量控制的验证者队列中等待事务的数量。</font><font style="vertical-align: inherit;">此变量可以在不重置组复制的情况下进行更改。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_flow_control_mode"></a>
        <a class="indexterm" name="idm140528023539632"></a>

        <a class="indexterm" name="idm140528023538592"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_flow_control_mode"><code class="literal">group_replication_flow_control_mode</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_flow_control_mode"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-flow-control-mode=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_flow_control_mode">group_replication_flow_control_mode</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列举</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">QUOTA</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效值</font></font></strong></span></td>
<td><p class="valid-value"><code class="literal">DISABLED</code></p><p class="valid-value"><code class="literal">QUOTA</code></p></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        指定用于流量控制的模式。</font><font style="vertical-align: inherit;">此变量可以在不重置组复制的情况下进行更改。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_force_members"></a>
        <a class="indexterm" name="idm140528023503072"></a>

        <a class="indexterm" name="idm140528023501968"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_force_members"><code class="literal">group_replication_force_members</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_force_members"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-force-members=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_force_members">group_replication_force_members</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        以逗号分隔的列表形式列出对等地址，例如
         </font></font><code class="literal">host1:port1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">host2:port2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该选项用于强制新组成员资格，其中被排除的成员不会收到新视图并被阻止。</font><font style="vertical-align: inherit;">您需要手动终止排除的服务器。</font><font style="vertical-align: inherit;">列表中的任何无效主机名都可能导致后续
         </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#start-group-replication" title="13.4.3.1 START GROUP_REPLICATION语法"><code class="literal">START GROUP_REPLICATION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        语句失败，因为它们可能会阻止组成员资格。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_group_name"></a>
        <a class="indexterm" name="idm140528023471200"></a>

        <a class="indexterm" name="idm140528023470096"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_group_name"><code class="literal">group_replication_group_name</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_group_name"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-group-name=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_group_name">group_replication_group_name</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        此服务器实例所属的组的名称。</font><font style="vertical-align: inherit;">必须是有效的UUID。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_group_seeds"></a>
        <a class="indexterm" name="idm140528023442256"></a>

        <a class="indexterm" name="idm140528023441152"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_group_seeds"><code class="literal">group_replication_group_seeds</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_group_seeds"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-group-seeds=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_group_seeds">group_replication_group_seeds</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        提供加入成员的成员的列表，其中加入成员需要加入成员才能获得与该组的同步。</font><font style="vertical-align: inherit;">该列表由指定为逗号分隔列表的种子成员的网络地址组成，例如
         </font></font><code class="literal">host1:port1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">host2:port2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通常情况下，该列表由该组的所有成员组成，但您可以选择一组组员作为种子。</font><font style="vertical-align: inherit;">该列表必须至少包含一个有效的成员地址。</font><font style="vertical-align: inherit;">启动组复制时验证每个地址。</font><font style="vertical-align: inherit;">如果列表不包含任何有效的主机名称，则发布</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#start-group-replication" title="13.4.3.1 START GROUP_REPLICATION语法"><code class="literal">START
        GROUP_REPLICATION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">失败。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_ip_whitelist"></a>
        <a class="indexterm" name="idm140528023410160"></a>

        <a class="indexterm" name="idm140528023409120"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_ip_whitelist"><code class="literal">group_replication_ip_whitelist</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_ip_whitelist"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-ip-whitelist=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_ip_whitelist">group_replication_ip_whitelist</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">AUTOMATIC</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        指定允许哪些主机连接到组。</font><font style="vertical-align: inherit;">默认情况下，该系统变量设置为
         </font></font><code class="literal">AUTOMATIC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许来自主机上的专用子网络的活动连接。</font><font style="vertical-align: inherit;">扫描主机上的活动接口，并将专用子网上的地址自动添加到允许列表中。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        或者，您可以将许可主机的白名单指定为逗号分隔的IPv4地址列表，子网CIDR表示法或（来自MySQL 5.7.21）主机名的任意组合。</font><font style="vertical-align: inherit;">例如：
      </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">192.0.2.22,198.51.100.0 / 24，example.org，www.example.com / 24</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        即使未明确指定，始终允许地址127.0.0.1连接。</font><font style="vertical-align: inherit;">IPv6地址和解析为IPv6地址的主机名称不受支持。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于主机名称，名称解析仅在另一个服务器发出连接请求时才会发生。</font><font style="vertical-align: inherit;">无法解析的主机名不会被视为白名单验证，并且会向错误日志中写入警告消息。</font><font style="vertical-align: inherit;">对已解析的主机名执行前向确认的反向DNS（FCrDNS）验证。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          主机名本来就不如白名单中的IP地址安全。</font><font style="vertical-align: inherit;">FCrDNS验证提供了良好的保护级别，但可能因某些类型的攻击而受到影响。</font><font style="vertical-align: inherit;">仅在严格需要时才在白名单中指定主机名称，并确保用于名称解析的所有组件（如DNS服务器）均受您的控制。</font><font style="vertical-align: inherit;">您还可以使用hosts文件在本地实施名称解析，以避免使用外部组件。
</font></font></p>
</div>
</li><li class="listitem"><p><a name="sysvar_group_replication_local_address"></a>
        <a class="indexterm" name="idm140528023372816"></a>

        <a class="indexterm" name="idm140528023371712"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_local_address"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-local-address=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address">group_replication_local_address</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        成员提供的来自其他成员的连接的网络地址，指定为</font></font><code class="literal">host:port</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        格式化的字符串。</font><font style="vertical-align: inherit;">该地址必须能够被该组的所有成员访问，因为XCOM（内部组通信系统）使用该地址。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请勿使用此地址与会员沟通。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        其他群组复制成员通过此联系此成员以
         </font></font><code class="literal">host:port</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行所有内部群组通信。</font><font style="vertical-align: inherit;">这不是MySQL服务器的SQL协议主机和端口。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_member_weight"></a>
        <a class="indexterm" name="idm140528023340768"></a>

        <a class="indexterm" name="idm140528023339664"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_member_weight"><code class="literal">group_replication_member_weight</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_member_weight"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-member-weight=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20年7月5日</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_member_weight">group_replication_member_weight</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">50</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低限度</font></font></strong></span></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span></td>
<td><code class="literal">100</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        可以分配给成员的百分比权重，以影响成员在发生故障转移时作为主要成员选举的机会，例如当现有主要成员离开单个主要组时。</font><font style="vertical-align: inherit;">为成员分配数字权重以确保选择特定成员，例如在主计划的维护期间，或确保某些硬件在发生故障转移时被优先处理。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于具有如下成员的组：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
            <code class="literal">member-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：group_replication_member_weight = 30，server_uuid = aaaa
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">member-2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：group_replication_member_weight = 40，server_uuid = bbbb
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">member-3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：group_replication_member_weight = 40，server_uuid = cccc
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">member-4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：group_replication_member_weight = 40，server_uuid = dddd
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        新主的选举中的构件上方将被分类为</font></font><code class="literal">member-2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><code class="literal">member-3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">member-4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
         </font></font><code class="literal">member-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这导致
         </font></font><code class="literal">member</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-2被选为故障转移事件中的新主节点。</font><font style="vertical-align: inherit;">有关更多信息，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-single-primary-mode" title="17.4.1.1单主模式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.4.1.1节“单主模式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_poll_spin_loops"></a>
        <a class="indexterm" name="idm140528023290160"></a>

        <a class="indexterm" name="idm140528023289120"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_poll_spin_loops"><code class="literal">group_replication_poll_spin_loops</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_poll_spin_loops"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-poll-spin-loops=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_poll_spin_loops">group_replication_poll_spin_loops</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位平台）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（32位平台）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位平台）</font></font></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（32位平台）</font></font></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位平台）</font></font></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（32位平台）</font></font></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位平台）</font></font></td>
<td><code class="literal">18446744073709547520</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（32位平台）</font></font></td>
<td><code class="literal">4294967295</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在线程等待更多传入网络消息之前，组通信线程等待通信引擎互斥量被释放的次数。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_retry_count"></a>
        <a class="indexterm" name="idm140528023238704"></a>

        <a class="indexterm" name="idm140528023237664"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_retry_count"><code class="literal">group_replication_recovery_retry_count</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_retry_count"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-retry-count=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_retry_count">group_replication_recovery_retry_count</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">10</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低限度</font></font></strong></span></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span></td>
<td><code class="literal">31536000</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在放弃之前，正在加入的成员尝试连接可用捐助者的次数。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_reconnect_interval"></a>
        <a class="indexterm" name="idm140528023200432"></a>

        <a class="indexterm" name="idm140528023199312"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_reconnect_interval"><code class="literal">group_replication_recovery_reconnect_interval</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_reconnect_interval"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-reconnect-interval=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_reconnect_interval">group_replication_recovery_reconnect_interval</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">60</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低限度</font></font></strong></span></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span></td>
<td><code class="literal">0</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当在组中找不到供体时重新连接尝试之间的睡眠时间，以秒为单位。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_use_ssl"></a>
        <a class="indexterm" name="idm140528023162128"></a>

        <a class="indexterm" name="idm140528023161088"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_use_ssl"><code class="literal">group_replication_recovery_use_ssl</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_use_ssl"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-use-ssl=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_use_ssl">group_replication_recovery_use_ssl</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">OFF</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        组复制恢复连接是否应使用SSL。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_ssl_ca"></a>
        <a class="indexterm" name="idm140528023130032"></a>

        <a class="indexterm" name="idm140528023128992"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_ca"><code class="literal">group_replication_recovery_ssl_ca</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_ssl_ca"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-ssl-ca=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_ca">group_replication_recovery_ssl_ca</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        包含可信SSL证书颁发机构列表的文件的路径。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_ssl_capath"></a>
        <a class="indexterm" name="idm140528023100992"></a>

        <a class="indexterm" name="idm140528023099952"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_capath"><code class="literal">group_replication_recovery_ssl_capath</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_ssl_capath"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-ssl-capath=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_capath">group_replication_recovery_ssl_capath</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        包含可信SSL证书颁发机构证书的目录的路径。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_ssl_cert"></a>
        <a class="indexterm" name="idm140528023071936"></a>

        <a class="indexterm" name="idm140528023070896"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_cert"><code class="literal">group_replication_recovery_ssl_cert</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_ssl_cert"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-ssl-cert=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_cert">group_replication_recovery_ssl_cert</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        用于建立安全连接的SSL证书文件的名称。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_ssl_key"></a>
        <a class="indexterm" name="idm140528023042880"></a>

        <a class="indexterm" name="idm140528023041840"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_key"><code class="literal">group_replication_recovery_ssl_key</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_ssl_key"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-ssl-key=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_key">group_replication_recovery_ssl_key</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        用于建立安全连接的SSL密钥文件的名称。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_ssl_cipher"></a>
        <a class="indexterm" name="idm140528023013840"></a>

        <a class="indexterm" name="idm140528023012800"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_cipher"><code class="literal">group_replication_recovery_ssl_cipher</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_ssl_cipher"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-ssl-cipher=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_cipher">group_replication_recovery_ssl_cipher</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        SSL加密允许的密码列表。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_ssl_crl"></a>
        <a class="indexterm" name="idm140528022984768"></a>

        <a class="indexterm" name="idm140528022983728"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_crl"><code class="literal">group_replication_recovery_ssl_crl</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_ssl_crl"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-ssl-crl=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_crl">group_replication_recovery_ssl_crl</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        包含包含证书撤销列表的文件的目录的路径。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_ssl_crlpath"></a>
        <a class="indexterm" name="idm140528022955712"></a>

        <a class="indexterm" name="idm140528022954672"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_crlpath"><code class="literal">group_replication_recovery_ssl_crlpath</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_ssl_crlpath"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-ssl-crlpath=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_crlpath">group_replication_recovery_ssl_crlpath</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        包含包含证书撤销列表的文件的目录的路径。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_ssl_verify_server_cert"></a>
        <a class="indexterm" name="idm140528022926608"></a>

        <a class="indexterm" name="idm140528022925568"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_verify_server_cert"><code class="literal">group_replication_recovery_ssl_verify_server_cert</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_ssl_verify_server_cert"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-ssl-verify-server-cert=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_ssl_verify_server_cert">group_replication_recovery_ssl_verify_server_cert</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">OFF</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使恢复过程检查捐助者发送的证书中服务器的通用名称值。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_recovery_complete_at"></a>
        <a class="indexterm" name="idm140528022894272"></a>

        <a class="indexterm" name="idm140528022893232"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_complete_at"><code class="literal">group_replication_recovery_complete_at</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_recovery_complete_at"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-recovery-complete-at=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_recovery_complete_at">group_replication_recovery_complete_at</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列举</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">TRANSACTIONS_APPLIED</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效值</font></font></strong></span></td>
<td><p class="valid-value"><code class="literal">TRANSACTIONS_CERTIFIED</code></p><p class="valid-value"><code class="literal">TRANSACTIONS_APPLIED</code></p></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        状态转移后处理缓存事务时的恢复策略。</font><font style="vertical-align: inherit;">此选项指定会员是否在接收到加入组（</font></font><code class="literal">TRANSACTIONS_CERTIFIED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或）</font><font style="vertical-align: inherit;">之前未接收的所有事务</font><font style="vertical-align: inherit;">或接收并应用它们（</font></font><code class="literal">TRANSACTIONS_APPLIED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">后，在线标记该会员</font><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_gtid_assignment_block_size"></a>
        <a class="indexterm" name="idm140528022856112"></a>

        <a class="indexterm" name="idm140528022854992"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_gtid_assignment_block_size"><code class="literal">group_replication_gtid_assignment_block_size</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_gtid_assignment_block_size"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-gtid-assignment-block-size=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_gtid_assignment_block_size">group_replication_gtid_assignment_block_size</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位平台）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（32位平台）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位平台）</font></font></td>
<td><code class="literal">1000000</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（32位平台）</font></font></td>
<td><code class="literal">1000000</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位平台）</font></font></td>
<td><code class="literal">1</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（32位平台）</font></font></td>
<td><code class="literal">1</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（64位平台）</font></font></td>
<td><code class="literal">18446744073709547520</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（32位平台）</font></font></td>
<td><code class="literal">4294967295</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        为每个成员保留的连续GTID数量。</font><font style="vertical-align: inherit;">每个成员消耗其块，并在需要时保留更多。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_single_primary_mode"></a>
        <a class="indexterm" name="idm140528022804496"></a>

        <a class="indexterm" name="idm140528022803456"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_single_primary_mode"><code class="literal">group_replication_single_primary_mode</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_single_primary_mode"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-single-primary-mode=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_single_primary_mode">group_replication_single_primary_mode</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">ON</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        指示组自动选择一台服务器作为处理读/写工作负载的服务器。</font><font style="vertical-align: inherit;">这台服务器是主要的，其他的都是SECONDARIES。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_ssl_mode"></a>
        <a class="indexterm" name="idm140528022772352"></a>

        <a class="indexterm" name="idm140528022771248"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_ssl_mode"><code class="literal">group_replication_ssl_mode</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_ssl_mode"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-ssl-mode=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_ssl_mode">group_replication_ssl_mode</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列举</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">DISABLED</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效值</font></font></strong></span></td>
<td><p class="valid-value"><code class="literal">DISABLED</code></p><p class="valid-value"><code class="literal">REQUIRED</code></p><p class="valid-value"><code class="literal">VERIFY_CA</code></p><p class="valid-value"><code class="literal">VERIFY_IDENTITY</code></p></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        指定组复制成员之间连接的安全状态。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_start_on_boot"></a>
        <a class="indexterm" name="idm140528022733888"></a>

        <a class="indexterm" name="idm140528022732784"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_start_on_boot"><code class="literal">group_replication_start_on_boot</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_start_on_boot"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-start-on-boot=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7.17</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_start_on_boot">group_replication_start_on_boot</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">ON</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在服务器启动期间服务器是否应启动组复制。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_transaction_size_limit"></a>
        <a class="indexterm" name="idm140528022701840"></a>

        <a class="indexterm" name="idm140528022700720"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_transaction_size_limit"><code class="literal">group_replication_transaction_size_limit</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_transaction_size_limit"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-transaction-size-limit=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19年7月5日</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_transaction_size_limit">group_replication_transaction_size_limit</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（&gt; = 5.7.19）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（&gt; = 5.7.19）</font></font></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（&gt; = 5.7.19）</font></font></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（&gt; = 5.7.19）</font></font></td>
<td><code class="literal">2147483647</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        配置组接受的最大事务大小（以字节为单位）。</font><font style="vertical-align: inherit;">大于此大小的事务将回滚。</font><font style="vertical-align: inherit;">使用此选项可避免导致组失败的大事务。</font><font style="vertical-align: inherit;">大型事务可能会导致组中的问题，无论是在内存分配还是网络带宽消耗方面，这可能会导致故障检测器触发，因为在忙于处理大型事务时给定成员无法访问。</font><font style="vertical-align: inherit;">当设置为0时，组的交易规模不受限制，并且可能存在大量交易导致组失败的风险。</font><font style="vertical-align: inherit;">根据组中需要的工作负载大小调整此变量的值。
      </font></font></p></li><li class="listitem"><p><a name="sysvar_group_replication_unreachable_majority_timeout"></a>
        <a class="indexterm" name="idm140528022662112"></a>

        <a class="indexterm" name="idm140528022661072"></a>

        <a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_unreachable_majority_timeout"><code class="literal">group_replication_unreachable_majority_timeout</code></a>
</p>
<div class="informaltable">
<table frame="box" rules="all" summary="Properties for group_replication_unreachable_majority_timeout"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></th>
<th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font></th>
</tr></thead><tbody><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行格式</font></font></strong></span></td>
<td><code class="literal">--group-replication-unreachable-majority-timeout=value</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19年7月5日</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font></font></strong></span></td>
<td><code class="literal"><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_unreachable_majority_timeout">group_replication_unreachable_majority_timeout</a></code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全球</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">动态</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></strong></span></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">整数</font></font></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></strong></span></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最低限度</font></font></strong></span></td>
<td><code class="literal">0</code></td>
</tr><tr><td scope="row"><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大</font></font></strong></span></td>
<td><code class="literal">31536000</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        配置在离开组之前遭受网络分区并且无法连接到大多数成员的成员需要等待多长时间。</font><font style="vertical-align: inherit;">默认情况下设置为0，这意味着由于网络分区而成为少数的成员永远等待连接组。</font><font style="vertical-align: inherit;">在一组5个服务器（S1，S2，S3，S4，S5）中，如果（S1，S2）和（S3，S4，S5）之间断开，则存在网络分区。</font><font style="vertical-align: inherit;">第一组（S1，S2）现在处于少数，因为它不能接触到一半以上的组。</font><font style="vertical-align: inherit;">尽管多数组（S3，S4，S5）仍在运行，但少数群体将永远等待网络重新连接。</font><font style="vertical-align: inherit;">任何由少数群体处理的交易都会被阻止，直到群组复制停止使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#stop-group-replication" title="13.4.3.2 STOP GROUP_REPLICATION语法"><code class="literal">STOP GROUP
        REPLICATION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 对少数的成员。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果配置为几秒钟，则在离开组之前，会员在与大多数成员失去联系后等待这段时间。</font><font style="vertical-align: inherit;">少数人处理的所有挂起事务都会回滚，少数分区中的服务器将移动到该</font></font><code class="literal">ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态并将其自身设置为
         </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_super_read_only"><code class="literal">super_read_only=ON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当你有一个对称组时，例如只有两个成员（S0，S2），如果有一个网络分区并且没有多数，则在配置的超时之后，所有成员关闭并进入</font></font><code class="literal">ERROR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状态。
</font></font></p>
</div>
</li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-replication-requirements-and-limitations"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.7要求和限制</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-requirements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.7.1组复制要求</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-limitations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.7.2组复制限制</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本节列出并说明组复制的要求和限制。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-requirements"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.7.1组复制要求</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您希望用于组复制的服务器实例必须满足以下要求。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="group-replication-infrastructure"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基础设施</font></font></h4>
</div>
</div>
</div>

<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InnoDB存储引擎。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              数据必须存储在
               </font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html" title="第14章InnoDB存储引擎"><code class="literal">InnoDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事务性存储引擎中。</font><font style="vertical-align: inherit;">事务是乐观执行的，然后在提交时检查冲突。</font><font style="vertical-align: inherit;">如果存在冲突，为了保持整个组的一致性，一些事务被回滚。</font><font style="vertical-align: inherit;">这意味着需要事务性存储引擎。</font><font style="vertical-align: inherit;">此外，
               </font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html" title="第14章InnoDB存储引擎"><code class="literal">InnoDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还提供了一些附加功能，可在与组复制一起运行时更好地管理和处理冲突。
            </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主键。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              每个要由组复制的表都必须具有定义的主键或主键等效项，其中等效项是非空的唯一键。</font><font style="vertical-align: inherit;">这些密钥是表格中每一行所需的唯一标识符，使系统能够通过确切识别每个事务已修改哪些行来确定哪些事务发生冲突。
            </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPv4网络。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL组复制使用的组通信引擎仅支持IPv4。</font><font style="vertical-align: inherit;">因此，组复制需要IPv4网络基础结构。
            </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络性能。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组复制旨在部署在服务器实例彼此非常接近的集群环境中，并受到网络延迟以及网络带宽的影响。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="group-replication-configuration"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器实例配置</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        必须在作为组成员的服务器实例上配置以下选项。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二进制日志活动。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置
               </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_log_bin"><code class="literal">--log-bin[=log_file_name]</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">MySQL组复制复制二进制日志内容，因此需要启动二进制日志才能运行。</font><font style="vertical-align: inherit;">该选项默认启用。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/server-administration.html#binary-log" title="5.4.4二进制日志"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.4.4节“二进制日志”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记录从站更新。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_log_slave_updates"><code class="literal">--log-slave-updates</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">服务器需要记录通过复制应用程序应用的二进制日志。</font><font style="vertical-align: inherit;">组中的服务器需要记录它们从组中收到并应用的所有事务。</font><font style="vertical-align: inherit;">这是必需的，因为恢复是依靠组中的二进制日志形式参与者进行的。</font><font style="vertical-align: inherit;">因此，每个服务器上都需要存在每个事务的副本，即使是在服务器本身没有启动的事务也是如此。
            </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二进制日志行格式。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_binlog_format"><code class="literal">--binlog-format=row</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">组复制依赖基于行的复制格式来在组中的服务器之间一致地传播更改。</font><font style="vertical-align: inherit;">它依靠基于行的基础架构来提取必要的信息，以检测组中不同服务器中并发执行的事务之间的冲突。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/replication.html#replication-formats" title="16.2.1复制格式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第16.2.1节“复制格式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全局事务标识符在。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_gtid_mode"><code class="literal"> --gtid-mode=ON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">组复制使用全局事务标识符来准确跟踪每个服务器实例上已提交哪些事务，从而能够推断出哪些服务器已执行的事务可能与其他地方的已提交事务发生冲突。</font><font style="vertical-align: inherit;">换句话说，明确的事务标识符是框架的基本部分，能够确定哪些事务可能发生冲突。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/replication.html#replication-gtids" title="16.1.3使用全局事务标识符进行复制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第16.1.3节“使用全局事务标识符进行复制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制信息存储库。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置
               </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_master_info_repository"><code class="literal">--master-info-repository=TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              和
               </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_relay_log_info_repository"><code class="literal">--relay-log-info-repository=TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">复制施放需要有写入主信息和中继日志元数据
               </font></font><code class="literal">mysql.slave_master_info</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">mysql.slave_relay_log_info</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统表。</font><font style="vertical-align: inherit;">这确保了组复制插件具有一致的可复制性和对复制元数据的事务管理。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/replication.html#slave-logs-status" title="16.2.4.2从站状态日志"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第16.2.4.2节“从站状态日志”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事务写集提取。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置
               </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_transaction_write_set_extraction"><code class="literal">--transaction-write-set-extraction=XXHASH64</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              以便在收集行以将它们记录到二进制日志中时，服务器也会收集写入集。</font><font style="vertical-align: inherit;">写入集基于每行的主键，并且是标签的简化和紧凑视图，用于唯一标识已更改的行。</font><font style="vertical-align: inherit;">这个标签然后用于检测冲突。
            </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多线程应用程序。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              组复制成员可以配置为多线程应用程序，使事务可以并行应用。</font><font style="vertical-align: inherit;">设置
               </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_slave_parallel_workers"><code class="literal">--slave-parallel-workers=N</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （其中</font></font><code class="literal">N</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是并行施加器线程的数量）
               </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_slave_preserve_commit_order"><code class="literal">--slave-preserve-commit-order=1</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
               </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_slave_parallel_type"><code class="literal">--slave-parallel-type=LOGICAL_CLOCK</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">设置
               </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_slave_parallel_workers"><code class="literal">--slave-parallel-workers=N</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              启用成员上的多线程应用程序。</font><font style="vertical-align: inherit;">组复制依赖于以保证所有参与成员以相同顺序接收和应用已提交事务为基础的一致性机制，因此您还必须设置
              </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_slave_preserve_commit_order"><code class="literal">--slave-preserve-commit-order=1</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              以确保并行交易的最终落实与原始交易的顺序相同。</font><font style="vertical-align: inherit;">最后，为了确定哪些事务可以并行执行，中继日志必须包含由其生成的事务父级信息
               </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_slave_parallel_type"><code class="literal">--slave-parallel-type=LOGICAL_CLOCK</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">试图添加一个</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_slave_parallel_workers"><code class="literal">--slave-parallel-workers</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              设置为大于0 </font><font style="vertical-align: inherit;">的成员
               </font><font style="vertical-align: inherit;">而不设置其他两个选项，则会生成一个错误，并阻止实例加入。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-limitations"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.7.2组复制限制</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制存在以下已知限制。
</font></font></p>
<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小费
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        组复制基于基于GTID的复制构建，因此您应该了解
         </font></font><a class="xref" href="/mysql-5.7-google-zh/replication.html#replication-gtids-restrictions" title="16.1.3.4使用GTID复制的限制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第16.1.3.4节“使用GTID复制的限制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制事件校验和。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            由于复制事件校验和的设计限制，组复制目前无法使用它们。</font><font style="vertical-align: inherit;">因此设置
             </font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_binlog_checksum"><code class="literal">--binlog-checksum=NONE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">间隙锁。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            认证过程没有考虑
             </font></font><a class="link" href="/mysql-5.7-google-zh/glossary.html#glos_gap_lock" title="间隙锁定"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">间隙锁</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因为关于间隙锁的信息在外面不可用
             </font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html" title="第14章InnoDB存储引擎"><code class="literal">InnoDB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多信息，</font><font style="vertical-align: inherit;">请参阅
             </font></font><a class="xref" href="/mysql-5.7-google-zh/innodb-storage-engine.html#innodb-gap-locks" title="间隙锁"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">间隙锁</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            除非您</font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html#isolevel_repeatable-read"><code class="literal">REPEATABLE
            READ</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在应用程序中</font><font style="vertical-align: inherit;">依赖</font><font style="vertical-align: inherit;">语义，</font><font style="vertical-align: inherit;">否则</font><font style="vertical-align: inherit;">我们建议在</font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html#isolevel_read-committed"><code class="literal">READ COMMITTED</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            组复制中</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">隔离级别。</font><font style="vertical-align: inherit;">InnoDB不使用间隙锁</font></font><a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html#isolevel_read-committed"><code class="literal">READ
            COMMITTED</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这将InnoDB中的本地冲突检测与由组复制执行的分布式冲突检测对齐。
</font></font></p>
</div>
</li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表锁和命名锁。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            认证过程没有考虑表锁（请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#lock-tables" title="13.3.5锁定表和解锁表语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.3.5节“锁表和解锁表语法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或命名锁（请参阅</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
          </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可串行化隔离级别。&nbsp;</font></font></b>
            <a class="link" href="/mysql-5.7-google-zh/innodb-storage-engine.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，多主群组不支持隔离级别。</font><font style="vertical-align: inherit;">设置事务隔离级别以
             </font></font><code class="literal">SERIALIZABLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置组复制拒绝提交事务。
          </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并发DDL与DML操作。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在使用多主模式时，不支持针对相同对象但在不同服务器上执行的并发数据定义语句和数据操作语句。</font><font style="vertical-align: inherit;">在对象上执行数据定义语言（DDL）语句期间，在同一对象上但在不同服务器实例上执行并发数据操纵语言（DML）具有在不检测到不同实例时执行冲突DDL的风险。
          </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有级联约束的外键。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            多主模式组（所有配置的成员
             </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_single_primary_mode"><code class="literal">group_replication_single_primary_mode=OFF</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）不支持具有多级外键依赖关系的表，特别是已定义
             </font></font><code class="literal">CASCADING</code>
            <a class="link" href="/mysql-5.7-google-zh/glossary.html#glos_foreign_key_constraint" title="FOREIGN KEY约束"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外键约束的表</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这是因为导致由多主模式组执行的级联操作的外键约束会导致未检测到的冲突并导致整个组成员的数据不一致。</font><font style="vertical-align: inherit;">因此，我们建议设置
             </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_enforce_update_everywhere_checks"><code class="literal">group_replication_enforce_update_everywhere_checks=ON</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            多主模式组中使用的服务器实例以避免未检测到的冲突。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在单主模式下，这不是问题，因为它不允许并发写入多个组成员，因此不存在未检测到冲突的风险。
        </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常大的交易。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            导致GTID内容足够大以至于不能在5秒窗口内通过网络在组成员之间复制的单个事务会导致组通信失败。</font><font style="vertical-align: inherit;">为了避免这个问题，尽可能地尽量限制交易规模。</font><font style="vertical-align: inherit;">例如，将使用的文件拆分</font></font><code class="literal">LOAD DATA
            INFILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为更小的块。
          </font></font></p></li><li class="listitem"><p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL企业审计和MySQL企业防火墙。&nbsp;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在版本5.7.21之前，MySQL Enterprise Audit和MySQL Enterprise Firewall使用
             </font><font style="vertical-align: inherit;">系统数据库中的</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表
             </font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">组复制不支持</font></font><code class="literal">MyISAM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格。

            
</font></font></p><a class="indexterm" name="idm140528022522864"></a><a class="indexterm" name="idm140528022521376"></a></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-replication-frequently-asked-questions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.8常见问题</font></font></h2>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本节为常见问题提供答案。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h3 class="title"><a name="group-replication-maximum-number-servers"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个组中的MySQL服务器的最大数量是多少？</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一个组可以包含最多9台服务器。</font><font style="vertical-align: inherit;">尝试将另一台服务器添加到具有9个成员的组中会导致拒绝加入请求。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-servers-in-a-group-connected"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组中的服务器如何连接？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通过打开点对点TCP连接，组中的服务器连接到组中的其他服务器。</font><font style="vertical-align: inherit;">这些连接仅用于组内服务器之间的内部通信和消息传递。</font><font style="vertical-align: inherit;">该地址由</font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      变量</font><font style="vertical-align: inherit;">配置
       </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-what-is-the-group-replication-bootstrap-group-option-used-for"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">什么是group_replication_bootstrap_group选项用于？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      引导标志指示成员
       </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个组并作为初始种子服务器。</font><font style="vertical-align: inherit;">加入组的第二个成员需要请求引导组的成员动态更改配置，以便将其添加到组中。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      成员需要在两种情况下引导组。</font><font style="vertical-align: inherit;">最初创建组时，或关闭并重新启动整个组时。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-credentials-for-recovery"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何设置恢复过程的凭据？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您可以使用该</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#change-master-to" title="13.4.2.1将主设备更改为语法"><code class="literal">CHANGE MASTER
      TO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">预配置组复制恢复通道凭据</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-scale-out-write-load"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我可以使用组复制扩展我的写入负载吗？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      不是直接的，但MySQL组复制是一个无共享完全复制解决方案，其中组中的所有服务器复制相同数量的数据。</font><font style="vertical-align: inherit;">因此，如果组中的一个成员作为事务提交操作的结果写入了N个字节，则大致N个字节也会写入其他成员的存储中，因为事务在任何地方都被复制。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      但是，考虑到其他成员不必执行原始成员在最初执行交易时必须执行的相同数量的处理，他们会更快地应用更改。</font><font style="vertical-align: inherit;">事务以仅用于应用行转换的格式进行复制，而不必再次重新执行事务（基于行的格式）。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      此外，假设更改以行为基础格式传播和应用，这意味着它们以优化和紧凑的格式接收，并且可能会减少与原始成员相比所需的IO操作数量。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      总而言之，您可以通过在团队中的不同成员之间传播无冲突交易来扩展处理。</font><font style="vertical-align: inherit;">而且您可能会向外扩展一小部分IO操作，因为远程服务器只会接收必要的更改以读取 - 修改 - 将更改写入稳定存储。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-performance-compared"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与简单复制相比，群组复制是否需要更多的网络带宽和CPU，并且工作负载相同？</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      预计会有一些额外负载，因为服务器需要不断进行互动以达到同步的目的。</font><font style="vertical-align: inherit;">很难量化多少数据。</font><font style="vertical-align: inherit;">它还取决于组的大小（三台服务器对组中的九台服务器的带宽要求压力较小）。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      此外，内存和CPU占用空间也较大，因为服务器同步部分和组消息的工作更复杂。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-deploy-across-wide-area-network"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我可以在广域网上部署组复制吗？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      是的，但每个成员之间的网络连接
       </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可靠并具有适当的性能。</font><font style="vertical-align: inherit;">低延迟，高带宽网络连接是实现最佳性能的要求。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果网络带宽本身就是一个问题，那么
       </font><font style="vertical-align: inherit;">可以使用</font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-message-compression" title="17.9.7.2消息压缩"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.9.7.2节“消息压缩”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来降低所需的带宽。</font><font style="vertical-align: inherit;">但是，如果网络丢包，导致重传和更高的端到端延迟，吞吐量和延迟都会受到负面影响。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当任何组员之间的网络往返时间（RTT）为2秒或更长时，您可能会遇到问题，因为内置故障检测机制可能会被错误触发。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-automatically-rejoin-temporary-problems"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在临时连接问题的情况下会员是否自动重新加入团体？</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这取决于连接问题的原因。</font><font style="vertical-align: inherit;">如果连接问题是暂时的，并且重新连接足够快以至于故障检测器不知道它，则服务器可能不会从组中移除。</font><font style="vertical-align: inherit;">如果这是一个“长期”连接问题，那么故障检测器最终会怀疑问题，并且服务器将从组中移除。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      一旦服务器从组中删除，您需要再次加入。</font><font style="vertical-align: inherit;">换句话说，在明确从组中删除服务器之后，需要手动重新加入服务器（或者让脚本自动执行）。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-member-excluded"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">什么时候会员从一个组中排除？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果该成员变为沉默，其他成员将其从组配置中删除。</font><font style="vertical-align: inherit;">实际上，这可能发生在成员崩溃或网络断开时。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在给定成员的给定超时过去之后检测到故障，并且创建没有静默成员的新配置。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-node-lag"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当一个节点明显滞后时会发生什么？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      没有任何方法来定义何时从组中自动排除成员的策略。</font><font style="vertical-align: inherit;">你需要找出一个成员落后的原因，并解决这个问题，或者从团队中删除成员。</font><font style="vertical-align: inherit;">否则，如果服务器速度太慢以至于触发流量控制，那么整个组也会变慢。</font><font style="vertical-align: inherit;">流量控制可根据您的需求进行配置。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-member-responsible-reconfiguration"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在怀疑组中存在问题时，是否有特殊成员负责触发重新配置？</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      不，在负责触发重新配置的组中没有特殊成员。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      任何成员都可以怀疑存在问题。</font><font style="vertical-align: inherit;">所有成员都需要（自动）同意给定的成员失败。</font><font style="vertical-align: inherit;">通过触发重新配置，一名成员负责将其从组中排除。</font><font style="vertical-align: inherit;">哪个成员负责驱逐成员不是你可以控制或设置的东西。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-provide-sharding"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我可以使用组复制进行分片吗？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制旨在提供高度可用的副本集; </font><font style="vertical-align: inherit;">数据和写入重复在组中的每个成员上。</font><font style="vertical-align: inherit;">为了扩展到单个系统可以提供的范围之外，您需要一个围绕多个组复制集合构建的编排和分片框架，其中每个副本集都维护并管理您的总数据集的给定分片或分区。</font><font style="vertical-align: inherit;">这种类型的设置通常称为</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“分片</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">群集</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，允许您线性扩展读取和写入，且不受限制。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-using-selinux"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我如何在SELinux中使用组复制？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果SELinux的启用，通过它可以验证使用
       </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sestatus -v</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，那么你需要能够使用该组复制通信端口，通过配置
       </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，为</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的mysqld</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以便它可以绑定到它，听那里。</font><font style="vertical-align: inherit;">要查看MySQL当前允许使用哪些端口，请发出
       </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">semanage port -l | </font><font style="vertical-align: inherit;">grep mysqld</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">假设配置的端口是6606，请通过发出</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">semanage端口-a -t mysqld_port_t -p tcp 6606</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将必要的端口添加到SELinux允许的</font><span class="command"><strong><font style="vertical-align: inherit;">端口</font></strong></span><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-using-iptables"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何在iptables中使用组复制？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果启用了iptables，则需要打开组复制端口以在机器之间进行通信。</font><font style="vertical-align: inherit;">要查看每台机器上的当前规则，请发布
       </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iptables -L</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">假设端口配置为6606，请通过发出</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iptables -A INPUT -p tcp -dport 6606 -j ACCEPT</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在必要的端口上启用通信
       </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-recover-relay-log"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何恢复组成员使用的复制通道的中继日志？</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制使用的复制通道的行为与主从复制中使用的复制通道的行为相同，因此依赖于中继日志。</font><font style="vertical-align: inherit;">如果</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#sysvar_relay_log"><code class="literal">relay_log</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">发生变化</font><font style="vertical-align: inherit;">，或者未设置选项且主机名称更改，则可能会出现错误。</font><font style="vertical-align: inherit;">在这种情况下</font></font><a class="xref" href="/mysql-5.7-google-zh/replication.html#slave-logs-relaylog" title="16.2.4.1从站中继日志"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font><a class="xref" href="/mysql-5.7-google-zh/replication.html#slave-logs-relaylog" title="16.2.4.1从站中继日志"><font style="vertical-align: inherit;">第16.2.4.1节“从站中继日志”</font></a><font style="vertical-align: inherit;">了解恢复过程。</font><font style="vertical-align: inherit;">或者，在组复制中特别解决该问题的另一种方法是发出</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#stop-group-replication" title="13.4.3.2 STOP GROUP_REPLICATION语法"><code class="literal">STOP GROUP_REPLICATION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，然后使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#start-group-replication" title="13.4.3.1 START GROUP_REPLICATION语法"><code class="literal">START GROUP_REPLICATION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      语句重新启动实例。</font><font style="vertical-align: inherit;">组复制插件</font></font><code class="literal">group_replication_applier</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再次</font><font style="vertical-align: inherit;">创建</font><font style="vertical-align: inherit;">通道。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-two-bind-addresses"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为什么组复制使用两个绑定地址？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制使用两个绑定地址为了分割SQL地址之间的网络流量，客户端使用该地址与成员进行通信，而
       </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组群成员在内部使用该地址进行通信。</font><font style="vertical-align: inherit;">例如，假定与分配给该网络地址的两个网络接口的服务器</font></font><code class="literal">203.0.113.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><code class="literal">198.51.100.179</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，您可以</font></font><code class="literal">203.0.113.1:33061</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过设置</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">内部群组网络地址
       </font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_local_address"><code class="literal">group_replication_local_address=203.0.113.1:33061</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后你可以使用</font></font><code class="literal">198.51.100.179</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for
       </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_hostname"><code class="literal">hostname</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><code class="literal">3306</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for
       </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_port"><code class="literal">port</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后，客户端SQL应用程序将连接到该成员
      </font></font><code class="literal">198.51.100.179:3306</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这使您可以在不同的网络上配置不同的规则。</font><font style="vertical-align: inherit;">同样，可以将内部组通信与用于客户端应用程序的网络连接分开，以提高安全性。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h3 class="title"><a name="group-replication-hostnames"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组复制如何使用网络地址和主机名？</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制使用成员之间的网络连接，因此其功能直接受到您如何配置主机名和端口的影响。</font><font style="vertical-align: inherit;">例如，组复制恢复过程基于使用服务器的主机名和端口的异步复制。</font><font style="vertical-align: inherit;">成员加入某个组时，它将使用列出的网络地址信息收到组成员资格信息
       </font></font><code class="literal">performance_schema.replication_group_members</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该表中列出的其中一名成员被选为该组成员缺少数据的捐助者。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这意味着您使用主机名配置的任何值（例如SQL网络地址或组种子地址）必须是完全限定的名称，并且可由组中的每个成员解析。</font><font style="vertical-align: inherit;">您可以通过例如DNS或正确配置的</font></font><code class="filename">/etc/hosts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件或其他本地进程</font><font style="vertical-align: inherit;">来确保这一点</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果您想要</font></font><code class="literal">MEMBER_HOST</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在服务器上</font><font style="vertical-align: inherit;">配置该</font><font style="vertical-align: inherit;">值，请在将其</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#option_mysqld_report-host"><code class="option">--report-host</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加入到组之前</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">服务器上的选项</font><font style="vertical-align: inherit;">指定</font><font style="vertical-align: inherit;">该
       </font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        分配的值直接使用，不受</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#option_mysqld_skip-name-resolve"><code class="option">--skip-name-resolve</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">影响
         </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要</font></font><code class="literal">MEMBER_PORT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在服务器上</font><font style="vertical-align: inherit;">配置</font><font style="vertical-align: inherit;">，请使用该</font></font><a class="link" href="/mysql-5.7-google-zh/replication.html#option_mysqld_report-port"><code class="option">--report-port</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">指定它</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="group-replication-technical-details"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9组复制技术细节</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-plugin-architecture"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.1组复制插件体系结构</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-the-group"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.2集团</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-data-manipulation-statements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.3数据操作语句</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-data-definition-statements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.4数据定义语句</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-distributed-recovery"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5分布式恢复</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-observability"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.6可观察性</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-performance"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7组复制性能</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本节提供了有关MySQL组复制的更多技术细节。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-plugin-architecture"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.1组复制插件体系结构</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL组复制是一个MySQL插件，它基于现有的MySQL复制基础架构，利用二进制日志，基于行的日志记录和全局事务标识符等功能。</font><font style="vertical-align: inherit;">它集成了当前的MySQL框架，如性能模式或插件和服务基础架构。</font><font style="vertical-align: inherit;">下图显示了描述MySQL组复制整体架构的框图。
</font></font></p>
<div class="figure">
<a name="idm140528022438256"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.9组复制插件框图</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-plugin-blocks.png" width="455" height="393" alt="该图后面的文字描述了该图的内容。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL Group Replication插件包含一组用于捕获，应用和生命周期的API，它们控制插件与MySQL服务器的交互方式。</font><font style="vertical-align: inherit;">有一些接口可以使信息从服务器流向插件，反之亦然。</font><font style="vertical-align: inherit;">这些接口将MySQL服务器核心与组复制插件隔离开来，并且大部分挂钩位于事务执行管道中。</font><font style="vertical-align: inherit;">在一个方向上，从服务器到插件，有事件通知，例如服务器启动，服务器恢复，服务器准备好接受连接，以及服务器即将提交事务。</font><font style="vertical-align: inherit;">另一方面，插件会指示服务器执行诸如提交或中止正在进行的事务等操作，
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制插件体系结构的下一层是一组组件，它们在将通知路由到它们时发生反应。</font><font style="vertical-align: inherit;">捕获组件负责跟踪与正在执行的事务相关的上下文。</font><font style="vertical-align: inherit;">应用程序组件负责在数据库上执行远程事务。</font><font style="vertical-align: inherit;">恢复组件负责管理分布式恢复，并负责通过选择捐助者来获得最新加入组的服务器，协调追赶程序并对捐助者失败做出反应。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      继续执行堆栈，复制协议模块包含复制协议的特定逻辑。</font><font style="vertical-align: inherit;">它处理冲突检测，并接收并向组传播事务。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      组复制插件体系结构的最后两层是组通信系统（GCS）API，以及基于Paxos的组通信引擎的实现。</font><font style="vertical-align: inherit;">GCS API是一个高级API，用于抽象构建复制状态机所需的属性（请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-background" title="17.1组复制背景"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.1节“组复制背景”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">因此它将消息层的实现从插件的其余上层分离出来。</font><font style="vertical-align: inherit;">组通信引擎处理与复制组成员的通信。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-the-group"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.2集团</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在MySQL组复制中，一组服务器形成一个复制组。</font><font style="vertical-align: inherit;">一个组有一个名称，它采用UUID的形式。</font><font style="vertical-align: inherit;">该组织是动态的，服务器可以随时离开（自愿或非自愿）并加入。</font><font style="vertical-align: inherit;">每当服务器加入或离开时，该组都会自行调整。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果一台服务器加入该组，它会通过从现有服务器获取缺失状态自动更新自己。</font><font style="vertical-align: inherit;">此状态通过异步MySQL复制进行传输。</font><font style="vertical-align: inherit;">如果某个服务器离开该组，例如该服务器已关闭以进行维护，则剩余的服务器会注意到它已自动离开并重新配置该组。</font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-group-membership" title="17.1.3.2组成员"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.1.3.2节“组员资格”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述的组员资格服务为</font><font style="vertical-align: inherit;">
      所有这些提供了权力。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-data-manipulation-statements"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.3数据操作语句</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      由于没有任何特定数据集的主服务器（主服务器），组中的每个服务器都可以随时执行事务，即使是更改状态（RW事务）的事务。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      任何服务器都可以在没有任何</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">先验</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 

      

      协调的</font><font style="vertical-align: inherit;">情况下执行交易</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，在提交时，它会与小组中的其他服务器进行协调，以决定该交易的命运。</font><font style="vertical-align: inherit;">这种协调有两个目的：（i）检查交易是否应承诺; </font><font style="vertical-align: inherit;">（ii）并传播更改，以便其他服务器也可以应用该事务。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      由于事务是通过原子广播发送的，因此组中的所有服务器都会收到该事务，否则都不会。</font><font style="vertical-align: inherit;">如果他们收到，那么他们都会按照与之前发送的其他交易相同的顺序收到。</font><font style="vertical-align: inherit;">冲突检测通过检查和比较写入交易集来进行。</font><font style="vertical-align: inherit;">因此，它们在行级被检测到。</font><font style="vertical-align: inherit;">冲突解决遵循第一个提交者获胜规则。</font><font style="vertical-align: inherit;">如果t1和t2在不同的站点同时执行，由于t2是在t1之前排序的，并且两者都改变​​了同一行，所以t2赢得冲突并且t1中止。</font><font style="vertical-align: inherit;">换句话说，t1试图改变已被t2渲染的数据。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果两个事务经常发生冲突，那么最好在同一台服务器上启动它们。</font><font style="vertical-align: inherit;">然后他们有机会在本地锁管理器上进行同步，而不是稍后在复制协议中中止。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-data-definition-statements"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.4数据定义语句</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在组复制拓扑中，执行数据定义语句（通常称为数据定义语言（DDL））时需要注意。</font><font style="vertical-align: inherit;">由于MySQL不支持原子或事务性DDL，因此无法乐观地执行DDL语句，并在需要时回滚。</font><font style="vertical-align: inherit;">因此，缺乏原子性并不直接适用于组复制所基于的乐观复制范式。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      因此，在复制数据定义语句时需要更加小心。</font><font style="vertical-align: inherit;">对架构操作尚未完成并随处复制时，架构对对象包含的数据所做的更改和更改需要通过同一台服务器进行处理。</font><font style="vertical-align: inherit;">不这样做可能会导致数据不一致。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果组以单主模式部署，那么这不是问题，因为所有更改都是通过同一台主服务器执行的。
</font></font></p>
</div>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL DDL执行不是原子或事务性的。</font><font style="vertical-align: inherit;">服务器首先执行并没有确定组协议提交。</font><font style="vertical-align: inherit;">因此，您必须通过同一台服务器为同一个对象路由DDL和DML，而DDL正在执行并且还没有到处复制。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-distributed-recovery"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5分布式恢复</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-distributed-recovery-basics"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5.1分布式恢复基础</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-recovering-from-a-point-in-time"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5.2从时间点恢复</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-view-changes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5.3查看更改</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-usage-advice-and-limitations-of-distributed-recovery"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5.4分布式恢复的使用建议和限制</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍加入组的成员通过该进程赶上组中剩余的服务器的过程，称为分布式恢复。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-distributed-recovery-basics"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5.1分布式恢复基础</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节是高层次的总结。</font><font style="vertical-align: inherit;">以下部分通过更详细地描述过程的阶段提供了更多细节。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        组复制分布式恢复可以概括为一个过程，通过该过程，服务器从组中缺少事务，以便它可以加入与其他组成员处理相同事务的组。</font><font style="vertical-align: inherit;">在分布式恢复期间，加入组的服务器将缓冲加入组的服务器正在接收组中所需的事务时发生的所有事务和成员事件。</font><font style="vertical-align: inherit;">一旦加入该组的服务器接收到该组的所有事务，它将应用在恢复过程中缓冲的事务。</font><font style="vertical-align: inherit;">在这个过程结束后，服务器将作为在线成员加入该组。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="group-replication-phase-1"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阶段1</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在第一阶段，加入该组的服务器将选择组中的一台在线服务器</font><font style="vertical-align: inherit;">作为缺失状态</font><font style="vertical-align: inherit;">的
           </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">捐助者</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">捐赠者负责向服务器提供加入该组所缺少的所有数据。</font><font style="vertical-align: inherit;">这是通过依靠在加入组的服务器和服务器之间建立的标准异步复制通道来实现的，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/replication.html#replication-channels" title="16.2.3复制通道"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第16.2.3节“复制通道”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通过此复制通道，复制捐赠者的二进制日志，直到加入该组的服务器成为该组的一部分时发生视图更改。</font><font style="vertical-align: inherit;">加入组的服务器在收到捐赠者的二进制日志时应用它。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在二进制日志被复制时，加入组的服务器也会缓存在组内交换的所有事务。</font><font style="vertical-align: inherit;">换句话说，它正在监听它加入该组后正在发生的交易，并且正在从捐助者处应用缺失状态。</font><font style="vertical-align: inherit;">当第一阶段结束并且向捐助者的复制渠道关闭时，加入该组的服务器将启动第二阶段：追赶。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="group-replication-phase-2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阶段2</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在这个阶段，加入组的服务器继续执行缓存的事务。</font><font style="vertical-align: inherit;">当排队等待执行的事务数量最终达到零时，会员将在线声明。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="group-replication-resilience"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">弹性</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          恢复过程可承受捐赠者失败，同时加入该组的服务器正在从中获取二进制日志。</font><font style="vertical-align: inherit;">在这种情况下，只要捐赠者在第一阶段失败，加入该组的服务器就会故障转移到新的捐助者并从该捐赠者恢复。</font><font style="vertical-align: inherit;">当发生这种情况时，加入组的服务器会关闭到明确加入组的失败服务器的连接，并打开与新捐助者的连接。</font><font style="vertical-align: inherit;">这是自动发生的。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-recovering-from-a-point-in-time"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5.2从时间点恢复</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要将加入组的服务器与捐助者同步到特定时间点，加入组和捐助者的服务器将使用MySQL全局事务标识符（GTID）机制。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/replication.html#replication-gtids" title="16.1.3使用全局事务标识符进行复制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第16.1.3节“使用全局事务标识符进行复制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，GTIDS仅提供了一种方法，可以确定加入组的服务器缺失哪些事务，它们无助于标记加入组的服务器必须赶上的具体时间点，也不帮助传送认证信息。</font><font style="vertical-align: inherit;">这是二进制日志视图标记的工作，它标记二进制日志流中的视图更改，并且还包含其他元数据信息，供应服务器加入缺少认证相关数据的组。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="group-replication-view-and-view-changes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看和查看更改</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了解释视图更改标记的概念，了解视图和视图更改的内容很重要。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          甲</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">视图</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对应于一组在当前配置中积极参与成员，换句话说的在时间上的特定点。</font><font style="vertical-align: inherit;">他们在系统中是正确的和在线的。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          甲</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">视图改变</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时所述组结构的修改情况，例如构件接合或离开发生。</font><font style="vertical-align: inherit;">任何组员资格变更都会导致独立视图变更在同一逻辑时间点传达给所有成员。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          甲</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">视图标识符</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">唯一地标识的图。</font><font style="vertical-align: inherit;">它在视图更改发生时生成
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在组通信层，视图更改及其相关的视图ID是成员加入之前和之后交换的数据之间的边界。</font><font style="vertical-align: inherit;">这个概念是通过一个新的二进制日志事件实现的：“查看更改日志事件”。</font><font style="vertical-align: inherit;">视图ID因此也成为在组成员身份发生变化之前和之后传输的事务的标记。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          视图标识符本身由两部分构成：
           </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（i）</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">随机生成的和
           </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ii）</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单调递增的整数。</font><font style="vertical-align: inherit;">第一部分在组创建时生成，并且在组中至少有一个成员时保持不变。</font><font style="vertical-align: inherit;">每次发生视图更改时，第二部分都会增加。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          构成视图id的异构对的原因在于，需要在成员加入或离开时明确地标记组更改，而且每当所有成员离开组时都需要明确标记组更改，并且没有关于该组所在视图的信息。实际上，单一增加标识符的使用可能会导致在完全组关闭后重新使用相同的标识，从而破坏恢复所依赖的二进制日志数据标记的唯一性。</font><font style="vertical-align: inherit;">总而言之，第一部分标识组从何时开始，而增量部分是当组从此时开始变化时的增量部分。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-view-changes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5.3查看更改</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节介绍了控制如何将视图更改标识符合并到二进制日志事件中并写入日志的过程。执行以下步骤：
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="group-replication-begin-stable-group"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开始：稳定组</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所有服务器都处于联机状态并处理来自组的传入事务。</font><font style="vertical-align: inherit;">就复制的交易而言，一些服务器可能稍微落后，但最终它们会收敛。</font><font style="vertical-align: inherit;">该组充当一个分布式和复制的数据库。
</font></font></p>
<div class="figure">
<a name="idm140528022382880"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.10稳定组</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-recovery-1.png" width="534" height="525" alt="服务器S1，S2和S3是该组的成员。 所有二进制日志中的最新项目是事务T20。">
</div>

</div>

</div>
<br class="figure-break">
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="group-replication-view-change-member-joins"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看更改：会员加入</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          每当新成员加入组并因此执行视图更改时，每个联机服务器都会将视图更改日志事件排队以供执行。</font><font style="vertical-align: inherit;">这是排队的，因为在视图更改之前，可以在服务器上排队几个事务以应用，因此这些事务属于旧视图。</font><font style="vertical-align: inherit;">在它们之后排队查看更改事件可以保证正确标记发生这种情况的时间。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          同时，加入该组的服务器通过视图抽象从会员服务所述的在线服务器列表中选择捐赠者。</font><font style="vertical-align: inherit;">成员加入视图4，在线成员将视图更改事件写入二进制日志。
</font></font></p>
<div class="figure">
<a name="idm140528022373312"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.11会员加入</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-recovery-2.png" width="654" height="559" alt="服务器S4加入该组并寻找捐助者。 服务器S1，S2和S3各自为它们的二进制日志排队查看改变条目VC4。 同时，服务器S1正在接收新的事务T21。">
</div>

</div>

</div>
<br class="figure-break">
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="group-replication-state-transfer-catching-up"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">国家转移：迎头赶上</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一旦加入组的服务器选择了组中的哪台服务器作为捐助者，则在两者之间建立新的异步复制连接并开始状态转移（阶段1）。</font><font style="vertical-align: inherit;">与捐助者的这种交互持续，直到服务器加入组的施加者线程处理视图改变日志事件，该事件对应于当加入组的服务器进入组时触发的视图改变。</font><font style="vertical-align: inherit;">换句话说，加入组的服务器复制来自捐助者，直到它到达具有与其已经处于的视图标记相匹配的视图标识符的标记。
</font></font></p>
<div class="figure">
<a name="idm140528022364000"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.12状态转移：追赶</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-recovery-3.png" width="603" height="525" alt="服务器S4选择服务器S2作为捐助者。 状态传输从服务器S2执行到服务器S4，直到到达视图改变条目VC4（view_id = VC4）。 服务器S4使用临时应用程序缓冲区进行状态传输，其二进制日志当前为空。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由于视图标识符在同一逻辑时间传输给组中的所有成员，因此加入组的服务器知道应停止复制哪个视图标识符。</font><font style="vertical-align: inherit;">这避免了复杂的GTID集计算，因为视图ID清楚地标记哪些数据属于每个组视图。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当加入组的服务器正在从授权者复制时，它也会缓存来自组的传入事务。</font><font style="vertical-align: inherit;">最终，它会停止从施主身上进行复制，并切换到应用缓存的应用。
</font></font></p>
<div class="figure">
<a name="idm140528022355376"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.13排队事务</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-recovery-4.png" width="644" height="525" alt="国家转让已经完成。 服务器S4已经应用了高达T20的事务并将它们写入其二进制日志。 服务器S4在恢复时缓存了在视图改变之后到达的事务T21在临时应用程序缓冲器中。">
</div>

</div>

</div>
<br class="figure-break">
</div>

<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="group-replication-finish-caught-up"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成：抓起来</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当加入组的服务器识别具有预期视图标识符的视图更改日志事件时，与授权者的连接将终止，并开始应用高速缓存的事务。</font><font style="vertical-align: inherit;">重要的一点是要了解最终的恢复程序。</font><font style="vertical-align: inherit;">虽然它充当二进制日志中的标记，但分隔视图更改，视图更改日志事件也起到另一个作用。</font><font style="vertical-align: inherit;">它传达所有服务器在加入组的服务器进入组时所感知的认证信息，换句话说，最后一次视图更改。</font><font style="vertical-align: inherit;">没有它，加入该组的服务器将没有必要的信息来证明（检测到冲突）后续事务。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          追赶期（第二阶段）不是确定性的，因为它取决于工作量和工作组收到交易的比率。</font><font style="vertical-align: inherit;">此过程完全联机，加入该组的服务器在追赶时不会阻止该组中的其他服务器。</font><font style="vertical-align: inherit;">因此，由于这个原因，加入组的服务器在进入阶段2时所落后的交易数量可能因工作量而异或增加或减少。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当加入该组的服务器达到零排队事务并且其存储的数据与其他成员相同时，其公共状态更改为联机。
</font></font></p>
<div class="figure">
<a name="idm140528022344544"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.14在线实例</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-recovery-5.png" width="597" height="525" alt="服务器S4现在是该组的在线成员。 它应用了高速缓存事务T21，因此它的二进制日志显示与其他组成员的二进制日志相同的项目，并且不再需要临时应用程序缓冲区。 新的传入交易T22现在被所有组成员接收和应用。">
</div>

</div>

</div>
<br class="figure-break">
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-usage-advice-and-limitations-of-distributed-recovery"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.5.4分布式恢复的使用建议和限制</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        分布式恢复确实有一些限制。</font><font style="vertical-align: inherit;">它基于经典的异步复制，因此如果加入组的服务器根本没有配置或配置了非常旧的备份映像，则速度可能会变慢。</font><font style="vertical-align: inherit;">这意味着如果在阶段1传输的数据太大，服务器可能需要很长时间才能恢复。</font><font style="vertical-align: inherit;">因此，建议在向组中添加服务器之前，应该为组中已有的服务器提供相当近的快照。</font><font style="vertical-align: inherit;">这将阶段1的长度最小化并减少对施主服务器的影响，因为它必须保存和传输更少的二进制日志。
</font></font></p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
警告
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          建议在将服务器添加到组之前设置服务器。</font><font style="vertical-align: inherit;">这样，可以最大限度地缩短恢复步骤的时间。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-observability"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.6可观察性</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Group Replication插件中内置了很多自动化功能。</font><font style="vertical-align: inherit;">尽管如此，你可能有时需要了解幕后发生的事情。</font><font style="vertical-align: inherit;">这是组复制和性能模式的检测变得重要的地方。</font><font style="vertical-align: inherit;">可以通过performance_schema表查询系统的整个状态（包括视图，冲突统计信息和服务状态）。</font><font style="vertical-align: inherit;">复制协议的分布式特性和服务器实例同意并因此在事务和元数据上同步的事实使得检查组的状态变得更简单。</font><font style="vertical-align: inherit;">例如，</font><font style="vertical-align: inherit;">您可以连接到组中的单个服务器，并通过在组复制相关的性能模式表上发出选择语句来获取本地和全局信息。</font><font style="vertical-align: inherit;">有关更多信息，请参阅
      </font></font><a class="xref" href="/mysql-5.7-google-zh/group-replication.html#group-replication-monitoring" title="17.3监视组复制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第17.3节“监控组复制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="group-replication-performance"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7组复制性能</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-fine-tuning-the-group-communication-thread"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7.1微调组通信线程</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-message-compression"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7.2消息压缩</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/group-replication.html#group-replication-flow-control"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7.3流量控制</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍如何使用可用的配置选项来获得组中的最佳性能。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-fine-tuning-the-group-communication-thread"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7.1微调组通信线程</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        组通信线程（GCT）在加载组复制插件时以循环方式运行。</font><font style="vertical-align: inherit;">GCT接收来自组和来自插件的消息，处理与仲裁和故障检测有关的任务，发送一些保持活动的消息，并处理从/到服务器/组的传入和传出事务。</font><font style="vertical-align: inherit;">GCT等待队列中的传入消息。</font><font style="vertical-align: inherit;">当没有消息时，GCT等待。</font><font style="vertical-align: inherit;">通过配置此等待时间稍长一点（进行主动等待），在实际进入睡眠状态之前，在某些情况下证明是有益的。</font><font style="vertical-align: inherit;">这是因为替代方案是操作系统将GCT从处理器中切换出来并执行上下文切换。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        为了强制GCT进行主动等待</font></font><a class="link" href="/mysql-5.7-google-zh/group-replication.html#sysvar_group_replication_poll_spin_loops"><code class="literal">group_replication_poll_spin_loops</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ，在实际轮询队列以查找下一条消息之前</font><font style="vertical-align: inherit;">，使用
         </font><font style="vertical-align: inherit;">选项，该选项使GCT循环与配置的循环次数无关。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        例如：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; SET GLOBAL group_replication_poll_spin_loops = 10000;</font></font></pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-message-compression"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7.2消息压缩</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当网络带宽成为瓶颈时，消息压缩可以在组通信级别上提高30-40％的吞吐量。</font><font style="vertical-align: inherit;">在负载较重的大型服务器组的情况下，这一点尤其重要。
</font></font></p>
<div class="table">
<a name="idm140528022321232"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表17.8不同二进制日志格式的LZ4压缩比</font></font></b></p>
<div class="table-contents">
<table summary="Compares the compression ratio for the ROW and STATEMENT binary log formats with different workloads."><colgroup><col width="0.59%"><col width="0.18%"><col width="0.24%"></colgroup><thead><tr>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                工作量
              </font></font></p></th>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                ROW的比率
              </font></font></p></th>
            <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                STMT的比率
              </font></font></p></th>
          </tr></thead><tbody><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                mysqlslapd
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                4,5
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                4,1
              </font></font></p></td>
          </tr><tr>
            <td scope="row"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                sysbench的
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                3,4
              </font></font></p></td>
            <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                2,9
              </font></font></p></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组内</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N个</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参与者</font><font style="vertical-align: inherit;">
        之间互连的TCP对等性
         </font><font style="vertical-align: inherit;">使得发送者将相同数量的数据发送</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        次。</font><font style="vertical-align: inherit;">此外，二进制日志可能会呈现出高压缩比（请参见上表）。</font><font style="vertical-align: inherit;">这使压缩成为包含大量事务的工作负载的一个引人注目的功能。
</font></font></p>
<div class="figure">
<a name="idm140528022303648"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图17.15压缩支持</font></font></b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="./images/gr-compress-decompress.png" width="603" height="492" alt="MySQL组复制插件体系结构如前面的主题中所述，其中五层插件位于MySQL服务器和复制组之间。 压缩和解压缩由Group Communication System API处理，这是Group Replication插件的第四层。 组通信引擎（插件的第五层）和组成员使用数据量较小的压缩事务​​。 MySQL服务器核心和Group Replication插件的三个更高层（API，捕获，应用程序和恢复组件以及复制协议模块）使用具有较大数据大小的原始事务。">
</div>

</div>

</div>
<br class="figure-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在数据移交给组通信线程之前，压缩发生在组通信引擎级别，所以它发生在mysql用户会话线程的上下文中。</font><font style="vertical-align: inherit;">事务有效载荷在被发送到组之前可以被压缩，并且在被接收时被解压缩。</font><font style="vertical-align: inherit;">压缩是有条件的，取决于配置的阈值。</font><font style="vertical-align: inherit;">默认情况下压缩已启用。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        另外，并不要求组中的所有服务器都启用了压缩功能才能够一起工作。</font><font style="vertical-align: inherit;">收到消息后，会员检查邮件信封以验证其是否被压缩。</font><font style="vertical-align: inherit;">如果需要，那么会员在交付给上层之前解压缩交易。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用的压缩算法是LZ4。</font><font style="vertical-align: inherit;">压缩在默认情况下启用，阈值为1000000字节。</font><font style="vertical-align: inherit;">压缩阈值（以字节为单位）可以设置为大于默认值的值。</font><font style="vertical-align: inherit;">在这种情况下，只有有效载荷大于阈值的事务才会被压缩。</font><font style="vertical-align: inherit;">以下是如何设置压缩阈值的示例。
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STOP GROUP_REPLICATION;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SET GLOBAL group_replication_compression_threshold = 2097152;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
START GROUP_REPLICATION;</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这将压缩阈值设置为2MB。</font><font style="vertical-align: inherit;">如果事务生成的有效负载大于2MB的复制消息（例如大于2MB的二进制日志事务条目），则会进行压缩。</font><font style="vertical-align: inherit;">将压缩设置阈值禁用为0。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="group-replication-flow-control"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7.3流量控制</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        组复制可确保事务仅在组中的大多数成员收到后才提交，并且同意所有同时发送的事务之间的相对顺序。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果写入组的总数量不超过组中任何成员的写入容量，则此方法运行良好。</font><font style="vertical-align: inherit;">如果这样做，并且其中一些成员的写入吞吐量低于其他成员，特别是小于作者成员，则这些成员可能开始落后于作者。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        让一些成员滞后于团队会带来一些有问题的后果，特别是对这些成员的阅读可能会使很旧的数据具体化。</font><font style="vertical-align: inherit;">根据成员落后的原因，组中的其他成员可能不得不保存更多或更少的复制上下文，以便能够满足来自慢速成员的潜在数据传输请求。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        但是，在复制协议中有一种机制，可以避免在快速和慢速成员之间的应用交易方面有太多距离。</font><font style="vertical-align: inherit;">这被称为流量控制机制。</font><font style="vertical-align: inherit;">它试图解决几个目标：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            以保持成员足够接近，使成员之间的缓冲和解除同步一个小问题;
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            快速适应不断变化的条件，比如不同的工作负载或更多的作者;
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            给每个成员公平分享可用的写入能力;
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            不要为了避免浪费资源而降低吞吐量。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        鉴于集团复制，决定是否扼杀与否可以决定考虑到两项工作队列的设计：</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（I）</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的
         </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">认证</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">队列;
        </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ⅱ）</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和二进制日志
         </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">施放</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">队列。</font><font style="vertical-align: inherit;">只要其中一个队列的大小超过用户定义的阈值，就会触发调节机制。</font><font style="vertical-align: inherit;">只配置:( </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一）</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        是否在验证者或申请者一级进行流量控制; </font><font style="vertical-align: inherit;">和</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ii）</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个队列的阈值是多少。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        流量控制取决于两个基本机制：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            监督成员收集所有组成员的吞吐量和队列大小的一些统计数据，以便学习猜测每个成员应该承受的最大写入压力是什么;
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在每个时刻试图超出其可用容量公平份额的成员的限制。
</font></font></p></li></ol>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="group-replication-probes-and-statistics"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7.3.1探测和统计</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          监控机制通过让每个成员部署一组探测器来收集有关其工作队列和吞吐量的信息。</font><font style="vertical-align: inherit;">然后，它会定期将该信息传播给该组，以便与其他成员共享该数据。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些探测器分散在整个插件堆栈中，并允许建立度量标准，例如：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              验证者队列大小;
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              复制应用程序队列大小;
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              交易认证的总数;
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              成员中应用的远程交易总数;
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              本地交易总数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一旦成员收到来自另一成员的统计信息，它会计算出关于在上一个监控期内有多少交易被认证，应用和本地执行的额外指标。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          监测数据将定期与小组中的其他人员共享。</font><font style="vertical-align: inherit;">监控周期必须足够高，以便其他成员可以决定当前的写入请求，但是足够低以至于对组带宽的影响最小。</font><font style="vertical-align: inherit;">这些信息每秒钟都会共享一次，这段时间足以解决这两个问题。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="group-replication-throttling"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.9.7.3.2组复制限制</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          根据群组中所有服务器收集的指标，节流机制会启动并决定是否限制成员能够执行/提交新交易的比率。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          因此，从所有成员获取的指标是计算每个成员的能力的基础：如果成员队列较大（对于认证或应用程序线程），则执行新交易的能力应接近经过认证或应用的能力最后一个时期。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          组中所有成员的最低容量决定了组的实际容量，而本地交易的数量决定了有多少成员正在写信给它，因此，有多少成员应该分享这些可用容量。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这意味着每个成员都有基于可用容量的既定写入配额，换句话说，它可以在下一个时期安全地发布一些交易。</font><font style="vertical-align: inherit;">如果验证者或二进制日志应用程序的队列大小超过用户定义的阈值，那么作者配额将由限制机制执行。

          
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          配额减少了上一期延迟的交易数量，然后再减少10％，以允许触发问题的队列缩小其大小。</font><font style="vertical-align: inherit;">为了避免队列大小超过阈值时的吞吐量大幅增加，此后的吞吐量只允许每个周期增长10％。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当前的限制机制不会惩罚低于配额的交易，但会延迟完成那些超过监控期限的交易。</font><font style="vertical-align: inherit;">因此，如果发出的写请求的配额非常小，则某些事务可能会有延迟接近监控时段。
</font></font></p>
</div>

</div>

</div>

</div>

</div>
<div class="copyright-footer">

</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tbody><tr>
<td width="40%" align="left"><a accesskey="p" href="/mysql-5.7-google-zh/replication.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a></td>
<td width="20%" align="center"><a accesskey="u" href="/mysql-5.7-google-zh/group-replication.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向上</font></font></a></td>
<td width="40%" align="right">&nbsp;<a accesskey="n" href="/mysql-5.7-google-zh/mysql-shell.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个</font></font></a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第16章复制</font></font></td>
<td width="20%" align="center"><a accesskey="h" href="/mysql-5.7-google-zh/index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">家</font></font></a></td>
<td width="40%" align="right" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第18章MySQL Shell用户指南</font></font></td>
</tr>
</tbody></table>
</div><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./images/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>


<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>