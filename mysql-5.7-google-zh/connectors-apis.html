<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>第27章连接器和API</title>
<link rel="stylesheet" href="./images/mvl.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2">
<link rel="start" href="/mysql-5.7-google-zh/index.html" title="{书名}">
<link rel="up" href="/mysql-5.7-google-zh/connectors-apis.html" title="">
<link rel="prev" href="/mysql-5.7-google-zh/sys-schema.html" title="第26章MySQL sys模式">
<link rel="next" href="/mysql-5.7-google-zh/extending-mysql.html" title="第28章扩展MySQL">
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./images/translateelement.css"></head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tbody><tr>
<th colspan="3" align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27章连接器和API</font></font></th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="/mysql-5.7-google-zh/sys-schema.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a>&nbsp;</td>
<th width="60%" align="center"></th>
<td width="20%" align="right">&nbsp;<a accesskey="n" href="/mysql-5.7-google-zh/extending-mysql.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个</font></font></a></td>
</tr>
</tbody></table>
<hr>
</div>
<div class="chapter">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="connectors-apis"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27章连接器和API</font></font></h1>

</div>

</div>

</div>
<div class="toc">
<p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录</font></font></b></p><dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#connector-c-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.1 MySQL连接器/ C</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#connector-cpp-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.2 MySQL Connector / C ++</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#connector-j-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.3 MySQL连接器/ J</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#connector-net-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.4 MySQL Connector / Net</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#connector-odbc-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.5 MySQL连接器/ ODBC</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#connector-python-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.6 MySQL连接器/ Python</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7 libmysqld，嵌入式MySQL服务器库</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld-compiling"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.1用libmysqld编译程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.2使用嵌入式MySQL服务器时的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld-options"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.3嵌入式服务器的选项</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld-example"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.4嵌入式服务器示例</font></font></a></span></dt></dl></dd><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8 MySQL C API</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-implementations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.1 MySQL C API实现</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-installations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.2同时安装MySQL服务器和连接器/ C</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-example-programs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.3示例C API客户端程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-building-running-clients"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4构建和运行C API客户端程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-data-structures"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.5 C API数据结构</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-function-overview"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.6 C API函数概述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7 C API函数描述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.8 C API准备的语句</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.9 C API编写的语句数据结构</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-function-overview"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.10 C API准备语句函数概述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11 C API准备语句函数说明</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-thread-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12 C API线程化函数描述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-embedded-server-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.13 C API嵌入式服务器功能描述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-plugin-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14 C API客户端插件功能</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-encrypted-connections"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.15 C API加密连接支持</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-queries"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.16 C API多语句执行支持</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-date-handling"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.17 C API预处理日期和时间值的语句处理</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-call-statements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.18 C API编写的CALL语句支持</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-problems"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.19 C API准备声明问题</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-auto-reconnect"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.20 C API自动重新连接控制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-common-issues"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.21 C API常见问题</font></font></a></span></dt></dl></dd><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-php-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.9 MySQL PHP API</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-perl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.10 MySQL Perl API</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-python"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.11 MySQL Python API</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-ruby"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.12 MySQL Ruby API</font></font></a></span></dt><dd><dl><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-ruby-mysqlruby"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.12.1 MySQL / Ruby API</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-ruby-rubymysql"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.12.2 Ruby / MySQL API</font></font></a></span></dt></dl></dd><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-tcl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.13 MySQL Tcl API</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-eiffel"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.14 MySQL埃菲尔包装</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140527963016416"></a><a class="indexterm" name="idm140527963015344"></a><a class="indexterm" name="idm140527963014272"></a><a class="indexterm" name="idm140527963013200"></a><a class="indexterm" name="idm140527963012128"></a><a class="indexterm" name="idm140527963011056"></a><a class="indexterm" name="idm140527963009984"></a><a class="indexterm" name="idm140527963008912"></a><a class="indexterm" name="idm140527963007840"></a><a class="indexterm" name="idm140527963006768"></a><a class="indexterm" name="idm140527963005696"></a><a class="indexterm" name="idm140527963004624"></a><a class="indexterm" name="idm140527963003552"></a><a class="indexterm" name="idm140527963002480"></a><a class="indexterm" name="idm140527963000992"></a><a class="indexterm" name="idm140527962999504"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL连接器为客户端程序提供到MySQL服务器的连接。</font><font style="vertical-align: inherit;">API提供对MySQL协议和MySQL资源的低级访问。</font><font style="vertical-align: inherit;">连接器和API都可以连接和执行来自其他语言或环境的MySQL语句，包括ODBC，Java（JDBC），Perl，Python，PHP，Ruby，本机C和嵌入式MySQL实例。
</font></font></p>
<h2><a name="idm140527962997216"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Oracle开发了许多连接器：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <a class="ulink" href="http://dev.mysql.com/doc/connector-c/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connector / C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是MySQL Client Library（</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">的独立替代品，</font><font style="vertical-align: inherit;">用于C应用程序。
      </font></font></p></li><li class="listitem"><p>
        <a class="ulink" href="http://dev.mysql.com/doc/connector-cpp/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connector / C ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使C ++应用程序能够连接到MySQL。
      </font></font></p></li><li class="listitem"><p>
        <a class="ulink" href="http://dev.mysql.com/doc/connector-j/5.1/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connector / J</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为使用标准Java数据库连接（JDBC）API从Java应用程序连接到MySQL提供驱动程序支持。
      </font></font></p></li><li class="listitem"><p>
        <a class="ulink" href="http://dev.mysql.com/doc/connector-net/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connector / Net</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使开发人员能够创建连接到MySQL的.NET应用程序。</font><font style="vertical-align: inherit;">Connector / Net实现了一个功能齐全的ADO.NET接口，并支持使用ADO.NET感知工具。</font><font style="vertical-align: inherit;">使用Connector / Net的应用程序可以用任何受支持的.NET语言编写。
      </font></font></p><p>
        <a class="ulink" href="http://dev.mysql.com/doc/visual-studio/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适用于Visual Studio的MySQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适用于Connector / Net和Microsoft Visual Studio 2012,2013,2015和2017.Visual Studio的MySQL提供了从Visual Studio访问MySQL对象和数据的功能。</font><font style="vertical-align: inherit;">作为Visual Studio软件包，它直接集成到服务器资源管理器中，可以创建新的连接并使用MySQL数据库对象。
      </font></font></p></li><li class="listitem"><p>
        <a class="ulink" href="http://dev.mysql.com/doc/connector-odbc/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connector / ODBC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为使用开放数据库连接（ODBC）API连接到MySQL提供驱动程序支持。</font><font style="vertical-align: inherit;">支持来自Windows，Unix和OS X平台的ODBC连接。
      </font></font></p></li><li class="listitem"><p>
        <a class="ulink" href="http://dev.mysql.com/doc/connector-python/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/ Python</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
        为使用符合</font></font><a class="ulink" href="http://www.python.org/dev/peps/pep-0249/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python DB API 2.0版</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的API从Python应用程序连接到MySQL提供驱动程序支持
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">不需要额外的Python模块或MySQL客户端库。
</font></font></p></li></ul>
</div>
<h2><a name="idm140527962982624"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL C API</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    要直接访问在C应用程序中本地使用MySQL，有两种方法：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        的</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#c-api" title="27.8 MySQL C API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供通过低级别的访问到MySQL客户/服务器协议
         </font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的客户端库。</font><font style="vertical-align: inherit;">这是用于连接到MySQL服务器实例的主要方法，并且由MySQL命令行客户端以及许多MySQL连接器和第三方API使用。
      </font></font></p><p>
        <code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 包含在MySQL发行版和Connector / C发行版中。
      </font></font></p></li><li class="listitem"><p>
        <code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 是一个嵌入式MySQL服务器库，使您能够将MySQL服务器的实例嵌入到C应用程序中。
      </font></font></p><p>
        <code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 包含在MySQL发行版中，但不包含在连接器/ C发行版中。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所述</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库被弃用的MySQL 19年5月7日的，并且将在MySQL 8.0被移除。
</font></font></p>
</div>
</li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    另请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-implementations" title="27.8.1 MySQL C API实现"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.1节“MySQL C API实现”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    要从C应用程序访问MySQL，或者为本章中的连接器或API不支持的语言构建MySQL接口，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#c-api" title="27.8 MySQL C API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">就是从哪里开始的。</font><font style="vertical-align: inherit;">许多程序员的实用程序可用于帮助完成此过程; </font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#programs-development" title="4.7 MySQL程序开发实用程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.7节“MySQL程序开发实用程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<h2><a name="idm140527962969312"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第三方MySQL API</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    本章介绍的其余API提供了从特定应用程序语言到MySQL的接口。</font><font style="vertical-align: inherit;">这些第三方解决方案不是由Oracle开发或支持的。</font><font style="vertical-align: inherit;">这里仅提供有关其使用和功能的基本信息，仅供参考。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    所有第三方语言API都是使用两种方法之一开发的，使用</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或通过实现</font></font><span class="firstterm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本地驱动程序</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这两种解决方案具有不同的优点
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        使用</font></font><span class="emphasis"><em><code class="literal">libmysqlclient</code></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        提供与MySQL的完全兼容性，因为它使用与MySQL客户端应用程序相同的库。</font><font style="vertical-align: inherit;">但是，功能集仅限于实现和接口公开，</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且由于在本机语言和MySQL API组件之间复制数据，性能可能会降低。
      </font></font></p></li><li class="listitem"><p>
        <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本地驱动程序</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是完全在主机语言或环境中的MySQL网络协议的实现。</font><font style="vertical-align: inherit;">本机驱动程序速度很快，因为组件之间的数据复制较少，并且它们可以提供通过标准MySQL API无法提供的高级功能。</font><font style="vertical-align: inherit;">本地驱动程序对于最终用户来说也更容易构建和部署，因为不需要复制MySQL客户端库就可以构建本地驱动程序组件。
</font></font></p></li></ul>
</div>
<p>
    <a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#connectors-apis-summary" title="表27.1 MySQL API和接口"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表27.1“MySQL API和接口”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列出了许多可用于MySQL的库和接口。

</font></font></p>
<div class="table">
<a name="connectors-apis-summary"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表27.1 MySQL API和接口</font></font></b></p>
<div class="table-contents">
<table summary="Summary of MySQL APIs and interfaces showing the environment, API, type, and related notes."><colgroup><col width="10%"><col width="35%"><col width="15%"><col width="40%"></colgroup><thead><tr>
      <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境</font></font></th>
      <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API</font></font></th>
      <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></th>
      <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">笔记</font></font></th>
    </tr></thead><tbody><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阿达</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GNU Ada MySQL绑定</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://gnade.sourceforge.net/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GNU Ada的MySQL绑定</font></font></a></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C API</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api" title="27.8 MySQL C API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8节“MySQL C API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/ C</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替代 </font></font><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-c/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ C开发人员指南</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/ C ++</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-cpp/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ C ++开发人员指南</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的++</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://tangentsoft.net/mysql++/doc/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL ++网站</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL包装</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看</font></font><a class="ulink" href="http://www.alhem.net/project/mysql/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL包装</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可可</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的，可可</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与Objective-C Cocoa环境兼容。</font><font style="vertical-align: inherit;">请参阅
         </font></font><a class="ulink" href="http://mysql-cocoa.sourceforge.net/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://mysql-cocoa.sourceforge.net/</font></font></a></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL for D</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">见</font></font><a class="ulink" href="http://www.steinmole.de/d/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的d</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">艾菲尔</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">埃菲尔MySQL</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#apis-eiffel" title="27.14 MySQL埃菲尔包装"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.14节“MySQL Eiffel Wrapper”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二郎神</font></font></td>
      <td><code class="literal">erlang-mysql-driver</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看
         </font></font><a class="ulink" href="http://code.google.com/p/erlang-mysql-driver/" target="_top"><code class="literal">erlang-mysql-driver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">哈斯克尔</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haskell MySQL绑定</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本机驱动</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://www.serpentine.com/blog/software/mysql/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brian O'Sullivan的纯Haskell MySQL绑定</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"></td>
      <td><code class="literal">hsql-mysql</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看
         </font></font><a class="ulink" href="http://hackage.haskell.org/cgi-bin/hackage-scripts/package/hsql-mysql-1.7" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haskell的MySQL驱动程序</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的Java / JDBC</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/ J</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本机驱动</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-j/5.1/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / J 5.1开发人员指南</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">卡亚</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYDB</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看</font></font><a class="ulink" href="http://kayalang.org/library/latest/MyDB" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MyDB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LUA</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LuaSQL</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参见
         </font></font><a class="ulink" href="http://keplerproject.github.io/luasql/doc/us/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LuaSQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.NET /单声道</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/净</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本机驱动</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-net/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / Net开发人员指南</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目标Caml</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目标Caml MySQL绑定</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://raevnos.pennmush.org/code/ocaml-mysql/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Objective Caml的MySQL绑定</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">八度</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GNU Octave的数据库绑定</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅
         </font></font><a class="ulink" href="http://octave.sourceforge.net/database/index.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GNU Octave的数据库绑定</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ODBC</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/ ODBC</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-odbc/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ ODBC开发人员指南</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perl的</font></font></td>
      <td><code class="literal">DBI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/</font></font><code class="literal">DBD::mysql</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#apis-perl" title="27.10 MySQL Perl API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.10节“MySQL Perl API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"></td>
      <td><code class="literal">Net::MySQL</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本机驱动</font></font></td>
      <td><font style="vertical-align: inherit;"></font><a class="ulink" href="http://search.cpan.org/dist/Net-MySQL/MySQL.pm" target="_top"><code class="literal">Net::MySQL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在CPAN </font><font style="vertical-align: inherit;">见
        </font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP</font></font></td>
      <td><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">ext/mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">界面（不推荐）</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看</font></font><a class="ulink" href="http://dev.mysql.com/doc/apis-php/en/apis-php-mysql.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原始MySQL API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"></td>
      <td><code class="literal">mysqli</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">ext/mysqli</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">界面</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/apis-php/en/apis-php-mysqli.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL改进的扩展</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"></td>
      <td><code class="literal">PDO_MYSQL</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/apis-php/en/apis-php-pdo-mysql.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL函数（PDO_MYSQL）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDO mysqlnd</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本机驱动</font></font></td>
      <td></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蟒蛇</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/ Python的</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本机驱动</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-python/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ Python开发人员指南</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蟒蛇</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器/ Python C扩展</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-python/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ Python开发人员指南</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQLdb的</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#apis-python" title="27.11 MySQL Python API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.11节“MySQL Python API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">红宝石</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的/红宝石</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用途</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#apis-ruby-mysqlruby" title="27.12.1 MySQL / Ruby API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.12.1节“MySQL / Ruby API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">红宝石/ MySQL的</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本机驱动</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#apis-ruby-rubymysql" title="27.12.2 Ruby / MySQL API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.12.2节“Ruby / MySQL API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方案</font></font></td>
      <td><code class="literal">Myscsh</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看
         </font></font><a class="ulink" href="https://github.com/aehrisch/myscsh" target="_top"><code class="literal">Myscsh</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPL</font></font></td>
      <td><code class="literal">sql_mysql</code></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参阅
         </font></font><a class="ulink" href="http://www.clifford.at/spl/spldoc/sql_mysql.html" target="_top"><code class="literal">sql_mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        SPL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
    </tr><tr>
      <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCL</font></font></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的MySQLTcl</font></font></td>
      <td><code class="literal">libmysqlclient</code></td>
      <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#apis-tcl" title="27.13 MySQL Tcl API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.13节“MySQL Tcl API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break">
<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-c-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.1 MySQL连接器/ C</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962768864"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL Connector / C手册以独立形式发布，不作为MySQL参考手册的一部分。</font><font style="vertical-align: inherit;">有关信息，请参阅这些文档：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        主要手册：</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-c/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ C开发人员指南</font></font></a>
      </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        发行说明：
         </font></font><a class="ulink" href="http://dev.mysql.com/doc/relnotes/connector-c/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / C发行说明</font></font></a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-cpp-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.2 MySQL Connector / C ++</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962762256"></a><a class="indexterm" name="idm140527962761216"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL Connector / C ++手册以独立形式发布，而不是MySQL参考手册的一部分。</font><font style="vertical-align: inherit;">有关信息，请参阅这些文档：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        主要手册：</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-cpp/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ C ++开发人员指南</font></font></a>
      </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        发行说明：
         </font></font><a class="ulink" href="http://dev.mysql.com/doc/relnotes/connector-cpp/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / C ++发行说明</font></font></a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-j-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.3 MySQL连接器/ J</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962754592"></a><a class="indexterm" name="idm140527962753552"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL Connector / J手册以独立形式发布，不作为MySQL参考手册的一部分。</font><font style="vertical-align: inherit;">有关信息，请参阅这些文档：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        主要手册：</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-j/5.1/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / J 5.1开发人员指南</font></font></a>
      </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        发行说明：
         </font></font><a class="ulink" href="http://dev.mysql.com/doc/relnotes/connector-j/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / J发行说明</font></font></a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-net-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.4 MySQL Connector / Net</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962746848"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL Connector / Net手册以独立形式发布，而不是MySQL参考手册的一部分。</font><font style="vertical-align: inherit;">有关信息，请参阅这些文档：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        主要手册：</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-net/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / Net开发者指南</font></font></a>
      </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        发行说明：
         </font></font><a class="ulink" href="http://dev.mysql.com/doc/relnotes/connector-net/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / Net发行说明</font></font></a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-odbc-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.5 MySQL连接器/ ODBC</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962740208"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL Connector / ODBC手册以独立形式发布，不作为MySQL参考手册的一部分。</font><font style="vertical-align: inherit;">有关信息，请参阅这些文档：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        主要手册：</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-odbc/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ ODBC开发人员指南</font></font></a>
      </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        发行说明：
         </font></font><a class="ulink" href="http://dev.mysql.com/doc/relnotes/connector-odbc/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ ODBC发行说明</font></font></a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="connector-python-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.6 MySQL连接器/ Python</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962733568"></a><a class="indexterm" name="idm140527962732528"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL Connector / Python手册以独立形式发布，而不是MySQL参考手册的一部分。</font><font style="vertical-align: inherit;">有关信息，请参阅这些文档：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        主要手册：</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-python/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ Python开发者指南</font></font></a>
      </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        发行说明：
         </font></font><a class="ulink" href="http://dev.mysql.com/doc/relnotes/connector-python/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / Python发行说明</font></font></a>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="libmysqld"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7 libmysqld，嵌入式MySQL服务器库</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld-compiling"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.1用libmysqld编译程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld-restrictions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.2使用嵌入式MySQL服务器时的限制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld-options"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.3嵌入式服务器的选项</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld-example"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.4嵌入式服务器示例</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140527962726128"></a><a class="indexterm" name="idm140527962725088"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    嵌入式MySQL服务器库可以在客户端应用程序中运行全功能的MySQL服务器。</font><font style="vertical-align: inherit;">主要优点是提高了嵌入式应用程序的速度并简化了管理。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      所述</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库被弃用的MySQL 19年5月7日的，并且将在MySQL 8.0被移除。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    嵌入式服务器库基于用C / C ++编写的MySQL客户端/服务器版本。</font><font style="vertical-align: inherit;">因此，嵌入式服务器也是用C / C ++编写的。</font><font style="vertical-align: inherit;">没有其他语言的嵌入式服务器可用。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    该API对于嵌入式MySQL版本和客户端/服务器版本是相同的。</font><font style="vertical-align: inherit;">要更改线程应用程序以使用嵌入式库，通常只需将呼叫添加到以下功能。
</font></font></p>
<div class="table">
<a name="refman-apis-libmysqld-mysql-server-library-embeded-functions"></a><p class="title"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表27.2 MySQL嵌入式服务器库函数</font></font></b></p>
<div class="table-contents">
<table summary="MySQL embedded server library functions and descriptions of when the functions should be called."><colgroup><col width="30%"><col width="70%"></colgroup><thead><tr>
        <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            功能
          </font></font></p></th>
        <th scope="col"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            何时打电话
          </font></font></p></th>
      </tr></thead><tbody><tr>
        <td scope="row"><p>
            <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a>
          </p></td>
        <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在调用任何其他MySQL函数之前调用它，最好在</font></font><code class="literal">main()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数的</font><font style="vertical-align: inherit;">早期调用它</font><font style="vertical-align: inherit;">。
          </font></font></p></td>
      </tr><tr>
        <td scope="row"><p>
            <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a>
          </p></td>
        <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在程序退出之前调用它。
          </font></font></p></td>
      </tr><tr>
        <td scope="row"><p>
            <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a>
          </p></td>
        <td><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在您创建的访问MySQL的每个线程中调用它。
          </font></font></p></td>
      </tr><tr>
        <td scope="row"><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-end" title="27.8.12.2 mysql_thread_end（）"><code class="literal">mysql_thread_end()</code></a></td>
        <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在打电话之前调用它</font></font><code class="literal">pthread_exit()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
</tr></tbody></table>
</div>

</div>
<br class="table-break"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    然后，</font></font><code class="filename">libmysqld.a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代替</font><font style="vertical-align: inherit;">链接您的代码</font></font><code class="filename">libmysqlclient.a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">为确保应用程序和服务器库之间的二进制兼容性，请始终针对用于编译服务器库的同一系列MySQL的头文件来编译应用程序。</font><font style="vertical-align: inherit;">例如，如果</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">针对MySQL 5.6头进行编译，请不要针对MySQL 5.7头编译应用程序，反之亦然。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    由于这些
     </font><font style="vertical-align: inherit;">
    功能也包含在内
     </font><font style="vertical-align: inherit;">，因此只需将应用程序与正确的库链接即可在嵌入式和客户端/服务器版本之间进行切换。</font><font style="vertical-align: inherit;">请参见
     </font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><font style="vertical-align: inherit;">第27.8.7.41节“mysql_library_init（）”</font></a><font style="vertical-align: inherit;">。
  </font></font><code class="literal">mysql_library_<em class="replaceable"><code>xxx</code></em>()</code><font style="vertical-align: inherit;"></font><code class="filename">libmysqlclient.a</code><font style="vertical-align: inherit;"></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    嵌入式服务器和独立服务器之间的一个区别是，对于嵌入式服务器，缺省情况下，连接的身份验证处于禁用状态。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="libmysqld-compiling"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.1用libmysqld编译程序</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在包含</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库的</font><font style="vertical-align: inherit;">预编译二进制MySQL发行版中
       </font><font style="vertical-align: inherit;">，MySQL使用适当的供应商编译器（如果有）编译该库。
    </font></font></p><p><font style="vertical-align: inherit;"></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果你自己从源代码创建MySQL，</font><font style="vertical-align: inherit;">
      要获得一个</font><font style="vertical-align: inherit;">库，你应该使用该</font></font><a class="link" href="/mysql-5.7-google-zh/installing.html#option_cmake_with_embedded_server"><code class="option">-DWITH_EMBEDDED_SERVER=1</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">配置MySQL
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/installing.html#source-configuration-options" title="2.9.4 MySQL源配置选项"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.9.4节“MySQL源配置选项”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      当你连接你的程序时</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，你还必须包含系统特定的</font></font><code class="literal">pthread</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      库和MySQL服务器使用的一些库。</font><font style="vertical-align: inherit;">您可以通过执行</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config --libmysqld-libs</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来获得完整的库列表</font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      即使您没有直接调用代码中的任何线程函数，也必须使用编译和链接线程程序的正确标志。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要编译C程序以包含必要的文件以将MySQL服务器库嵌入到程序的可执行版本中，编译器需要知道在哪里可以找到各种文件，并且需要有关如何编译程序的说明。</font><font style="vertical-align: inherit;">下面的例子展示了如何从命令行编译一个程序，假设你正在使用</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，使用GNU C编译器：
    </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc mysql_test.c -o mysql_test \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
`/ usr / local / mysql / bin / mysql_config --include --libmysqld-libs`</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      紧跟在</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令之后的是C程序源文件的名称。</font><font style="vertical-align: inherit;">在此之后，该
       </font></font><code class="option">-o</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项被用来指示下面的文件名称是编译器要给输出文件编译的程序的名称。</font><font style="vertical-align: inherit;">下一行代码告诉编译器获取包含它的系统的包含文件和库以及其他设置的位置。</font><font style="vertical-align: inherit;">该
       </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令包含在反引号，不是单引号。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在一些非</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平台上，嵌入式库依赖于C ++运行时库，并且与嵌入式库链接可能会导致丢失符号错误。</font><font style="vertical-align: inherit;">要解决此问题，请使用C ++编译器进行链接，或在链接命令行上明确列出所需的库。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="libmysqld-restrictions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.2使用嵌入式MySQL服务器时的限制</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      嵌入式服务器具有以下限制：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有用户定义的函数（UDF）。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          核心转储上没有堆栈跟踪。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您不能将其设置为主设备或从设备（不复制）。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在低内存系统上，非常大的结果集可能无法使用。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您无法使用套接字或TCP / IP从外部进程连接到嵌入式服务器。</font><font style="vertical-align: inherit;">但是，您可以连接到中间应用程序，而中间应用程序又可以代表远程客户端或外部进程连接到嵌入式服务器。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在嵌入式服务器中不可重入，并且不能连续或同时用于多个连接。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          事件调度程序不可用。</font><font style="vertical-align: inherit;">因此，
           </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_event_scheduler"><code class="literal">event_scheduler</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量被禁用。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          性能模式不可用。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          嵌入式服务器不能</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与另一台服务器</font><font style="vertical-align: inherit;">共享相同的
           </font><font style="vertical-align: inherit;">目录。</font><font style="vertical-align: inherit;">从MySQL 5.7.8开始，此目录的默认值可以在构建时使用</font><span class="command"><strong><font style="vertical-align: inherit;">CMake</font></strong></span><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">进行设置
           </font><font style="vertical-align: inherit;">。
</font></font><a class="link" href="/mysql-5.7-google-zh/installing.html#option_cmake_install_secure_file_priv_embeddeddir"><code class="option">INSTALL_SECURE_FILE_PRIV_EMBEDDEDDIR</code></a>
          <span class="command"><strong><font style="vertical-align: inherit;"></font></strong></span><font style="vertical-align: inherit;"></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      其中一些限制可以通过编辑</font></font><code class="filename">mysql_embed.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含文件并重新编译MySQL </font><font style="vertical-align: inherit;">来改变
       </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="libmysqld-options"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.3嵌入式服务器的选项</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962656256"></a><a class="indexterm" name="idm140527962654800"></a><a class="indexterm" name="idm140527962653312"></a><a class="indexterm" name="idm140527962651824"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      可以使用</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqld</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
      服务器守护进程</font><font style="vertical-align: inherit;">提供的任何选项都可以</font><font style="vertical-align: inherit;">与嵌入式服务器库一起使用。</font><font style="vertical-align: inherit;">服务器选项可以在数组中作为</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初始化服务器</font><font style="vertical-align: inherit;">的参数给出
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">他们也可能在一个选项文件中给出</font></font><code class="filename">my.cnf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要为C程序指定选项文件，请使用该</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#option_general_defaults-file"><code class="option">--defaults-file</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      选项作为</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">的第二个参数的其中一个元素
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">该</font><font style="vertical-align: inherit;">函数的</font><font style="vertical-align: inherit;">更多信息，
       </font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.41节“mysql_library_init（）”</font></font></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用选项文件可以更轻松地在客户端/服务器应用程序和嵌入MySQL的应用程序之间切换。</font><font style="vertical-align: inherit;">在该</font></font><code class="literal">[server]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组</font><font style="vertical-align: inherit;">下设置通用选项</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些都由MySQL版本读取。</font><font style="vertical-align: inherit;">客户端/服务器特定的选项应该放在该</font></font><code class="literal">[mysqld]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分下。</font><font style="vertical-align: inherit;">在该</font></font><code class="literal">[embedded]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分中添加</font><font style="vertical-align: inherit;">特定于嵌入式MySQL服务器库的选项
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">特定于应用程序的选项在标有章节的部分
       </font></font><code class="literal">[ApplicationName_SERVER]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#option-files" title="4.2.6使用选项文件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.2.6节“使用选项文件”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="libmysqld-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.7.4嵌入式服务器示例</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这两个示例程序应该在Linux或FreeBSD系统上不做任何更改。</font><font style="vertical-align: inherit;">对于其他操作系统，需要进行较小的更改，主要是使用文件路径。</font><font style="vertical-align: inherit;">这些示例旨在提供足够的详细信息，以便您了解问题，而不会出现实际应用程序必不可少的混乱因素。</font><font style="vertical-align: inherit;">第一个例子非常简单。</font><font style="vertical-align: inherit;">第二个例子是一些更高级的错误检查。</font><font style="vertical-align: inherit;">第一个之后是一个用于编译程序的命令行条目。</font><font style="vertical-align: inherit;">第二个是后面跟着一个GNUmake文件，它可以用来编译。
    </font></font></p><p>
      <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例1</font></font></strong></span>
    </p><p>
      <code class="filename">test1_libmysqld.c</code>
    </p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include &lt;stdio.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;stdlib.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;stdarg.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include“mysql.h”</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL * mysql;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_RES *结果;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_ROW记录;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静态字符* server_options [] = \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
       {“mysql_test”，“--defaults-file = my.cnf”，NULL};</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int num_elements =（sizeof（server_options）/ sizeof（char *）） -  1;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
static char * server_groups [] = {“libmysqld_server”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                 “libmysqld_client”，NULL};</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int main（void）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   mysql_library_init（num_elements，server_options，server_groups）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   mysql = mysql_init（NULL）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   mysql_options（mysql，MYSQL_READ_DEFAULT_GROUP，“libmysqld_client”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   mysql_options（mysql，MYSQL_OPT_USE_EMBEDDED_CONNECTION，NULL）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   mysql_real_connect（mysql，NULL，NULL，NULL，“database1”，0，NULL，0）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   mysql_query（mysql，“SELECT column1，column2 FROM table1”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   results = mysql_store_result（mysql）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   while（（record = mysql_fetch_row（results）））{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“％s  - ％s \ n”，记录[0]，记录[1]）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   了mysql_free_result（结果）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   mysql_close（MySQL的）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   mysql_library_end（）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   返回0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这里是编译上述程序的命令行：
    </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc test1_libmysqld.c -o test1_libmysqld \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 `/ usr / local / mysql / bin / mysql_config --include --libmysqld-libs`</font></font><font></font>
</pre><p>
      <span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例2</font></font></strong></span>
    </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要尝试该示例，请</font></font><code class="filename">test2_libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在与MySQL源目录相同的级别</font><font style="vertical-align: inherit;">创建一个</font><font style="vertical-align: inherit;">目录。</font><font style="vertical-align: inherit;">保存</font></font><code class="filename">test2_libmysqld.c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">源文件和
       </font></font><code class="filename">GNUmakefile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录，并</font></font><code class="filename">make</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从
       </font></font><code class="filename">test2_libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录中</font><font style="vertical-align: inherit;">运行GNU
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p>
      <code class="filename">test2_libmysqld.c</code>
    </p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ *</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 *一个简单的示例客户端，使用嵌入式MySQL服务器库</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;mysql.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;stdarg.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;stdio.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;stdlib.h&gt;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL * db_connect（const char * dbname）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
void db_disconnect（MYSQL * db）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
void db_do_query（MYSQL * db，const char * query）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
const char * server_groups [] = {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “test2_libmysqld_SERVER”，“嵌入”，“服务器”，NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
};</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INT</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
main（int argc，char ** argv）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL * one，* two;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *必须在任何其他mysql之前调用mysql_library_init（）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   * 功能。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *你可以使用mysql_library_init（0，NULL，NULL）和它</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *使用组初始化服务器= {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *“服务器”，“嵌入”，NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *}。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *在您的$ HOME / .my.cnf文件中，您可能想要放置：</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[test2_libmysqld_SERVER]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
language = / path / to / source / of / mysql / sql / share / english</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *当然，你可以在通过之前修改argc和argv</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *他们到这个功能。</font><font style="vertical-align: inherit;">或者你可以在任何时候创建新的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *你喜欢的方式。</font><font style="vertical-align: inherit;">但是在argv中的所有参数（除了</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   * argv [0]，这是程序名）应该是有效的选项</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *为MySQL服务器。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *如果你把这个客户端与普通的mysqlclient连接起来</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *库，这个函数只是一个什么也不做的存根。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_library_init（argc，argv，（char **）server_groups）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  one = db_connect（“test”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  two = db_connect（NULL）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  db_do_query（一个，“SHOW TABLE STATUS”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  db_do_query（两个，“SHOW DATABASES”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_close（二）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_close（之一）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *必须在所有其他mysql函数之后调用* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_library_end（）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（EXIT_SUCCESS）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静态无效</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
死（MYSQL * db，char * fmt，...）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  va_list ap;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  va_start（ap，fmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  vfprintf（stderr，fmt，ap）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  va_end用来（AP）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  （void）putc（'\ n'，stderr）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（db）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    db_disconnect（分贝）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（EXIT_FAILURE）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL *</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
db_connect（const char * dbname）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL * db = mysql_init（NULL）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（！db）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    死（db，“mysql_init失败：无内存”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *请注意，客户端和服务器使用不同的组名。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *这很关键，因为服务器不接受</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   *客户的选择，反之亦然。</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_options（db，MYSQL_READ_DEFAULT_GROUP，“test2_libmysqld_CLIENT”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（！mysql_real_connect（db，NULL，NULL，NULL，dbname，0，NULL，0））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    死（db，“mysql_real_connect失败：％s”，mysql_error（db））;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  返回db;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空虚</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
db_disconnect（MYSQL * db）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_close（分贝）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空虚</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
db_do_query（MYSQL * db，const char *查询）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（mysql_query（db，query）！= 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    转到;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（mysql_field_count（db）&gt; 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MYSQL_RES * res;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MYSQL_ROW row，end_row;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    int num_fields;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    如果（！（res = mysql_store_result（db）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      转到;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    num_fields = mysql_num_fields（res）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    while（（row = mysql_fetch_row（res）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      （void）fputs（“&gt;&gt;”，stdout）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      for（end_row = row + num_fields; row &lt;end_row; ++ row）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        （void）printf（“％s \ t”，row？（char *）* row：“NULL”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      （void）fputc（'\ n'，stdout）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    （void）fputc（'\ n'，stdout）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    了mysql_free_result（RES）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    （void）printf（“受影响的行：％lld \ n”，mysql_affected_rows（db））;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  返回;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
呃：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  （db，“db_do_query失败：％s [％s]”，mysql_error（db），查询）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p>
      <code class="filename">GNUmakefile</code>
    </p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＃这假定MySQL软件安装在/ usr / local / mysql中</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
inc：= / usr / local / mysql / include / mysql</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lib：= / usr / local / mysql / lib</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃如果你还没有安装MySQL软件，那就试试这个</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#inc：= $（HOME）/mqlql-5.7/include</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#lib：= $（HOME）/mysql-5.7/libmysqld</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CC：= gcc</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CPPFLAGS：= -I $（增量）-D_THREAD_SAFE -D_REENTRANT</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CFLAGS：= -g -W -Wall</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LDFLAGS：=  - 静态</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃您可以将-lmysqld更改为-lmysqlclient以使用</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃客户端/服务器库</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LDLIBS = -L $（lib）-lmysqld -lm -ldl -lcrypt</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ifneq（，$（shell grep FreeBSD / COPYRIGHT 2&gt; / dev / null））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃FreeBSD</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LDFLAGS + =  - 线程</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃假设Linux</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LDLIBS + = -lpthread</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
万一</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
＃这适用于简单的单文件测试程序</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
来源：= $（通配符* .c）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对象：= $（patsubst％c，％o，$（sources））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
targets：= $（basename $（sources））</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全部：$（目标）</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
清洁：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        rm -f $（目标）$（对象）* .core</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="c-api"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8 MySQL C API</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-implementations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.1 MySQL C API实现</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-installations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.2同时安装MySQL服务器和连接器/ C</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-example-programs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.3示例C API客户端程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-building-running-clients"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4构建和运行C API客户端程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-data-structures"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.5 C API数据结构</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-function-overview"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.6 C API函数概述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7 C API函数描述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.8 C API准备的语句</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.9 C API编写的语句数据结构</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-function-overview"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.10 C API准备语句函数概述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11 C API准备语句函数说明</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-thread-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12 C API线程化函数描述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-embedded-server-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.13 C API嵌入式服务器功能描述</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-plugin-functions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14 C API客户端插件功能</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-encrypted-connections"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.15 C API加密连接支持</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-queries"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.16 C API多语句执行支持</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-date-handling"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.17 C API预处理日期和时间值的语句处理</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-call-statements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.18 C API编写的CALL语句支持</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-problems"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.19 C API准备声明问题</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-auto-reconnect"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.20 C API自动重新连接控制</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-common-issues"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.21 C API常见问题</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140527962613472"></a><a class="indexterm" name="idm140527962611984"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    C API提供对MySQL客户端/服务器协议的低级访问，并使C程序能够访问数据库内容。</font><font style="vertical-align: inherit;">C API代码随MySQL分发并在</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库中</font><font style="vertical-align: inherit;">实现
     </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
     </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-implementations" title="27.8.1 MySQL C API实现"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.1节“MySQL C API实现”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    大多数其他客户端API使用该</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    库与MySQL服务器进行通信。</font><font style="vertical-align: inherit;">（例外是Connector / J和Connector / Net。）这意味着，例如，您可以利用许多其他客户端程序使用的相同环境变量，因为它们是从库中引用的。</font><font style="vertical-align: inherit;">有关这些变量的列表，请参见
     </font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#programs-overview" title="4.1 MySQL程序概述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.1节“MySQL程序概述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    有关使用C API构建客户端程序的说明，请参见
     </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-building-clients" title="27.8.4.1构建C API客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.4.1节“构建C API客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关线程编程，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-threaded-clients" title="27.8.4.3编写C API线程客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.4.3节“编写C API线程客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要在同一个程序中创建包含“服务器”和“客户端”的独立应用程序（并且不与外部MySQL服务器通信），请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld" title="27.7 libmysqld，嵌入式MySQL服务器库"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.7节“libmysqld，嵌入式MySQL服务器库”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果在升级后遇到编译客户端程序（例如</font></font><code class="literal">Commands out of sync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或意外的核心转储）问题，则可能使用旧的头文件或库文件编译程序。</font><font style="vertical-align: inherit;">在这种情况下，请检查</font><font style="vertical-align: inherit;">用于编译</font><font style="vertical-align: inherit;">的</font></font><code class="filename">mysql.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件和
       </font></font><code class="filename">libmysqlclient.a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库</font><font style="vertical-align: inherit;">的日期，
       </font><font style="vertical-align: inherit;">以确认它们来自新的MySQL分发版。</font><font style="vertical-align: inherit;">如果没有，请用新的头文件和库重新编译程序。</font><font style="vertical-align: inherit;">如果库的主版本号已更改（例如，从纂修可能也有必要对共享客户端库编译的程序
       </font></font><code class="filename">libmysqlclient.so.17</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到
       </font></font><code class="filename">libmysqlclient.so.18</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">有关其他兼容性信息，请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-running-clients" title="27.8.4.4运行C API客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.4.4节“运行C API客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    客户端具有最大的通信缓冲区大小。</font><font style="vertical-align: inherit;">最初分配的缓冲区大小（16KB）会自动增大到最大值（默认情况下为16MB）。</font><font style="vertical-align: inherit;">由于缓冲区大小仅在需求保证时才增加，因此仅增加最大限制本身并不会导致使用更多资源。</font><font style="vertical-align: inherit;">这种大小检查主要是针对错误的语句和通信数据包的预防措施。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    通信缓冲区必须足够大以包含单个SQL语句（用于客户端到服务器的通信）和一行返回的数据（用于服务器到客户端的通信）。</font><font style="vertical-align: inherit;">每个会话的通信缓冲区都会动态放大，以处理任何查询或排到最大限制的行。</font><font style="vertical-align: inherit;">例如，如果您的
     </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值包含高达16MB的数据，则您必须具有至少16MB的通信缓冲区限制（在服务器和客户端中）。</font><font style="vertical-align: inherit;">客户端库中内置的默认最大值为1GB，但服务器中的默认最大值为1MB。</font><font style="vertical-align: inherit;">您可以通过</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在服务器启动时</font><font style="vertical-align: inherit;">更改</font><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">的值来增加此值
     </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/server-administration.html#server-configuration" title="5.1.1配置服务器"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.1节“配置服务器”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL服务器</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_net_buffer_length"><code class="literal">net_buffer_length</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在每次查询后将每个</font><font style="vertical-align: inherit;">通信缓冲区缩小为
     </font><font style="vertical-align: inherit;">字节。</font><font style="vertical-align: inherit;">对于客户端来说，与连接关联的缓冲区的大小在连接关闭之前不会减少，此时客户端内存将被回收。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-implementations"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.1 MySQL C API实现</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL C API是一个基于C的API，用C编写的客户端应用程序可以用来与MySQL服务器通信。</font><font style="vertical-align: inherit;">客户端程序在编译时引用C API头文件，并在链接时链接到C API库文件。</font><font style="vertical-align: inherit;">该库有两个版本，具体取决于应用程序如何与服务器进行通信：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：库的客户端版本，用于通过网络连接进行通信的应用程序，作为独立服务器进程的客户端。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：库的嵌入式服务器版本，用于在应用程序本身中包含嵌入式MySQL服务器的应用程序。</font><font style="vertical-align: inherit;">应用程序与自己的专用服务器实例进行通信。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            所述</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库被弃用的MySQL 19年5月7日的，并且将在MySQL 8.0被移除。
</font></font></p>
</div>
</li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      两个库都有相同的接口。</font><font style="vertical-align: inherit;">就C API调用而言，应用程序与独立服务器进行通信的方式与嵌入式服务器进行通信的方式相同。</font><font style="vertical-align: inherit;">给定客户端可以建立与独立或嵌入式服务器，通信，取决于它是否对链接
       </font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在构建时。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有两种方法可以获得构建C API客户端程序所需的C API头文件和库文件：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          安装一个MySQL服务器分配。</font><font style="vertical-align: inherit;">服务器分配包括</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          安装连接器/ C分配。</font><font style="vertical-align: inherit;">连接器/ C分布仅包括</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">他们不包括
           </font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于MySQL服务器和连接器/ C，您都可以安装包含预先构建的C API文件的二进制发行版，或者您可以使用源代码发行版并自行构建C API文件。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通常，您安装MySQL服务器分配或连接器/ C分配，但不能同时安装。</font><font style="vertical-align: inherit;">有关同步MySQL服务器和连接器/ C安装涉及的问题的信息，请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-installations" title="27.8.2同时安装MySQL服务器和连接器/ C"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.2节“同时安装MySQL服务器和连接器/ C”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      链接C API客户端应用程序时使用的库文件的名称取决于构建发行版的库类型和平台：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在Unix（和类Unix）系统上，静态库是
           </font></font><code class="filename">libmysqlclient.a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">动态库
           </font></font><code class="filename">libmysqlclient.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在大多数Unix系统和</font></font><code class="filename">libmysqlclient.dylib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OS X上。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于包含嵌入式服务器库的分发版，相应的库名称以开始
           </font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是
           </font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在Windows上，静态库
           </font></font><code class="filename">mysqlclient.lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和动态库都是</font></font><code class="filename">libmysql.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Windows发行版还包括</font></font><code class="filename">libmysql.lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用动态库所需的静态导入库。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于包括嵌入式服务器库分布，相应的库名
           </font></font><code class="filename">mysqlserver.lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="filename">libmysqld.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="filename">libmysqld.lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          Windows发行版还包含一组调试库。</font><font style="vertical-align: inherit;">这些名称与nondebug库相同，但位于</font></font><code class="filename">lib/debug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库中。</font><font style="vertical-align: inherit;">编译使用调试C运行时构建的客户端时，必须使用调试库。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在Unix上，您可能还会看到</font></font><code class="literal">_r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名称</font><font style="vertical-align: inherit;">中包含的库
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在MySQL 5.5之前，这些被构建为与非</font></font><code class="literal">_r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库</font><font style="vertical-align: inherit;">无关的线程安全（重入）</font><font style="vertical-align: inherit;">库。</font><font style="vertical-align: inherit;">从5.5开始，两个库都是相同的，</font></font><code class="literal">_r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名称是与相应非</font></font><code class="literal">_r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名称的</font><font style="vertical-align: inherit;">符号链接</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">没有必要使用这些</font></font><code class="literal">_r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库。</font><font style="vertical-align: inherit;">例如，如果使用</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取链接器标志，则可以</font><font style="vertical-align: inherit;">在所有情况下</font><font style="vertical-align: inherit;">使用</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config --libs</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，即使对于线程客户端也是如此。</font><font style="vertical-align: inherit;">没有必要使用
       </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config --libs_r</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-multiple-installations"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.2同时安装MySQL服务器和连接器/ C</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL服务器和连接器/ C安装包都提供了构建和运行MySQL C API客户端程序所需的文件。</font><font style="vertical-align: inherit;">本节讨论何时可以在同一个系统上安装两种产品。</font><font style="vertical-align: inherit;">对于某些包装格式，这可能没有冲突。</font><font style="vertical-align: inherit;">对于其他产品，不能同时安装。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本讨论假设两种产品使用类似的包装类型（例如，两种产品的RPM包装）。</font><font style="vertical-align: inherit;">它并不试图描述打包类型之间的共存（例如，使用一个产品的RPM包和另一个产品的
       </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tar</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件包）。</font><font style="vertical-align: inherit;">它也没有描述Oracle提供的包和第三方供应商提供的包的共存。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果您安装了这两种产品，则可能需要调整开发工具或运行时环境，以便选择一组头文件和库。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-building-clients" title="27.8.4.1构建C API客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.4.1节“构建C API客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-running-clients" title="27.8.4.4运行C API客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.4.4节“运行C API客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p>
      <span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tar</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和Zip文件包将安装在解压缩到的目录下。</font><font style="vertical-align: inherit;">例如，您可以解压缩MySQL Server和Connector / C</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tar</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包，
      </font></font><code class="filename">/usr/local</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且它们将解压到不同的目录名中而不会发生冲突。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Windows MSI安装程序使用它们自己的安装目录，因此MySQL Server和Connector / C安装程序不会发生冲突。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      OS X DMG软件包安装在相同的父目录下，但位于不同的子目录中，因此不存在冲突。</font><font style="vertical-align: inherit;">例如：
    </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/usr/local/mysql-5.6.11-osx10.7-x86_64/</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/usr/local/mysql-connector-c-6.1.0-osx10.7-x86/</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Solaris PKG软件包安装在相同的父目录下，但位于不同的子目录中，因此不存在冲突。</font><font style="vertical-align: inherit;">例如：
    </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/选择/ MySQL的/ mysql的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的/ opt / MySQL的/连接器-C</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Solaris Connector / C安装程序不会从系统目录（例如</font></font><code class="filename">/usr/bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><code class="filename">/usr/lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装目录）</font><font style="vertical-align: inherit;">创建任何符号链接</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">安装后必须手动完成。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于RPM安装，有几种类型的RPM软件包。</font><font style="vertical-align: inherit;">MySQL服务器</font></font><code class="literal">shared</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><code class="literal">devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RPM软件包与相应的Connector / C RPM软件包类似。</font><font style="vertical-align: inherit;">这些RPM软件包类型不能共存，因为MySQL服务器和连接器/ C RPM软件包对与客户端库相关的文件使用相同的安装位置。</font><font style="vertical-align: inherit;">这意味着下列条件成立：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font><font style="vertical-align: inherit;">安装了</font><font style="vertical-align: inherit;">MySQL服务器</font></font><code class="literal">shared</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RPM包，它们将提供C API头文件和库，并且不需要安装Connector / C RPM包。</font><font style="vertical-align: inherit;">无论如何要安装Connector / C包，你必须首先删除相应的MySQL服务器包。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您已经安装了Connector / C RPM软件包，则要安装MySQL Server RPM软件包，必须首先删除Connector / C RPM软件包。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL服务器RPM包比其他</font></font><code class="literal">shared</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><code class="literal">devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不连接器/ C包冲突，如果安装连接器/ C可以安装。</font><font style="vertical-align: inherit;">这包括包含</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqld</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器本身</font><font style="vertical-align: inherit;">的主服务器RPM </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-example-programs"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.3示例C API客户端程序</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962527600"></a><a class="indexterm" name="idm140527962526144"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL源代码发行版中的许多客户端都是用C编写的，比如</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行工具"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqladmin" title="4.5.2 mysqladmin  - 用于管理MySQL服务器的客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqladmin</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqlshow" title="4.5.8 mysqlshow  - 显示数据库，表和列信息"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqlshow</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果您正在寻找演示如何使用C API的示例，请查看这些客户端：获取源代码分发并查找其</font></font><code class="literal">client</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/installing.html#getting-mysql" title="2.1.2如何获取MySQL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.1.2节“如何获取MySQL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-building-running-clients"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4构建和运行C API客户端程序</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-building-clients"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.1构建C API客户端程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-building-clients-pkg-config"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.2使用pkg-config构建C API客户端程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-threaded-clients"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.3编写C API线程客户端程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-running-clients"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.4运行C API客户端程序</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-server-client-versions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.5 C API服务器和客户端库版本</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下各节提供了有关构建使用C API的客户端程序的信息。</font><font style="vertical-align: inherit;">主题包括编译和链接客户端，编写线程客户端以及排除运行时问题。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-building-clients"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.1构建C API客户端程序</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140527962515872"></a><a class="indexterm" name="idm140527962514416"></a><a class="indexterm" name="idm140527962513344"></a><a class="indexterm" name="idm140527962511856"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        本节提供了编译使用MySQL C API的C程序的指导原则。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="c-api-building-clients-compiling-mysql-clients-on-unix"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Unix上编译MySQL客户端</font></font></h5>
</div>
</div>
</div>
<a class="indexterm" name="idm140527962508560"></a><a class="indexterm" name="idm140527962507072"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这里的例子使用</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为编译器。</font><font style="vertical-align: inherit;">在某些系统上可能适用不同的编译器（例如，</font><font style="vertical-align: inherit;">OS X或FreeBSD上的</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clang</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或Solaris上的Sun Studio）。</font><font style="vertical-align: inherit;">根据需要调整示例。
        </font></font></p><p><font style="vertical-align: inherit;"></font><code class="option">-I</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译使用MySQL头文件的客户端程序时，</font><font style="vertical-align: inherit;">
          可能需要指定一个</font><font style="vertical-align: inherit;">选项，以便编译器可以找到它们。</font><font style="vertical-align: inherit;">例如，如果头文件已安装</font></font><code class="literal">/usr/local/mysql/include</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请在编译命令中使用此选项：
        </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-I在/ usr /本地/ mysql /下包括
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL客户端必须使用</font></font><code class="option">-lmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接命令中</font><font style="vertical-align: inherit;">的
           </font><font style="vertical-align: inherit;">选项进行链接。</font><font style="vertical-align: inherit;">您可能还需要指定一个</font></font><code class="option">-L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项来告诉链接器在哪里找到库。</font><font style="vertical-align: inherit;">例如，如果库已安装
           </font></font><code class="filename">/usr/local/mysql/lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请在链接命令中使用以下选项：
        </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-L / usr / local / mysql / lib -lmysqlclient
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          系统上的路径名称可能有所不同。</font><font style="vertical-align: inherit;">根据需要</font><font style="vertical-align: inherit;">调整
           </font></font><code class="option">-I</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="option">-L</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了在Unix上编译MySQL程序更简单，使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脚本。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.7.1节“ </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 显示用于编译客户端的选项”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显示编译或链接所需的选项：
        </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shell&gt; </font></font><strong class="userinput"><code>mysql_config --cflags</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
shell&gt;</font></font><strong class="userinput"><code>mysql_config --libs</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您可以运行这些命令来获取正确的选项，并手动将它们添加到编译或链接命令中。</font><font style="vertical-align: inherit;">或者，</font><font style="vertical-align: inherit;">
          使用反引号在命令行中直接</font><font style="vertical-align: inherit;">包含</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的输出</font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shell&gt; </font></font><strong class="userinput"><code>gcc -c `mysql_config --cflags` progname.c</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
shell&gt;</font></font><strong class="userinput"><code>gcc -o progname progname.o `mysql_config --libs`</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在Unix上，链接默认使用动态库。</font><font style="vertical-align: inherit;">要链接到静态客户端库，请将其路径名添加到链接命令中。</font><font style="vertical-align: inherit;">例如，如果库位于
           </font></font><code class="filename">/usr/local/mysql/lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，链接如下所示：
        </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>gcc -o progname progname.o /usr/local/mysql/lib/libmysqlclient.a</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者使用</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来提供库名称：
        </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>gcc -o progname progname.o `mysql_config --variable=pkglibdir`/libmysqlclient.a</code></strong>
</pre><p>
          <a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目前不提供列出静态链接所需的所有库的方法，因此可能需要在链接命令上命名其他库（例如，</font></font><code class="literal">-lnsl -lsocket</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Solaris上）。</font><font style="vertical-align: inherit;">要想知道要添加哪些库，请使用
          </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mysql_config --libs</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ldd libmysqlclient.so</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或</font><font style="vertical-align: inherit;">OS X上的</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> otool -L libmysqlclient.dylib</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p>
          <span class="command"><strong><font style="vertical-align: inherit;"></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用</font><span class="command"><strong><font style="vertical-align: inherit;"> pkg-config</font></strong></span><font style="vertical-align: inherit;">作为</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的替代方法来
          </font><font style="vertical-align: inherit;">获取信息，例如编译MySQL应用程序所需的编译器标记或链接库。</font><font style="vertical-align: inherit;">例如，以下几对命令是等价的：
        </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config --cflags</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pkg-config --cflags mysqlclient</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_config --libs</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pkg-config --libs mysqlclient</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要为静态链接生成标志，请使用以下命令：
        </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config --static --libs mysqlclient
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关更多信息，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-building-clients-pkg-config" title="27.8.4.2使用pkg-config构建C API客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.4.2节“使用pkg-config构建C API客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="c-api-building-clients-compiling-mysql-clients-on-microsoft-windows"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Microsoft Windows上编译MySQL客户端</font></font></h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962466144"></a><a class="indexterm" name="idm140527962464656"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要指定标题和库文件位置，请使用开发环境提供的工具。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要在Windows上构建C API客户端，必须链接C客户端库以及Windows ws2_32套接字库和Secur32安全库。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您可以将代码与动态或静态C客户端库链接起来。</font><font style="vertical-align: inherit;">在Windows上，静态库被命名
           </font></font><code class="filename">mysqlclient.lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且动态库被命名</font></font><code class="filename">libmysql.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">另外，
           </font></font><code class="filename">libmysql.lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用动态库需要静态导入库。</font><font style="vertical-align: inherit;">如果使用静态C客户端库，则客户端应用程序必须使用与用于编译C客户端库（Visual Studio 2013用于由Oracle构建的静态C客户端库）相同版本的Visual Studio进行编译。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-c/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接/ C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个独立的，直接替代来与MySQL服务器分布MySQL的C客户机库。</font><font style="vertical-align: inherit;">Oracle构建的</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-c/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL Connector / C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目前包含两个版本的静态客户端库，一个使用Visual Studio 2013构建，另一个使用Visual Studio 2015; </font><font style="vertical-align: inherit;">使用与您用来编译应用程序的Visual Studio版本相匹配的版本。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当使用Oracle构建的MySQL C客户端库（或MySQL Connector / C）时，请遵循以下规则来连接客户端应用程序的C运行时：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于社区版本的MySQL C客户端库（或社区版本的MySQL连接器/ C）：

</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                    <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于版本5.7.17和之前版本</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    （或MySQL Connector / C Community 6.1.9和之前版本）：

</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                          如果链接到静态C客户端库，则静态链接到C运行时（使用
                           </font></font><code class="literal">/MT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译器选项）。
                        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                          如果链接到动态C客户端库，则静态或动态链接到C运行库（使用</font></font><code class="literal">/MT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者
                           </font></font><code class="literal">/MD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译器选项）。
</font></font></p></li></ul>
</div>
<p>
                  </p></li><li class="listitem"><p>
                    <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于V5.7.18及更高版本</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    （或MySQL Connector / C社区6.1.10及更高版本）：</font></font><code class="literal">/MD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无论是链接到静态还是动态C客户端库，</font><font style="vertical-align: inherit;">始终动态链接到C运行时（使用
                    </font><font style="vertical-align: inherit;">编译器选项）。</font><font style="vertical-align: inherit;">此外，</font><font style="vertical-align: inherit;">
                    如果使用C客户端库，则</font><font style="vertical-align: inherit;">运行客户端应用程序的目标主机需要
                    </font><font style="vertical-align: inherit;">安装</font></font><a class="ulink" href="https://www.microsoft.com/en-us/download/details.aspx?id=40784" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Visual Studio 2013</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><a class="ulink" href="https://www.microsoft.com/en-us/download/details.aspx?id=48145" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Visual C ++ Redistributable，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    如果您使用的是MySQL Connector / C，则需要安装</font><a class="ulink" href="https://www.microsoft.com/en-us/download/details.aspx?id=48145" target="_top"><font style="vertical-align: inherit;"> Visual Studio 2015</font></a><font style="vertical-align: inherit;">的
                    </font><a class="ulink" href="https://www.microsoft.com/en-us/download/details.aspx?id=48145" target="_top"><font style="vertical-align: inherit;"> Visual C ++ Redistributable</font></a><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p>
            </p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于商业版本的MySQL C客户端库（或商业版本的MySQL连接器/ C）：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果链接到静态C客户端库，则静态链接到C运行时（使用</font></font><code class="literal">
                  /MT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译器选项）。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果链接到动态C客户端库，则静态或动态链接到C运行时（使用任一个</font></font><code class="literal">/MT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                   </font></font><code class="literal">/MD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译器选项）。
</font></font></p></li></ul>
</div>
</li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一般来说，链接到静态MySQL C客户端库时，客户端库和客户端应用程序在链接C运行时时必须使用相同的编译器选项 - 也就是说，如果您的C客户端库使用该</font></font><code class="literal">/MT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">编译，那么</font><font style="vertical-align: inherit;">您的客户端应用程序也应该使用该</font></font><code class="literal">/MT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">进行编译
           </font><font style="vertical-align: inherit;">，等等（</font><font style="vertical-align: inherit;">有关更多详细信息，</font><font style="vertical-align: inherit;">请参阅
           </font></font><a class="ulink" href="http://msdn.microsoft.com/en-us/library/2kzt1wy3.aspx" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述C库链接选项的MSDN页面</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">当您从源代码构建自己的静态MySQL C客户端库（或MySQL Connector / C）并将客户端应用程序链接到它时，请遵循此规则。

</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
              <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调试模式：</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于上述规则，您无法以调试模式（使用</font></font><code class="literal">/MTd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
              </font></font><code class="literal">/MDd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译器选项）</font><font style="vertical-align: inherit;">构建应用程序，</font><font style="vertical-align: inherit;">并将其链接到由Oracle构建的静态C客户端库，该库
              </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并非</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用调试选项构建; </font><font style="vertical-align: inherit;">相反，您将不得不使用调试选项从源代码构建静态客户端库。
</font></font></p>
</div>
<p>
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="c-api-building-clients-troubleshooting-problems-linking-to-the-mysql-client-library"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">疑难解答链接到MySQL客户端库的问题</font></font></h5>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962430384"></a><a class="indexterm" name="idm140527962428896"></a><a class="indexterm" name="idm140527962427408"></a><a class="indexterm" name="idm140527962425920"></a><a class="indexterm" name="idm140527962424432"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          MySQL客户端库包含内置的SSL支持。无需指定</font></font><code class="literal">-lssl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">-lcrypto</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在链接时</font><font style="vertical-align: inherit;">指定</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这样做可能会在运行时导致问题。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果链接程序找不到MySQL客户端库，则可能会出现以符号开头的未定义引用错误，
           </font></font><code class="literal">mysql_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如下所示：
        </font></font></p><pre data-lang="none" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/tmp/ccFKsdPa.o：在函数`main'中：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/tmp/ccFKsdPa.o(.text+0xb）：对'mysql_init'的未定义引用</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/tmp/ccFKsdPa.o(.text+0x31）：对'mysql_real_connect'的未定义引用</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/tmp/ccFKsdPa.o(.text+0x69）：对'mysql_error'的未定义引用</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/tmp/ccFKsdPa.o(.text+0x9a）：未定义的引用'mysql_close'</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您应该能够通过</font><font style="vertical-align: inherit;">在链接命令的末尾</font><font style="vertical-align: inherit;">添加来解决此问题
           </font><font style="vertical-align: inherit;">，其中
           </font><font style="vertical-align: inherit;">代表客户端库所在目录的路径名。</font><font style="vertical-align: inherit;">要确定正确的目录，请尝试以下命令：
        </font></font><code class="literal">-L<em class="replaceable"><code>dir_path</code></em>
          -lmysqlclient</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>dir_path</code></em><font style="vertical-align: inherit;"></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>mysql_config --libs</code></strong>
</pre><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          的输出</font><font style="vertical-align: inherit;">可能会指示其他库，这些库也应该在link命令中指定。</font><font style="vertical-align: inherit;">您可以</font><font style="vertical-align: inherit;">
          使用反引号</font><font style="vertical-align: inherit;">将</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输出直接</font><font style="vertical-align: inherit;">包含</font><font style="vertical-align: inherit;">在编译或链接命令中。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>gcc -o progname progname.o `mysql_config --libs`</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果在</font></font><code class="literal">floor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">符号未定义的</font><font style="vertical-align: inherit;">链接时发生错误
           </font><font style="vertical-align: inherit;">，请通过添加</font></font><code class="option">-lm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到编译/链接行的末尾来</font><font style="vertical-align: inherit;">链接到数学库</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">同样，如果系统中应存在其他函数的未定义引用错误（例如</font></font><code class="literal">connect()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请检查相关函数的手册页以确定应将哪些库添加到链接命令中）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您的系统中不存在未定义的引用错误（如下面的函数），那通常意味着您的MySQL客户端库在与您的系统不兼容的系统上编译：
        </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mf_format.o（.text + 0x201）：未定义的引用'__lxstat'
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在这种情况下，您应该下载最新的MySQL或连接器/ C源代码分发并自己编译MySQL客户端库。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/installing.html#source-installation" title="2.9从源代码安装MySQL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.9节“从源代码安装MySQL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-c/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL连接器/ C开发人员指南</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-building-clients-pkg-config"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.2使用pkg-config构建C API客户端程序</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL发行版包含一个</font></font><code class="filename">mysqlclient.pc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件，</font><font style="vertical-align: inherit;">该
         </font><font style="vertical-align: inherit;">文件提供有关MySQL配置的信息以供
         </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令使用。</font><font style="vertical-align: inherit;">这使得
         </font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以用来替代
         </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-config" title="4.7.1 mysql_config  - 显示编译客户端的选项"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来获得编译MySQL应用程序所需的编译器标记或链接库等信息。</font><font style="vertical-align: inherit;">例如，以下几对命令是等价的：
      </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_config --cflags</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pkg-config --cflags mysqlclient</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_config --libs</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pkg-config --libs mysqlclient</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        最后一个</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令为动态链接生成标志。</font><font style="vertical-align: inherit;">要为静态链接生成标志，请使用以下命令：
      </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config --static --libs mysqlclient
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在某些平台上，带和不带的输出
         </font></font><code class="option">--static</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能是相同的。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
          <a class="indexterm" name="idm140527962393088"></a>

          <a class="indexterm" name="idm140527962392000"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

          如果</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未找到MySQL信息，则可能需要将</font></font><code class="literal">PKG_CONFIG_PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量</font><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为</font></font><code class="filename">mysqlclient.pc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          文件所在的</font></font><code class="filename">pkgconfig</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录</font><font style="vertical-align: inherit;">，默认情况下通常
           </font><font style="vertical-align: inherit;">是MySQL库目录下的目录。</font><font style="vertical-align: inherit;">例如（适当地调整位置）：
        </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">export PKG_CONFIG_PATH = / usr / local / mysql / lib / pkgconfig＃sh，bash，...</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
setenv PKG_CONFIG_PATH / usr / local / mysql / lib / pkgconfig＃csh，tcsh，...</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="filename">mysqlconfig.pc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装位置可以通过控制
           </font><span class="command"><strong><font style="vertical-align: inherit;">CMake的</font></strong></span><font style="vertical-align: inherit;">选项。</font><font style="vertical-align: inherit;">请参见
           </font><a class="xref" href="/mysql-5.7-google-zh/installing.html#source-configuration-options" title="2.9.4 MySQL源配置选项"><font style="vertical-align: inherit;">第2.9.4节“MySQL源配置选项”</font></a><font style="vertical-align: inherit;">。
</font></font><a class="link" href="/mysql-5.7-google-zh/installing.html#option_cmake_install_pkgconfigdir"><code class="option">INSTALL_PKGCONFIGDIR</code></a>
          <span class="command"><strong><font style="vertical-align: inherit;"></font></strong></span><font style="vertical-align: inherit;"></font><a class="xref" href="/mysql-5.7-google-zh/installing.html#source-configuration-options" title="2.9.4 MySQL源配置选项"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><code class="option">--variable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项采用配置变量名称并显示变量值：
      </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config --variable =前缀mysqlclient＃安装前缀目录</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pkg-config --variable = includedir mysqlclient＃头文件目录</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pkg-config --variable = libdir mysqlclient＃库目录</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要查看</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用该</font></font><code class="option">--variable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">显示</font><font style="vertical-align: inherit;">哪些变量值</font><font style="vertical-align: inherit;">，请使用以下命令：
      </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config --print-variables mysqlclient
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您可以使用</font><font style="vertical-align: inherit;">反引号在命令行中</font><font style="vertical-align: inherit;">使用</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来包含它为特定选项生成的输出。</font><font style="vertical-align: inherit;">例如，要编译和链接MySQL客户端程序，请</font><font style="vertical-align: inherit;">按如下所示</font><font style="vertical-align: inherit;">使用</font></font><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkg-config</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
      </font></font></p><pre data-lang="bash" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc -c`pkg-config --cflags mysqlclient` progname.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -o progname progname.o`pkg-config --libs mysqlclient`</font></font><font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-threaded-clients"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.3编写C API线程客户端程序</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962373376"></a><a class="indexterm" name="idm140527962371920"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        客户端库几乎是线程安全的。</font><font style="vertical-align: inherit;">最大的问题是</font></font><code class="filename">sql/net_serv.cc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        从套接字读取</font><font style="vertical-align: inherit;">的子程序</font><font style="vertical-align: inherit;">不是中断安全的。</font><font style="vertical-align: inherit;">这是因为你可能想要拥有自己的闹钟，这可能会导致长时间读取到服务器。</font><font style="vertical-align: inherit;">如果您为</font></font><code class="literal">SIGPIPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中断</font><font style="vertical-align: inherit;">安装中断处理程序，则</font><font style="vertical-align: inherit;">套接字处理应该是线程安全的。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        为了避免中止程序时的连接终止时，MySQL块</font></font><code class="literal">SIGPIPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上的第一次调用
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect" title="27.8.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要使用您自己的
         </font></font><code class="literal">SIGPIPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理程序，请先调用
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后安装处理程序。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果</font><font style="vertical-align: inherit;">在与</font><font style="vertical-align: inherit;">客户端库</font><font style="vertical-align: inherit;">链接时出现</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未定义符号</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则在大多数情况下，这是因为您没有在链接/编译命令中包含线程库。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        客户端库每个连接都是线程安全的。</font><font style="vertical-align: inherit;">您可以让两个线程共享相同的连接，但需要注意以下事项：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            多个线程无法在同一连接上同时向MySQL服务器发送查询。</font><font style="vertical-align: inherit;">尤其是，您必须确保</font><font style="vertical-align: inherit;">在一个线程中</font><font style="vertical-align: inherit;">调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不在其他线程中使用相同的连接。</font><font style="vertical-align: inherit;">你必须在你对一个互斥锁
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电话。</font><font style="vertical-align: inherit;">后</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回时，锁可以被释放并且其他线程可以查询同一个连接。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果您使用POSIX线程，则可以使用
             </font></font><code class="literal">pthread_mutex_lock()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
             </font></font><code class="literal">pthread_mutex_unlock()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建立并释放互斥锁。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            许多线程可以访问使用检索的不同结果集
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，必须确保在结果集关闭之前没有其他线程正在使用相同的连接。</font><font style="vertical-align: inherit;">但是，对于共享相同连接的线程客户端来说，它确实是最好的选择
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果您有一个线程未创建与MySQL数据库的连接，但正在调用MySQL函数，则需要知道以下内容：
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当你调用的时候</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL为调试库使用的线程创建一个线程特定的变量（等等）。</font><font style="vertical-align: inherit;">如果在线程调用之前调用MySQL函数
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则该线程没有适当的线程特定变量，并且您很可能迟早会收到核心转储。</font><font style="vertical-align: inherit;">为避免出现问题，您必须执行以下操作：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            拨打</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            之前的任何其他MySQL功能。</font><font style="vertical-align: inherit;">它不是线程安全的，所以在创建线程之前调用它，或使用互斥锁保护呼叫。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在调用任何MySQL函数之前，</font><font style="vertical-align: inherit;">
            安排
             </font><font style="vertical-align: inherit;">在线程处理程序中尽早调用它。</font><font style="vertical-align: inherit;">如果你打电话
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它会呼唤
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">你。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在线程中，在调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-end" title="27.8.12.2 mysql_thread_end（）"><code class="literal">mysql_thread_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">之前调用</font></font><code class="literal">pthread_exit()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这释放了MySQL线程特定变量所使用的内存。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        前面的注释
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也适用于
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect" title="27.8.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">哪些呼叫
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-running-clients"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.4运行C API客户端程序</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果在升级后遇到编译客户端程序（例如</font></font><code class="literal">Commands out of sync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        或意外的核心转储）问题，则可能使用旧的头文件或库文件编译程序。</font><font style="vertical-align: inherit;">在这种情况下，请检查</font><font style="vertical-align: inherit;">用于编译</font><font style="vertical-align: inherit;">的</font></font><code class="filename">mysql.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件和
         </font></font><code class="filename">libmysqlclient.a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库</font><font style="vertical-align: inherit;">的日期，</font><font style="vertical-align: inherit;">以确认它们来自新的MySQL分发版。</font><font style="vertical-align: inherit;">如果没有，请用新的头文件和库重新编译程序。</font><font style="vertical-align: inherit;">如果库的主版本号已更改（例如，从纂修可能也有必要对共享客户端库编译的程序
         </font></font><code class="filename">libmysqlclient.so.17</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到
         </font></font><code class="filename">libmysqlclient.so.18</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        主要客户端库版本确定兼容性。</font><font style="vertical-align: inherit;">（例如，因为</font></font><code class="literal">libmysqlclient.so.18.1.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主版本是18.）因此，附带较新版本MySQL的库是对具有相同主编号的较旧版本的替代版本。</font><font style="vertical-align: inherit;">只要主要的库版本相同，您可以升级库并且旧的应用程序应该继续使用它。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当您尝试执行MySQL程序时，运行时可能会发生未定义参考错误。</font><font style="vertical-align: inherit;">如果这些错误指定了以“ </font></font><code class="literal">mysql_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或” </font><font style="vertical-align: inherit;">开头的符号</font><font style="vertical-align: inherit;">或表示
         </font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无法找到该</font></font><code class="filename">libmysqlclient.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库</font><font style="vertical-align: inherit;">，则表示您的系统找不到该共享
         </font><font style="vertical-align: inherit;">库。</font><font style="vertical-align: inherit;">解决此问题的方法是告诉系统在该库所在的目录中搜索共享库。</font><font style="vertical-align: inherit;">使用以下方法适用于您的系统：
</font></font></p><a class="indexterm" name="idm140527962314800"></a><a class="indexterm" name="idm140527962313712"></a><a class="indexterm" name="idm140527962312224"></a><a class="indexterm" name="idm140527962311136"></a>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            将所在目录的路径添加
             </font></font><code class="filename">libmysqlclient.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到
             </font></font><code class="literal">LD_LIBRARY_PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><code class="literal">LD_LIBRARY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在OS X上，将所在目录的路径添加
             </font></font><code class="filename">libmysqlclient.dylib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到
             </font></font><code class="literal">DYLD_LIBRARY_PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            将共享库文件（如</font></font><code class="filename">libmysqlclient.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">复制到
             </font><font style="vertical-align: inherit;">系统搜索的某个目录中，例如
             </font></font><code class="filename">/lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过执行更新共享库信息</font></font><code class="literal">ldconfig</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一定要复制所有相关的文件。</font><font style="vertical-align: inherit;">共享库可能存在多个名称下，使用符号链接提供备用名称。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果应用程序链接到嵌入式服务器库，则运行时错误消息将指示
         </font><font style="vertical-align: inherit;">库</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而非
         </font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库，但问题的解决方案与刚描述的相同。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-server-client-versions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.4.5 C API服务器和客户端库版本</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL服务器版本的字符串和数字形式在编译时可用作</font></font><code class="literal">MYSQL_SERVER_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="literal">MYSQL_VERSION_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宏</font><font style="vertical-align: inherit;">的值
         </font><font style="vertical-align: inherit;">，在运行时用作</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-server-info" title="27.8.7.32 mysql_get_server_info（）"><code class="literal">mysql_get_server_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-server-version" title="27.8.7.33 mysql_get_server_version（）"><code class="literal">mysql_get_server_version()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        函数</font><font style="vertical-align: inherit;">的值
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL客户端库版本取决于提供库的分发类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于MySQL发行版，客户端库版本是MySQL版本。</font><font style="vertical-align: inherit;">该版本的字符串和数字形式在编译时可用作</font></font><code class="literal">MYSQL_SERVER_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><code class="literal">MYSQL_VERSION_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宏</font><font style="vertical-align: inherit;">的值
             </font><font style="vertical-align: inherit;">，在运行时用作</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-client-info" title="27.8.7.27 mysql_get_client_info（）"><code class="literal">mysql_get_client_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-client-version" title="27.8.7.28 mysql_get_client_version（）"><code class="literal">mysql_get_client_version()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            函数</font><font style="vertical-align: inherit;">的值
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            这两个</font><font style="vertical-align: inherit;">宏</font></font><code class="literal">LIBMYSQL_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><code class="literal">LIBMYSQL_VERSION_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宏具有相同的值</font></font><code class="literal">MYSQL_SERVER_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><code class="literal">MYSQL_VERSION_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且这两组宏可以互换使用。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于Connector / C发行版，客户端库版本是Connector / C版本。</font><font style="vertical-align: inherit;">该版本的字符串和数字形式在编译时可用作</font></font><code class="literal">LIBMYSQL_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><code class="literal">LIBMYSQL_VERSION_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宏</font><font style="vertical-align: inherit;">的值</font><font style="vertical-align: inherit;">，在运行时用作</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-client-info" title="27.8.7.27 mysql_get_client_info（）"><code class="literal">mysql_get_client_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-client-version" title="27.8.7.28 mysql_get_client_version（）"><code class="literal">mysql_get_client_version()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            函数</font><font style="vertical-align: inherit;">的值
             </font><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            在</font></font><code class="literal">MYSQL_SERVER_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
             </font></font><code class="literal">MYSQL_VERSION_ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宏表示字符串，并在其上连接器/ C分布基于的MySQL版本数字形式。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-data-structures"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.5 C API数据结构</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527962274640"></a><a class="indexterm" name="idm140527962273152"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍C语言API数据结构，而不是用于准备语句的数据结构。</font><font style="vertical-align: inherit;">有关后者的信息，请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures" title="27.8.9 C API编写的语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.9节“C API准备语句数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="indexterm" name="idm140527962269440"></a>

          <code class="literal">MYSQL</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该结构表示一个数据库连接的处理程序。</font><font style="vertical-align: inherit;">它几乎用于所有MySQL函数。</font><font style="vertical-align: inherit;">不要试图制作一个</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的副本</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">不能保证这样的副本可用。
        </font></font></p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140527962265552"></a>

          <code class="literal">MYSQL_RES</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该结构表示返回行（一个查询的结果</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show" title="13.7.5 SHOW语法"><code class="literal">SHOW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#describe" title="13.8.1 DESCRIBE语法"><code class="literal">DESCRIBE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">查询返回的信息称为</font><font style="vertical-align: inherit;">本节其余部分</font><font style="vertical-align: inherit;">的</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140527962257136"></a>

          <code class="literal">MYSQL_ROW</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这是一行数据的类型安全表示。</font><font style="vertical-align: inherit;">它目前是作为一个计数字节串的数组来实现的。</font><font style="vertical-align: inherit;">（如果字段值可能包含二进制数据，则不能将它们视为以空字符结尾的字符串，因为这些值可能在内部包含空字节。）行是通过调用获得的
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140527962252624"></a>

          <code class="literal">MYSQL_FIELD</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该结构包含元数据：关于字段的信息，例如字段的名称，类型和大小。</font><font style="vertical-align: inherit;">其成员在本节后面会有更详细的描述。</font><font style="vertical-align: inherit;">您可以</font></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          重复</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">来获取</font><font style="vertical-align: inherit;">每个字段</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">字段值不是这个结构的一部分; </font><font style="vertical-align: inherit;">它们被包含在一个</font></font><code class="literal">MYSQL_ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构中。
        </font></font></p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140527962246576"></a>

          <code class="literal">MYSQL_FIELD_OFFSET</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这是MySQL字段列表中偏移量的类型安全表示。</font><font style="vertical-align: inherit;">（由...使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-seek" title="27.8.7.23 mysql_field_seek（）"><code class="literal">mysql_field_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）偏移量是一行中的字段号，从零开始。
        </font></font></p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140527962242112"></a>

          <a class="indexterm" name="idm140527962241040"></a>

          <code class="literal">my_ulonglong</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          用于行数和类型
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这种类型提供了一系列的</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to
           </font></font><code class="literal">1.84e19</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一些使用此类型返回行计数的函数返回-1作为无符号值来指示错误或异常情况。</font><font style="vertical-align: inherit;">您可以通过比较返回值</font></font><code class="literal">(my_ulonglong)-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
           </font></font><code class="literal">(my_ulonglong)~0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等价）</font><font style="vertical-align: inherit;">来检查-1 </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在某些系统上，尝试打印类型的值
           </font></font><code class="literal">my_ulonglong</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不起作用。</font><font style="vertical-align: inherit;">要打印这样的值，请将其转换为</font></font><code class="literal">unsigned long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并使用</font></font><code class="literal">%lu</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打印格式。</font><font style="vertical-align: inherit;">例：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">printf（“行数：％lu \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        （unsigned long）mysql_num_rows（result））;</font></font><font></font>
</pre></li><li class="listitem"><p>
          <a class="indexterm" name="idm140527962226592"></a>

          <a class="indexterm" name="idm140527962225520"></a>

          <code class="literal">my_bool</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          布尔类型，用于值为true（非零）或false（零）的值。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该</font></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构包含以下列表中描述的成员。</font><font style="vertical-align: inherit;">这些定义主要适用于由</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">产生的结果集列
       </font><font style="vertical-align: inherit;">。
      </font></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构也用于提供元数据</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      从使用预处理</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">执行的存储过程返回的参数
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于这些参数，某些结构成员的含义与列值的含义不同。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">char * name</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字段的名称，作为以空字符结尾的字符串。</font><font style="vertical-align: inherit;">如果该字段被赋予了一个别名</font></font><code class="literal">AS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，那么该值</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">就是别名。</font><font style="vertical-align: inherit;">对于过程参数，参数名称。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">char * org_name</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字段的名称，作为以空字符结尾的字符串。</font><font style="vertical-align: inherit;">别名被忽略。</font><font style="vertical-align: inherit;">对于表达式，该值是一个空字符串。</font><font style="vertical-align: inherit;">对于过程参数，参数名称。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">char * table</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          包含此字段的表的名称（如果它不是计算字段）。</font><font style="vertical-align: inherit;">对于计算字段，该
           </font></font><code class="literal">table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是一个空字符串。</font><font style="vertical-align: inherit;">如果从视图中选择列，则为视图</font></font><code class="literal">table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命名。</font><font style="vertical-align: inherit;">如果表或视图被赋予了一个带有</font></font><code class="literal">AS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">的别名
           </font><font style="vertical-align: inherit;">，则该值
           </font></font><code class="literal">table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是别名。</font><font style="vertical-align: inherit;">对于a
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#union" title="13.2.9.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该值是空字符串。</font><font style="vertical-align: inherit;">对于过程参数，过程名称。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">char * org_table</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表的名称，作为以空字符结尾的字符串。</font><font style="vertical-align: inherit;">别名被忽略。</font><font style="vertical-align: inherit;">如果从视图中选择列，则为视图
           </font></font><code class="literal">org_table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命名。</font><font style="vertical-align: inherit;">如果从派生表中选择列，则</font></font><code class="literal">org_table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          命名基表。</font><font style="vertical-align: inherit;">如果派生表包装视图，
           </font></font><code class="literal">org_table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仍然命名基表。</font><font style="vertical-align: inherit;">如果该列是表达式，</font></font><code class="literal">org_table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则为空字符串。</font><font style="vertical-align: inherit;">对于a </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#union" title="13.2.9.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该值是空字符串。</font><font style="vertical-align: inherit;">对于过程参数，该值是过程名称。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">char * db</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字段来自的数据库的名称，作为以空字符结尾的字符串。</font><font style="vertical-align: inherit;">如果该字段是计算字段，
           </font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则为空字符串。</font><font style="vertical-align: inherit;">对于a
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#union" title="13.2.9.3 UNION语法"><code class="literal">UNION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该值是空字符串。</font><font style="vertical-align: inherit;">对于过程参数，包含该过程的数据库的名称。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">char * catalog</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          目录名称。</font><font style="vertical-align: inherit;">这个值总是
           </font></font><code class="literal">"def"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">char * def</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该字段的默认值，作为以空字符结尾的字符串。</font><font style="vertical-align: inherit;">这仅在您使用时设置
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-fields" title="27.8.7.43 mysql_list_fields（）"><code class="literal">mysql_list_fields()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned long length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该字段的宽度。</font><font style="vertical-align: inherit;">这对应于显示长度，以字节为单位。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          服务器</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在生成结果集之前</font><font style="vertical-align: inherit;">确定该</font><font style="vertical-align: inherit;">值，因此这是能够从结果列中保持最大可能值的数据类型所需的最小长度，而不事先知道查询将生成的实际值结果集。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned long max_length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果集字段的最大宽度（结果集中实际行的最长字段值的字节长度）。</font><font style="vertical-align: inherit;">如果您使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-fields" title="27.8.7.43 mysql_list_fields（）"><code class="literal">mysql_list_fields()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则它包含该字段的最大长度。</font><font style="vertical-align: inherit;">如果你使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这个变量的值是零。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值</font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是结果集中值的字符串表示的长度。</font><font style="vertical-align: inherit;">例如，如果检索一个
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列和
           </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最宽</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font><code class="literal">-12.345</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是图7（的长度
           </font></font><code class="literal">'-12.345'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您使用的是预准备语句，
           </font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则默认情况下不会进行设置，因为对于二进制协议，值的长度取决于结果集中值的类型。</font><font style="vertical-align: inherit;">（请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures" title="27.8.9 C API编写的语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.9节“C API准备语句数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）如果您仍想使用这些</font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，请启用该</font></font><code class="literal">STMT_ATTR_UPDATE_MAX_LENGTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          选项，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并在调用时设置长度
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.3节“mysql_stmt_attr_set（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.28节“mysql_stmt_store_result（）”）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned int name_length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的长度</font></font><code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned int org_name_length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的长度</font></font><code class="literal">org_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned int table_length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的长度</font></font><code class="literal">table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned int org_table_length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的长度</font></font><code class="literal">org_table</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned int db_length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的长度</font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned int catalog_length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的长度</font></font><code class="literal">catalog</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned int def_length</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          的长度</font></font><code class="literal">def</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned int flags</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          描述该字段的位标志。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值可能具有零个或多个位集，如下表所示。
</font></font></p>
<div class="informaltable">
<table summary="Bit-flag values and a description of each flag."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志说明</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">NOT_NULL_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">领域不能 </font></font><code class="literal">NULL</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">PRI_KEY_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段是主键的一部分</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">UNIQUE_KEY_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">领域是一个独特的关键的一部分</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MULTIPLE_KEY_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段是非唯一键的一部分</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">UNSIGNED_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Field有这个</font></font><code class="literal">UNSIGNED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">ZEROFILL_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Field有这个</font></font><code class="literal">ZEROFILL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">BINARY_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Field有这个</font></font><code class="literal">BINARY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">AUTO_INCREMENT_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Field有这个</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">ENUM_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">领域是一个 </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a></td>
            </tr><tr>
              <td scope="row"><code class="literal">SET_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">场是一个 </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a></td>
            </tr><tr>
              <td scope="row"><code class="literal">BLOB_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段是</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（已弃用）</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">TIMESTAMP_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段是</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（已弃用）</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">NUM_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段是数字; </font><font style="vertical-align: inherit;">请参阅下表中的其他说明</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">NO_DEFAULT_VALUE_FLAG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段没有默认值; </font><font style="vertical-align: inherit;">请参阅下表中的其他说明</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          其中一些标志表示数据类型信息，并被</font><font style="vertical-align: inherit;">稍后描述</font><font style="vertical-align: inherit;">
          的</font><font style="vertical-align: inherit;">成员中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">取代或与其结合使用
           </font><font style="vertical-align: inherit;">：
</font></font><code class="literal">MYSQL_TYPE_<em class="replaceable"><code>xxx</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">field-&gt;type</code><font style="vertical-align: inherit;"></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              要检查</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，请检查</font></font><code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
               </font></font><code class="literal">MYSQL_TYPE_BLOB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><code class="literal">MYSQL_TYPE_TIMESTAMP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（
               </font></font><code class="literal">BLOB_FLAG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><code class="literal">TIMESTAMP_FLAG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志是不需要的。）
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并将
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值作为字符串返回。</font><font style="vertical-align: inherit;">对于这些，请检查</font></font><code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              值是否为</font></font><code class="literal">MYSQL_TYPE_STRING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">ENUM_FLAG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者
               </font></font><code class="literal">SET_FLAG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志是否设置为
               </font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
</font></font></p></li></ul>
</div>
<p>
          <code class="literal">NUM_FLAG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示一列是数字。</font><font style="vertical-align: inherit;">这包括与一个类型的列
           </font></font><code class="literal">MYSQL_TYPE_DECIMAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_NEWDECIMAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_TINY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_SHORT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_LONG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_FLOAT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_DOUBLE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_LONGLONG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_INT24</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><code class="literal">MYSQL_TYPE_YEAR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <code class="literal">NO_DEFAULT_VALUE_FLAG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表明列</font></font><code class="literal">DEFAULT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的定义中</font><font style="vertical-align: inherit;">没有</font><font style="vertical-align: inherit;">子句。</font><font style="vertical-align: inherit;">这不适用于</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          列（因为这些列有默认值
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或
           </font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列（具有默认值）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例说明了该</font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">的典型用法
           </font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果（field-&gt; flags＆NOT_NULL_FLAG）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“字段不能为空\ n”）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您可以使用下表中显示的便捷宏来确定值的布尔状态
           </font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="informaltable">
<table summary="Flag status values and a description of each flag."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志状态</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">IS_NOT_NULL(flags)</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果此字段被定义为，则为真 </font></font><code class="literal">NOT NULL</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">IS_PRI_KEY(flags)</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果此字段是主键，则为真</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">IS_BLOB(flags)</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果此字段是a </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（不建议使用，则</font></font><code class="literal">field-&gt;type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">测试
                 </font><font style="vertical-align: inherit;">）</font></font></td>
</tr></tbody></table>
</div>
</li><li class="listitem"><p>
          <code class="literal">unsigned int decimals</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          数字字段的小数位数，以及时间字段的小数秒精度。
        </font></font></p></li><li class="listitem"><p>
          <code class="literal">unsigned int charsetnr</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指示字段的字符集/归类对的ID号。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通常，结果集中的字符值将转换为由</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">指示的字符集
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，</font></font><code class="literal">charsetnr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对应于该变量指示的字符集。</font><font style="vertical-align: inherit;">字符集转换可以通过设置</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来
           </font><font style="vertical-align: inherit;">抑制
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，
           </font></font><code class="literal">charsetnr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对应于原始表格列或表达式的字符集。</font><font style="vertical-align: inherit;">另请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/charset.html#charset-connection" title="10.4连接字符集和排序规则"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.4节“连接字符集和排序规则”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要区分字符串数据类型的二进制和非二进制数据，请检查</font></font><code class="literal">charsetnr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值</font><font style="vertical-align: inherit;">是否</font><font style="vertical-align: inherit;">为63.如果是，则字符集为
           </font></font><code class="literal">binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，表示二进制数据而非非二进制数据。</font><font style="vertical-align: inherit;">这使您能够区分
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从类型
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型。
        </font></font></p><p>
          <code class="literal">charsetnr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是相同的那些在所显示的</font></font><code class="literal">Id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述的柱
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show-collation" title="13.7.5.4 SHOW COLLATION语法"><code class="literal">SHOW COLLATION</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句或
           </font></font><code class="literal">ID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所述的列
           </font></font><code class="literal">INFORMATION_SCHEMA</code>
          <a class="link" href="/mysql-5.7-google-zh/information-schema.html#collations-table" title="24.2 INFORMATION_SCHEMA COLLATIONS表"><code class="literal">COLLATIONS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表。</font><font style="vertical-align: inherit;">您可以使用这些信息来源查看哪些字符集和归类特定</font></font><code class="literal">charsetnr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值指示：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL的&gt; </font></font><strong class="userinput"><code>SHOW COLLATION WHERE Id = 63;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------- + --------- + ---- + --------- + ---------- +  - -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">整理| </font><font style="vertical-align: inherit;">字符集| </font><font style="vertical-align: inherit;">Id | </font><font style="vertical-align: inherit;">默认| </font><font style="vertical-align: inherit;">编译| </font><font style="vertical-align: inherit;">Sortlen |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------- + --------- + ---- + --------- + ---------- +  - -------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">二进制| </font><font style="vertical-align: inherit;">二进制| </font><font style="vertical-align: inherit;">63 | </font><font style="vertical-align: inherit;">是| </font><font style="vertical-align: inherit;">是| </font><font style="vertical-align: inherit;">1 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------- + --------- + ---- + --------- + ---------- +  - -------- +</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql&gt; </font></font><strong class="userinput"><code>SELECT COLLATION_NAME, CHARACTER_SET_NAME</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    - &gt;</font></font><strong class="userinput"><code>FROM INFORMATION_SCHEMA.COLLATIONS WHERE ID = 33;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------- + -------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">COLLATION_NAME | </font><font style="vertical-align: inherit;">CHARACTER_SET_NAME |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------- + -------------------- +</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">utf8_general_ci | </font><font style="vertical-align: inherit;">utf8 |</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
+ ----------------- + -------------------- +</font></font><font></font>
</pre></li><li class="listitem"><p>
          <code class="literal">enum enum_field_types type</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字段的类型。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值可能是</font></font><code class="literal">MYSQL_TYPE_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下表中显示</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">符号</font><font style="vertical-align: inherit;">之一</font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="informaltable">
<table summary="MYSQL_TYPE_ values and a description of each type."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型说明</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TINY</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">TINYINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_SHORT</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">SMALLINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_LONG</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INTEGER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_INT24</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">MEDIUMINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_LONGLONG</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DECIMAL</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#fixed-point-types" title="11.2.2定点类型（准确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#fixed-point-types" title="11.2.2定点类型（准确值） -  DECIMAL，NUMERIC"><code class="literal">NUMERIC</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_NEWDECIMAL</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精确的数学</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#fixed-point-types" title="11.2.2定点类型（准确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#fixed-point-types" title="11.2.2定点类型（准确值） -  DECIMAL，NUMERIC"><code class="literal">NUMERIC</code></a></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_FLOAT</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DOUBLE</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">REAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_BIT</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#bit-type" title="11.2.4位值类型 -  BIT"><code class="literal">BIT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TIMESTAMP</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DATE</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TIME</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DATETIME</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_YEAR</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#year" title="11.3.3年份类型"><code class="literal">YEAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_STRING</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_VAR_STRING</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_BLOB</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                 </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段（用于
                 </font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确定最大长度）</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_SET</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_ENUM</code></td>
              <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_GEOMETRY</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间领域</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_NULL</code></td>
              <td><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">型字段</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          The </font></font><code class="literal">MYSQL_TYPE_TIME2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_DATETIME2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and
           </font></font><code class="literal">MYSQL_TYPE_TIMESTAMP2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）类型代码仅用于服务器端。</font><font style="vertical-align: inherit;">客户看到
           </font></font><code class="literal">MYSQL_TYPE_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_DATETIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">MYSQL_TYPE_TIMESTAMP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您可以使用</font></font><code class="literal">IS_NUM()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宏来测试字段是否具有数字类型。</font><font style="vertical-align: inherit;">将</font></font><code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">传递
           </font><font style="vertical-align: inherit;">给</font></font><code class="literal">IS_NUM()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          它，如果该字段是数字，则将其计算为TRUE。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if（IS_NUM（field-&gt; type））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“字段是数字\ n”）;</font></font><font></font>
</pre><p>
          <a class="link" href="/mysql-5.7-google-zh/data-types.html#enum" title="11.4.4 ENUM类型"><code class="literal">ENUM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并将
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#set" title="11.4.5 SET类型"><code class="literal">SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值作为字符串返回。</font><font style="vertical-align: inherit;">对于这些，请检查</font></font><code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值是否为</font></font><code class="literal">MYSQL_TYPE_STRING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">ENUM_FLAG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者</font></font><code class="literal">SET_FLAG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          标志是否设置为</font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-function-overview"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.6 C API函数概述</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961890976"></a><a class="indexterm" name="idm140527961889488"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下列表总结了C API中可用的功能。</font><font style="vertical-align: inherit;">有关更多详细信息，请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-functions" title="27.8.7 C API函数描述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7节“C API函数描述”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#my-init" title="27.8.12.1 my_init（）"><code class="literal">my_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：在线程安全程序中初始化全局变量和线程处理程序
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回改变的行数/删除/插入的最后
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-autocommit" title="27.8.7.2 mysql_autocommit（）"><code class="literal">mysql_autocommit()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：打开/关闭自动提交模式
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-change-user" title="27.8.7.3 mysql_change_user（）"><code class="literal">mysql_change_user()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：在打开的连接上更改用户和数据库
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-character-set-name" title="27.8.7.4 mysql_character_set_name（）"><code class="literal">mysql_character_set_name()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回当前连接的默认字符集名称
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-client-find-plugin" title="27.8.14.1 mysql_client_find_plugin（）"><code class="literal">mysql_client_find_plugin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回指向插件的指针
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-client-register-plugin" title="27.8.14.2 mysql_client_register_plugin（）"><code class="literal">mysql_client_register_plugin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：注册一个插件
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-close" title="27.8.7.5 mysql_close（）"><code class="literal">mysql_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：关闭服务器连接
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-commit" title="27.8.7.6 mysql_commit（）"><code class="literal">mysql_commit()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：提交交易
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect" title="27.8.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：连接到MySQL服务器（此功能已弃用;请
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改用）
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-create-db" title="27.8.7.8 mysql_create_db（）"><code class="literal">mysql_create_db()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：创建一个数据库（此功能已弃用;请改用SQL语句
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-database" title="13.1.11 CREATE DATABASE语法"><code class="literal">CREATE DATABASE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-data-seek" title="27.8.7.9 mysql_data_seek（）"><code class="literal">mysql_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：查询查询结果集中的任意行号
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-debug" title="27.8.7.10 mysql_debug（）"><code class="literal">mysql_debug()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
           </font></font><code class="literal">DBUG_PUSH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与给定的字符串
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-drop-db" title="27.8.7.11 mysql_drop_db（）"><code class="literal">mysql_drop_db()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：删除数据库（此功能已弃用;请改用SQL语句
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#drop-database" title="13.1.22 DROP DATABASE语法"><code class="literal">DROP DATABASE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-dump-debug-info" title="27.8.7.12 mysql_dump_debug_info（）"><code class="literal">mysql_dump_debug_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：使服务器将调试信息写入日志
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：确定结果集的最后一行是否已被读取（此功能已被弃用; </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用</font><font style="vertical-align: inherit;">此功能
           </font><font style="vertical-align: inherit;">）
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回最近调用的MySQL函数的错误号
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回最近调用的MySQL函数的错误消息
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-escape-string" title="27.8.7.16 mysql_escape_string（）"><code class="literal">mysql_escape_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：转义字符串中的特殊字符以用于SQL语句
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回下一个表格字段的类型
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field-direct" title="27.8.7.18 mysql_fetch_field_direct（）"><code class="literal">mysql_fetch_field_direct()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：给定一个字段号，返回一个表字段的类型
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-fields" title="27.8.7.19 mysql_fetch_fields（）"><code class="literal">mysql_fetch_fields()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回所有字段结构的数组
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-lengths" title="27.8.7.20 mysql_fetch_lengths（）"><code class="literal">mysql_fetch_lengths()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回当前行中所有列的长度
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从结果集中获取下一行
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回最近语句的结果列数
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-seek" title="27.8.7.23 mysql_field_seek（）"><code class="literal">mysql_field_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将列光标放在指定的列上
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-tell" title="27.8.7.24 mysql_field_tell（）"><code class="literal">mysql_field_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回用于最后一个的字段光标的位置
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：释放结果集使用的内存
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-character-set-info" title="27.8.7.26 mysql_get_character_set_info（）"><code class="literal">mysql_get_character_set_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回有关默认字符集的信息
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-client-info" title="27.8.7.27 mysql_get_client_info（）"><code class="literal">mysql_get_client_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将客户端版本信息作为字符串返回
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-client-version" title="27.8.7.28 mysql_get_client_version（）"><code class="literal">mysql_get_client_version()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以整数形式返回客户端版本信息
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-host-info" title="27.8.7.29 mysql_get_host_info（）"><code class="literal">mysql_get_host_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回描述连接的字符串
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-option" title="27.8.7.30 mysql_get_option（）"><code class="literal">mysql_get_option()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          选项
         </font><font style="vertical-align: inherit;">的值</font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-proto-info" title="27.8.7.31 mysql_get_proto_info（）"><code class="literal">mysql_get_proto_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回连接使用的协议版本
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-server-info" title="27.8.7.32 mysql_get_server_info（）"><code class="literal">mysql_get_server_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回服务器版本号
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-server-version" title="27.8.7.33 mysql_get_server_version（）"><code class="literal">mysql_get_server_version()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以整数形式返回服务器的版本号
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-ssl-cipher" title="27.8.7.34 mysql_get_ssl_cipher（）"><code class="literal">mysql_get_ssl_cipher()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回当前的SSL密码
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-hex-string" title="27.8.7.35 mysql_hex_string（）"><code class="literal">mysql_hex_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以十六进制格式编码字符串
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-info" title="27.8.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回有关最近执行的查询的信息
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取或初始化</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一个查询</font><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">列
         </font><font style="vertical-align: inherit;">生成的ID</font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-kill" title="27.8.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：杀死给定的线程
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：完成MySQL C API库
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：初始化MySQL C API库
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-dbs" title="27.8.7.42 mysql_list_dbs（）"><code class="literal">mysql_list_dbs()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回与简单正则表达式匹配的数据库名称
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-fields" title="27.8.7.43 mysql_list_fields（）"><code class="literal">mysql_list_fields()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回匹配简单正则表达式的字段名称
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-processes" title="27.8.7.44 mysql_list_processes（）"><code class="literal">mysql_list_processes()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回当前服务器线程的列表
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-tables" title="27.8.7.45 mysql_list_tables（）"><code class="literal">mysql_list_tables()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回匹配简单正则表达式的表名
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin" title="27.8.14.3 mysql_load_plugin（）"><code class="literal">mysql_load_plugin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：加载一个插件
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin-v" title="27.8.14.4 mysql_load_plugin_v（）"><code class="literal">mysql_load_plugin_v()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：加载一个插件
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-more-results" title="27.8.7.46 mysql_more_results（）"><code class="literal">mysql_more_results()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：检查是否存在更多结果
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回/启动多重结果执行中的下一个结果
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-fields" title="27.8.7.48 mysql_num_fields（）"><code class="literal">mysql_num_fields()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回结果集中的列数
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回结果集中的行数
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：为连接选项设置
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options4" title="27.8.7.51 mysql_options4（）"><code class="literal">mysql_options4()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：为连接选项设置
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：检查到服务器的连接是否正常工作，必要时重新连接
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-plugin-options" title="27.8.14.5 mysql_plugin_options（）"><code class="literal">mysql_plugin_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：设置一个插件选项
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：执行指定为空终止字符串的SQL查询
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：连接到MySQL服务器
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string" title="27.8.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：考虑到连接的当前字符集，转义字符串中的特殊字符以用于SQL语句
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote" title="27.8.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：转义字符串中的特殊字符以便在SQL语句中使用，同时考虑连接的当前字符集和引用上下文
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：执行指定为计数字符串的SQL查询
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-refresh" title="27.8.7.58 mysql_refresh（）"><code class="literal">mysql_refresh()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：刷新或重置表格和缓存
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-reload" title="27.8.7.59 mysql_reload（）"><code class="literal">mysql_reload()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：通知服务器重新加载授权表
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-reset-connection" title="27.8.7.60 mysql_reset_connection（）"><code class="literal">mysql_reset_connection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：重置连接以清除会话状态
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-rollback" title="27.8.7.61 mysql_rollback（）"><code class="literal">mysql_rollback()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：回退交易
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-seek" title="27.8.7.62 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：使用返回的值寻找结果集中的行偏移量
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-tell" title="27.8.7.63 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-tell" title="27.8.7.63 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回行光标位置
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-select-db" title="27.8.7.64 mysql_select_db（）"><code class="literal">mysql_select_db()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：选择一个数据库
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-end" title="27.8.13.1 mysql_server_end（）"><code class="literal">mysql_server_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：完成MySQL C API库
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-init" title="27.8.13.2 mysql_server_init（）"><code class="literal">mysql_server_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：初始化MySQL C API库
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-first" title="27.8.7.65 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：获取会话状态更改信息的第一部分
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-next" title="27.8.7.66 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：获取会话状态更改信息的下一部分
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-character-set" title="27.8.7.67 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：为当前连接设置默认字符集
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-local-infile-default" title="27.8.7.68 mysql_set_local_infile_default（）"><code class="literal">mysql_set_local_infile_default()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA
          LOCAL INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理程序回调设置为其默认值
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-local-infile-handler" title="27.8.7.69 mysql_set_local_infile_handler（）"><code class="literal">mysql_set_local_infile_handler()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：安装特定于应用程序的
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA LOCAL
          INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理程序回调
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-server-option" title="27.8.7.70 mysql_set_server_option（）"><code class="literal">mysql_set_server_option()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：为连接设置一个选项（如
           </font></font><code class="literal">multi-statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate" title="27.8.7.72 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回最后一个错误的SQLSTATE错误代码
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-shutdown" title="27.8.7.71 mysql_shutdown（）"><code class="literal">mysql_shutdown()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：关闭数据库服务器
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：准备建立到服务器的SSL连接
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stat" title="27.8.7.74 mysql_stat（）"><code class="literal">mysql_stat()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以字符串形式返回服务器状态
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：检索完整的结果集给客户端
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-end" title="27.8.12.2 mysql_thread_end（）"><code class="literal">mysql_thread_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：完成线程处理程序
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-id" title="27.8.7.76 mysql_thread_id（）"><code class="literal">mysql_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回当前的线程ID
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：初始化线程处理程序
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-safe" title="27.8.12.4 mysql_thread_safe（）"><code class="literal">mysql_thread_safe()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：如果客户端编译为线程安全，则返回1
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：启动逐行结果集检索
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-warning-count" title="27.8.7.78 mysql_warning_count（）"><code class="literal">mysql_warning_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回以前的SQL语句的警告计数
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      应用程序应该使用这个总体大纲来与MySQL进行交互：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过调用初始化MySQL客户端库
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该功能既存在于</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          C客户端库中，也</font><font style="vertical-align: inherit;">存在于</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库中，因此无论您是通过与</font></font><code class="option">-libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志</font><font style="vertical-align: inherit;">链接来构建常规客户端程序</font><font style="vertical-align: inherit;">，还是</font><font style="vertical-align: inherit;">通过与</font><font style="vertical-align: inherit;">标志</font><font style="vertical-align: inherit;">链接来构建
           </font><font style="vertical-align: inherit;">嵌入式服务器应用程序，都可以使用该功能</font></font><code class="option">-libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过调用初始化连接处理程序并通过调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接到服务器
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          发出SQL语句并处理它们的结果。</font><font style="vertical-align: inherit;">（以下讨论提供了有关如何执行此操作的更多信息。）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过调用关闭与MySQL服务器的连接
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-close" title="27.8.7.5 mysql_close（）"><code class="literal">mysql_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过调用最终使用MySQL客户端库
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      打电话的目的
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为提供MySQL客户端库提供恰当的初始化和结束。</font><font style="vertical-align: inherit;">对于与客户端库链接的应用程序，它们提供改进的内存管理。</font><font style="vertical-align: inherit;">如果你没有调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">则会
       </font><font style="vertical-align: inherit;">分配一块内存。</font><font style="vertical-align: inherit;">（这不会增加应用程序使用的内存量，但有些内存泄​​漏检测器会对此抱怨。）对于与嵌入式服务器链接的应用程序，这些调用会启动和停止服务器。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在非多线程环境中，调用
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会被忽略，因为</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会根据需要自动调用它。</font><font style="vertical-align: inherit;">但是，
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在多线程环境中不是线程安全的，因此也不是
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用的
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您必须</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在产生任何线程之前进行</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">，或者使用互斥锁来保护调用，无论是调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还是间接</font><font style="vertical-align: inherit;">调用
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这应该在任何其他客户端库调用之前完成。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要连接到服务器，请调用
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初始化连接处理程序，然后</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该处理程序（以及其他信息，例如主机名，用户名和密码）</font><font style="vertical-align: inherit;">进行调用
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">连接后，
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将
       </font></font><code class="literal">reconnect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志（</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构的</font><font style="vertical-align: inherit;">一部分
       </font><font style="vertical-align: inherit;">）设置为
       </font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API 5.0.3以前</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">版本</font><font style="vertical-align: inherit;">或
       </font><font style="vertical-align: inherit;">新版本中的值。</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此标志的</font><font style="vertical-align: inherit;">值
       </font><font style="vertical-align: inherit;">表示如果由于连接丢失而无法执行语句，则在放弃之前尝试重新连接到服务器。</font><font style="vertical-align: inherit;">您可以使用该
       </font></font><code class="literal">MYSQL_OPT_RECONNECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来控制重新连接行为。</font><font style="vertical-align: inherit;">完成连接后，请致电
      </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-close" title="27.8.7.5 mysql_close（）"><code class="literal">mysql_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 终止它。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      当连接处于活动状态时，客户端可以使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      或</font><font style="vertical-align: inherit;">将SQL语句发送到服务器</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">两者之间的区别在于
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">期望查询被指定为以空字符结尾的字符串，而
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">期望计数的字符串。</font><font style="vertical-align: inherit;">如果字符串包含二进制数据（可能包含空字节），则必须使用
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于每个非</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询（例如</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），你能找出多少行通过调用改变（受影响）
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询，您将检索选定的行作为结果集。</font><font style="vertical-align: inherit;">（请注意，某些语句是
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在样，他们返回行。这些措施包括</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show" title="13.7.5 SHOW语法"><code class="literal">SHOW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#describe" title="13.8.1 DESCRIBE语法"><code class="literal">DESCRIBE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。对待这些声明的方式相同</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的语句。）
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      客户端有两种处理结果集的方法。</font><font style="vertical-align: inherit;">一种方法是通过调用一次检索整个结果集
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该函数从服务器获取查询返回的所有行并将它们存储在客户端中。</font><font style="vertical-align: inherit;">第二种方式是让客户端通过调用来逐行启动结果集检索
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该函数初始化检索，但实际上并未从服务器获取任何行。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在这两种情况下，您都可以通过调用访问行
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">访问先前从服务器获取的行。</font><font style="vertical-align: inherit;">与
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实际上从服务器检索行。</font><font style="vertical-align: inherit;">有关每行数据大小的信息可通过调用获得
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-lengths" title="27.8.7.20 mysql_fetch_lengths（）"><code class="literal">mysql_fetch_lengths()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在完成结果集之后，调用
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">释放用于它的内存。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      这两种检索机制是互补的。</font><font style="vertical-align: inherit;">选择最适合每个客户端应用程序的方法。</font><font style="vertical-align: inherit;">在实践中，客户往往
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更常用。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      其优势
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在于，因为所有行都被提取到客户端，所以您不仅可以按顺序访问行，还可以使用结果集中的来回</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-data-seek" title="27.8.7.9 mysql_data_seek（）"><code class="literal">mysql_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      或</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-seek" title="27.8.7.62 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在结果集内更改当前行的位置。</font><font style="vertical-align: inherit;">你也可以通过调用找出有多少行
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">另一方面，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于大型结果集</font><font style="vertical-align: inherit;">，内存需求
       </font><font style="vertical-align: inherit;">可能非常高，并且您更可能遇到内存不足的情况。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      其优点</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      是客户端对结果集的内存要求较少，因为它一次只维护一行（因为分配开销较少，
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">速度可能更快）。</font><font style="vertical-align: inherit;">缺点是您必须快速处理每一行以避免捆绑服务器，您不能随机访问结果集中的行（您只能按顺序访问行），并且结果集中的行数是未知的，直到您已全部检索到它们。</font><font style="vertical-align: inherit;">此外，</font><font style="vertical-align: inherit;">
      即使您在检索过程中确定找到了您要查找的信息</font><font style="vertical-align: inherit;">，也</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索所有行。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      API使得客户端可以对语句作出适当的响应（仅在必要时检索行），而无需知道语句是否为</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">你可以</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在每个</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">之后</font><font style="vertical-align: inherit;">通过调用来
       </font><font style="vertical-align: inherit;">完成
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果结果集调用成功，则语句为a
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，您可以读取行。</font><font style="vertical-align: inherit;">如果结果集调用失败，请调用
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以确定结果是否实际上是预期的。</font><font style="vertical-align: inherit;">如果
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回零，声明没有返回数据（表明它是一个
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等），并没有返回行。</font><font style="vertical-align: inherit;">如果
      </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该语句应该返回行，但不是。</font><font style="vertical-align: inherit;">这表明该声明是
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">失败的。</font><font style="vertical-align: inherit;">有关</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何完成这一操作的示例，</font><font style="vertical-align: inherit;">请参阅说明
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      双方</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让你获得有关组成结果集（领域，他们的名字和类型的数量，等等）的字段的信息。</font><font style="vertical-align: inherit;">您可以通过</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      重复</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">，或通过调用行内的字段编号，在行内
       </font><font style="vertical-align: inherit;">依次访问字段信息</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field-direct" title="27.8.7.18 mysql_fetch_field_direct（）"><code class="literal">mysql_fetch_field_direct()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通过调用可以改变当前的字段光标位置
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-seek" title="27.8.7.23 mysql_field_seek（）"><code class="literal">mysql_field_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">设置字段光标会影响后续的呼叫
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您也可以通过呼叫一次获得所有字段的信息
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-fields" title="27.8.7.19 mysql_fetch_fields（）"><code class="literal">mysql_fetch_fields()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      为了检测和报告错误，MySQL通过</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">提供对错误信息的访问
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些会返回最近调用的函数的错误代码或错误消息，这些函数可以成功或失败，从而使您能够确定错误何时发生以及发生了什么。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7 C API函数描述</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.1 mysql_affected_rows（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-autocommit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.2 mysql_autocommit（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-change-user"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.3 mysql_change_user（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-character-set-name"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.4 mysql_character_set_name（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-close"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.5 mysql_close（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-commit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.6 mysql_commit（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.7 mysql_connect（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-create-db"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.8 mysql_create_db（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-data-seek"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.9 mysql_data_seek（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-debug"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.10 mysql_debug（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-drop-db"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.11 mysql_drop_db（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-dump-debug-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.12 mysql_dump_debug_info（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.13 mysql_eof（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.14 mysql_errno（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.15 mysql_error（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-escape-string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.16 mysql_escape_string（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.17 mysql_fetch_field（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field-direct"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.18 mysql_fetch_field_direct（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-fields"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.19 mysql_fetch_fields（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-lengths"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.20 mysql_fetch_lengths（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.21 mysql_fetch_row（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.22 mysql_field_count（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-seek"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.23 mysql_field_seek（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-tell"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.24 mysql_field_tell（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.25 mysql_free_result（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-character-set-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.26 mysql_get_character_set_info（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-client-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.27 mysql_get_client_info（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-client-version"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.28 mysql_get_client_version（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-host-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.29 mysql_get_host_info（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-option"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.30 mysql_get_option（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-proto-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.31 mysql_get_proto_info（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-server-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.32 mysql_get_server_info（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-server-version"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.33 mysql_get_server_version（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-ssl-cipher"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.34 mysql_get_ssl_cipher（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-hex-string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.35 mysql_hex_string（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-info"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.36 mysql_info（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.37 mysql_init（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.38 mysql_insert_id（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-kill"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.39 mysql_kill（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.40 mysql_library_end（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.41 mysql_library_init（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-dbs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.42 mysql_list_dbs（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-fields"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.43 mysql_list_fields（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-processes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.44 mysql_list_processes（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-tables"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.45 mysql_list_tables（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-more-results"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.46 mysql_more_results（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.47 mysql_next_result（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-fields"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.48 mysql_num_fields（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.49 mysql_num_rows（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.50 mysql_options（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.51 mysql_options4（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.52 mysql_ping（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.53 mysql_query（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.54 mysql_real_connect（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.55 mysql_real_escape_string（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.56 mysql_real_escape_string_quote（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.57 mysql_real_query（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-refresh"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.58 mysql_refresh（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-reload"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.59 mysql_reload（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-reset-connection"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.60 mysql_reset_connection（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-rollback"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.61 mysql_rollback（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-seek"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.62 mysql_row_seek（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-tell"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.63 mysql_row_tell（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-select-db"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.64 mysql_select_db（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.65 mysql_session_track_get_first（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-next"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.66 mysql_session_track_get_next（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-character-set"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.67 mysql_set_character_set（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-local-infile-default"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.68 mysql_set_local_infile_default（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-local-infile-handler"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.69 mysql_set_local_infile_handler（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-server-option"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.70 mysql_set_server_option（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-shutdown"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.71 mysql_shutdown（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.72 mysql_sqlstate（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.73 mysql_ssl_set（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stat"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.74 mysql_stat（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.75 mysql_store_result（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-id"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.76 mysql_thread_id（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.77 mysql_use_result（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-warning-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.78 mysql_warning_count（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在这里的描述中，</font><font style="vertical-align: inherit;">C编程语言意义上的</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手段</font><font style="vertical-align: inherit;">的参数或返回值
       </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不是MySQL </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      值。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      返回值的函数通常会返回一个指针或一个整数。</font><font style="vertical-align: inherit;">除非另有规定，否则返回指针的函数会返回一个非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值来指示成功或</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示错误</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值，而返回整数的函数会返回零来指示成功或非零来指示错误。</font><font style="vertical-align: inherit;">请注意，</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非零</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
      意味着这一点。</font><font style="vertical-align: inherit;">除非函数描述另有说明，否则不要针对零以外的值进行测试：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果（结果）/ *正确* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ...错误...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（结果&lt;0）/ *不正确* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ...错误...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（结果== -1）/ *不正确* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ...错误...</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      当一个函数返回一个错误时，</font><font style="vertical-align: inherit;">函数描述</font><font style="vertical-align: inherit;">的
       </font></font><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Errors</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子部分将列出可能的错误类型。</font><font style="vertical-align: inherit;">你可以通过调用找出其中哪些发生了
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通过调用可以获得错误的字符串表示形式
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-affected-rows"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.1 mysql_affected_rows（）</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140527961544080"></a><p>
        <code class="literal">my_ulonglong mysql_affected_rows(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-affected-rows-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会在用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or
           </font><font style="vertical-align: inherit;">执行语句后立即调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它返回改变，删除或插入的最后一条语句的行数，如果它是一个</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">陈述，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作品像</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，默认情况下受影响的行值是实际更改的行数。</font><font style="vertical-align: inherit;">如果您</font><font style="vertical-align: inherit;">在连接到</font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;">mysqld</font></strong></span></a><font style="vertical-align: inherit;">时</font><font style="vertical-align: inherit;">指定了
           </font></font><code class="literal">CLIENT_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志
           </font><font style="vertical-align: inherit;">，受影响的行值就是</font><span class="quote"><font style="vertical-align: inherit;">“ </font></span><span class="quote"><span class="quote"><font style="vertical-align: inherit;">找到</font></span></span><span class="quote"><font style="vertical-align: inherit;"> ”</font></span><font style="vertical-align: inherit;">的行数</font><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">即与该</font><font style="vertical-align: inherit;">条款</font><font style="vertical-align: inherit;">相匹配</font><font style="vertical-align: inherit;">。
        </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;"></font></strong></span></a><font style="vertical-align: inherit;"></font><span class="quote"><font style="vertical-align: inherit;"></font><span class="quote"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#replace" title="13.2.8 REPLACE语法"><code class="literal">REPLACE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，如果新行替换旧行，受影响的行值为2，因为在这种情况下，删除副本后插入了一行。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert-on-duplicate" title="13.2.5.2 INSERT ... ON DUPLICATE KEY UPDATE语法"><code class="literal">INSERT
          ... ON DUPLICATE KEY UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，如果行作为新行插入，则每行的受影响行值为1，如果更新现有行，则为2;如果现有行被设置为其当前值，则每次行值为0。</font><font style="vertical-align: inherit;">如果您指定
           </font></font><code class="literal">CLIENT_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志，如果现有行设置为其当前值，受影响的行值为1（而不是0）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储过程</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">之后</font><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回它将在过程中执行的最后一个语句返回的值，或者</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回该语句</font></font><code class="literal">-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在该过程中，您可以
           </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在SQL级别使用以获取单个语句的受影响行值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在MySQL 5.7中，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为更广泛的语句返回有意义的值。</font><font style="vertical-align: inherit;">有关详细信息，请参阅用于描述
           </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在
           </font></font><a class="xref" href="/mysql-5.7-google-zh/functions.html#information-functions" title="12.14信息功能"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.14节，“信息函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-affected-rows-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          大于零的整数表示受影响或检索的行数。</font><font style="vertical-align: inherit;">零表示没有记录被更新为一个</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          语句，没有行与</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">匹配，</font><font style="vertical-align: inherit;">或者没有查询尚未执行。</font><font style="vertical-align: inherit;">-1表示查询返回错误，或者对于</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在调用之前调用
           </font><font style="vertical-align: inherit;">该错误
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          因为</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个无符号值，所以可以通过比较返回值</font></font><code class="literal">(my_ulonglong)-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
           </font></font><code class="literal">(my_ulonglong)~0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等价于）</font><font style="vertical-align: inherit;">来检查-1 </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-affected-rows-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-affected-rows-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char * stmt =“更新产品SET成本=成本* 1.25</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              WHERE组= 10“;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的mysql_query（与MySQL，stmt）;第</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
printf（“％ld产品更新”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
       （long）mysql_affected_rows（＆mysql））;</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-autocommit"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.2 mysql_autocommit（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961491648"></a><p>
        <code class="literal">my_bool mysql_autocommit(MYSQL *mysql, my_bool
        mode)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-autocommit-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><code class="literal">mode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为1，则</font><font style="vertical-align: inherit;">设置自动提交模式</font><font style="vertical-align: inherit;">，如果</font></font><code class="literal">mode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为0 </font><font style="vertical-align: inherit;">，则设置</font><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">关闭</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-autocommit-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-autocommit-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-change-user"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.3 mysql_change_user（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961481840"></a><p>
        <code class="literal">my_bool mysql_change_user(MYSQL *mysql, const char
        *user, const char *password, const char *db)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-change-user-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          更改用户并使指定的数据库
           </font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成为指定的连接上的默认（当前）数据库</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在随后的查询中，此数据库是不包含显式数据库说明符的表引用的默认值。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-change-user" title="27.8.7.3 mysql_change_user（）"><code class="literal">mysql_change_user()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果连接的用户无法通过身份验证或无权使用数据库，则会失败。</font><font style="vertical-align: inherit;">在这种情况下，用户和数据库不会更改。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          传递一个</font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果你不想有一个默认的数据库。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个函数重置会话状态，就好像一个已经完成了一个新连接并重新认证一样。</font><font style="vertical-align: inherit;">（请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-auto-reconnect" title="27.8.20 C API自动重新连接控制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.20节“C API自动重新连接控制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。）它总是执行
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#commit" title="13.3.1 START TRANSACTION，COMMIT和ROLLBACK语法"><code class="literal">ROLLBACK</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任何活动事务，关闭并删除所有临时表，并解锁所有锁定的表。</font><font style="vertical-align: inherit;">会话系统变量被重置为相应全局系统变量的值。</font><font style="vertical-align: inherit;">准备好的语句被释放并且
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#handler" title="13.2.4 HANDLER语法"><code class="literal">HANDLER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量被关闭。</font><font style="vertical-align: inherit;">获得的锁</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          被释放。</font><font style="vertical-align: inherit;">即使用户没有改变，也会出现这些效果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要在不更改用户的情况下以更轻量级的方式重置连接状态，请使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-reset-connection" title="27.8.7.60 mysql_reset_connection（）"><code class="literal">mysql_reset_connection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-change-user-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-change-user-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您可以从中获得相同的信息
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以及：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_er_unknown_com_error"><code class="literal">ER_UNKNOWN_COM_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器不执行这个命令（可能是一个旧的服务器）。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_er_access_denied_error"><code class="literal">ER_ACCESS_DENIED_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用户或密码错误。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_er_bad_db_error"><code class="literal">ER_BAD_DB_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该数据库不存在。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_er_dbaccess_denied_error"><code class="literal">ER_DBACCESS_DENIED_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用户没有对数据库的访问权限。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_er_wrong_db_name"><code class="literal">ER_WRONG_DB_NAME</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              数据库名称太长。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-change-user-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果（mysql_change_user（＆mysql，“user”，“ </font></font><em class="replaceable"><code>password</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”，“new_database”））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   fprintf（stderr，“无法更改用户，错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_error（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-character-set-name"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.4 mysql_character_set_name（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961433056"></a><p>
        <code class="literal">const char *mysql_character_set_name(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-character-set-name-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回当前连接的默认字符集名称。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-character-set-name-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          默认的字符集名称
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-character-set-name-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-close"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.5 mysql_close（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961424608"></a><p>
        <code class="literal">void mysql_close(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-close-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          关闭以前打开的连接。
          </font><font style="vertical-align: inherit;">
          如果处理程序是由</font><font style="vertical-align: inherit;">or
           </font><font style="vertical-align: inherit;">自动</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-close" title="27.8.7.5 mysql_close（）"><code class="literal">mysql_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分配的，也会释放指向的连接处理</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">程序
           </font><font style="vertical-align: inherit;">。
</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect" title="27.8.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-close-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-close-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-commit"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.6 mysql_commit（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961411632"></a><p>
        <code class="literal">my_bool mysql_commit(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-commit-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          提交当前事务。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个函数的作用取决于</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">的值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">特别是，如果</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is
           </font></font><code class="literal">RELEASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或2）</font><font style="vertical-align: inherit;">的值
           </font><font style="vertical-align: inherit;">，服务器在终止事务并关闭客户端连接后执行释放。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-close" title="27.8.7.5 mysql_close（）"><code class="literal">mysql_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从客户端程序</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">关闭客户端的连接。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-commit-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-commit-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-connect"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.7 mysql_connect（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961397920"></a><p>
        <code class="literal">MYSQL *mysql_connect(MYSQL *mysql, const char *host,
        const char *user, const char *passwd)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-connect-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能已弃用。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">使用
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect" title="27.8.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试建立与运行于其上的MySQL数据库引擎的连接
           </font></font><code class="literal">host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect" title="27.8.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须先成功完成，然后才能执行任何其他API函数，除了
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-client-info" title="27.8.7.27 mysql_get_client_info（）"><code class="literal">mysql_get_client_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数的含义与相应的参数
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相同，但连接参数可能不同
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，C API会自动为连接结构分配内存，并在您调用时释放它</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-close" title="27.8.7.5 mysql_close（）"><code class="literal">mysql_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这种方法的缺点是，如果连接失败，则无法检索错误消息。</font><font style="vertical-align: inherit;">（为了得到错误信息</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，你必须提供一个有效的</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针。）
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-connect-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          同样
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-connect-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          同样
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-create-db"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.8 mysql_create_db（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961372816"></a><p>
        <code class="literal">int mysql_create_db(MYSQL *mysql, const char
        *db)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-create-db-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          创建由</font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数</font><font style="vertical-align: inherit;">命名的数据库</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能已弃用。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">使用
           </font><font style="vertical-align: inherit;">来发出SQL
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#create-database" title="13.1.11 CREATE DATABASE语法"><code class="literal">CREATE DATABASE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-create-db-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-create-db-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-create-db-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果（mysql_create_db（＆mysql，“my_database”））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   fprintf（stderr，“创建新数据库失败，错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_error（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-data-seek"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.9 mysql_data_seek（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961347760"></a><p>
        <code class="literal">void mysql_data_seek(MYSQL_RES *result, my_ulonglong
        offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-data-seek-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在查询结果集中搜索任意行。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是一个行号。</font><font style="vertical-align: inherit;">指定范围从</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">至
           </font><font style="vertical-align: inherit;">的值</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows(result)-1</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数要求结果集结构包含查询的整个结果，因此
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-data-seek" title="27.8.7.9 mysql_data_seek（）"><code class="literal">mysql_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能只能与结合使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不能与</font><font style="vertical-align: inherit;">结合
           </font><font style="vertical-align: inherit;">使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-data-seek-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-data-seek-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-debug"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.10 mysql_debug（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961332240"></a><p>
        <code class="literal">void mysql_debug(const char *debug)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-debug-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">DBUG_PUSH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用给定的字符串</font><font style="vertical-align: inherit;">
          做一个</font><font style="vertical-align: inherit;">。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-debug" title="27.8.7.10 mysql_debug（）"><code class="literal">mysql_debug()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Fred Fish调试库。</font><font style="vertical-align: inherit;">要使用此功能，您必须编译客户端库以支持调试。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/extending-mysql.html#dbug-package" title="28.5.3 DBUG包"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.5.3节“DBUG包”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-debug-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-debug-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-debug-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此处显示的调用会使客户端库</font></font><code class="filename">/tmp/client.trace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在客户端计算机上</font><font style="vertical-align: inherit;">生成一个跟踪文件</font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_DEBUG（ “d：吨：O，/ TMP / client.trace”）;
</font></font></pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-drop-db"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.11 mysql_drop_db（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961317696"></a><p>
        <code class="literal">int mysql_drop_db(MYSQL *mysql, const char
        *db)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-drop-db-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          删除由</font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数</font><font style="vertical-align: inherit;">命名的数据库</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能已弃用。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">使用
           </font><font style="vertical-align: inherit;">来发出SQL
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#drop-database" title="13.1.22 DROP DATABASE语法"><code class="literal">DROP DATABASE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-drop-db-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-drop-db-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-drop-db-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果（mysql_drop_db（＆mysql，“my_database”））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“无法删除数据库：错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          mysql_error（与MySQL））;</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-dump-debug-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.12 mysql_dump_debug_info（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961292624"></a><p>
        <code class="literal">int mysql_dump_debug_info(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-dump-debug-info-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指示服务器将调试信息写入错误日志。</font><font style="vertical-align: inherit;">连接的用户必须具有该
           </font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_super"><code class="literal">SUPER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特权。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-dump-debug-info-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-dump-debug-info-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-eof"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.13 mysql_eof（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961273072"></a><p>
        <code class="literal">my_bool mysql_eof(MYSQL_RES *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-eof-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能已弃用。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以用来代替。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 确定结果集的最后一行是否已被读取。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您从成功的调用中获取结果集
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则客户端会在一次操作中收到整个集合。</font><font style="vertical-align: inherit;">在这种情况下，</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">始终</font><font style="vertical-align: inherit;">返回
           </font><font style="vertical-align: inherit;">意味着已经达到结果集的结尾，并且不需要调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用时
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">总是返回true。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另一方面，如果您用于
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启动结果集检索，则在您</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重复</font><font style="vertical-align: inherit;">调用时，将从服务器中逐一获取结果集的行
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">由于在此过程中连接可能会发生错误，因此</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并不一定意味着结果集的末尾已正常到达。</font><font style="vertical-align: inherit;">在这种情况下，您可以使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来确定发生了什么。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果达到结果集的末尾，则返回一个非零值，如果发生错误，则返回零。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          历史上，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          早于标准的MySQL错误函数
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">由于这些错误函数提供了相同的信息，因此优先使用它们</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这已被弃用。</font><font style="vertical-align: inherit;">（事实上​​，它们提供了更多的信息，因为</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只返回一个布尔值，而错误函数表明出现错误的原因。）
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-eof-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">如果已达到结果集的末尾，则为非零值。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-eof-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-eof-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例显示了您可能如何使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-eof" title="27.8.7.13 mysql_eof（）"><code class="literal">mysql_eof()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_query（＆mysql，“SELECT * FROM some_table”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
result = mysql_use_result（＆mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
while（（row = mysql_fetch_row（result）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    //用数据做一些事情</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！mysql_eof（result））// mysql_fetch_row（）由于错误而失败</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误：％s \ n”，mysql_error（＆mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          但是，您可以使用标准的MySQL错误函数获得相同的效果：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_query（＆mysql，“SELECT * FROM some_table”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
result = mysql_use_result（＆mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
while（（row = mysql_fetch_row（result）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    //用数据做一些事情</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_errno（＆mysql））// mysql_fetch_row（）由于错误而失败</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误：％s \ n”，mysql_error（＆mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-errno"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.14 mysql_errno（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961230816"></a><p>
        <code class="literal">unsigned int mysql_errno(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-errno-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于由指定的连接</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回可能成功或失败的最近调用的API函数的错误代码。</font><font style="vertical-align: inherit;">返回值为零意味着没有错误发生。</font><font style="vertical-align: inherit;">客户端错误消息编号在MySQL </font></font><code class="filename">errmsg.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">头文件</font><font style="vertical-align: inherit;">中列出
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">服务器错误消息编号列在中
           </font></font><code class="filename">mysqld_error.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><a class="xref" href="/mysql-5.7-google-zh/error-handling.html" title="附录B错误，错误代码和常见问题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录B</font></font><i><font style="vertical-align: inherit;"></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中列出了
           </font><a class="xref" href="/mysql-5.7-google-zh/error-handling.html" title="附录B错误，错误代码和常见问题"><i><font style="vertical-align: inherit;">错误，错误，错误代码和常见问题</font></i></a><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            某些功能
             </font><font style="vertical-align: inherit;">如果成功</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则不设置
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">经验法则是所有必须向服务器请求信息重置的功能，
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果他们成功。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          由返回的</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLSTATE值不同
           </font><font style="vertical-align: inherit;">返回的MySQL特定的错误编号
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate" title="27.8.7.72 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行工具"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端程序使用以下格式显示错误，其中</font></font><code class="literal">1146</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值并且
           </font></font><code class="literal">'42S02'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是相应的
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate" title="27.8.7.72 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>SELECT * FROM no_such_table;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1146（42S02）：表'test.no_such_table'不存在</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-errno-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          上次</font><font style="vertical-align: inherit;">
          调用</font><font style="vertical-align: inherit;">的错误代码值
           </font><font style="vertical-align: inherit;">，如果失败。</font><font style="vertical-align: inherit;">零意味着没有错误发生。
</font></font><code class="literal">mysql_<em class="replaceable"><code>xxx</code></em>()</code><font style="vertical-align: inherit;"></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-errno-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-error"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.15 mysql_error（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961202368"></a><p>
        <code class="literal">const char *mysql_error(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-error-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于由指定的连接</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将返回一个以null结尾的字符串，其中包含最近调用失败的API函数的错误消息。</font><font style="vertical-align: inherit;">如果函数没有失败，则返回值
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能是前一个错误，或者是一个空字符串，表示没有错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          经验法则是所有必须向服务器请求信息重置的功能，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果他们成功。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于重置的函数，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用这两个测试中的任何一个来检查错误：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果（* mysql_error（MySQL的））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  //发生错误</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_error（与MySQL）[0]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  //发生错误</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          客户端错误消息的语言可以通过重新编译MySQL客户端库来更改。</font><font style="vertical-align: inherit;">您可以选择几种不同语言的错误消息。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/charset.html#error-message-language" title="10.11设置错误消息语言"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.11节“设置错误消息语言”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-error-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          描述错误的以空字符结尾的字符串。</font><font style="vertical-align: inherit;">如果没有发生错误，则为空字符串。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-error-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-escape-string"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.16 mysql_escape_string（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961184512"></a>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请勿使用此功能。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-escape-string" title="27.8.7.16 mysql_escape_string（）"><code class="literal">mysql_escape_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有使它能够尊重当前字符集或引用上下文的参数。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote" title="27.8.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          改为</font><font style="vertical-align: inherit;">使用
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-field"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.17 mysql_fetch_field（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961178800"></a><p>
        <code class="literal">MYSQL_FIELD *mysql_fetch_field(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以结构形式返回结果集的一列的定义
           </font></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">重复调用此函数以检索有关结果集中所有列的信息。
          </font><font style="vertical-align: inherit;">当没有更多字段离开时</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重置为每次执行新</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询</font><font style="vertical-align: inherit;">时返回有关第一个字段的信息</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">返回的字段
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也受到呼叫的影响
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-seek" title="27.8.7.23 mysql_field_seek（）"><code class="literal">mysql_field_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          了</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在表上</font><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">但尚未调用的
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数，那么如果您打电话</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">询问</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font><font style="vertical-align: inherit;">的长度</font><font style="vertical-align: inherit;">，则MySQL会返回默认的BLOB长度（8 KB）
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（因为MySQL不知道最大长度，因此选择8KB大小，</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这应该在某个时候进行配置。）一旦检索到结果集，
           </font></font><code class="literal">field-&gt;max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含特定查询中该列的最大值的长度。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前列</font><font style="vertical-align: inherit;">
          的</font><font style="vertical-align: inherit;">结构。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有列留下。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_FIELD *字段;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
while（（field = mysql_fetch_field（result）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“字段名称％s \ n”，字段 - &gt;名称）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-field-direct"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.18 mysql_fetch_field_direct（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961148976"></a><p>
        <code class="literal">MYSQL_FIELD *mysql_fetch_field_direct(MYSQL_RES
        *result, unsigned int fieldnr)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-direct-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定</font></font><code class="literal">fieldnr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集中某列</font><font style="vertical-align: inherit;">的字段编号</font><font style="vertical-align: inherit;">，将该列的字段定义作为</font></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构返回。</font><font style="vertical-align: inherit;">使用此函数检索任意列的定义。</font><font style="vertical-align: inherit;">指定</font></font><code class="literal">fieldnr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">范围从0到的值
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-fields" title="27.8.7.48 mysql_num_fields（）"><code class="literal">mysql_num_fields(result)-1</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-direct-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定列</font><font style="vertical-align: inherit;">
          的</font><font style="vertical-align: inherit;">结构。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-direct-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-field-direct-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unsigned int num_fields;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int i;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_FIELD *字段;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
num_fields = mysql_num_fields（result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
for（i = 0; i &lt;num_fields; i ++）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    field = mysql_fetch_field_direct（result，i）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“Field％u是％s \ n”，i，field-&gt; name）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-fields"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.19 mysql_fetch_fields（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961133472"></a><p>
        <code class="literal">MYSQL_FIELD *mysql_fetch_fields(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-fields-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果集</font><font style="vertical-align: inherit;">的所有</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的数组</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每个结构为结果集的一列提供字段定义。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-fields-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集的所有列</font><font style="vertical-align: inherit;">
          的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">数组</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-fields-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-fields-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unsigned int num_fields;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int i;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_FIELD *字段;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
num_fields = mysql_num_fields（result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fields = mysql_fetch_fields（result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
for（i = 0; i &lt;num_fields; i ++）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   printf（“Field％u是％s \ n”，i，fields [i] .name）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-lengths"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.20 mysql_fetch_lengths（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961121008"></a><p>
        <code class="literal">unsigned long *mysql_fetch_lengths(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-lengths-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回结果集中当前行的列的长度。</font><font style="vertical-align: inherit;">如果您打算复制字段值，则此长度信息对于优化也很有用，因为您可以避免调用</font></font><code class="literal">strlen()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">另外，如果结果集包含二进制数据，则
           </font></font><span class="bold"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font></strong></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用此函数来确定数据的大小，因为
           </font></font><code class="literal">strlen()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于包含空字符的任何字段都会返回不正确的结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          空列和包含</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值的</font><font style="vertical-align: inherit;">列的长度
           </font><font style="vertical-align: inherit;">为零。</font><font style="vertical-align: inherit;">要了解如何区分这两种情况，请参阅说明
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-lengths-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示每列大小（不包括任何终止空字节）的无符号长整型数组。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-lengths-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-lengths" title="27.8.7.20 mysql_fetch_lengths（）"><code class="literal">mysql_fetch_lengths()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅对结果集的当前行有效。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果在调用之前</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或在检索结果中的所有行之后</font><font style="vertical-align: inherit;">调用它，
           </font><font style="vertical-align: inherit;">它会返回
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-lengths-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_ROW行;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无符号长*长;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int num_fields;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int i;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
row = mysql_fetch_row（result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（排）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    num_fields = mysql_num_fields（result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    长度= mysql_fetch_lengths（结果）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for（i = 0; i &lt;num_fields; i ++）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
         printf（“列％u是％lu字节的长度。\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                我，长度[我]）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-fetch-row"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.21 mysql_fetch_row（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961100704"></a><p>
        <code class="literal">MYSQL_ROW mysql_fetch_row(MYSQL_RES *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检索结果集的下一行。</font><font style="vertical-align: inherit;">当使用后
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时，有没有更多的行检索。</font><font style="vertical-align: inherit;">当使用后
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时，有没有要检索的行或出现了错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行中值的数量由下式给出
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-fields" title="27.8.7.48 mysql_num_fields（）"><code class="literal">mysql_num_fields(result)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
           </font></font><code class="literal">row</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">持有从调用的返回值
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，指针的值作为访问</font></font><code class="literal">row[0]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到
           </font></font><code class="literal">row[mysql_num_fields(result)-1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行中的值由
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针指示。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行中的字段值的长度可以通过调用获得</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-lengths" title="27.8.7.20 mysql_fetch_lengths（）"><code class="literal">mysql_fetch_lengths()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">包含</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          两者的</font><font style="vertical-align: inherit;">空字段和字段的</font><font style="vertical-align: inherit;">长度为0; </font><font style="vertical-align: inherit;">你可以通过检查字段值的指针来区分它们。</font><font style="vertical-align: inherit;">如果指针是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该字段是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">否则，该字段为空。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一</font></font><code class="literal">MYSQL_ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一行结构。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有更多的行要检索或发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          错误不会在调用之间重置
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-fetch-row-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_ROW行;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int num_fields;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int i;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
num_fields = mysql_num_fields（result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
while（（row = mysql_fetch_row（result）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   无符号长*长;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   长度= mysql_fetch_lengths（结果）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   for（i = 0; i &lt;num_fields; i ++）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
       printf（“[％。* s]”，（int）长度[i]，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              行[i]？</font><font style="vertical-align: inherit;">row [i]：“NULL”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   的printf（ “\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-field-count"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.22 mysql_field_count（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961064528"></a><p>
        <code class="literal">unsigned int mysql_field_count(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-field-count-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回连接上最近一次查询的列数。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个函数的正常使用是在
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回的时候
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（因此你没有结果集指针）。</font><font style="vertical-align: inherit;">在这种情况下，您可以调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以确定是否
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该产生非空结果。</font><font style="vertical-align: inherit;">这使得客户端程序能够在不知道查询是否是</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
           </font><font style="vertical-align: inherit;">类似</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的）语句的</font><font style="vertical-align: inherit;">情况下采取适当的行动</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这里显示的例子说明了如何做到这一点。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#null-mysql-store-result" title="27.8.21.1为什么mysql_store_result（）有时在mysql_query（）返回成功后返回NULL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.21.1节“为什么在mysql_query（）返回成功后mysql_store_result（）有时返回NULL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-count-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示结果集中列数的无符号整数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-count-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-count-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_RES *结果;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int num_fields;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int num_rows;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_query（＆mysql，query_string））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    //错误</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
否则//查询成功，处理它返回的任何数据</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    result = mysql_store_result（＆mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    如果（结果）//有行</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        num_fields = mysql_num_fields（result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        //检索行，然后调用mysql_free_result（result）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    else // mysql_store_result（）什么都不返回; </font><font style="vertical-align: inherit;">它应该有吗？</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果（mysql_field_count（＆mysql）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            //查询不返回数据</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            //（它不是一个SELECT）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            num_rows = mysql_affected_rows（＆mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        否则// mysql_store_result（）应该返回数据</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            fprintf（stderr，“错误：％s \ n”，mysql_error（＆mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另一种方法是用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count(&amp;mysql)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          呼叫</font><font style="vertical-align: inherit;">替换
           </font><font style="vertical-align: inherit;">呼叫
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno(&amp;mysql)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，您直接检查错误，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据语句是否为a </font><font style="vertical-align: inherit;">的值来推断
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-field-seek"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.23 mysql_field_seek（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961036592"></a><p>
        <code class="literal">MYSQL_FIELD_OFFSET mysql_field_seek(MYSQL_RES *result,
        MYSQL_FIELD_OFFSET offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-field-seek-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将字段光标设置为给定的偏移量。</font><font style="vertical-align: inherit;">下一次调用来
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索与该偏移量关联的列的字段定义。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要寻找一行的开始，传递一个
           </font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">零值。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-seek-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字段光标的前一个值。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-seek-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-field-tell"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.24 mysql_field_tell（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961025600"></a><p>
        <code class="literal">MYSQL_FIELD_OFFSET mysql_field_tell(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-field-tell-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回用于最后一个的字段光标的位置
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值可以用作参数
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-seek" title="27.8.7.23 mysql_field_seek（）"><code class="literal">mysql_field_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-tell-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          字段光标的当前偏移量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-field-tell-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-free-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.25 mysql_free_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961014512"></a><p>
        <code class="literal">void mysql_free_result(MYSQL_RES *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-free-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          释放分配用于通过设置造成的内存
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-dbs" title="27.8.7.42 mysql_list_dbs（）"><code class="literal">mysql_list_dbs()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等。</font><font style="vertical-align: inherit;">当您完成结果集时，您必须通过调用释放它使用的内存
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          释放后不要尝试访问结果集。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-free-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-free-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-character-set-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.26 mysql_get_character_set_info（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527961000400"></a><p>
        <code class="literal">void mysql_get_character_set_info(MYSQL *mysql,
        MY_CHARSET_INFO *cs)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-character-set-info-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能提供有关默认客户端字符集的信息。</font><font style="vertical-align: inherit;">默认字符集可能会随</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-character-set" title="27.8.7.67 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          功能</font><font style="vertical-align: inherit;">而改变</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-character-set-info-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此示例显示</font></font><code class="literal">MY_CHARSET_INFO</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">中可用的字段
           </font><font style="vertical-align: inherit;">：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果（！mysql_set_character_set（＆mysql，“utf8”））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MY_CHARSET_INFO cs;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    mysql_get_character_set_info（＆mysql，＆cs）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“字符集信息：\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“字符集+整理号码：％d \ n”，cs.number）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“字符集名称：％s \ n”，cs.name）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“整理名称：％s \ n”，cs.csname）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“comment：％s \ n”，cs.comment）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“目录：％s \ n”，cs.dir）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“多字节字符最小长度：％d \ n”，cs.mbminlen）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“多字节字符最大长度：％d \ n”，cs.mbmax​​len）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-client-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.27 mysql_get_client_info（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960989088"></a><p>
        <code class="literal">const char *mysql_get_client_info(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-client-info-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个表示MySQL客户端库版本的字符串; </font><font style="vertical-align: inherit;">例如</font></font><code class="literal">"5.7.23"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数值是提供客户端库的MySQL或Connector / C的版本。</font><font style="vertical-align: inherit;">有关更多信息，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-server-client-versions" title="27.8.4.5 C API服务器和客户端库版本"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.4.5节“C API服务器和客户端库版本”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-client-info-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示MySQL客户端库版本的字符串。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-client-info-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-client-version"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.28 mysql_get_client_version（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960978432"></a><p>
        <code class="literal">unsigned long mysql_get_client_version(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-client-version-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个表示MySQL客户端库版本的整数。</font><font style="vertical-align: inherit;">该值的格式</font></font><code class="literal">XYYZZ</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          ，其中</font></font><code class="literal">X</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是主要版本，
           </font></font><code class="literal">YY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是发行级别（或次要版本），并且</font></font><code class="literal">ZZ</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是发行级别内的子版本：
        </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">major_version * 10000 + release_level * 100 + sub_version
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例如，</font></font><code class="literal">"5.7.23"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回为</font></font><code class="literal">50723</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数值是提供客户端库的MySQL或Connector / C的版本。</font><font style="vertical-align: inherit;">有关更多信息，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-server-client-versions" title="27.8.4.5 C API服务器和客户端库版本"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.4.5节“C API服务器和客户端库版本”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-client-version-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个表示MySQL客户端库版本的整数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-client-version-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-host-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.29 mysql_get_host_info（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960962656"></a><p>
        <code class="literal">const char *mysql_get_host_info(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-host-info-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回描述正在使用的连接类型的字符串，包括服务器主机名。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-host-info-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示服务器主机名和连接类型的字符串。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-host-info-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-option"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.30 mysql_get_option（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960953968"></a><p>
        <code class="literal">int mysql_get_option(MYSQL *mysql, enum mysql_option
        option, const void *arg)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-option-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回使用可设置选项的当前值
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值应该被视为只读。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">论点是你想要它的价值的选项。</font><font style="vertical-align: inherit;">所述</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是一个指向一个变量在其中存储该选项值。
          </font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是一个指向适合</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">的类型变量的指针</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">下表显示了每个</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">使用哪种变量类型
           </font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="informaltable">
<table summary="Options for mysql_get_option()."><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr>
              <th scope="col"><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 类型</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适用的</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">价值</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">unsigned int</code></td>
              <td><code class="literal">MYSQL_OPT_CONNECT_TIMEOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_PROTOCOL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_READ_TIMEOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_RETRY_COUNT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                </font></font><code class="literal">MYSQL_OPT_WRITE_TIMEOUT</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned long</code></td>
              <td><code class="literal">MYSQL_OPT_MAX_ALLOWED_PACKET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                </font></font><code class="literal">MYSQL_OPT_NET_BUFFER_LENGTH</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">my_bool</code></td>
              <td><code class="literal">MYSQL_ENABLE_CLEARTEXT_PLUGIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_CAN_HANDLE_EXPIRED_PASSWORDS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_COMPRESS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_GUESS_CONNECTION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_LOCAL_INFILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_RECONNECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_ENFORCE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_VERIFY_SERVER_CERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_USE_EMBEDDED_CONNECTION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_USE_REMOTE_CONNECTION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_REPORT_DATA_TRUNCATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                </font></font><code class="literal">MYSQL_SECURE_AUTH</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">const char *</code></td>
              <td><code class="literal">MYSQL_DEFAULT_AUTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_CAPATH </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_CERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_CIPHER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_CRL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_CRLPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_SSL_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_TLS_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_READ_DEFAULT_FILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_READ_DEFAULT_GROUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_SERVER_PUBLIC_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_SET_CHARSET_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_SET_CHARSET_NAME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_SET_CLIENT_IP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                </font></font><code class="literal">MYSQL_SHARED_MEMORY_BASE_NAME</code></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能被查询（返回错误）</font></font></td>
              <td><code class="literal">MYSQL_INIT_COMMAND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_CONNECT_ATTR_DELETE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                 </font></font><code class="literal">MYSQL_OPT_CONNECT_ATTR_RESET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
                </font></font><code class="literal">MYSQL_OPT_NAMED_PIPE</code></td>
</tr></tbody></table>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-option-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零如果发生错误; </font><font style="vertical-align: inherit;">这发生在</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无法查询的值上。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-option-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下呼叫测试该
           </font></font><code class="literal">MYSQL_OPT_RECONNECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项。</font><font style="vertical-align: inherit;">调用成功返回后，值为
           </font></font><code class="literal">reconnect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true或false表示是否启用自动重新连接。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">my_bool重新连接;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_get_option（mysql，MYSQL_OPT_RECONNECT，＆reconnect））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_get_options（）失败\ n”）;</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-proto-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.31 mysql_get_proto_info（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960886992"></a><p>
        <code class="literal">unsigned int mysql_get_proto_info(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-proto-info-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回当前连接使用的协议版本。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-proto-info-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示当前连接使用的协议版本的无符号整数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-proto-info-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-server-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.32 mysql_get_server_info（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960878512"></a><p>
        <code class="literal">const char *mysql_get_server_info(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-server-info-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个表示MySQL服务器版本的字符串; </font><font style="vertical-align: inherit;">例如</font></font><code class="literal">"5.7.23"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-server-info-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示MySQL服务器版本的字符串。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-server-info-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-server-version"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.33 mysql_get_server_version（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960869120"></a><p>
        <code class="literal">unsigned long mysql_get_server_version(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-server-version-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个表示MySQL服务器版本的整数。</font><font style="vertical-align: inherit;">该值的格式</font></font><code class="literal">XYYZZ</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中
           </font></font><code class="literal">X</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是主要版本，
           </font></font><code class="literal">YY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是发行级别（或次要版本），并且</font></font><code class="literal">ZZ</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是发行级别内的子版本：
        </font></font></p><pre data-lang="simple" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">major_version * 10000 + release_level * 100 + sub_version
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          例如，</font></font><code class="literal">"5.7.23"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回为</font></font><code class="literal">50723</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能在客户端程序中用于确定是否存在某些特定于版本的服务器功能。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-server-version-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个表示MySQL服务器版本的整数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-server-version-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-get-ssl-cipher"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.34 mysql_get_ssl_cipher（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960854192"></a><p>
        <code class="literal">const char *mysql_get_ssl_cipher(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-get-ssl-cipher-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-ssl-cipher" title="27.8.7.34 mysql_get_ssl_cipher（）"><code class="literal">mysql_get_ssl_cipher()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将用于给定连接的加密密码返回给服务器。</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是从中返回的连接处理程序</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-get-ssl-cipher-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个字符串，用于命名用于连接的加密密码，或者</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接未加密。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-hex-string"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.35 mysql_hex_string（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960843328"></a><p>
        <code class="literal">unsigned long mysql_hex_string(char *to, const char
        *from, unsigned long length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-hex-string-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该函数创建用于SQL语句的合法SQL字符串。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/language-structure.html#string-literals" title="9.1.1字符串文字"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9.1.1节“字符串文字”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"></font><code class="literal">from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数中</font><font style="vertical-align: inherit;">
          的字符串以</font><font style="vertical-align: inherit;">十六进制格式编码，每个字符编码为两个十六进制数字。</font><font style="vertical-align: inherit;">结果放置在
           </font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数中，后面跟着一个终止空字节。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向的字符串</font></font><code class="literal">from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是
           </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节长。</font><font style="vertical-align: inherit;">您必须将</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓冲区</font><font style="vertical-align: inherit;">分配
           </font><font style="vertical-align: inherit;">为至少
           </font></font><code class="literal">length*2+1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节长。</font><font style="vertical-align: inherit;">当
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-hex-string" title="27.8.7.35 mysql_hex_string（）"><code class="literal">mysql_hex_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回时，内容</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是空结尾的字符串。</font><font style="vertical-align: inherit;">返回值是编码字符串的长度，不包括终止空字节。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值可以使用</font><font style="vertical-align: inherit;">
          或</font><font style="vertical-align: inherit;">
          格式</font><font style="vertical-align: inherit;">放置到SQL语句中</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，返回值不包括
           </font><font style="vertical-align: inherit;">or </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">来电者必须提供所需的那些。
</font></font><code class="literal">X'<em class="replaceable"><code>value</code></em>'</code><font style="vertical-align: inherit;"></font><code class="literal">0x<em class="replaceable"><code>value</code></em></code><font style="vertical-align: inherit;"></font><code class="literal">X'...'</code><font style="vertical-align: inherit;"></font><code class="literal">0x</code><font style="vertical-align: inherit;"></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-hex-string-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char查询[1000]，*结束;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = strmov（query，“INSERT INTO test_table values（”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = strmov（end，“X'”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结束+ = mysql_hex_string（结束，“这是什么”，12）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = strmov（end，“'，X'”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结束+ = mysql_hex_string（结束，“二进制数据：\ 0 \ r \ n”，16）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = strmov（end，“'）”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_real_query（＆mysql，query，（unsigned int）（end  -  query）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   fprintf（stderr，“无法插入行，错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_error（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">strmov()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例中使用</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">函数包含在</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库中，其工作原理与此类似，</font></font><code class="literal">strcpy()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但会返回指向第一个参数的终止null的指针。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-hex-string-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          放入的编码字符串的长度
           </font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，不包括终止空字符。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-hex-string-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.36 mysql_info（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960816384"></a><p>
        <code class="literal">const char *mysql_info(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-info-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检索一个字符串，提供有关最近执行的语句的信息，但仅限于此处列出的语句。</font><font style="vertical-align: inherit;">对于其他声明，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-info" title="27.8.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如此处所述，字符串的格式根据语句的类型而有所不同。</font><font style="vertical-align: inherit;">这些数字只是说明性的; </font><font style="vertical-align: inherit;">该字符串包含适合该语句的值。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT语法"><code class="literal">INSERT INTO
              ... SELECT ...</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              字符串格式： </font></font><code class="literal">Records: 100 Duplicates: 0
              Warnings: 0</code>
            </p></li><li class="listitem"><p>
              <code class="literal">INSERT INTO ... VALUES
              (...),(...),(...)...</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              字符串格式： </font></font><code class="literal">Records: 3 Duplicates: 0 Warnings:
              0</code>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA
              INFILE ...</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              字符串格式： </font></font><code class="literal">Records: 1 Deleted: 0 Skipped: 0
              Warnings: 0</code>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#alter-table" title="13.1.8 ALTER TABLE语法"><code class="literal">ALTER TABLE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              字符串格式： </font></font><code class="literal">Records: 3 Duplicates: 0 Warnings:
              0</code>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              字符串格式： </font></font><code class="literal">Rows matched: 40 Changed: 40
              Warnings: 0</code>
</p></li></ul>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-info" title="27.8.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅为该语句的多行表单</font><font style="vertical-align: inherit;">返回一个非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT ...
          VALUES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（也就是说，仅当指定了多个值列表时）。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-info-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示有关最近执行的语句的附加信息的字符串。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果没有信息可用于该陈述。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-info-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-init"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.37 mysql_init（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960785536"></a><p>
        <code class="literal">MYSQL *mysql_init(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-init-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          分配或初始化一个</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适合</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">对象
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
           </font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针，函数将分配，初始化并返回一个新对象。</font><font style="vertical-align: inherit;">否则，对象被初始化并返回对象的地址。</font><font style="vertical-align: inherit;">如果
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分配一个新对象，则在</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-close" title="27.8.7.5 mysql_close（）"><code class="literal">mysql_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用关闭连接</font><font style="vertical-align: inherit;">时释放它
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在非多线程环境中，
           </font><font style="vertical-align: inherit;">
          根据需要自动</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在多线程环境中不是线程安全的，因此也不是</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在调用之前</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在产生任何线程</font><font style="vertical-align: inherit;">之前调用</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">或者使用互斥锁来保护
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用。</font><font style="vertical-align: inherit;">这应该在任何其他客户端库调用之前完成。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-init-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          初始化的</font></font><code class="literal">MYSQL*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理程序。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果内存不足以分配新对象。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-init-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果内存不足，</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则返回。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-insert-id"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.38 mysql_insert_id（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960759504"></a><p>
        <code class="literal">my_ulonglong mysql_insert_id(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-insert-id-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前一个</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">列
           </font><font style="vertical-align: inherit;">生成的值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font><font style="vertical-align: inherit;">的表格中</font><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">，或者使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置了列值
           </font><font style="vertical-align: inherit;">后，使用此函数
           </font><font style="vertical-align: inherit;">。
        </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非在下列条件之一下明确更新，否则</font><font style="vertical-align: inherit;">
          返回值
           </font><font style="vertical-align: inherit;">始终为零：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将值存储到</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              列中的</font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这是真实的是否值由存储的特殊值自动生成
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入列，或者是显式非特殊值。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在多行</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">的情况下
               </font><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功插入</font><font style="vertical-align: inherit;">的第一个自动生成的
               </font><font style="vertical-align: inherit;">值。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果未成功插入行，则
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回0。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果一个
               </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT语法"><code class="literal">INSERT ...
              SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句被执行，并且没有自动生成的值被成功插入，则
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回最后插入的行的ID。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果一个
               </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT语法"><code class="literal">INSERT ...
              SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句使用
               </font><font style="vertical-align: inherit;">，
               </font><font style="vertical-align: inherit;">返回
               </font><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过插入</font><font style="vertical-align: inherit;">
              任何列或更新任何列来
               </font><font style="vertical-align: inherit;">生成</font><font style="vertical-align: inherit;">值的
               </font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果前面的语句返回错误，则值
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是未定义的。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以简化为以下顺序：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果有一</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列，并且自动生成的值已成功插入，则返回第一个此类值。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果
               </font><font style="vertical-align: inherit;">
              在语句中发生</font><font style="vertical-align: inherit;">，即使</font><font style="vertical-align: inherit;">在受影响的表中</font><font style="vertical-align: inherit;">有一</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">，也要
               </font><font style="vertical-align: inherit;">返回
               </font><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a><font style="vertical-align: inherit;"></font><em class="replaceable"><code>expr</code></em><font style="vertical-align: inherit;"></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              返回值取决于所使用的语句。</font><font style="vertical-align: inherit;">在</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              声明</font><font style="vertical-align: inherit;">后调用时</font><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果表中有一</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  列，并且</font><font style="vertical-align: inherit;">该</font><font style="vertical-align: inherit;">列中有一些显式值已成功插入表中，则返回最后一个显式值。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert-on-duplicate" title="13.2.5.2 INSERT ... ON DUPLICATE KEY UPDATE语法"><code class="literal">INSERT
              ... ON DUPLICATE KEY UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font><font style="vertical-align: inherit;">后调用时
               </font><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果表中有一</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  列，并且有一些显式的成功插入值或一些更新值，则返回最后一个插入或更新的值。
</font></font></p></li></ul>
</div>
</li></ol>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果前面的语句未使用的
           </font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">价值。</font><font style="vertical-align: inherit;">如果您需要稍后保存该值，请务必</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在生成值的语句后立即</font><font style="vertical-align: inherit;">调用
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          仅受当前客户端连接中发布的语句影响。</font><font style="vertical-align: inherit;">它不受其他客户发表的声明影响。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL函数将包含被成功地插入该第一自动生成的值的值。
          </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在语句之间不重置，因为该函数的值在服务器中保留。</font><font style="vertical-align: inherit;">另一个区别
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是，</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您将</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列设置为特定的非特定值</font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">则不会更新</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/functions.html#information-functions" title="12.14信息功能"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.14节“信息功能”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在生成</font><font style="vertical-align: inherit;">
          值</font><font style="vertical-align: inherit;">的存储过程</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句后</font><font style="vertical-align: inherit;">返回
           </font><font style="vertical-align: inherit;">，</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为在这种情况下
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">于过程中的语句</font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">而不是过程中的语句。</font><font style="vertical-align: inherit;">在该过程中，您可以使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL级别来获取该</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          之所以之间的差异
           </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
           </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由易在脚本中使用，同时
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">试图提供什么发生了更准确的信息
           </font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">栏。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-insert-id-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在前面的讨论中描述。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-insert-id-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_er_auto_increment_conflict"><code class="literal">ER_AUTO_INCREMENT_CONFLICT</code></a>
            </p><p><font style="vertical-align: inherit;"></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中</font><font style="vertical-align: inherit;">
              用户指定的</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">落在当前</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值与当前行数和受影响行数的总和</font><font style="vertical-align: inherit;">之间的范围内
               </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-kill"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.39 mysql_kill（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960662032"></a><p>
        <code class="literal">int mysql_kill(MYSQL *mysql, unsigned long
        pid)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-kill-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 5.7.11开始，</font></font><code class="literal">mysql_kill()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已被弃用，并将在未来版本的MySQL中删除。</font><font style="vertical-align: inherit;">相反，使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            执行</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#kill" title="13.7.6.4 KILL语法"><code class="literal">KILL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请求服务器终止由指定的线程
           </font></font><code class="literal">pid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能已弃用。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">使用
           </font><font style="vertical-align: inherit;">来发出SQL
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#kill" title="13.7.6.4 KILL语法"><code class="literal">KILL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-kill" title="27.8.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 无法处理大于32位的值，但为防止在这些情况下杀死错误的线程会返回错误：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果给定的ID大于32位，则
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-kill" title="27.8.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
               </font></font><a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_invalid_conn_handle"><code class="literal">CR_INVALID_CONN_HANDLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在服务器的内部线程ID计数器达到大于32位的值后，它将</font></font><a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_er_data_out_of_range"><code class="literal">ER_DATA_OUT_OF_RANGE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为任何</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-kill" title="27.8.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              调用</font><font style="vertical-align: inherit;">返回
               </font><font style="vertical-align: inherit;">错误</font><font style="vertical-align: inherit;">并
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-kill" title="27.8.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">失败。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-kill-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-kill-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_invalid_conn_handle"><code class="literal">CR_INVALID_CONN_HANDLE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该值</font></font><code class="literal">pid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大于32位。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_er_data_out_of_range"><code class="literal">ER_DATA_OUT_OF_RANGE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              服务器的内部线程ID计数器已达到大于32位的值，此时拒绝所有
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-kill" title="27.8.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-library-end"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.40 mysql_library_end（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960618656"></a><p>
        <code class="literal">void mysql_library_end(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-library-end-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个函数完成了MySQL库。</font><font style="vertical-align: inherit;">在完成使用库时调用它（例如，从服务器断开连接后）。</font><font style="vertical-align: inherit;">调用所采取的行动取决于您的应用程序是否链接到MySQL客户端库或MySQL嵌入式服务器库。</font><font style="vertical-align: inherit;">对于</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过使用</font></font><code class="option">-lmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志</font><font style="vertical-align: inherit;">链接</font><font style="vertical-align: inherit;">库</font><font style="vertical-align: inherit;">的客户端程序</font><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行一些内存管理来清理。</font><font style="vertical-align: inherit;">对于</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过使用</font></font><code class="option">-lmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志</font><font style="vertical-align: inherit;">链接</font><font style="vertical-align: inherit;">库</font><font style="vertical-align: inherit;">的嵌入式服务器应用程序</font><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关闭嵌入式服务器，然后清理。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            为避免在使用该库完成应用程序后发生内存泄漏（例如，在关闭与服务器的连接之后），请确保</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            显式</font><font style="vertical-align: inherit;">调用
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这使得执行内存管理来清理和释放库使用的资源。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关使用信息，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-function-overview" title="27.8.6 C API函数概述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.6节“C API函数概述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.41节“mysql_library_init（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-library-init"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.41 mysql_library_init（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960604112"></a><p>
        <code class="literal">int mysql_library_init(int argc, char **argv, char
        **groups)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-library-init-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用任何其他MySQL函数之前调用此函数来初始化MySQL客户端库，无论您的应用程序是常规客户端程序还是使用嵌入式服务器。</font><font style="vertical-align: inherit;">如果应用程序使用嵌入式服务器，此调用启动服务器，并初始化任何子系统（</font></font><code class="literal">mysys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">InnoDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等）服务器使用。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            为避免在使用该库完成应用程序后发生内存泄漏（例如，在关闭与服务器的连接之后），请确保</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            显式</font><font style="vertical-align: inherit;">调用
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这使得执行内存管理来清理和释放库使用的资源。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.40节“mysql_library_end（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          应用程序作为普通客户端还是使用嵌入式服务器的选择取决于您是</font><font style="vertical-align: inherit;">在链接时</font><font style="vertical-align: inherit;">使用该</font><font style="vertical-align: inherit;">库</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还是
           </font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库来生成最终的可执行文件。</font><font style="vertical-align: inherit;">有关更多信息，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-function-overview" title="27.8.6 C API函数概述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.6节“C API函数概述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在非多线程环境中，调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会被忽略，因为</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          会根据需要自动调用它。</font><font style="vertical-align: inherit;">但是，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在多线程环境中不是线程安全的，因此也不是</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用的
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您必须</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在产生任何线程之前进行</font><font style="vertical-align: inherit;">调用
           </font><font style="vertical-align: inherit;">，或者使用互斥锁来保护调用，无论是调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还是间接
           </font><font style="vertical-align: inherit;">调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在任何其他客户端库调用之前执行此操作。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><code class="literal">argc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">argv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数是类似于参数
           </font></font><code class="literal">main()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并启用选项对嵌入式服务器的传球。</font><font style="vertical-align: inherit;">为了方便起见，</font><font style="vertical-align: inherit;">如果没有服务器的命令行参数</font><font style="vertical-align: inherit;">，</font></font><code class="literal">argc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以是</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（零）。</font><font style="vertical-align: inherit;">对于仅作为普通（非嵌入式）客户端使用的应用程序而言，这种情况通常是这种情况，通常情况下这种调用会写为
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init(0, NULL,
          NULL)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include &lt;mysql.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;stdlib.h&gt;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int main（void）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（mysql_library_init（0，NULL，NULL））{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“无法初始化MySQL客户端库\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *在这里使用任何MySQL API函数* /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_library_end（）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  返回EXIT_SUCCESS;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当传递参数（</font></font><code class="literal">argc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大于</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时，</font></font><code class="literal">argv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">忽略</font><font style="vertical-align: inherit;">第一个元素
           </font><font style="vertical-align: inherit;">（通常包含程序名）。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制作参数的副本，因此可以安全销毁
           </font></font><code class="literal">argv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">groups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在通话之后。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于嵌入式应用程序，如果要在不启动嵌入式服务器的情况下连接到外部服务器，则必须为其指定一个负值</font></font><code class="literal">argc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">groups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">论点是，指示从中读取选项选项文件组字符串数组。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#option-files" title="4.2.6使用选项文件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.2.6节“使用选项文件”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在数组中进行最后的输入</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">为了方便起见，如果</font></font><code class="literal">groups</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数本身是
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则</font><font style="vertical-align: inherit;">默认使用</font></font><code class="literal">[server]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">[embedded]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include &lt;mysql.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;stdlib.h&gt;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静态char * server_args [] = {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “this_program”，/ *这个字符串没有被使用* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “--datadir =”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “--key_buffer_size = 32M”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
};</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静态字符* server_groups [] = {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “嵌入式”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “服务器”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “this_program_SERVER”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  （char *）NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
};</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int main（void）{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（mysql_library_init（sizeof（server_args）/ sizeof（char *））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                        server_args，server_groups））{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“无法初始化MySQL客户端库\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *在这里使用任何MySQL API函数* /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_library_end（）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  返回EXIT_SUCCESS;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-library-init-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-list-dbs"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.42 mysql_list_dbs（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960557408"></a><p>
        <code class="literal">MYSQL_RES *mysql_list_dbs(MYSQL *mysql, const char
        *wild)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-list-dbs-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回由服务器上的数据库名称组成的结果集，该数据库名称与</font></font><code class="literal">wild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">指定的简单正则表达式匹配</font><font style="vertical-align: inherit;">。</font></font><code class="literal">wild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以包含通配符</font></font><code class="literal">%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者可以是一个</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指针，以匹配所有数据库。</font><font style="vertical-align: inherit;">调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-dbs" title="27.8.7.42 mysql_list_dbs（）"><code class="literal">mysql_list_dbs()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与执行查询相似</font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">SHOW DATABASES [LIKE
          <em class="replaceable"><code>wild</code></em>]</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您必须释放结果集
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-dbs-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功</font><font style="vertical-align: inherit;">
          的</font><font style="vertical-align: inherit;">结果。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-dbs-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-list-fields"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.43 mysql_list_fields（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960527424"></a><p>
        <code class="literal">MYSQL_RES *mysql_list_fields(MYSQL *mysql, const char
        *table, const char *wild)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-list-fields-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 5.7.11开始，</font></font><code class="literal">mysql_list_fields()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            已被弃用，并将在未来版本的MySQL中删除。</font><font style="vertical-align: inherit;">相反，使用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show-columns" title="13.7.5.5 SHOW COLUMNS语法"><code class="literal">SHOW COLUMNS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个空结果集，其元数据提供有关给定表中与该</font></font><code class="literal">wild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">指定的简单正则表达式匹配的列的信息
           </font><font style="vertical-align: inherit;">。</font></font><code class="literal">wild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以包含通配符</font></font><code class="literal">%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者可以是一个</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指针，以匹配的所有字段。</font><font style="vertical-align: inherit;">调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-fields" title="27.8.7.43 mysql_list_fields（）"><code class="literal">mysql_list_fields()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与执行查询相似</font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">SHOW COLUMNS FROM
          <em class="replaceable"><code>tbl_name</code></em> [LIKE
          <em class="replaceable"><code>wild</code></em>]</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          最好用来</font><font style="vertical-align: inherit;">代替
           </font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">SHOW COLUMNS FROM
          <em class="replaceable"><code>tbl_name</code></em></code><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-fields" title="27.8.7.43 mysql_list_fields（）"><code class="literal">mysql_list_fields()</code></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您必须释放结果集
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-fields-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功</font><font style="vertical-align: inherit;">
          的</font><font style="vertical-align: inherit;">结果。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-fields-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-fields-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int i;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_RES * tbl_cols = mysql_list_fields（mysql，“mytbl”，“f％”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int field_cnt = mysql_num_fields（tbl_cols）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
printf（“列数：％d \ n”，field_cnt）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
for（i = 0; i &lt;field_cnt; ++ i）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * col描述表格的第i列* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_FIELD * col = mysql_fetch_field_direct（tbl_cols，i）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“Column％d：％s \ n”，i，col-&gt; name）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
了mysql_free_result（tbl_cols）;</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-list-processes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.44 mysql_list_processes（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960489632"></a><p>
        <code class="literal">MYSQL_RES *mysql_list_processes(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-list-processes-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 5.7.11开始，
             </font></font><code class="literal">mysql_list_processes()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已被弃用，并将在未来版本的MySQL中删除。</font><font style="vertical-align: inherit;">相反，使用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show-processlist" title="13.7.5.29 SHOW PROCESSLIST语法"><code class="literal">SHOW PROCESSLIST</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回描述当前服务器线程的结果集。</font><font style="vertical-align: inherit;">这是与</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqladmin" title="4.5.2 mysqladmin  - 用于管理MySQL服务器的客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqladmin processlist</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show-processlist" title="13.7.5.29 SHOW PROCESSLIST语法"><code class="literal">SHOW PROCESSLIST</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询</font><font style="vertical-align: inherit;">报告的信息相同的信息
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您必须释放结果集
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-processes-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功</font><font style="vertical-align: inherit;">
          的</font><font style="vertical-align: inherit;">结果。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-processes-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-list-tables"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.45 mysql_list_tables（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960461648"></a><p>
        <code class="literal">MYSQL_RES *mysql_list_tables(MYSQL *mysql, const char
        *wild)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-list-tables-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回当前数据库中由与该</font></font><code class="literal">wild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">指定的简单正则表达式匹配的表名组成的结果集</font><font style="vertical-align: inherit;">。</font></font><code class="literal">wild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以包含通配符</font></font><code class="literal">%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者可以是一个</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指针，以匹配的所有表。</font><font style="vertical-align: inherit;">调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-list-tables" title="27.8.7.45 mysql_list_tables（）"><code class="literal">mysql_list_tables()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与执行查询相似</font><font style="vertical-align: inherit;">。
        </font></font><code class="literal">SHOW TABLES [LIKE
          <em class="replaceable"><code>wild</code></em>]</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您必须释放结果集
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-tables-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功</font><font style="vertical-align: inherit;">
          的</font><font style="vertical-align: inherit;">结果。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-list-tables-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-more-results"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.46 mysql_more_results（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960434128"></a><p>
        <code class="literal">my_bool mysql_more_results(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-more-results-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当您执行指定为单个语句字符串的多个语句时，或执行</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可返回多个结果集的语句时，</font><font style="vertical-align: inherit;">会使用此函数
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-more-results" title="27.8.7.46 mysql_more_results（）"><code class="literal">mysql_more_results()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果当前执行的语句中存在更多结果，则为true，在这种情况下，应用程序必须调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以获取结果。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-more-results-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p>
          <code class="literal">TRUE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（1）是否存在更多结果。
          </font></font><code class="literal">FALSE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（0）如果没有更多的结果存在。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在大多数情况下，您可以调用它
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来测试是否存在更多结果，如果是，则启动检索。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-queries" title="27.8.16 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.16节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.47节“mysql_next_result（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-more-results-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-next-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.47 mysql_next_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960416400"></a><p>
        <code class="literal">int mysql_next_result(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-next-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当您执行指定为单个语句字符串的多个语句时，或者当您使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句执行可以返回多个结果集的存储过程</font><font style="vertical-align: inherit;">时，会使用此函数
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">读取下一个语句结果并返回状态以指示是否存在更多结果。</font><font style="vertical-align: inherit;">如果
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回错误，则不会有更多结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在每次调用之前
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果它是返回结果集的语句（而不仅仅是结果状态）</font><font style="vertical-align: inherit;">，则必须调用</font><font style="vertical-align: inherit;">当前语句。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接的状态后，就好像您已经调用过
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或者
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来的语句一样。</font><font style="vertical-align: inherit;">这意味着，你可以打电话
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-warning-count" title="27.8.7.78 mysql_warning_count（）"><code class="literal">mysql_warning_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您的程序使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          语句来执行存储过程，则</font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须启用</font><font style="vertical-align: inherit;">该
           </font><font style="vertical-align: inherit;">标志。</font><font style="vertical-align: inherit;">这是因为</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          除了过程中执行的语句可能返回的任何结果集外，</font><font style="vertical-align: inherit;">每个</font><font style="vertical-align: inherit;">结果</font><font style="vertical-align: inherit;">都会</font><font style="vertical-align: inherit;">返回一个结果来指示调用状态。</font><font style="vertical-align: inherit;">由于</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以返回多个结果，</font><font style="vertical-align: inherit;">因此
           </font><font style="vertical-align: inherit;">可以使用调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来确定是否有更多结果</font><font style="vertical-align: inherit;">的循环来处理它们
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在你打电话时启用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者明确地通过传递
           </font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志本身，或者通过传递</font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（也启用</font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">隐式地
           </font><font style="vertical-align: inherit;">启用
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在MySQL 5.7中，</font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认是启用的。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          也可以通过调用来测试是否有更多结果</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-more-results" title="27.8.7.46 mysql_more_results（）"><code class="literal">mysql_more_results()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，此函数不会更改连接状态，因此如果它返回true，则仍然必须调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前进到下一个结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关显示如何使用的示例
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-queries" title="27.8.16 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.16节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-next-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<div class="informaltable">
<table summary="mysql_next_result() return values and a description of each value."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功，并有更多的结果</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功，没有更多的结果</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; 0</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生错误</font></font></td>
</tr></tbody></table>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-next-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。</font><font style="vertical-align: inherit;">例如，如果您没有调用
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前的结果集。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-num-fields"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.48 mysql_num_fields（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960351648"></a><a class="indexterm" name="idm140527960350576"></a><p>
        <code class="literal">unsigned int mysql_num_fields(MYSQL_RES
        *result)</code>
      </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要传递</font></font><code class="literal">MYSQL*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，请使用
         </font></font><code class="literal">unsigned int mysql_field_count(MYSQL *mysql)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-num-fields-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回结果集中的列数。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您可以从指向结果集的指针或连接处理程序获取列数。</font><font style="vertical-align: inherit;">你会使用连接处理程序if
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（因此你没有结果集指针）。</font><font style="vertical-align: inherit;">在这种情况下，您可以调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以确定是否
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该产生非空结果。</font><font style="vertical-align: inherit;">这使得客户端程序能够在不知道查询是否是</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
           </font><font style="vertical-align: inherit;">类似</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的）语句的</font><font style="vertical-align: inherit;">情况下采取适当的行动</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这里显示的例子说明了如何做到这一点。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#null-mysql-store-result" title="27.8.21.1为什么mysql_store_result（）有时在mysql_query（）返回成功后返回NULL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.21.1节“为什么在mysql_query（）返回成功后mysql_store_result（）有时返回NULL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-fields-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示结果集中列数的无符号整数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-fields-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-fields-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_RES *结果;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int num_fields;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned int num_rows;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_query（＆mysql，query_string））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    //错误</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
否则//查询成功，处理它返回的任何数据</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    result = mysql_store_result（＆mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    如果（结果）//有行</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        num_fields = mysql_num_fields（result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        //检索行，然后调用mysql_free_result（result）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    else // mysql_store_result（）什么都不返回; </font><font style="vertical-align: inherit;">它应该有吗？</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if（mysql_errno（＆mysql））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           fprintf（stderr，“错误：％s \ n”，mysql_error（＆mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        else if（mysql_field_count（＆mysql）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            //查询不返回数据</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            //（它不是一个SELECT）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            num_rows = mysql_affected_rows（＆mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另一种方法（如果你知道你的查询应该返回一个结果集）是</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno(&amp;mysql)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用一个检查</font><font style="vertical-align: inherit;">来替换这个
           </font><font style="vertical-align: inherit;">调用是否
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count(&amp;mysql)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回0.只有在出现问题时才会发生这种情况。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-num-rows"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.49 mysql_num_rows（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960323360"></a><p>
        <code class="literal">my_ulonglong mysql_num_rows(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-num-rows-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回结果集中的行数。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          取决于您使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还是
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回结果集。</font><font style="vertical-align: inherit;">如果你使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会立即被调用。</font><font style="vertical-align: inherit;">如果您使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直到检索到结果集中的所有行才返回正确的值。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">旨在用于返回结果集的语句，例如
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于语句如
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以与获得受影响的行的数量
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-rows-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果集中的行数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-num-rows-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-options"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.50 mysql_options（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527960297616"></a><p>
        <code class="literal">int mysql_options(MYSQL *mysql, enum mysql_option
        option, const void *arg)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-options-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可用于设置额外的连接选项并影响连接的行为。</font><font style="vertical-align: inherit;">可以多次调用该函数来设置多个选项。</font><font style="vertical-align: inherit;">要检索选项值，请使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-option" title="27.8.7.30 mysql_get_option（）"><code class="literal">mysql_get_option()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通话</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">后
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和之前
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect" title="27.8.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是你想要设置的选项; </font><font style="vertical-align: inherit;">该</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是选项的价值。</font><font style="vertical-align: inherit;">如果选项是整数，则指定一个指向整数值的指针作为</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          SSL证书和密钥文件等信息选项用于建立加密连接（如果此类连接可用），但不强制要求加密连接。</font><font style="vertical-align: inherit;">要求加密连接，请使用
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-encrypted-connections" title="27.8.15 C API加密连接支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.15节“C API加密连接支持”中介绍的技术</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下列表描述了可能的选项，其效果以及</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每种选项的使用方式。</font><font style="vertical-align: inherit;">对于表示</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未使用的</font><font style="vertical-align: inherit;">选项说明
           </font><font style="vertical-align: inherit;">，其值不相关; </font><font style="vertical-align: inherit;">通常是传递0.几个选项仅适用于应用程序与
           </font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库链接并且未用于与</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端库</font><font style="vertical-align: inherit;">链接的应用程序
           </font><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">MYSQL_DEFAULT_AUTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              要使用的身份验证插件的名称。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_ENABLE_CLEARTEXT_PLUGIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：</font></font><code class="literal">my_bool *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              启用</font></font><code class="literal">mysql_clear_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              明文身份验证插件。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#cleartext-pluggable-authentication" title="6.5.1.5客户端明文可插入认证"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.5.1.5节“客户端明文可插入验证”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_INIT_COMMAND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              连接到MySQL服务器时要执行的SQL语句。</font><font style="vertical-align: inherit;">如果发生重新连接，则自动重新执行。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（说法：</font></font><code class="literal">char
              *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              从中连接到服务器的网络接口。</font><font style="vertical-align: inherit;">这在客户端主机具有多个网络接口时使用。</font><font style="vertical-align: inherit;">参数是主机名或IP地址（指定为字符串）。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CAN_HANDLE_EXPIRED_PASSWORDS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （参数类型：</font></font><code class="literal">my_bool *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指示客户端是否可以处理过期的密码。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#expired-password-handling" title="6.3.8密码过期和沙盒模式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.3.8节“密码过期和沙箱模式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_COMPRESS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （参数：未使用）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用压缩的客户端/服务器协议。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_DELETE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：</font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              给定一个密钥名称，该选项将从当前连接属性集中删除一个键/值对，以在连接时传递给服务器。</font><font style="vertical-align: inherit;">该参数是一个指向以null结尾的字符串命名密钥的指针。</font><font style="vertical-align: inherit;">密钥名称与现有密钥的比较区分大小写。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              另请参阅
               </font></font><code class="literal">MYSQL_OPT_CONNECT_ATTR_RESET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code class="literal">MYSQL_OPT_CONNECT_ATTR_ADD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项的说明以及</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options4" title="27.8.7.51 mysql_options4（）"><code class="literal">mysql_options4()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font><font style="vertical-align: inherit;">说明中的
               </font><font style="vertical-align: inherit;">选项说明
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该功能描述还包括一个使用示例。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              性能架构通过</font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#session-connect-attrs-table" title="25.11.9.2 session_connect_attrs表"><code class="literal">session_connect_attrs</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#session-account-connect-attrs-table" title="25.11.9.1 session_account_connect_attrs表"><code class="literal">session_account_connect_attrs</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              表</font><font style="vertical-align: inherit;">公开连接属性
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/performance-schema.html#performance-schema-connection-attribute-tables" title="25.11.9性能架构连接属性表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第25.11.9节“性能架构连接属性表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_RESET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （参数未使用）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此选项重置（清除）当前连接属性集以在连接时传递给服务器。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              另请参阅
               </font></font><code class="literal">MYSQL_OPT_CONNECT_ATTR_DELETE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code class="literal">MYSQL_OPT_CONNECT_ATTR_ADD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项的说明以及</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options4" title="27.8.7.51 mysql_options4（）"><code class="literal">mysql_options4()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font><font style="vertical-align: inherit;">说明中的
               </font><font style="vertical-align: inherit;">选项说明
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该功能描述还包括一个使用示例。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              性能架构通过</font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#session-connect-attrs-table" title="25.11.9.2 session_connect_attrs表"><code class="literal">session_connect_attrs</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#session-account-connect-attrs-table" title="25.11.9.1 session_account_connect_attrs表"><code class="literal">session_account_connect_attrs</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              表</font><font style="vertical-align: inherit;">公开连接属性
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/performance-schema.html#performance-schema-connection-attribute-tables" title="25.11.9性能架构连接属性表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第25.11.9节“性能架构连接属性表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CONNECT_TIMEOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：</font></font><code class="literal">unsigned int *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              连接超时以秒为单位。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_GUESS_CONNECTION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （参数：未使用）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于与</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库</font><font style="vertical-align: inherit;">链接的应用程序
               </font><font style="vertical-align: inherit;">，此选项使库可以猜测是使用嵌入式服务器还是远程服务器。</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">猜测</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
              表示如果主机名被设置而不是
               </font></font><code class="literal">localhost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它使用远程服务器。</font><font style="vertical-align: inherit;">这种行为是默认的。
              </font></font><code class="literal">MYSQL_OPT_USE_EMBEDDED_CONNECTION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
               </font></font><code class="literal">MYSQL_OPT_USE_REMOTE_CONNECTION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以用来覆盖它。</font><font style="vertical-align: inherit;">对于链接到</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端库的</font><font style="vertical-align: inherit;">应用程序，此选项将被忽略
               </font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_LOCAL_INFILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：可选指针</font></font><code class="literal">unsigned int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该选项影响客户端</font><font style="vertical-align: inherit;">
              操作的</font></font><code class="literal">LOCAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              能力</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">缺省情况下，</font></font><code class="literal">LOCAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              功能由编译到MySQL客户端库的缺省值决定（请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.2.6节“LOAD DATA INFILE语法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">要显式控制此功能，请调用
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以设置
               </font></font><code class="literal">MYSQL_OPT_LOCAL_INFILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">LOCAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果指针指向</font></font><code class="literal">unsigned int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个零值，</font><font style="vertical-align: inherit;">则被禁用</font><font style="vertical-align: inherit;">。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">LOCAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有给出指针或指针指向</font></font><code class="literal">unsigned
                  int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非零值，</font><font style="vertical-align: inherit;">则启用</font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">LOCAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端</font><font style="vertical-align: inherit;">
              成功使用</font><font style="vertical-align: inherit;">加载操作也要求服务器允许它。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_MAX_ALLOWED_PACKET</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（说法：
               </font></font><code class="literal">unsigned long *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该选项设置
               </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量。</font><font style="vertical-align: inherit;">如果</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则该调用会为该会话设置会话系统变量值。</font><font style="vertical-align: inherit;">如果
               </font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则调用将设置全局系统变量值。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_NAMED_PIPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （参数：未使用）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果服务器允许命名管道连接，则使用命名管道连接到Windows上的MySQL服务器。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_NET_BUFFER_LENGTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（说法：
               </font></font><code class="literal">unsigned long *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该选项设置
               </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_net_buffer_length"><code class="literal">net_buffer_length</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量。</font><font style="vertical-align: inherit;">如果</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数不是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则该调用会为该会话设置会话系统变量值。</font><font style="vertical-align: inherit;">如果
               </font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则调用将设置全局系统变量值。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_PROTOCOL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">unsigned int *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用的协议类型。</font><font style="vertical-align: inherit;">指定其中一个</font></font><code class="literal">mysql_protocol_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义
               </font><font style="vertical-align: inherit;">的枚举值
               </font></font><code class="filename">mysql.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_READ_TIMEOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">unsigned int *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              每次尝试从服务器读取的超时时间（以秒为单位）。</font><font style="vertical-align: inherit;">有必要重试，因此总有效超时值是选项值的三倍。</font><font style="vertical-align: inherit;">您可以设置该值，以便可以在</font></font><code class="literal">Close_Wait_Timeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10分钟</font><font style="vertical-align: inherit;">的TCP / IP </font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">之前检测到丢失的连接
               </font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_RECONNECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">my_bool *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果发现连接丢失，则启用或禁用自动重新连接到服务器。</font><font style="vertical-align: inherit;">重新连接默认关闭; </font><font style="vertical-align: inherit;">此选项提供了一种明确设置重新连接行为的方法。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-auto-reconnect" title="27.8.20 C API自动重新连接控制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.2节“C API自动重新连接控制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_RETRY_COUNT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">unsigned int *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              与连接到服务器或与其通信时中断的I / O相关系统调用的重试计数。</font><font style="vertical-align: inherit;">默认值为1（如果初始呼叫总共中断2次，则重试1次）。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该选项只能由与NDB集群支持编写的C客户端库链接的客户端使用。</font><font style="vertical-align: inherit;">它从MySQL NDB Cluster 7.5.1开始可用。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              证书颁发机构（CA）证书文件的路径名称。</font><font style="vertical-align: inherit;">该选项（如果使用）必须指定服务器使用的相同证书。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CAPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              包含可信SSL证书文件的目录的路径名。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              客户端公钥证书文件的路径名。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CIPHER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              SSL加密允许的密码列表。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CRL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              包含证书吊销列表的文件的路径名称。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_CRLPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              包含包含证书吊销列表的文件的目录的路径名称。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_ENFORCE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">my_bool *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              是否要求连接使用SSL。</font><font style="vertical-align: inherit;">如果启用并且无法建立加密连接，则连接尝试失败。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此选项从MySQL 5.7.11开始不推荐使用，并在MySQL 8.0中删除。</font><font style="vertical-align: inherit;">相反，使用
               </font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值为
               </font></font><code class="literal">SSL_MODE_REQUIRED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              客户机私钥文件的路径名称。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">unsigned int *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              安全状态，以用于连接到服务器：</font></font><code class="literal">SSL_MODE_DISABLED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">SSL_MODE_PREFERRED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">SSL_MODE_REQUIRED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">SSL_MODE_VERIFY_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">SSL_MODE_VERIFY_IDENTITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认是</font></font><code class="literal">SSL_MODE_PREFERRED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些模式是在中</font></font><code class="literal">mysql_ssl_mode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">枚举
               </font><font style="vertical-align: inherit;">的允许值
               </font></font><code class="filename">mysql.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关安全状态的更多信息，请参阅的描述
               </font></font><a class="link" href="/mysql-5.7-google-zh/security.html#option_general_ssl-mode"><code class="option">--ssl-mode</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在
               </font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#encrypted-connection-options" title="6.4.2加密连接的命令选项"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.4.2节，“加密连接命令选项”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该选项已添加到MySQL 5.7.11中。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_SSL_VERIFY_SERVER_CERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （参数类型：</font></font><code class="literal">my_bool *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              根据连接到服务器时使用的主机名启用或禁用证书中的服务器公用名身份验证。</font><font style="vertical-align: inherit;">如果不匹配，连接将被拒绝。</font><font style="vertical-align: inherit;">对于加密连接，此功能可用于防止中间人攻击。</font><font style="vertical-align: inherit;">身份验证默认为禁用。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此选项不适用于自签名证书，该证书不包含服务器名称作为通用名称值。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此选项从MySQL 5.7.11开始不推荐使用，并在MySQL 8.0中删除。</font><font style="vertical-align: inherit;">相反，使用
               </font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值为
               </font></font><code class="literal">SSL_MODE_VERIFY_IDENTITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_TLS_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              客户端允许的加密连接协议。</font><font style="vertical-align: inherit;">该值是一个包含一个或多个协议名称的逗号分隔列表。</font><font style="vertical-align: inherit;">可以为这个选项命名的协议取决于用于编译MySQL的SSL库。</font><font style="vertical-align: inherit;">有关详细信息，请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#encrypted-connection-protocols-ciphers" title="6.4.6加密的连接协议和密码"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.4.6节“加密连接协议和密码”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该选项已添加到MySQL 5.7.10中。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_USE_EMBEDDED_CONNECTION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （参数：未使用）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于与</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库</font><font style="vertical-align: inherit;">链接的应用程序
               </font><font style="vertical-align: inherit;">，此选项强制使用嵌入式服务器进行连接。</font><font style="vertical-align: inherit;">对于与</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端库</font><font style="vertical-align: inherit;">链接的应用程序将被忽略</font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_USE_REMOTE_CONNECTION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （参数：未使用）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于与</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库</font><font style="vertical-align: inherit;">链接的应用程序
               </font><font style="vertical-align: inherit;">，此选项强制使用远程服务器进行连接。</font><font style="vertical-align: inherit;">对于与</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端库</font><font style="vertical-align: inherit;">链接的应用程序将被忽略</font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_USE_RESULT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （参数：未使用）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此选项未使用。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_WRITE_TIMEOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">unsigned int *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              每次尝试写入服务器的超时时间（以秒为单位）。</font><font style="vertical-align: inherit;">如果有必要重试，所以总有效超时值是选项值的两倍。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在其中查找客户端插件的目录。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_READ_DEFAULT_FILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              从命名选项文件中读取选项而不是从
               </font></font><code class="filename">my.cnf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_READ_DEFAULT_GROUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：</font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              从指定的组中读取选项</font></font><code class="filename">my.cnf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或使用指定的文件
               </font><font style="vertical-align: inherit;">读取选项
               </font></font><code class="literal">MYSQL_READ_DEFAULT_FILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_REPORT_DATA_TRUNCATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：</font></font><code class="literal">my_bool *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              使用</font><font style="vertical-align: inherit;">结构</font></font><code class="literal">error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              成员</font><font style="vertical-align: inherit;">启用或禁用报告准备好的语句的数据截断错误</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（默认：启用。）
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SECURE_AUTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">my_bool *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              是否连接到不支持MySQL 4.1.1及更高版本中使用的密码散列的服务器。</font><font style="vertical-align: inherit;">该选项默认启用。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SERVER_PUBLIC_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              包含客户端公钥副本的文件的路径名，该副本是服务器为基于RSA密钥对的密码交换所需的。</font><font style="vertical-align: inherit;">该文件必须采用PEM格式。</font><font style="vertical-align: inherit;">此选项适用于使用</font></font><code class="literal">sha256_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">身份验证插件</font><font style="vertical-align: inherit;">进行</font><font style="vertical-align: inherit;">身份验证的</font><font style="vertical-align: inherit;">客户端</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于不使用其中一个插件进行身份验证的帐户，此选项会被忽略。</font><font style="vertical-align: inherit;">如果不使用基于RSA的密码交换，它也会被忽略，例如当客户端使用安全连接连接到服务器时。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              有关该</font></font><code class="literal">sha256_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插件的</font><font style="vertical-align: inherit;">信息
               </font><font style="vertical-align: inherit;">，请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#sha256-pluggable-authentication" title="6.5.1.4 SHA-256可插入式验证"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.5.1.4节“SHA-256可插入验证”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SET_CHARSET_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              包含字符集定义文件的目录的路径名。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SET_CHARSET_NAME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用作默认字符集的字符集名称。</font><font style="vertical-align: inherit;">参数可以是
               </font></font><code class="literal">MYSQL_AUTODETECT_CHARSET_NAME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据操作系统设置使字符集自动检测（请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/charset.html#charset-connection" title="10.4连接字符集和排序规则"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第10.4节“连接字符集和归类”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SET_CLIENT_IP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：
               </font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于与</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器库</font><font style="vertical-align: inherit;">链接的应用程序
               </font><font style="vertical-align: inherit;">（
               </font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用身份验证支持进行编译时），此选项意味着用户被认为已从指定的IP地址（指定为字符串）进行连接以进行身份​​验证。</font><font style="vertical-align: inherit;">对于与</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端库</font><font style="vertical-align: inherit;">链接的应用程序将被忽略</font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">MYSQL_SHARED_MEMORY_BASE_NAME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：</font></font><code class="literal">char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果服务器支持共享内存连接，则用于与Windows上的服务器通信的共享内存对象的名称。</font><font style="vertical-align: inherit;">指定与</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#option_mysqld_shared-memory-base-name"><code class="option">--shared-memory-base-name</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用于</font><font style="vertical-align: inherit;">连接</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqld" title="4.3.1 mysqld  -  MySQL服务器"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqld</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">相同的值
               </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">client</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您使用</font></font><code class="literal">MYSQL_READ_DEFAULT_FILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或，
           </font><font style="vertical-align: inherit;">则</font><font style="vertical-align: inherit;">
          该</font><font style="vertical-align: inherit;">组总是被阅读
           </font></font><code class="literal">MYSQL_READ_DEFAULT_GROUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          选项文件中的指定组可能包含以下选项。
</font></font></p>
<div class="informaltable">
<table summary="Options that may appear in the option file and a description of each option."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">character-sets-dir=<em class="replaceable"><code>dir_name</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装字符集的目录。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">compress</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用压缩的客户端/服务器协议。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">connect-timeout=<em class="replaceable"><code>seconds</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接超时以秒为单位。</font><font style="vertical-align: inherit;">在Linux上，此超时也用于等待来自服务器的第一个答案。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">database=<em class="replaceable"><code>db_name</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有在connect命令中指定数据库，请连接到此数据库。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">debug</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调试选项。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">default-character-set=<em class="replaceable"><code>charset_name</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用的默认字符集。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">disable-local-infile</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA
                LOCAL INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">enable-cleartext-plugin</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用</font></font><code class="literal">mysql_clear_password</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明文身份验证插件。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">host=<em class="replaceable"><code>host_name</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认主机名。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">init-command=<em class="replaceable"><code>stmt</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接到MySQL服务器时执行的语句。</font><font style="vertical-align: inherit;">如果发生重新连接，则自动重新执行。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">interactive-timeout=<em class="replaceable"><code>seconds</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与指定</font></font><code class="literal">CLIENT_INTERACTIVE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为
                 </font><font style="vertical-align: inherit;">相同</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.54节“mysql_real_connect（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">local-infile[={0|1}]</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有参数或非零参数，则使用
                 </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA
                LOCAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">否则禁用。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">max_allowed_packet=<em class="replaceable"><code>bytes</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端可以从服务器读取的数据包的最大大小。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">multi-queries</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">， </font></font><code class="literal">multi-results</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从多语句执行或存储过程启用多个结果集。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">multi-statements</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使客户端能够在单个字符串中发送多个语句（由</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符</font><font style="vertical-align: inherit;">分隔</font><font style="vertical-align: inherit;">）。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">password=<em class="replaceable"><code>password</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认密码。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">pipe</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用命名管道连接到Windows上的MySQL服务器。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">port=<em class="replaceable"><code>port_num</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认端口号。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">protocol={TCP|SOCKET|PIPE|MEMORY}</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接到服务器时使用的协议。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">return-found-rows</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">告诉</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-info" title="27.8.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在使用时返回找到的行而不是更新的行
                 </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">shared-memory-base-name=<em class="replaceable"><code>name</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于连接到服务器的共享内存名称。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">socket={<em class="replaceable"><code>file_name</code></em>|<em class="replaceable"><code>pipe_name</code></em>}</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认套接字文件。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-ca=<em class="replaceable"><code>file_name</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">证书授权文件。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-capath=<em class="replaceable"><code>dir_name</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">认证中心目录。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-cert=<em class="replaceable"><code>file_name</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">证书文件。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-cipher=<em class="replaceable"><code>cipher_list</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">允许的SSL密码。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">ssl-key=<em class="replaceable"><code>file_name</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密钥文件。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">timeout=<em class="replaceable"><code>seconds</code></em></code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">喜欢</font></font><code class="literal">connect-timeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">user</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认用户。</font></font></td>
</tr></tbody></table>
</div>
<p>
          <code class="literal">timeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已被替换
           </font></font><code class="literal">connect-timeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但
           </font></font><code class="literal">timeout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仍支持向后兼容性。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关MySQL程序使用的选项文件的更多信息，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#option-files" title="4.2.6使用选项文件"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.2.6节“使用选项文件”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">如果您指定未知选项，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          调用请求在客户端/服务器协议中使用压缩，导致从</font></font><code class="literal">[odbc]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项文件中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">组</font><font style="vertical-align: inherit;">读取
           </font><font style="vertical-align: inherit;">选项，并禁用事务自动提交模式：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL mysql;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_init（与MySQL）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的mysql_options（与MySQL，MYSQL_OPT_COMPRESS，0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的mysql_options（与MySQL，MYSQL_READ_DEFAULT_GROUP， “ODBC”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（＆mysql，MYSQL_INIT_COMMAND，“SET autocommit = 0”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！mysql_real_connect（＆mysql，“host”，“user”，“passwd”，“database”，0，NULL，0））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“无法连接到数据库：错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          mysql_error（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-options4"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.51 mysql_options4（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959970176"></a><p>
        <code class="literal">int mysql_options4(MYSQL *mysql, enum mysql_option
        option, const void *arg1, const void *arg2)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-options4-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options4" title="27.8.7.51 mysql_options4（）"><code class="literal">mysql_options4()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二个参数中指定的选项</font><font style="vertical-align: inherit;">类似，
           </font><font style="vertical-align: inherit;">但具有额外的第四个参数，以便可以传递两个值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下面的列表介绍了允许的选项，它们的作用，以及如何</font></font><code class="literal">arg1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">arg2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_ADD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（参数类型：</font></font><code class="literal">char *, char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此选项将一个属性键/值对添加到当前连接属性组，以在连接时传递给服务器。</font><font style="vertical-align: inherit;">这两个参数都是以空字符结尾的字符串的指针。</font><font style="vertical-align: inherit;">第一个和第二个字符串分别表示键和值。</font><font style="vertical-align: inherit;">如果密钥为空或已存在于当前连接属性集中，则会发生错误。</font><font style="vertical-align: inherit;">密钥名称与现有密钥的比较区分大小写。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              以下划线（</font></font><code class="literal">_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">开头的键名</font><font style="vertical-align: inherit;">保留供内部使用，不应由应用程序创建。</font><font style="vertical-align: inherit;">这个约定允许MySQL引入新属性而不与应用程序属性相冲突。
            </font></font></p><p>
              <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options4" title="27.8.7.51 mysql_options4（）"><code class="literal">mysql_options4()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对它将接受的连接属性数据的总大小施加64KB的限制。</font><font style="vertical-align: inherit;">对于导致超出此限制的呼叫，会
               </font></font><a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_invalid_parameter_no"><code class="literal">CR_INVALID_PARAMETER_NO</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              发生错误。</font><font style="vertical-align: inherit;">属性大小限制检查也在服务器端进行。</font><font style="vertical-align: inherit;">有关详细信息，请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/performance-schema.html#performance-schema-connection-attribute-tables" title="25.11.9性能架构连接属性表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第25.11.9节“性能架构连接属性表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中还介绍了性能架构如何通过</font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#session-connect-attrs-table" title="25.11.9.2 session_connect_attrs表"><code class="literal">session_connect_attrs</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#session-account-connect-attrs-table" title="25.11.9.1 session_account_connect_attrs表"><code class="literal">session_account_connect_attrs</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              表</font><font style="vertical-align: inherit;">公开连接属性
               </font><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              另请参阅功能描述中的
               </font></font><code class="literal">MYSQL_OPT_CONNECT_ATTR_RESET</code>
              <code class="literal">MYSQL_OPT_CONNECT_ATTR_DELETE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项说明
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options4-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">如果您指定未知选项，则为非零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options4-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_duplicate_connection_attr"><code class="literal">CR_DUPLICATE_CONNECTION_ATTR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指定了重复的属性名称。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_invalid_parameter_no"><code class="literal">CR_INVALID_PARAMETER_NO</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              密钥名称为空或者键/值连接属性数据量超过64KB限制。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-options4-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个例子演示了指定连接属性的调用：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL mysql;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_init（与MySQL）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（＆mysql，MYSQL_OPT_CONNECT_ATTR_RESET，0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options4（＆mysql，MYSQL_OPT_CONNECT_ATTR_ADD，“key1”，“value1”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options4（＆mysql，MYSQL_OPT_CONNECT_ATTR_ADD，“key2”，“value2”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options4（＆mysql，MYSQL_OPT_CONNECT_ATTR_ADD，“key3”，“value3”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（＆mysql，MYSQL_OPT_CONNECT_ATTR_DELETE，“key1”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！mysql_real_connect（＆mysql，“host”，“user”，“passwd”，“database”，0，NULL，0））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“无法连接到数据库：错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        mysql_error（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-ping"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.52 mysql_ping（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959931744"></a><p>
        <code class="literal">int mysql_ping(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-ping-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检查到服务器的连接是否正常。</font><font style="vertical-align: inherit;">如果连接断开并且启用了自动重新连接，则尝试重新连接。</font><font style="vertical-align: inherit;">如果连接关闭并且自动重新连接被禁用，则
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          自动重新连接在默认情况下被禁用。</font><font style="vertical-align: inherit;">要启用它，请</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用
           </font></font><code class="literal">MYSQL_OPT_RECONNECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项进行</font><font style="vertical-align: inherit;">调用
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关详细信息，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.50节“mysql_options（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 可以被闲置很长一段时间的客户端使用，以检查服务器是否已关闭连接并在必要时重新连接。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）确实会导致重新连接，但没有明确的指示。</font><font style="vertical-align: inherit;">要确定是否发生重新连接，请
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-id" title="27.8.7.76 mysql_thread_id（）"><code class="literal">mysql_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在调用之前调用以获取原始连接标识符
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-id" title="27.8.7.76 mysql_thread_id（）"><code class="literal">mysql_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再次</font><font style="vertical-align: inherit;">调用
           </font><font style="vertical-align: inherit;">以查看标识符是否已更改。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果发生重新连接，连接的某些特征将被重置。</font><font style="vertical-align: inherit;">有关这些特性的详细信息，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-auto-reconnect" title="27.8.20 C API自动重新连接控制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.2节“C API自动重新连接控制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-ping-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果与服务器的连接处于活动状态，则为零。</font><font style="vertical-align: inherit;">非零，如果发生错误。</font><font style="vertical-align: inherit;">非零返回并不表示MySQL服务器本身是否关闭; </font><font style="vertical-align: inherit;">该连接可能因其他原因（如网络问题）而中断。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-ping-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-query"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.53 mysql_query（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959902688"></a><p>
        <code class="literal">int mysql_query(MYSQL *mysql, const char
        *stmt_str)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-query-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          执行由空字符结尾的字符串指向的SQL语句</font></font><code class="literal">stmt_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通常，字符串必须由一个没有终止分号（</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或</font><font style="vertical-align: inherit;">单个SQL语句组成</font></font><code class="literal">\g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果启用了多语句执行，则该字符串可以包含多个用分号分隔的语句。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-queries" title="27.8.16 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.16节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能用于包含二进制数据的语句; </font><font style="vertical-align: inherit;">你必须
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改用。</font><font style="vertical-align: inherit;">（二进制数据可能包含</font></font><code class="literal">\0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符，它被</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解释为语句字符串的结尾。）
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果你想知道这个语句是否返回一个结果集，你可以用它
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来检查这个。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.22节“mysql_field_count（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-query-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-query-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-connect"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.54 mysql_real_connect（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959873904"></a><p>
        <code class="literal">MYSQL *mysql_real_connect(MYSQL *mysql, const char
        *host, const char *user, const char *passwd, const char *db,
        unsigned int port, const char *unix_socket, unsigned long
        client_flag)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-connect-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试建立与运行于其上的MySQL数据库引擎的连接</font></font><code class="literal">host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须先成功完成，然后才能执行任何其他需要有效</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          连接处理程序结构的</font><font style="vertical-align: inherit;">API函数</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数指定如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于第一个参数，指定现有</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的地址</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在打电话之前
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请致电
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初始化</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构。</font><font style="vertical-align: inherit;">您可以通过</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼叫</font><font style="vertical-align: inherit;">更改很多连接选项
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.50节“mysql_options（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              值</font></font><code class="literal">host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是主机名或IP地址。</font><font style="vertical-align: inherit;">如果</font></font><code class="literal">host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或字符串
               </font></font><code class="literal">"localhost"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则假定与本地主机的连接。</font><font style="vertical-align: inherit;">对于Windows，如果服务器启用了共享内存连接，则客户端使用共享内存连接进行连接。</font><font style="vertical-align: inherit;">否则，使用TCP / IP。</font><font style="vertical-align: inherit;">对于Unix，客户端使用Unix套接字文件进行连接。</font><font style="vertical-align: inherit;">对于本地连接，您还可以影响连接的类型以用于连接</font></font><code class="literal">MYSQL_OPT_PROTOCOL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><code class="literal">MYSQL_OPT_NAMED_PIPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">服务器必须支持连接类型。</font><font style="vertical-align: inherit;">对于一个
               </font></font><code class="literal">host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font><code class="literal">"."</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Windows上，如果服务器启用了命名管道连接，则客户端使用命名管道进行连接。</font><font style="vertical-align: inherit;">如果命名管道连接未启用，则会发生错误。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该</font></font><code class="literal">user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数包含用户的MySQL登录ID。</font><font style="vertical-align: inherit;">如果</font></font><code class="literal">user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或空字符串
               </font></font><code class="literal">""</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则假定当前用户。</font><font style="vertical-align: inherit;">在Unix下，这是当前的登录名。</font><font style="vertical-align: inherit;">在Windows ODBC下，必须明确指定当前用户名。</font><font style="vertical-align: inherit;">请参阅</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html" title="第27章连接器和API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27章</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器和API中</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的连接器/ ODBC部分
               </font><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该</font></font><code class="literal">passwd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数包含密码</font></font><code class="literal">user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
               </font></font><code class="literal">passwd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则只</font></font><code class="literal">user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查具有空白（空）密码字段的用户表中的</font><font style="vertical-align: inherit;">条目</font><font style="vertical-align: inherit;">是否匹配。</font><font style="vertical-align: inherit;">这使数据库管理员能够以这样的方式设置MySQL权限系统，即根据用户是否指定了密码，用户可以获得不同的权限。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                在打电话之前不要试图加密密码
                 </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">密码加密由客户端API自动处理。
</font></font></p>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在</font></font><code class="literal">user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">passwd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              参数使用任何字符集已配置的</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象。</font><font style="vertical-align: inherit;">默认情况下，这是</font></font><code class="literal">latin1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但可以</font><font style="vertical-align: inherit;">在连接之前</font><font style="vertical-align: inherit;">通过调用进行更改</font><font style="vertical-align: inherit;">。
            </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options(mysql,
              MYSQL_SET_CHARSET_NAME,
              "<em class="replaceable"><code>charset_name</code></em>")</code></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
              <code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是数据库名称。</font><font style="vertical-align: inherit;">如果
               </font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则连接将默认数据库设置为此值。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><code class="literal">port</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是0，则将该值用作TCP / IP连接的端口号。</font><font style="vertical-align: inherit;">请注意，该
               </font></font><code class="literal">host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数确定连接的类型。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><code class="literal">unix_socket</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则字符串指定要使用的套接字或命名管道。</font><font style="vertical-align: inherit;">请注意，该
               </font></font><code class="literal">host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数确定连接的类型。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              值</font></font><code class="literal">client_flag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常为0，但可以设置为以下标志的组合以启用某些功能：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">CAN_HANDLE_EXPIRED_PASSWORDS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户端可以处理过期的密码。</font><font style="vertical-align: inherit;">有关更多信息，请参见
                   </font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#expired-password-handling" title="6.3.8密码过期和沙盒模式"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.3.8节“密码过期和沙盒模式”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_COMPRESS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：在客户端/服务器协议中使用压缩。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_FOUND_ROWS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回找到的（匹配的）行数，而不是更改的行数。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_IGNORE_SIGPIPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：防止客户端库安装
                   </font></font><code class="literal">SIGPIPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">信号处理程序。</font><font style="vertical-align: inherit;">这可以用来避免与应用程序已经安装的处理程序发生冲突。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_IGNORE_SPACE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：在函数名称后面允许空格。</font><font style="vertical-align: inherit;">使所有函数名称保留字。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_INTERACTIVE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><font style="vertical-align: inherit;">关闭连接前</font><font style="vertical-align: inherit;">允许
                   </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_interactive_timeout"><code class="literal">interactive_timeout</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  不活动秒数（而不是
                   </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_wait_timeout"><code class="literal">wait_timeout</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秒）。</font><font style="vertical-align: inherit;">客户端的会话</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_wait_timeout"><code class="literal">wait_timeout</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量被设置为</font><font style="vertical-align: inherit;">会话
                   </font><font style="vertical-align: inherit;">变量的值
                   </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_interactive_timeout"><code class="literal">interactive_timeout</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_LOCAL_FILES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：启用
                   </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA
                  LOCAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：告诉服务器客户端可以处理来自多语句执行或存储过程的多个结果集。</font><font style="vertical-align: inherit;">如果</font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用</font><font style="vertical-align: inherit;">此标志，则自动启用该标志
                   </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关此标志的更多信息，请参阅此表后面的注释。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：告诉服务器客户端可以用一个字符串发送多个语句（用</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  字符</font><font style="vertical-align: inherit;">分隔</font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">如果此标志未设置，则多语句执行被禁用。</font><font style="vertical-align: inherit;">有关此标志的更多信息，请参阅此表后面的注释。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_NO_SCHEMA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不要允许
                   </font></font><em class="replaceable"><code>db_name.tbl_name.col_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  语法。</font><font style="vertical-align: inherit;">这是用于ODBC的。</font><font style="vertical-align: inherit;">如果使用该语法，它会导致解析器生成错误，这对于在某些ODBC程序中捕获错误非常有用。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_ODBC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">： 没用过。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_SSL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：使用SSL（加密协议）。</font><font style="vertical-align: inherit;">不要在应用程序中设置此选项; </font><font style="vertical-align: inherit;">它在客户端库内部设置。</font><font style="vertical-align: inherit;">相反，使用
                   </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
                   </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在打电话之前
                   </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
                </font></font></p></li><li class="listitem"><p>
                  <code class="literal">CLIENT_REMEMBER_OPTIONS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记住呼叫指定的选项
                   </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果没有此选项，如果
                   </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  失败，则必须</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在重新尝试连接之前</font><font style="vertical-align: inherit;">重复
                   </font><font style="vertical-align: inherit;">呼叫。</font><font style="vertical-align: inherit;">使用此选项，
                   </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼叫不需要重复。
</font></font></p></li></ul>
</div>
</li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您的程序使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          语句来执行存储过程，则</font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须启用</font><font style="vertical-align: inherit;">该
           </font><font style="vertical-align: inherit;">标志。</font><font style="vertical-align: inherit;">这是因为</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          除了过程中执行的语句可能返回的任何结果集外，</font><font style="vertical-align: inherit;">每个</font><font style="vertical-align: inherit;">结果</font><font style="vertical-align: inherit;">都会</font><font style="vertical-align: inherit;">返回一个结果来指示调用状态。</font><font style="vertical-align: inherit;">由于</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以返回多个结果，</font><font style="vertical-align: inherit;">因此
           </font><font style="vertical-align: inherit;">可以使用调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来确定是否有更多结果</font><font style="vertical-align: inherit;">的循环来处理它们
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在你打电话时启用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者明确地通过传递
           </font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志本身，或者通过传递</font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（也启用</font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">隐式地
           </font><font style="vertical-align: inherit;">启用
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在MySQL 5.7中，</font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认是启用的。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果启用</font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理每次调用的结果
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用调用的循环
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来确定是否有更多结果。</font><font style="vertical-align: inherit;">有关示例，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-queries" title="27.8.16 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.16节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于某些参数，可以从选项文件中获取该值，而不是在</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用中</font><font style="vertical-align: inherit;">使用明确的值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要执行此操作，请</font><font style="vertical-align: inherit;">在致电前</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用</font></font><code class="literal">MYSQL_READ_DEFAULT_FILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><code class="literal">MYSQL_READ_DEFAULT_GROUP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项进行呼叫</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后，在
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用中，</font><font style="vertical-align: inherit;">为每个要从选项文件中读取的参数</font><font style="vertical-align: inherit;">指定</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无值</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为</font></font><code class="literal">host</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，指定一个值
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或空字符串（</font></font><code class="literal">""</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为</font></font><code class="literal">user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，指定一个值
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或空字符串。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为</font></font><code class="literal">passwd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，指定一个值
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（对于密码，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">中的空字符串的值
               </font><font style="vertical-align: inherit;">不能在选项文件中被覆盖，因为空字符串明确指出MySQL帐户必须有空密码。）
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为</font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，指定一个值
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或空字符串。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于</font></font><code class="literal">port</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，指定值为0。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为</font></font><code class="literal">unix_socket</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，指定一个值
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果在参数的选项文件中找不到任何值，则按照本节前面给出的说明中的说明使用其默认值。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-connect-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个</font></font><code class="literal">MYSQL*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接处理程序，如果连接成功，</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果连接是不成功的。</font><font style="vertical-align: inherit;">对于成功的连接，返回值与第一个参数的值相同。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-connect-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_conn_host_error"><code class="literal">CR_CONN_HOST_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无法连接到MySQL服务器。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_connection_error"><code class="literal">CR_CONNECTION_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无法连接到本地MySQL服务器。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_ipsock_error"><code class="literal">CR_IPSOCK_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无法创建IP套接字。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_socket_create_error"><code class="literal">CR_SOCKET_CREATE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无法创建Unix套接字。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_host"><code class="literal">CR_UNKNOWN_HOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无法找到主机名的IP地址。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_version_error"><code class="literal">CR_VERSION_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              尝试连接到使用不同协议版本的客户端库的服务器导致协议不匹配。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_namedpipeopen_error"><code class="literal">CR_NAMEDPIPEOPEN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无法在Windows上创建命名管道。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_namedpipewait_error"><code class="literal">CR_NAMEDPIPEWAIT_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无法等待Windows上的命名管道。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_namedpipesetstate_error"><code class="literal">CR_NAMEDPIPESETSTATE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无法在Windows上获取管道处理程序。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_connect_timeout"><code class="literal">connect_timeout</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; 0并且</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_connect_timeout"><code class="literal">connect_timeout</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接服务器</font><font style="vertical-align: inherit;">花费的时间超过了
               </font><font style="vertical-align: inherit;">几秒，或者如果服务器在执行时死掉了</font></font><code class="literal">init-command</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_already_connected"><code class="literal">CR_ALREADY_CONNECTED</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接处理程序已连接。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-connect-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL mysql;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_init（与MySQL）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的mysql_options（与MySQL，MYSQL_READ_DEFAULT_GROUP， “your_prog_name”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！mysql_real_connect（＆mysql，“host”，“user”，“passwd”，“database”，0，NULL，0））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“无法连接到数据库：错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          mysql_error（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL客户端库读取</font></font><code class="literal">[client]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">[your_prog_name]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分中
           </font></font><code class="filename">my.cnf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以确保您的程序工作的文件，即使有人已经设置MySQL在一些非标准的方式。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          连接后，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将
           </font></font><code class="literal">reconnect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志（</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构的</font><font style="vertical-align: inherit;">一部分
           </font><font style="vertical-align: inherit;">）设置为
           </font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API 5.0.3以前</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">版本</font><font style="vertical-align: inherit;">或</font><font style="vertical-align: inherit;">新版本中的值。</font></font><code class="literal">1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此标志的</font><font style="vertical-align: inherit;">值
           </font><font style="vertical-align: inherit;">表示如果由于连接丢失而无法执行语句，则在放弃之前尝试重新连接到服务器。</font><font style="vertical-align: inherit;">您可以使用该</font></font><code class="literal">MYSQL_OPT_RECONNECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来控制重新连接行为。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-escape-string"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.55 mysql_real_escape_string（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959684896"></a><p>
        <code class="literal">unsigned long mysql_real_escape_string(MYSQL *mysql,
        char *to, const char *from, unsigned long length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该函数创建用于SQL语句的合法SQL字符串。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/language-structure.html#string-literals" title="9.1.1字符串文字"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9.1.1节“字符串文字”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string" title="27.8.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_insecure_api_err"><code class="literal">CR_INSECURE_API_ERR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sqlmode_no_backslash_escapes"><code class="literal">NO_BACKSLASH_ESCAPES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            启用</font><font style="vertical-align: inherit;">了</font><font style="vertical-align: inherit;">SQL模式，则会</font><font style="vertical-align: inherit;">
            失败并产生
             </font><font style="vertical-align: inherit;">错误</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，函数不能转义引号字符，除非将其加倍，为了正确执行此操作，它必须知道有关引用上下文的更多信息。</font><font style="vertical-align: inherit;">取而代之的是，使用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote" title="27.8.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它需要一个额外的参数来指定引用上下文。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为字符转义取决于服务器使用的字符集参数必须是一个有效的，开放的连接。
        </font></font></p><a class="indexterm" name="idm140527959672672"></a><p><font style="vertical-align: inherit;"></font><code class="literal">from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数中</font><font style="vertical-align: inherit;">
          的字符串</font><font style="vertical-align: inherit;">被编码以产生转义的SQL字符串，并考虑到连接的当前字符集。</font><font style="vertical-align: inherit;">结果放置在</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数中，后面跟着一个终止空字节。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          编码的字符是</font></font><code class="literal">\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">NUL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ASCII 0）， ，</font></font><code class="literal">\n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
          </font></font><code class="literal">\r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和控制+ Z。</font><font style="vertical-align: inherit;">严格地说，MySQL只需要反斜杠和用于引用查询中字符串的引号字符就会被转义。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string" title="27.8.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          引用其他字符以使它们更容易在日志文件中读取。</font><font style="vertical-align: inherit;">为进行比较，请参见</font><a class="xref" href="/mysql-5.7-google-zh/language-structure.html#string-literals" title="9.1.1字符串文字"><font style="vertical-align: inherit;">第9.1.1节“字符串文字”</font></a><font style="vertical-align: inherit;">和
           </font><a class="xref" href="/mysql-5.7-google-zh/functions.html#string-functions" title="12.5字符串函数"><font style="vertical-align: inherit;">第12.5节“字符串函数”中的</font></a><font style="vertical-align: inherit;">文字字符串和</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_quote"><code class="literal">QUOTE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL函数</font><font style="vertical-align: inherit;">的引用规则</font><font style="vertical-align: inherit;">。
        </font></font><a class="xref" href="/mysql-5.7-google-zh/language-structure.html#string-literals" title="9.1.1字符串文字"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a class="xref" href="/mysql-5.7-google-zh/functions.html#string-functions" title="12.5字符串函数"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向的字符串</font></font><code class="literal">from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是
           </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节长。</font><font style="vertical-align: inherit;">您必须将</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓冲区</font><font style="vertical-align: inherit;">分配
           </font><font style="vertical-align: inherit;">为至少
           </font></font><code class="literal">length*2+1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节长。</font><font style="vertical-align: inherit;">（在最坏的情况下，每个字符可能需要使用两个字节进行编码，并且必须有空间来存放终止空字节。）
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string" title="27.8.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回时，其内容</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为以空字符结尾的字符串。</font><font style="vertical-align: inherit;">返回值是编码字符串的长度，不包括终止空字节。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您必须更改连接的字符集，请使用该</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-character-set" title="27.8.7.67 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数而不是执行</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET
          NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-character-set" title="13.7.4.2 SET CHARACTER SET语法"><code class="literal">SET CHARACTER
          SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）语句。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-character-set" title="27.8.7.67 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          作品像</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但也会影响所使用的字符集
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string" title="27.8.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例将两个转义字符串插入</font></font><code class="literal">INSERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中，每个</font><font style="vertical-align: inherit;">字符串
           </font><font style="vertical-align: inherit;">都在单引号字符中：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char查询[1000]，*结束;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = my_stpcpy（query，“INSERT INTO test_table VALUES（'”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end + = mysql_real_escape_string（＆mysql，end，“这是什么”，12）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = my_stpcpy（end，“'，'”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end + = mysql_real_escape_string（＆mysql，end，“binary data：\ 0 \ r \ n”，16）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = my_stpcpy（end，“'）”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_real_query（＆mysql，query，（unsigned int）（end  -  query）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   fprintf（stderr，“无法插入行，错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_error（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">my_stpcpy()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例中使用</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">函数包含在</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          库中，其工作原理与此类似，</font></font><code class="literal">strcpy()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但会返回指向第一个参数的终止null的指针。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          放入</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">中的编码字符串的长度
           </font><font style="vertical-align: inherit;">，不包括终止空字节，如果发生错误，则为-1。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          因为
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string" title="27.8.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个无符号值，所以可以通过比较返回值</font></font><code class="literal">(unsigned long)-1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或</font></font><code class="literal">(unsigned long)~0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等价于）</font><font style="vertical-align: inherit;">来检查-1 </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_insecure_api_err"><code class="literal">CR_INSECURE_API_ERR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sqlmode_no_backslash_escapes"><code class="literal">NO_BACKSLASH_ESCAPES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用</font><font style="vertical-align: inherit;">了</font><font style="vertical-align: inherit;">SQL模式，</font><font style="vertical-align: inherit;">则会发生此错误，
               </font><font style="vertical-align: inherit;">因为在这种情况下，
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string" title="27.8.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无法保证产生正确编码的结果。</font><font style="vertical-align: inherit;">为避免此错误，请
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote" title="27.8.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              改用。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-escape-string-quote"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.56 mysql_real_escape_string_quote（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959623936"></a><p>
        <code class="literal">unsigned long mysql_real_escape_string_quote(MYSQL
        *mysql, char *to, const char *from, unsigned long length, char
        quote)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-quote-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该函数创建用于SQL语句的合法SQL字符串。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/language-structure.html#string-literals" title="9.1.1字符串文字"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9.1.1节“字符串文字”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为字符转义取决于服务器使用的字符集参数必须是一个有效的，开放的连接。
        </font></font></p><a class="indexterm" name="idm140527959618000"></a><p><font style="vertical-align: inherit;"></font><code class="literal">from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数中</font><font style="vertical-align: inherit;">
          的字符串</font><font style="vertical-align: inherit;">被编码以产生转义的SQL字符串，并考虑到连接的当前字符集。</font><font style="vertical-align: inherit;">结果放置在</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数中，后面跟着一个终止空字节。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          编码的字符是</font></font><code class="literal">\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">NUL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ASCII 0）， ，</font></font><code class="literal">\n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
          </font></font><code class="literal">\r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制+ Z，和</font></font><code class="literal">`</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">严格地说，MySQL只需要反斜杠和用于引用查询中字符串的引号字符就会被转义。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote" title="27.8.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          引用其他字符以使它们更容易在日志文件中读取。</font><font style="vertical-align: inherit;">为进行比较，请参见</font><a class="xref" href="/mysql-5.7-google-zh/language-structure.html#string-literals" title="9.1.1字符串文字"><font style="vertical-align: inherit;">第9.1.1节“字符串文字”</font></a><font style="vertical-align: inherit;">和
           </font><a class="xref" href="/mysql-5.7-google-zh/functions.html#string-functions" title="12.5字符串函数"><font style="vertical-align: inherit;">第12.5节“字符串函数”中的</font></a><font style="vertical-align: inherit;">文字字符串和</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_quote"><code class="literal">QUOTE()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL函数</font><font style="vertical-align: inherit;">的引用规则</font><font style="vertical-align: inherit;">。
</font></font><a class="xref" href="/mysql-5.7-google-zh/language-structure.html#string-literals" title="9.1.1字符串文字"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a class="xref" href="/mysql-5.7-google-zh/functions.html#string-functions" title="12.5字符串函数"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sqlmode_ansi_quotes"><code class="literal">ANSI_QUOTES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用</font><font style="vertical-align: inherit;">了</font><font style="vertical-align: inherit;">SQL模式，
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote" title="27.8.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            则不能用于转义双引号字符以在双引号标识符中使用。</font><font style="vertical-align: inherit;">（该功能无法确定是否启用该模式以确定正确的转义字符。）
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向的字符串</font></font><code class="literal">from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须是
           </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节长。</font><font style="vertical-align: inherit;">您必须将</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓冲区</font><font style="vertical-align: inherit;">分配
           </font><font style="vertical-align: inherit;">为至少
           </font></font><code class="literal">length*2+1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节长。</font><font style="vertical-align: inherit;">（在最坏的情况下，每个字符可能需要使用两个字节进行编码，并且必须有空间来存放终止空字节。）
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote" title="27.8.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回时，其内容</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为以空字符结尾的字符串。</font><font style="vertical-align: inherit;">返回值是编码字符串的长度，不包括终止空字节。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">quote</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数指示要放置转义字符串的上下文。</font><font style="vertical-align: inherit;">假设您打算跳过该</font></font><code class="literal">from</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，并将转义字符串（在这里指定
           </font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）插入以下其中一个语句中：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1）SELECT * FROM table WHERE name =' </font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2）SELECT * FROM table WHERE name =“ </font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3）SELECT * </font></font><em class="replaceable"><code>str</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FROM``WHERE id = 103
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要为每个语句正确执行转义，请</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote" title="27.8.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          按以下方式</font><font style="vertical-align: inherit;">调用
           </font><font style="vertical-align: inherit;">，其中最后一个参数指示引用上下文：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1）len = mysql_real_escape_string_quote（＆mysql，to，from，from_len，'\''）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2）len = mysql_real_escape_string_quote（＆mysql，to，from，from_len，'''）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3）len = mysql_real_escape_string_quote（＆mysql，to，from，from_len，'`'）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您必须更改连接的字符集，请使用该</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-character-set" title="27.8.7.67 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数而不是执行</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET
          NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-character-set" title="13.7.4.2 SET CHARACTER SET语法"><code class="literal">SET CHARACTER
          SET</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）语句。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-character-set" title="27.8.7.67 mysql_set_character_set（）"><code class="literal">mysql_set_character_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          作品像</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但也会影响所使用的字符集
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string-quote" title="27.8.7.56 mysql_real_escape_string_quote（）"><code class="literal">mysql_real_escape_string_quote()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不是。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-quote-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例将两个转义字符串插入</font></font><code class="literal">INSERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中，每个</font><font style="vertical-align: inherit;">字符串
           </font><font style="vertical-align: inherit;">都在单引号字符中：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char查询[1000]，*结束;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = my_stpcpy（query，“INSERT INTO test_table VALUES（'”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end + = mysql_real_escape_string_quote（＆mysql，end，“这是什么”，12，'\''）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = my_stpcpy（end，“'，'”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end + = mysql_real_escape_string_quote（＆mysql，end，“binary data：\ 0 \ r \ n”，16，'\''）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
end = my_stpcpy（end，“'）”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_real_query（＆mysql，query，（unsigned int）（end  -  query）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   fprintf（stderr，“无法插入行，错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_error（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">my_stpcpy()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例中使用</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">函数包含在</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          库中，其工作原理与此类似，</font></font><code class="literal">strcpy()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但会返回指向第一个参数的终止null的指针。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-quote-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          放入</font></font><code class="literal">to</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">中的编码字符串的长度
           </font><font style="vertical-align: inherit;">，不包括终止空字节。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-escape-string-quote-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-real-query"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.57 mysql_real_query（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959567024"></a><p>
        <code class="literal">int mysql_real_query(MYSQL *mysql, const char
        *stmt_str, unsigned long length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-real-query-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          执行所指向的SQL语句
           </font></font><code class="literal">stmt_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，字符串
           </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节长。</font><font style="vertical-align: inherit;">通常，字符串必须由一个没有终止分号（</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或</font><font style="vertical-align: inherit;">单个SQL语句组成</font></font><code class="literal">\g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果启用了多语句执行，则该字符串可以包含多个用分号分隔的语句。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-queries" title="27.8.16 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.16节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不能用于包含二进制数据的语句; </font><font style="vertical-align: inherit;">你必须
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改用。</font><font style="vertical-align: inherit;">（二进制数据可能包含</font></font><code class="literal">\0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符，它被</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解释为语句字符串的结尾。）另外，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">速度比</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为它不调用</font></font><code class="literal">strlen()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句字符串</font><font style="vertical-align: inherit;">要快</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果你想知道这个语句是否返回一个结果集，你可以用它
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来检查这个。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.22节“mysql_field_count（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-query-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-real-query-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-refresh"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.58 mysql_refresh（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959534368"></a><p>
        <code class="literal">int mysql_refresh(MYSQL *mysql, unsigned int
        options)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-refresh-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            从MySQL 5.7.11开始，</font></font><code class="literal">mysql_refresh()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已被弃用，并将在未来版本的MySQL中删除。</font><font style="vertical-align: inherit;">相反，使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            执行</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush" title="13.7.6.3 FLUSH语法"><code class="literal">FLUSH</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数刷新表或缓存，或重置复制服务器信息。</font><font style="vertical-align: inherit;">连接的用户必须具有该
           </font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_reload"><code class="literal">RELOAD</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特权。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">options</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是由以下值的任意组合构成的位掩码。</font><font style="vertical-align: inherit;">多个值可以组合在一起以通过单个呼叫执行多个操作。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">REFRESH_GRANT</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              刷新授权表，如</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush-privileges"><code class="literal">FLUSH
              PRIVILEGES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_LOG</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              冲洗日志，就像</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush-logs"><code class="literal">FLUSH
              LOGS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_TABLES</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              刷新表缓存，就像</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush-tables"><code class="literal">FLUSH
              TABLES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_HOSTS</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              刷新主机缓存，如</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush-hosts"><code class="literal">FLUSH
              HOSTS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_STATUS</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              重置状态变量，如</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush-status"><code class="literal">FLUSH
              STATUS</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_THREADS</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              刷新线程缓存。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_SLAVE</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在从属复制服务器上，重置主服务器信息并重新启动从属服务器
               </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#reset-slave" title="13.4.2.4 RESET SLAVE语法"><code class="literal">RESET SLAVE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">REFRESH_MASTER</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在主复制服务器上，删除二进制日志索引中列出的二进制日志文件并截断​​索引文件，如</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER语法"><code class="literal">RESET
              MASTER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-refresh-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-refresh-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-reload"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.59 mysql_reload（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959484832"></a><p>
        <code class="literal">int mysql_reload(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-reload-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请求MySQL服务器重新加载授权表。</font><font style="vertical-align: inherit;">连接的用户必须具有该
           </font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_reload"><code class="literal">RELOAD</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特权。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此功能已弃用。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">使用
           </font><font style="vertical-align: inherit;">来发出SQL
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#flush-privileges"><code class="literal">FLUSH PRIVILEGES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-reload-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-reload-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-reset-connection"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.60 mysql_reset_connection（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959461536"></a><p>
        <code class="literal">int mysql_reset_connection(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-reset-connection-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          重置连接以清除会话状态。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-reset-connection" title="27.8.7.60 mysql_reset_connection（）"><code class="literal">mysql_reset_connection()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有类似于
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-change-user" title="27.8.7.3 mysql_change_user（）"><code class="literal">mysql_change_user()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或自动重新连接的效果，除非连接未关闭并重新打开，并且未执行重新认证。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-change-user" title="27.8.7.3 mysql_change_user（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.3节“mysql_change_user（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）并参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-auto-reconnect" title="27.8.20 C API自动重新连接控制"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.20节“C API自动重新连接控制”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与连接有关的状态受影响如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              任何活动的事务都回滚并且自动提交模式被重置。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              所有表锁都被释放。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              所有</font></font><code class="literal">TEMPORARY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格都关闭（并丢弃）。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              会话系统变量重新初始化为相应全局系统变量的值，包括系统变量，这些系统变量由语句（例如）隐式设置</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用户变量设置丢失。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              已准备好的声明已发布。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#handler" title="13.2.4 HANDLER语法"><code class="literal">HANDLER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 变量被关闭。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              值
               </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被重置为0。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              获得的锁
               </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被释放。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-reset-connection-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-rollback"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.61 mysql_rollback（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959435136"></a><p>
        <code class="literal">my_bool mysql_rollback(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-rollback-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          回滚当前事务。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个函数的作用取决于</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">的值
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">特别是，如果</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is
           </font></font><code class="literal">RELEASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或2）</font><font style="vertical-align: inherit;">的值
           </font><font style="vertical-align: inherit;">，服务器在终止事务并关闭客户端连接后执行释放。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-close" title="27.8.7.5 mysql_close（）"><code class="literal">mysql_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从客户端程序</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">关闭客户端的连接。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-rollback-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-rollback-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-row-seek"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.62 mysql_row_seek（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959421536"></a><p>
        <code class="literal">MYSQL_ROW_OFFSET mysql_row_seek(MYSQL_RES *result,
        MYSQL_ROW_OFFSET offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-row-seek-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将行游标设置为查询结果集中的任意行。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是行偏移量，通常是从</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-tell" title="27.8.7.63 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font><font style="vertical-align: inherit;">返回的值
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-seek" title="27.8.7.62 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值不是行号; </font><font style="vertical-align: inherit;">在数字结果集内寻找一行，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-data-seek" title="27.8.7.9 mysql_data_seek（）"><code class="literal">mysql_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          取而代之。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数要求结果集结构包含查询的整个结果，因此
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-seek" title="27.8.7.62 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能只能与结合使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不能与</font><font style="vertical-align: inherit;">结合
           </font><font style="vertical-align: inherit;">使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-row-seek-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行游标的前一个值。</font><font style="vertical-align: inherit;">该值可能会传递给后续的呼叫
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-seek" title="27.8.7.62 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-row-seek-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-row-tell"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.63 mysql_row_tell（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959402720"></a><p>
        <code class="literal">MYSQL_ROW_OFFSET mysql_row_tell(MYSQL_RES
        *result)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-row-tell-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回最后一行的光标的当前位置
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值可以用作参数
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-seek" title="27.8.7.62 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-tell" title="27.8.7.63 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只有之后</font><font style="vertical-align: inherit;">
          使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不是之后</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-row-tell-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行光标的当前偏移量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-row-tell-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-select-db"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.64 mysql_select_db（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959387520"></a><p>
        <code class="literal">int mysql_select_db(MYSQL *mysql, const char
        *db)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-select-db-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使指定的数据库</font></font><code class="literal">db</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成为指定的连接上的默认（当前）数据库</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在随后的查询中，此数据库是不包含显式数据库说明符的表引用的默认值。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-select-db" title="27.8.7.64 mysql_select_db（）"><code class="literal">mysql_select_db()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 除非所连接的用户可以被认证为具有使用数据库的权限。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-select-db-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-select-db-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-session-track-get-first"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.65 mysql_session_track_get_first（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959365824"></a><a class="indexterm" name="idm140527959364736"></a><p>
        <code class="literal">int mysql_session_track_get_first(MYSQL *mysql, enum
        enum_session_state_type type, const char **data, size_t
        *length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-first-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该功能获取从服务器接收到的第一个会话状态变化信息。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了控制对会话的更改状态通知，使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_session_track_state_change"><code class="literal">session_track_state_change</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_session_track_schema"><code class="literal">session_track_schema</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_session_track_system_variables"><code class="literal">session_track_system_variables</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_session_track_gtids"><code class="literal">session_track_gtids</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          系统变量（参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/server-administration.html#server-system-variables" title="5.1.5服务器系统变量"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.5节，“服务器系统变量”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数参数的使用如下。</font><font style="vertical-align: inherit;">这些描述也适用于
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-next" title="27.8.7.66 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它采用相同的参数。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：连接处理程序。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：要检索的信息的类型。</font><font style="vertical-align: inherit;">此参数的允许值是在以下</font></font><code class="literal">enum_session_state_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              定义</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">枚举</font><font style="vertical-align: inherit;">的成员</font></font><code class="filename">mysql_com.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
            </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举enum_session_state_type</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_SYSTEM_VARIABLES，/ *会话系统变量* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_SCHEMA，/ *当前模式* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_STATE_CHANGE / *跟踪会话状态更改* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  SESSION_TRACK_GTIDS，/ *追踪GTID / *</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
};</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为了便于循环所有可能类型的会话信息，</font><font style="vertical-align: inherit;">宏</font></font><code class="literal">SESSION_TRACK_BEGIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              和</font></font><code class="literal">SESSION_TRACK_END</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">宏被定义为等于</font></font><code class="literal">enum_session_state_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举</font><font style="vertical-align: inherit;">的第一个和最后一个成员
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">本节后面显示的示例代码演示了这种技术。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code class="literal">const
              char *</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">的地址</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在成功调用之后，此变量指向返回的数据，应将其视为只读。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code class="literal">size_t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">的地址
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">调用成功后，此变量包含</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">指向的数据的长度</font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在成功调用之后，</font><font style="vertical-align: inherit;">根据该</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">解释
           </font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值</font></font><code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如下所示：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_SCHEMA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
               </font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是新的默认模式名称，
               </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是名称长度。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_SYSTEM_VARIABLES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：当会话系统变量发生变化时，每个变量返回两个值（在不同的调用中）。</font><font style="vertical-align: inherit;">对于第一次调用，
               </font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量名称
               </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是名称长度。</font><font style="vertical-align: inherit;">对于第二次调用，</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是变量值并且</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是值的长度。</font><font style="vertical-align: inherit;">值这两个数据值都表示为字符串。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_STATE_CHANGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
               </font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个包含布尔标志的字节，用于指示是否发生会话状态更改并且</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应为1.该标志表示为ASCII值，而不是二进制（例如
               </font></font><code class="literal">'1'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，不是</font></font><code class="literal">0x01</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">SESSION_TRACK_GTIDS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
               </font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含GTID设置信息并且</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是其长度。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-first-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-first-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-first-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例显示如何调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-first" title="27.8.7.65 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          并
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-next" title="27.8.7.66 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          检索并显示成功执行SQL语句字符串（表示为</font></font><code class="literal">stmt_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）后</font><font style="vertical-align: inherit;">所有可用的会话状态更改信息</font><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">printf（“执行：％s \ n”，stmt_str）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_query（mysql，stmt_str）！= 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“错误％u：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_errno（mysql），mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  返回;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_RES * result = mysql_store_result（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（结果）/ *有一个结果集要获取* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * ...在这里处理行... * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“返回的行数：％lu \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          （unsigned long）mysql_num_rows（result））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  了mysql_free_result（结果）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
其他/ *没有结果集* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（mysql_field_count（mysql）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“受影响的行数：％lu \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            （unsigned long）mysql_affected_rows（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他/ *发生错误* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误％u：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
             mysql_errno（mysql），mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *提取任何可用的会话状态更改信息* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
枚举enum_session_state_type类型;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
for（type = SESSION_TRACK_BEGIN; type &lt;= SESSION_TRACK_END; type ++）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  const char * data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  size_t长度;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（mysql_session_track_get_first（mysql，type，＆data，＆length）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“Type =％d：\ n”，type）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“mysql_session_track_get_first（）返回：％*。* s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            （int）长度，（int）长度，数据）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *检查更多数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    while（mysql_session_track_get_next（mysql，type，＆data，＆length）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“mysql_session_track_get_next（）返回：％*。* s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （int）长度，（int）长度，数据）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-session-track-get-next"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.66 mysql_session_track_get_next（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959307136"></a><a class="indexterm" name="idm140527959306048"></a><p>
        <code class="literal">int mysql_session_track_get_next(MYSQL *mysql, enum
        enum_session_state_type type, const char **data, size_t
        *length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-next-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数获取从服务器接收到的会话状态更改信息，然后检索
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-first" title="27.8.7.65 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功调用之后</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-first" title="27.8.7.65 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-next" title="27.8.7.66 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          重复</font><font style="vertical-align: inherit;">调用
           </font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">直到返回非零值，表示没有更多信息可用。</font><font style="vertical-align: inherit;">调用序列与用于的调用序列
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-next" title="27.8.7.66 mysql_session_track_get_next（）"><code class="literal">mysql_session_track_get_next()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          相似
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-first" title="27.8.7.65 mysql_session_track_get_first（）"><code class="literal">mysql_session_track_get_first()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关演示这两个函数的更多信息和示例，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-session-track-get-first" title="27.8.7.65 mysql_session_track_get_first（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.65节“mysql_session_track_get_first（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-next-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-session-track-get-next-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-set-character-set"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.67 mysql_set_character_set（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959289424"></a><p>
        <code class="literal">int mysql_set_character_set(MYSQL *mysql, const char
        *csname)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-set-character-set-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该功能用于设置当前连接的默认字符集。</font><font style="vertical-align: inherit;">该字符串</font></font><code class="literal">csname</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定一个有效的字符集名称。</font><font style="vertical-align: inherit;">连接归类成为字符集的默认归类。</font><font style="vertical-align: inherit;">这个函数像</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET
          NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font><font style="vertical-align: inherit;">一样工作</font><font style="vertical-align: inherit;">，但也设置了它的值
           </font></font><code class="literal">mysql-&gt;charset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，从而影响了所使用的字符集
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-escape-string" title="27.8.7.55 mysql_real_escape_string（）"><code class="literal">mysql_real_escape_string()</code></a>
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-character-set-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-character-set-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL mysql;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_init（与MySQL）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！mysql_real_connect（＆mysql，“host”，“user”，“passwd”，“database”，0，NULL，0））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“无法连接到数据库：错误：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          mysql_error（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！mysql_set_character_set（＆mysql，“utf8”））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“新客户端字符集：％s \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           mysql_character_set_name（与MySQL））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-set-local-infile-default"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.68 mysql_set_local_infile_default（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959275536"></a><a class="indexterm" name="idm140527959274448"></a><p>
        <code class="literal">void mysql_set_local_infile_default(MYSQL
        *mysql);</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-default-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA
          LOCAL INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回调函数设置为C客户端库内部使用的默认值。</font><font style="vertical-align: inherit;">如果库</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-local-infile-handler" title="27.8.7.69 mysql_set_local_infile_handler（）"><code class="literal">mysql_set_local_infile_handler()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有被调用或者不为每个回调提供有效的函数，</font><font style="vertical-align: inherit;">库自动调用该函数
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-default-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-default-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-set-local-infile-handler"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.69 mysql_set_local_infile_handler（）</font></font></h4>

</div>

</div>

</div>
<p>
        <code class="literal">void mysql_set_local_infile_handler(MYSQL *mysql, int
        (*local_infile_init)(void **, const char *, void *), int
        (*local_infile_read)(void *, char *, unsigned int), void
        (*local_infile_end)(void *), int (*local_infile_error)(void *,
        char*, unsigned int), void *userdata);</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-handler-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数安装在执行</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD
          DATA LOCAL INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">期间使用的回调</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它使应用程序能够对本地（客户端）数据文件读取进行控制。</font><font style="vertical-align: inherit;">参数是连接处理程序，一组指向回调函数的指针以及指向数据区域的指针，回调可用于共享信息。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-local-infile-handler" title="27.8.7.69 mysql_set_local_infile_handler（）"><code class="literal">mysql_set_local_infile_handler()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，您必须编写以下回调函数：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INT</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
local_infile_init（void ** ptr，const char * filename，void * userdata）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          初始化函数。</font><font style="vertical-align: inherit;">这被调用一次来完成必要的设置，打开数据文件，分配数据结构等等。</font><font style="vertical-align: inherit;">第一个</font></font><code class="literal">void**</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是一个指向指针的指针。</font><font style="vertical-align: inherit;">您可以将指针（即，
           </font></font><code class="literal">*ptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）设置为一个将传递给其他每个回调的值（如a </font></font><code class="literal">void*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">回调可以使用这个指向的值来维护状态信息。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">userdata</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是传递到相同的值
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-local-infile-handler" title="27.8.7.69 mysql_set_local_infile_handler（）"><code class="literal">mysql_set_local_infile_handler()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使初始化函数成功返回零，非零则返回错误。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INT</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
local_infile_read（void * ptr，char * buf，unsigned int buf_len）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          数据读取功能。</font><font style="vertical-align: inherit;">这被重复调用来读取数据文件。</font></font><code class="literal">buf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指向存储读取数据的缓冲区，并且</font></font><code class="literal">buf_len</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          是回调可以读取和存储在缓冲区中的最大字节数。</font><font style="vertical-align: inherit;">（它可以读取更少的字节，但不应该读更多。）
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值是读取的字节数，如果不能读取更多数据（这表示EOF），则为零。</font><font style="vertical-align: inherit;">如果发生错误，则返回小于零的值。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空虚</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
local_infile_end（void * ptr）</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          终止功能。</font><font style="vertical-align: inherit;">这在</font></font><code class="literal">local_infile_read()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回零（EOF）或错误</font><font style="vertical-align: inherit;">后被调用一次
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这个函数中，释放分配的任何内存</font></font><code class="literal">local_infile_init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并执行必要的其他清理。</font><font style="vertical-align: inherit;">即使初始化函数返回错误，也会调用它。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INT</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
local_infile_error（void * ptr，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                   char * error_msg，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                   unsigned int error_msg_len）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          错误处理函数。</font><font style="vertical-align: inherit;">这被称为获取文本错误消息以返回给用户，以防其他函数返回错误。</font></font><code class="literal">error_msg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向写入消息的缓冲区，并且
           </font></font><code class="literal">error_msg_len</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是缓冲区的长度。</font><font style="vertical-align: inherit;">将消息写为空字符串，</font></font><code class="literal">error_msg_len</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最长</font><font style="vertical-align: inherit;">为
           </font><font style="vertical-align: inherit;">1个字节。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值是错误号。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通常，其他回调将错误消息存储在所指向的数据结构中</font></font><code class="literal">ptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以便
           </font></font><code class="literal">local_infile_error()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以将消息从那里复制到</font></font><code class="literal">error_msg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-local-infile-handler" title="27.8.7.69 mysql_set_local_infile_handler（）"><code class="literal">mysql_set_local_infile_handler()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          C代码并将指针传递给回调函数之后，可以发出一条
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA LOCAL
          INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句（例如，通过使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">客户端库自动调用您的回调。</font><font style="vertical-align: inherit;">指定的文件名将</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD
          DATA LOCAL INFILE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为第二个参数传递给</font></font><code class="literal">local_infile_init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          回调</font><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-handler-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-local-infile-handler-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-set-server-option"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.70 mysql_set_server_option（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959224768"></a><p>
        <code class="literal">int mysql_set_server_option(MYSQL *mysql, enum
        enum_mysql_set_option option)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-set-server-option-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          启用或禁用连接选项。
          </font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以具有以下值之一。
</font></font></p>
<div class="informaltable">
<table summary="Options for mysql_set_server_option() and a description of each option."><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_ON</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用多语句支持</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_OFF</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用多语句支持</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果启用多语句支持，则应从调用中检索结果，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用调用的循环
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来确定是否有更多结果。</font><font style="vertical-align: inherit;">有关示例，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-queries" title="27.8.16 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.16节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          启用多语句支持与</font></font><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_ON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过将</font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志
           </font><font style="vertical-align: inherit;">传递给</font><font style="vertical-align: inherit;">启用多语句支持的效果
           </font><font style="vertical-align: inherit;">并不完全相同
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
           </font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也启用
           </font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果您</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在程序</font><font style="vertical-align: inherit;">中使用
           </font><font style="vertical-align: inherit;">SQL语句，则必须启用多重结果支持; </font><font style="vertical-align: inherit;">这意味着它</font></font><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_ON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本身不足以允许使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-server-option-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-set-server-option-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_er_unknown_com_error"><code class="literal">ER_UNKNOWN_COM_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              服务器不支持
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-server-option" title="27.8.7.70 mysql_set_server_option（）"><code class="literal">mysql_set_server_option()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （服务器的版本低于4.1.1）或者服务器不支持试图设置的选项。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-shutdown"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.71 mysql_shutdown（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959179968"></a><p>
        <code class="literal">int mysql_shutdown(MYSQL *mysql, enum
        mysql_enum_shutdown_level shutdown_level)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-shutdown-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>

</div>

</div>

</div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p>
            <code class="literal">mysql_shutdown()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已被弃用，并将在未来版本的MySQL中删除。</font><font style="vertical-align: inherit;">相反，使用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#shutdown" title="13.7.6.7 SHUTDOWN语法"><code class="literal">SHUTDOWN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要求数据库服务器关闭。</font><font style="vertical-align: inherit;">连接的用户必须具有该</font></font><a class="link" href="/mysql-5.7-google-zh/security.html#priv_shutdown"><code class="literal">SHUTDOWN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特权。</font><font style="vertical-align: inherit;">MySQL服务器只支持一种类型的关闭;
          </font></font><code class="literal">shutdown_level</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须等于
           </font></font><code class="literal">SHUTDOWN_DEFAULT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">动态链接的可执行文件</font><font style="vertical-align: inherit;">需要与旧的</font><font style="vertical-align: inherit;">动态库</font><font style="vertical-align: inherit;">一起使用，这些</font><font style="vertical-align: inherit;">可执行文件使用旧版本的</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">头文件和调用
           </font><font style="vertical-align: inherit;">进行编译</font><font style="vertical-align: inherit;">。
        </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-shutdown" title="27.8.7.71 mysql_shutdown（）"><code class="literal">mysql_shutdown()</code></a><font style="vertical-align: inherit;"></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另一种方法
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-shutdown" title="27.8.7.71 mysql_shutdown（）"><code class="literal">mysql_shutdown()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#shutdown" title="13.7.6.7 SHUTDOWN语法"><code class="literal">SHUTDOWN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL语句。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="xref" href="/mysql-5.7-google-zh/server-administration.html#server-shutdown" title="5.1.13服务器关闭进程"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.1.13节“服务器关闭过程”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          介绍了
           </font><a class="xref" href="/mysql-5.7-google-zh/server-administration.html#server-shutdown" title="5.1.13服务器关闭进程"><font style="vertical-align: inherit;">关闭过程</font></a><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-shutdown-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-shutdown-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-sqlstate"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.72 mysql_sqlstate（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959147968"></a><p>
        <code class="literal">const char *mysql_sqlstate(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-sqlstate-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回包含最近执行的SQL语句的SQLSTATE错误代码的以NULL结尾的字符串。</font><font style="vertical-align: inherit;">错误代码由五个字符组成。</font></font><code class="literal">'00000'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          意味着</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有错误。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些值由ANSI SQL和ODBC指定。</font><font style="vertical-align: inherit;">有关可能值的列表，请参阅
           </font></font><a class="xref" href="/mysql-5.7-google-zh/error-handling.html" title="附录B错误，错误代码和常见问题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录B，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误，错误代码和常见问题</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回的SQLSTATE值与返回的
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate" title="27.8.7.72 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL特定错误号不同
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行工具"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端程序使用以下格式显示错误，其中</font></font><code class="literal">1146</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值并且
           </font></font><code class="literal">'42S02'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是相应的
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate" title="27.8.7.72 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值：
        </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外壳&gt; </font></font><strong class="userinput"><code>SELECT * FROM no_such_table;</code></strong><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误1146（42S02）：表'test.no_such_table'不存在</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          并非所有的MySQL错误编号都映射到SQLSTATE错误代码。</font><font style="vertical-align: inherit;">值</font></font><code class="literal">'HY000'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（一般错误）用于未映射的错误编号。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate" title="27.8.7.72 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          失败</font><font style="vertical-align: inherit;">后</font><font style="vertical-align: inherit;">致电</font><font style="vertical-align: inherit;">，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate" title="27.8.7.72 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能不会返回有用的值。</font><font style="vertical-align: inherit;">例如，如果主机被服务器阻塞并且连接关闭而没有向客户端发送任何SQLSTATE值，则会发生这种情况。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-sqlstate-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          包含SQLSTATE错误代码的以空字符结尾的字符串。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-sqlstate-see-also"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也可以看看</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.14节“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.15节“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-sqlstate" title="27.8.11.27 mysql_stmt_sqlstate（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.27节“mysql_stmt_sqlstate（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-ssl-set"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.73 mysql_ssl_set（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959119856"></a><p>
        <code class="literal">my_bool mysql_ssl_set(MYSQL *mysql, const char *key,
        const char *cert, const char *ca, const char *capath, const char
        *cipher)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-ssl-set-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于使用SSL建立加密连接。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数必须是一个有效的连接处理程序。</font><font style="vertical-align: inherit;">任何未使用的SSL参数可以给出
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果使用，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须先调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除非在客户端库中启用SSL支持，否则什么也不做。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取加密连接</font><font style="vertical-align: inherit;">是可选的，
           </font><font style="vertical-align: inherit;">因为默认情况下，如果服务器支持加密连接，则MySQL程序尝试使用加密进行连接，如果无法建立加密连接，则回退到未加密连接（请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#using-encrypted-connections" title="6.4.1配置MySQL以使用加密连接"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.4.1节“配置MySQL使用加密连接“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于必须指定特定证书和密钥文件，加密密码等的应用程序可能很有用。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定用于建立加密连接的SSL信息（如证书和密钥文件）（如果此类连接可用），但不强制要求加密获得的连接。</font><font style="vertical-align: inherit;">要求加密连接，请使用
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-encrypted-connections" title="27.8.15 C API加密连接支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.15节“C API加密连接支持”中介绍的技术</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          相对于默认加密提供的额外安全性，客户端可以提供与服务器使用的证书相匹配的CA证书并启用主机名身份验证。</font><font style="vertical-align: inherit;">通过这种方式，服务器和客户端将它们的信任置于相同的CA证书中，并且客户端验证它所连接的主机是否是预期的主机。</font><font style="vertical-align: inherit;">有关详细信息，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-encrypted-connections" title="27.8.15 C API加密连接支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.15节“C API加密连接支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个便利的功能，它基本上等同于这组</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_options（mysql，MYSQL_OPT_SSL_KEY，key）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（mysql，MYSQL_OPT_SSL_CERT，cert）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（mysql，MYSQL_OPT_SSL_CA，ca）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（mysql，MYSQL_OPT_SSL_CAPATH，capath）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（mysql，MYSQL_OPT_SSL_CIPHER，cipher）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          正因为如此等价的，应用程序可以，而不是调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接，省略对于其期权价值是这些选项调用
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此外，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还提供不可用的加密连接选项
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，例如
           </font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定连接的安全状态，以及
           </font></font><code class="literal">MYSQL_OPT_TLS_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定客户端允许加密连接的协议。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从中返回的连接处理程序</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户机私钥文件的路径名称。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">cert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户端公钥证书文件的路径名。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">ca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：证书颁发机构（CA）证书文件的路径名称。</font><font style="vertical-align: inherit;">该选项（如果使用）必须指定服务器使用的相同证书。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">capath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含可信SSL证书文件的目录的路径名。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">cipher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：SSL加密允许的密码列表。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-ssl-set-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个函数总是返回</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果SSL设置不正确，则</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在尝试连接时</font><font style="vertical-align: inherit;">，后续
           </font><font style="vertical-align: inherit;">调用会返回错误。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stat"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.74 mysql_stat（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959072256"></a><p>
        <code class="literal">const char *mysql_stat(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stat-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个包含与</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysqladmin" title="4.5.2 mysqladmin  - 用于管理MySQL服务器的客户端"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysqladmin status</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
          命令</font><font style="vertical-align: inherit;">提供的信息类似的信息的字符串</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这包括以秒计的正常运行时间以及正在运行的线程，问题，重新加载和打开的表的数量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stat-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          描述服务器状态的字符串。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stat-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-store-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.75 mysql_store_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527959052000"></a><p>
        <code class="literal">MYSQL_RES *mysql_store_result(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-store-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          调用之后</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，你必须调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为每个成功产生一个结果集的语句（</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show" title="13.7.5 SHOW语法"><code class="literal">SHOW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#describe" title="13.8.1 DESCRIBE语法"><code class="literal">DESCRIBE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE语法"><code class="literal">CHECK TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等）。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在完成结果集后，您</font><font style="vertical-align: inherit;">还必须致电
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您无需致电
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或发送
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他声明，但如果您</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在任何情况下</font><font style="vertical-align: inherit;">致电，则不会造成任何伤害或造成任何显着的性能下降
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可以通过检查是否</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非零值</font><font style="vertical-align: inherit;">来检测语句是否具有结果集
           </font><font style="vertical-align: inherit;">（稍后会详细介绍）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果启用多语句支持，则应从调用中检索结果，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用调用的循环
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来确定是否有更多结果。</font><font style="vertical-align: inherit;">有关示例，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-multiple-queries" title="27.8.16 C API多语句执行支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.16节“C API多语句执行支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果你想知道一个语句是否应该返回一个结果集，你可以用它
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来检查这个。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.22节“mysql_field_count（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将查询的整个结果读取到客户端，分配
           </font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构并将结果放入此结构中。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果语句没有返回结果集（例如，如果它是一个</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          语句）</font><font style="vertical-align: inherit;">，则返回空指针</font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果读取结果集失败，也返回一个空指针。</font><font style="vertical-align: inherit;">您可以通过检查是否</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非空字符串，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回非零值或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回零</font><font style="vertical-align: inherit;">来检查是否发生错误
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果没有返回行，则返回空结果集。</font><font style="vertical-align: inherit;">（空结果集与空指针不同，作为返回值。）
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并获取不是空指针的结果后，可以调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以查明结果集中有多少行。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          你可以调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从结果集读取行，或者
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-seek" title="27.8.7.62 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-tell" title="27.8.7.63 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取或设置结果集中的当前行位置。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#null-mysql-store-result" title="27.8.21.1为什么mysql_store_result（）有时在mysql_query（）返回成功后返回NULL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.21.1节“为什么在mysql_query（）返回成功后mysql_store_result（）有时返回NULL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-store-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          甲</font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果结构的结果。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（0）如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-store-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重置
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果成功。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-thread-id"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.76 mysql_thread_id（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958980400"></a><p>
        <code class="literal">unsigned long mysql_thread_id(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-thread-id-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回当前连接的线程ID。</font><font style="vertical-align: inherit;">该值可以用作</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-kill" title="27.8.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">杀死线程</font><font style="vertical-align: inherit;">的参数
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果连接丢失并且您重新连接
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，线程ID会更改。</font><font style="vertical-align: inherit;">这意味着你不应该得到线程ID并将其存储以备后用。</font><font style="vertical-align: inherit;">你需要的时候应该得到它。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果线程ID变得大于32位（在某些系统上可能会发生），此功能无法正常工作。</font><font style="vertical-align: inherit;">为避免出现问题
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-id" title="27.8.7.76 mysql_thread_id（）"><code class="literal">mysql_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请勿使用它。</font><font style="vertical-align: inherit;">要获取连接ID，请执行</font></font><code class="literal">SELECT
            CONNECTION_ID()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询并检索结果。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-id-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当前连接的线程ID。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-id-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-use-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.77 mysql_use_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958965680"></a><p>
        <code class="literal">MYSQL_RES *mysql_use_result(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-use-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          调用之后</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，你必须调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          或者</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为每个成功产生一个结果集的语句（</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show" title="13.7.5 SHOW语法"><code class="literal">SHOW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#describe" title="13.8.1 DESCRIBE语法"><code class="literal">DESCRIBE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE语法"><code class="literal">CHECK TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，等等）。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在完成结果集后，您</font><font style="vertical-align: inherit;">还必须致电
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启动结果集检索，但实际上并没有将结果集读入客户端
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">相反，每行必须通过调用来单独检索</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这将直接从服务器读取查询结果，而不将其存储在临时表或本地缓冲区中，这比使用更快的内存和更少的内存
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">客户端仅为当前行和可能增长到</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字节</font><font style="vertical-align: inherit;">的通信缓冲区分配内存
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另一方面，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您正在为客户端上的每一行执行大量处理，或者输出发送到用户可能键入的屏幕</font></font><code class="literal">^S</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（停止滚动）</font><font style="vertical-align: inherit;">，则不应使用
           </font><font style="vertical-align: inherit;">锁定读取</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这将绑定服务器并阻止其他线程更新从中获取数据的任何表。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用时</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，必须执行
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直到
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值，否则，未提取的行将作为下一个查询的结果集的一部分返回。</font></font><code class="literal">Commands out of
          sync; you can't run this command now</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果你忘记这样做</font><font style="vertical-align: inherit;">，C API会给出错误</font><font style="vertical-align: inherit;">！
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          您不得使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-data-seek" title="27.8.7.9 mysql_data_seek（）"><code class="literal">mysql_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-seek" title="27.8.7.62 mysql_row_seek（）"><code class="literal">mysql_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-row-tell" title="27.8.7.63 mysql_row_tell（）"><code class="literal">mysql_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从返回的结果
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，也不得发出其他查询，直至
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完成。</font><font style="vertical-align: inherit;">（但是，在获取所有行后，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准确返回</font><font style="vertical-align: inherit;">所读取的行
           </font><font style="vertical-align: inherit;">数。）
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一旦完成了结果集，</font><font style="vertical-align: inherit;">
          您就必须致电
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在使用</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌入式服务器时，内存的好处基本上会丢失，因为</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在调用</font><font style="vertical-align: inherit;">每一行之前，内存使用量会逐渐增加
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-use-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个</font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果结构。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-use-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重置
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果成功。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-warning-count"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.7.78 mysql_warning_count（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958898000"></a><p>
        <code class="literal">unsigned int mysql_warning_count(MYSQL
        *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-warning-count-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回执行前一个SQL语句期间生成的错误，警告和注释的数量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-warning-count-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          警告计数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-warning-count-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statements"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.8 C API准备的语句</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958888288"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL客户端/服务器协议提供了使用准备好的语句。</font><font style="vertical-align: inherit;">此功能使用</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      由</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init" title="27.8.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初始化函数</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">语句处理程序数据结构
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">准备好的执行是多次执行语句的有效方法。</font><font style="vertical-align: inherit;">该语句首先被解析以准备执行。</font><font style="vertical-align: inherit;">然后使用初始化函数返回的语句处理程序在稍后执行一次或多次。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对于多次执行的语句，准备执行比直接执行要快，主要是因为查询只解析一次。</font><font style="vertical-align: inherit;">在直接执行的情况下，查询在每次执行时都会被解析。</font><font style="vertical-align: inherit;">准备好的执行还可以减少网络流量，因为对于准备好的语句的每次执行，只需要发送参数的数据。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      在某些情况下，编写的声明可能不会提高性能。</font><font style="vertical-align: inherit;">为了获得最佳结果，请使用准备和非准备语句来测试您的应用程序，并选择最佳性能。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      预准备语句的另一个优点是它使用二进制协议，使客户端和服务器之间的数据传输更加高效。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关可用作预准备语句的SQL语句列表，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#sql-syntax-prepared-statements" title="13.5准备的SQL语句语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.5节“准备</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好的</font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#sql-syntax-prepared-statements" title="13.5准备的SQL语句语法"><font style="vertical-align: inherit;">SQL语句语法”</font></a><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      对准备好的语句引用的表或视图的元数据更改会被检测到，并在下次执行时导致语句自动重新编译。</font><font style="vertical-align: inherit;">有关更多信息，请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/optimization.html#statement-caching" title="8.10.4缓存准备好的语句和存储的程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.10.4节“准备好的语句和存储的程序的缓存”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-data-structures"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.9 C API编写的语句数据结构</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-type-codes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.9.1 C API编写的语句类型代码</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-type-conversions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.9.2 C API准备好的语句类型转换</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140527958878384"></a><a class="indexterm" name="idm140527958876880"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      编写的语句使用几种数据结构：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为了获得一个语句处理程序，传递一个</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          连接处理程序
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init" title="27.8.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，返回一个指向</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据结构</font><font style="vertical-align: inherit;">的指针</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这个结构用于声明的进一步操作。</font><font style="vertical-align: inherit;">要指定要准备的语句，请将
           </font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针和语句字符串传递给</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          为准备好的语句提供输入参数，设置
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构并传递给它们
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要接收输出列值，请设置
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构并将其传递给
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构用于在两个方向上传输时间数据。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下讨论详细描述了准备好的语句数据类型。</font><font style="vertical-align: inherit;">有关如何使用它们的示例，请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.10节“mysql_stmt_execute（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.11节“mysql_stmt_fetch（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="indexterm" name="idm140527958859328"></a>

          <code class="literal">MYSQL_STMT</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个结构是一个准备好的语句的处理程序。</font><font style="vertical-align: inherit;">处理程序通过调用创建
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init" title="27.8.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它返回指向a的指针</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该处理程序将用于该语句的所有后续操作，直到您将其关闭为止
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，此时处理程序将变为无效并且不应再使用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构没有用于应用程序的成员。</font><font style="vertical-align: inherit;">应用程序不应该尝试复制</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构。</font><font style="vertical-align: inherit;">不能保证这样的副本可用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          多个语句处理程序可以与单个连接相关联。</font><font style="vertical-align: inherit;">处理程序数量的限制取决于可用的系统资源。
        </font></font></p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140527958850272"></a>

          <code class="literal">MYSQL_BIND</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个结构既用于语句输入（发送到服务器的数据值）也用于输出（从服务器返回的结果值）：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输入，使用</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来将参数数据值绑定到缓冲区以供使用
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出，使用</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              将缓冲区绑定到结果集列，以用于使用行来获取行
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要使用</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构，将其内容置零以初始化它，然后适当地设置其成员。</font><font style="vertical-align: inherit;">例如，要声明和初始化三个</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的数组
           </font><font style="vertical-align: inherit;">，请使用以下代码：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_BIND绑定[3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
memset（bind，0，sizeof（bind））;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构包含以下用于应用程序的成员。</font><font style="vertical-align: inherit;">对于其中一些成员，使用方式取决于结构是用于输入还是输出。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">enum enum_field_types buffer_type</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              缓冲区的类型。</font><font style="vertical-align: inherit;">此成员指示绑定到语句参数或结果集列的C语言变量的数据类型。</font><font style="vertical-align: inherit;">对于输入，
               </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示包含要发送到服务器的值的变量的类型。</font><font style="vertical-align: inherit;">对于输出，它表示从服务器接收的值应该存储到的变量的类型。</font><font style="vertical-align: inherit;">有关允许</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-type-codes" title="27.8.9.1 C API编写的语句类型代码"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.9.1节“C API准备语句类型代码”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">void *buffer</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指向要用于数据传输的缓冲区的指针。</font><font style="vertical-align: inherit;">这是C语言变量的地址。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输入，</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个指向变量的指针，在该变量中存储语句参数的数据值。</font><font style="vertical-align: inherit;">当你调用时
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL使用存储在变量中的值代替语句中的相应参数标记（</font></font><code class="literal">?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在语句字符串中</font><font style="vertical-align: inherit;">指定</font><font style="vertical-align: inherit;">）。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出，</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个指向返回结果集列值的变量的指针。</font><font style="vertical-align: inherit;">当你调用时
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，MySQL在结果集的当前行中存储一个列值到这个变量中。</font><font style="vertical-align: inherit;">呼叫返回时您可以访问该值。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为了最大限度地减少MySQL在客户端的C语言值和服务器端的SQL值之间执行类型转换的需要，请使用类型与相应SQL值类型相似的C变量：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  对于数字数据类型，</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  应指向适当的数字C类型的变量。</font><font style="vertical-align: inherit;">对于整数变量（可以
                   </font></font><code class="literal">char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于单字节值或整数类型用于较大值），还应该</font></font><code class="literal">unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过设置</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员来</font><font style="vertical-align: inherit;">指示变量是否具有该
                   </font><font style="vertical-align: inherit;">属性
                   </font><font style="vertical-align: inherit;">，稍后介绍。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  对于字符（非二进制）和二进制字符串数据类型，</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应指向字符缓冲区。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  对于日期和时间数据类型，
                   </font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该指向一个
                   </font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              有关C类型和SQL类型之间映射的指导以及有关类型转换的注释，请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-type-codes" title="27.8.9.1 C API编写的语句类型代码"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.9.1节“C API准备语句类型代码”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-type-conversions" title="27.8.9.2 C API准备好的语句类型转换"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.9.2节“C API准备语句类型转换”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">unsigned long buffer_length</code>
            </p><p><font style="vertical-align: inherit;"></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以字节</font><font style="vertical-align: inherit;">
              为</font><font style="vertical-align: inherit;">单位</font><font style="vertical-align: inherit;">的实际大小</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这表示可以存储在缓冲区中的最大数据量。</font><font style="vertical-align: inherit;">对于字符和二进制C数据，该
               </font></font><code class="literal">buffer_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值指定</font></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定输入值</font><font style="vertical-align: inherit;">时</font><font style="vertical-align: inherit;">的长度</font><font style="vertical-align: inherit;">，或</font><font style="vertical-align: inherit;">用于
               </font><font style="vertical-align: inherit;">指定输入值时可以获取到缓冲区中的最大输出数据字节数
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">unsigned long *length</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              指向一个</font></font><code class="literal">unsigned long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">的指针</font><font style="vertical-align: inherit;">，指示存储在其中的实际数据字节数</font></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              用于字符或二进制C数据。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输入参数数据绑定，设置
               </font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为指示存储在中的参数值的实际长度
               </font></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这被使用
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出值绑定，MySQL </font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在您调用时进行
               </font><font style="vertical-align: inherit;">设置
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值决定如何解释长度：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果返回值为0，则</font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  表示参数值的实际长度。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果返回值是
                   </font></font><code class="literal">MYSQL_DATA_TRUNCATED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则
                   </font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示参数值的未截断长度。</font><font style="vertical-align: inherit;">在这种情况下，最小值</font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                   </font></font><code class="literal">buffer_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示值的实际长度。
</font></font></p></li></ul>
</div>
<p>
              <code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于数值和时态数据类型会被忽略，因为该
               </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值决定了数据值的长度。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              如果您在获取它之前必须确定返回值的长度，请参阅
               </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.11节“mysql_stmt_fetch（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以了解一些策略。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">my_bool *is_null</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              这个成员指向一个</font></font><code class="literal">my_bool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              变量，如果一个值为真则为真
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果不是则为假
               </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于输入，设置
               </font></font><code class="literal">*is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为true表示您将</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值作为语句参数</font><font style="vertical-align: inherit;">传递</font><font style="vertical-align: inherit;">。
            </font></font></p><p>
              <code class="literal">is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指向</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布尔标量</font><font style="vertical-align: inherit;">的
               </font><span class="emphasis"><em><font style="vertical-align: inherit;">指针</font></em></span><font style="vertical-align: inherit;">，而不是布尔标量，以提供指定</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值的</font><font style="vertical-align: inherit;">灵活性
               </font><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果您的数据值始终
                   </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，用
                   </font></font><code class="literal">MYSQL_TYPE_NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为
                   </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在绑定列值。</font><font style="vertical-align: inherit;">其他</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  成员，包括</font></font><code class="literal">is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并不重要。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  如果数据值总是</font></font><code class="literal">NOT
                  NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置</font></font><code class="literal">is_null = (my_bool*)
                  0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并设置适当的其他成员要绑定变量。
                </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  在其他所有情况下，适当地设置其他成员并将其设置</font></font><code class="literal">is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><code class="literal">my_bool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量</font><font style="vertical-align: inherit;">的地址</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在执行之间将该变量的值适当地设置为true或false，以分别指示相应的数据值是
                   </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">NOT
                  NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出，当你获取一行时，MySQL </font></font><code class="literal">is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据从语句返回的结果集列值是否是否将</font><font style="vertical-align: inherit;">指向的值设置</font><font style="vertical-align: inherit;">为true或false </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">my_bool is_unsigned</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              此构件适用于与数据类型C变量，可以是</font></font><code class="literal">unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              （</font></font><code class="literal">char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">short int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">long long int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is
               </font><font style="vertical-align: inherit;">指向的变量</font><font style="vertical-align: inherit;">设置</font><font style="vertical-align: inherit;">为true，否则</font><font style="vertical-align: inherit;">设置</font><font style="vertical-align: inherit;">为</font></font><code class="literal">unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false。</font><font style="vertical-align: inherit;">例如，如果你绑定一个</font></font><code class="literal">signed char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              变量</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，指定一个类型代码</font></font><code class="literal">MYSQL_TYPE_TINY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并设置
               </font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为false。</font><font style="vertical-align: inherit;">如果你绑定一个
               </font></font><code class="literal">unsigned char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，类型代码是相同的，但</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该是真的。</font><font style="vertical-align: inherit;">（因为</font></font><code class="literal">char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它没有定义它是有符号还是无符号的，所以最好使用明确的关于符号</font></font><code class="literal">signed
              char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或）</font></font><code class="literal">unsigned char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p>
              <code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅适用于客户端的C语言变量。</font><font style="vertical-align: inherit;">它没有指出服务器端相应SQL值的签名。</font><font style="vertical-align: inherit;">例如，如果您使用
               </font></font><code class="literal">int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量为</font></font><code class="literal">BIGINT UNSIGNED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">提供值
               </font><font style="vertical-align: inherit;">，
               </font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则应为false，因为它
               </font></font><code class="literal">int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是有符号类型。</font><font style="vertical-align: inherit;">如果您使用
               </font></font><code class="literal">unsigned int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量为</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">提供值</font><font style="vertical-align: inherit;">，
               </font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则应为true，因为
               </font></font><code class="literal">unsigned int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它是无符号类型。</font><font style="vertical-align: inherit;">MySQL会在两个方向上执行有符号值和无符号值之间的正确转换，但如果截断结果会发生警告。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">my_bool *error</code>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于输出，将此成员设置为指向一个
               </font></font><code class="literal">my_bool</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量，以便在进行一次行提取操作后，获取存储在那里的参数的截断信息。</font><font style="vertical-align: inherit;">当启用截断报告时，
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
               </font></font><code class="literal">MYSQL_DATA_TRUNCATED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
               </font><font style="vertical-align: inherit;">在发生截断的参数</font></font><code class="literal">*error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构中为</font><font style="vertical-align: inherit;">true
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">截断表示符号或有效数字丢失，或者字符串太长而无法放入列中。</font><font style="vertical-align: inherit;">截断报告在默认情况下处于启用状态，但可以通过</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该
               </font></font><code class="literal">MYSQL_REPORT_DATA_TRUNCATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">调用来控制
               </font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p>
          <a class="indexterm" name="idm140527958730560"></a>

          <code class="literal">MYSQL_TIME</code>
        </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此结构被用于发送和接收
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接数据和从所述服务器。</font><font style="vertical-align: inherit;">设置</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为指向一个部件</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构，并且设置</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个的构件
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构颞类型之一（</font></font><code class="literal">MYSQL_TYPE_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_DATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_DATETIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_TIMESTAMP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构包含下表中列出的成员。
</font></font></p>
<div class="informaltable">
<table summary="Members of the MYSQL_TIME structure and a description of each member."><colgroup><col width="40%"><col width="60%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会员</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">unsigned int year</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">那一年</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int month</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一年中的月份</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int day</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每月的一天</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int hour</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一天中的小时</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int minute</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一小时的一分钟</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned int second</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二分钟</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">my_bool neg</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示时间是否定的布尔标志</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">unsigned long second_part</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">秒的小数部分以微秒表示</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          只有那些</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适用于给定类型的时间值</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">部分</font><font style="vertical-align: inherit;">才被使用。</font><font style="vertical-align: inherit;">的
           </font></font><code class="literal">year</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">month</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">day</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元件用于
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值。</font><font style="vertical-align: inherit;">的
           </font></font><code class="literal">hour</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">minute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">second</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元件用于
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-date-handling" title="27.8.17 C API预处理日期和时间值的语句处理"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.17节“C API准备好的语句处理日期和时间值”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-prepared-statement-type-codes"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.9.1 C API编写的语句类型代码</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958672896"></a><a class="indexterm" name="idm140527958671392"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">
        的</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员
         </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示绑定到语句参数或结果集列的C语言变量的数据类型。</font><font style="vertical-align: inherit;">对于输入，</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        指示包含要发送到服务器的值的变量的类型。</font><font style="vertical-align: inherit;">对于输出，它表示从服务器接收的值应该存储到的变量的类型。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        下表显示了</font><font style="vertical-align: inherit;">发送到服务器的输入值</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">成员
         </font><font style="vertical-align: inherit;">的允许值
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该表显示了您可以使用的C变量类型，相应的类型代码以及可以使用提供的值无需转换的SQL数据类型。</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据要绑定的C语言变量的数据类型</font><font style="vertical-align: inherit;">选择</font><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">对于整数类型，您还应该设置
         </font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员以指示变量是有符号还是无符号。
</font></font></p>
<div class="informaltable">
<table summary="C type input variables, corresponding buffer_type values, and the SQL data types for which the supplied value can be used without conversion."><colgroup><col width="30%"><col width="35%"><col width="35%"></colgroup><thead><tr>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输入变量C类型</font></font></th>
            <th scope="col"><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 值</font></font></th>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目标值的SQL类型</font></font></th>
          </tr></thead><tbody><tr>
            <td scope="row"><code class="literal">signed char</code></td>
            <td><code class="literal">MYSQL_TYPE_TINY</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">TINYINT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">short int</code></td>
            <td><code class="literal">MYSQL_TYPE_SHORT</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">SMALLINT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">int</code></td>
            <td><code class="literal">MYSQL_TYPE_LONG</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">long long int</code></td>
            <td><code class="literal">MYSQL_TYPE_LONGLONG</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">float</code></td>
            <td><code class="literal">MYSQL_TYPE_FLOAT</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">double</code></td>
            <td><code class="literal">MYSQL_TYPE_DOUBLE</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">MYSQL_TIME</code></td>
            <td><code class="literal">MYSQL_TYPE_TIME</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">MYSQL_TIME</code></td>
            <td><code class="literal">MYSQL_TYPE_DATE</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">MYSQL_TIME</code></td>
            <td><code class="literal">MYSQL_TYPE_DATETIME</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">MYSQL_TIME</code></td>
            <td><code class="literal">MYSQL_TYPE_TIMESTAMP</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">char[]</code></td>
            <td><code class="literal">MYSQL_TYPE_STRING</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
              </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a></td>
          </tr><tr>
            <td scope="row"><code class="literal">char[]</code></td>
            <td><code class="literal">MYSQL_TYPE_BLOB</code></td>
            <td><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
              </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a></td>
          </tr><tr>
            <td scope="row"></td>
            <td><code class="literal">MYSQL_TYPE_NULL</code></td>
            <td><code class="literal">NULL</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_TYPE_NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按照</font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures" title="27.8.9 C API编写的语句数据结构"><font style="vertical-align: inherit;">第27.8.9节“C API准备语句数据结构”中</font></a></font><code class="literal">is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员
         </font><font style="vertical-align: inherit;">的说明中所述</font><font style="vertical-align: inherit;">
        使用</font><font style="vertical-align: inherit;">。
      </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures" title="27.8.9 C API编写的语句数据结构"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于输入字符串数据，使用</font></font><code class="literal">MYSQL_TYPE_STRING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        或</font></font><code class="literal">MYSQL_TYPE_BLOB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于该值是字符（非二进制）还是二进制字符串：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">MYSQL_TYPE_STRING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示字符输入字符串数据。</font><font style="vertical-align: inherit;">假定该值位于由</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量</font><font style="vertical-align: inherit;">指示的字符集中
             </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果服务器将该值存储到具有不同字符集的列中，则会将该值转换为该字符集。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_TYPE_BLOB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示二进制输入字符串数据 </font><font style="vertical-align: inherit;">该值被视为具有
             </font></font><code class="literal">binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符集。</font><font style="vertical-align: inherit;">也就是说，它被视为字节字符串，并且不发生转换。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        下表显示了</font><font style="vertical-align: inherit;">从服务器接收的输出值结构</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员
         </font><font style="vertical-align: inherit;">的允许值
         </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该表显示了接收值的SQL类型，这些值在结果集元数据中的相应类型代码，以及推荐的C语言数据类型以绑定到</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构以接收SQL值而不进行转换。</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据要绑定的C语言变量的数据类型</font><font style="vertical-align: inherit;">选择
         </font><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">对于整数类型，您还应该设置</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        成员以指示变量是有符号还是无符号。
</font></font></p>
<div class="informaltable">
<table summary="SQL types of received values, corresponding buffer_type values, and recommended C data type output variables."><colgroup><col width="30%"><col width="35%"><col width="35%"></colgroup><thead><tr>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接收值的SQL类型</font></font></th>
            <th scope="col"><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 值</font></font></th>
            <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输出变量C类型</font></font></th>
          </tr></thead><tbody><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">TINYINT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_TINY</code></td>
            <td><code class="literal">signed char</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">SMALLINT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_SHORT</code></td>
            <td><code class="literal">short int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">MEDIUMINT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_INT24</code></td>
            <td><code class="literal">int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">INT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_LONG</code></td>
            <td><code class="literal">int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">BIGINT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_LONGLONG</code></td>
            <td><code class="literal">long long int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_FLOAT</code></td>
            <td><code class="literal">float</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">DOUBLE</code></a></td>
            <td><code class="literal">MYSQL_TYPE_DOUBLE</code></td>
            <td><code class="literal">double</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#fixed-point-types" title="11.2.2定点类型（准确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a></td>
            <td><code class="literal">MYSQL_TYPE_NEWDECIMAL</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#year" title="11.3.3年份类型"><code class="literal">YEAR</code></a></td>
            <td><code class="literal">MYSQL_TYPE_SHORT</code></td>
            <td><code class="literal">short int</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a></td>
            <td><code class="literal">MYSQL_TYPE_TIME</code></td>
            <td><code class="literal">MYSQL_TIME</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a></td>
            <td><code class="literal">MYSQL_TYPE_DATE</code></td>
            <td><code class="literal">MYSQL_TIME</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a></td>
            <td><code class="literal">MYSQL_TYPE_DATETIME</code></td>
            <td><code class="literal">MYSQL_TIME</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a></td>
            <td><code class="literal">MYSQL_TYPE_TIMESTAMP</code></td>
            <td><code class="literal">MYSQL_TIME</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
              </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a></td>
            <td><code class="literal">MYSQL_TYPE_STRING</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
              </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a></td>
            <td><code class="literal">MYSQL_TYPE_VAR_STRING</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TINYBLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
              </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TINYTEXT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_TINY_BLOB</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">， </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_BLOB</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">MEDIUMBLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
              </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">MEDIUMTEXT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_MEDIUM_BLOB</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">LONGBLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
              </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">LONGTEXT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_LONG_BLOB</code></td>
            <td><code class="literal">char[]</code></td>
          </tr><tr>
            <td scope="row"><a class="link" href="/mysql-5.7-google-zh/data-types.html#bit-type" title="11.2.4位值类型 -  BIT"><code class="literal">BIT</code></a></td>
            <td><code class="literal">MYSQL_TYPE_BIT</code></td>
            <td><code class="literal">char[]</code></td>
</tr></tbody></table>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="c-api-prepared-statement-type-conversions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.9.2 C API准备好的语句类型转换</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958453856"></a><a class="indexterm" name="idm140527958452352"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        编写的语句在客户端和服务器之间使用客户端上的C语言变量传输数据，这些变量与服务器端的SQL值相对应。</font><font style="vertical-align: inherit;">如果客户端的C变量类型与服务器端的相应SQL值类型之间存在不匹配，则MySQL会在两个方向上执行隐式类型转换。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL知道服务器端SQL值的类型代码。</font><font style="vertical-align: inherit;">结构中</font><font style="vertical-align: inherit;">的</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值
         </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示保存客户端上的值的C变量的类型代码。</font><font style="vertical-align: inherit;">这两个代码一起告诉MySQL必须执行什么样的转换，如果有的话。</font><font style="vertical-align: inherit;">这里有些例子：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果使用</font></font><code class="literal">MYSQL_TYPE_LONG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有
             </font></font><code class="literal">int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可变的整数值传递到要被存储到服务器
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#floating-point-types" title="11.2.3浮点类型（近似值） -  FLOAT，DOUBLE"><code class="literal">FLOAT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的列时，MySQL存放前的值以浮点格式转换。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果您获取SQL </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">MEDIUMINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            列值，但指定</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            值的</font></font><code class="literal">MYSQL_TYPE_LONGLONG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font><code class="literal">long long int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并将</font><font style="vertical-align: inherit;">类型的C变量</font><font style="vertical-align: inherit;">用作目标缓冲区，则MySQL会将</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#integer-types" title="11.2.1整型（精确值） -  INTEGER，INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT"><code class="literal">MEDIUMINT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于存储</font><font style="vertical-align: inherit;">的
             </font><font style="vertical-align: inherit;">值（需要少于8个字节）转换为
             </font></font><code class="literal">long long int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（8字节变量）。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果取为255字节的值的数值列到一个
             </font></font><code class="literal">char[4]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符数组和指定
             </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值
             </font></font><code class="literal">MYSQL_TYPE_STRING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该数组中所得到的值是一个4字节串</font></font><code class="literal">'255\0'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            MySQL </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#fixed-point-types" title="11.2.2定点类型（准确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以原始服务器端值的字符串表示形式</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">值，这就是相应C类型的原因
             </font></font><code class="literal">char[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，
             </font></font><code class="literal">12.345</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为返回给客户端
             </font></font><code class="literal">'12.345'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果您指定
             </font></font><code class="literal">MYSQL_TYPE_NEWDECIMAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和字符串缓冲区绑定到</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构，
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储在缓冲区无需转换为字符串值。</font><font style="vertical-align: inherit;">如果您指定一个数字变量和类型代码，
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则将字符串格式</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#fixed-point-types" title="11.2.2定点类型（准确值） -  DECIMAL，NUMERIC"><code class="literal">DECIMAL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            值</font><font style="vertical-align: inherit;">转换</font><font style="vertical-align: inherit;">为数字形式。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            对于</font></font><code class="literal">MYSQL_TYPE_BIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型代码，
             </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#bit-type" title="11.2.4位值类型 -  BIT"><code class="literal">BIT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值返回到字符串缓冲区，这就是相应的C类型的原因
             </font></font><code class="literal">char[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值表示需要在客户端解释的位字符串。</font><font style="vertical-align: inherit;">要以更容易处理的类型返回值，可以使用以下任一种表达式将值转换为整数：
          </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT bit_col + 0 FROM t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SELECT CAST（bit_col AS UNSIGNED）FROM t</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要检索该值，请绑定一个足够大的整数变量以保存该值并指定相应的相应整数类型代码。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在将变量绑定</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        到要用于获取列值</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">之前</font><font style="vertical-align: inherit;">，可以检查结果集中每列的类型代码。</font><font style="vertical-align: inherit;">如果您想确定哪种变量类型最适合避免类型转换，这可能是可取的。</font><font style="vertical-align: inherit;">要获取类型代码，请</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在执行准备好的语句后
         </font><font style="vertical-align: inherit;">调用
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">元数据提供对结果集的类型代码的访问，如</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.23节“mysql_stmt_result_metadata（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-data-structures" title="27.8.5 C API数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.5节“C API数据结构”中所述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        要确定从服务器返回的结果集中的输出字符串值是否包含二进制或非二进制数据，请检查</font></font><code class="literal">charsetnr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果集元数据</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">是否</font><font style="vertical-align: inherit;">为63（请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-data-structures" title="27.8.5 C API数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.5节“C API数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">如果是这样，字符集是</font></font><code class="literal">binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它表示二进制数据而不</font><font style="vertical-align: inherit;">是非</font><font style="vertical-align: inherit;">二进制数据。</font><font style="vertical-align: inherit;">这使您能够区分</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">BINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从
         </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">CHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#binary-varbinary" title="11.4.2 BINARY和VARBINARY类型"><code class="literal">VARBINARY</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从
         </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#char" title="11.4.1 CHAR和VARCHAR类型"><code class="literal">VARCHAR</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从类型
         </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果</font><font style="vertical-align: inherit;">通过调用来设置列元数据结构
         </font><font style="vertical-align: inherit;">的</font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员
         </font><font style="vertical-align: inherit;">，请注意，</font><font style="vertical-align: inherit;">结果集</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值指示结果值的最长字符串表示的长度，而不是二进制表示的长度。</font><font style="vertical-align: inherit;">也就是说，</font><font style="vertical-align: inherit;">不一定对应于用准备语句使用二进制协议获取值所需的缓冲区的大小。</font><font style="vertical-align: inherit;">根据您获取值的变量类型选择缓冲区的大小。</font><font style="vertical-align: inherit;">例如，</font><font style="vertical-align: inherit;">包含值-128 </font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">列可能具有</font><font style="vertical-align: inherit;">值4.但是任何二进制表示</font></font><code class="literal">MYSQL_FIELD</code><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"></font><code class="literal">max_length</code><font style="vertical-align: inherit;"></font><code class="literal">max_length</code><font style="vertical-align: inherit;"></font><code class="literal">TINYINT</code><font style="vertical-align: inherit;"></font><code class="literal">max_length</code><font style="vertical-align: inherit;"></font><code class="literal">TINYINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值只需要1个字节的存储空间，因此您可以提供一个</font></font><code class="literal">signed char</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于存储值</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">变量，并设置</font></font><code class="literal">is_unsigned</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为指示值已被签名。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对准备好的语句引用的表或视图的元数据更改会被检测到，并在下次执行时导致语句自动重新编译。</font><font style="vertical-align: inherit;">有关更多信息，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/optimization.html#statement-caching" title="8.10.4缓存准备好的语句和存储的程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.10.4节“准备好的语句和存储的程序的缓存”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-function-overview"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.10 C API准备语句函数概述</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958391120"></a><a class="indexterm" name="idm140527958389616"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下列表总结了可用于准备好的语句处理的功能。</font><font style="vertical-align: inherit;">有关更多详细信息，请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-functions" title="27.8.11 C API准备语句函数说明"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11节“C API准备语句函数描述”中的说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-affected-rows" title="27.8.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回更改，删除或插入的编写行数</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-get" title="27.8.11.2 mysql_stmt_attr_get（）"><code class="literal">mysql_stmt_attr_get()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：获取预准备语句的属性值
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：为预准备语句设置属性
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将应用程序数据缓冲区与准备好的SQL语句中的参数标记关联起来
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将应用程序数据缓冲区与结果集中的列相关联
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：释放准备好的语句所使用的内存
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-data-seek" title="27.8.11.7 mysql_stmt_data_seek（）"><code class="literal">mysql_stmt_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：在语句结果集中搜索任意行号
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-errno" title="27.8.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回上次语句执行的错误号
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-error" title="27.8.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回上次语句执行的错误消息
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：执行准备好的声明
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从结果集中提取下一行数据并返回所有绑定列的数据
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch-column" title="27.8.11.12 mysql_stmt_fetch_column（）"><code class="literal">mysql_stmt_fetch_column()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：为结果集的当前行的一列提取数据
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-field-count" title="27.8.11.13 mysql_stmt_field_count（）"><code class="literal">mysql_stmt_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回最近语句的结果列数
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-free-result" title="27.8.11.14 mysql_stmt_free_result（）"><code class="literal">mysql_stmt_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：释放分配给语句处理程序的资源
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init" title="27.8.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：为</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">分配内存</font><font style="vertical-align: inherit;">并初始化它
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-insert-id" title="27.8.11.16 mysql_stmt_insert_id（）"><code class="literal">mysql_stmt_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过预处理语句</font><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">列
         </font><font style="vertical-align: inherit;">生成的ID
          </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result" title="27.8.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回/启动多重结果执行中的下一个结果
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-num-rows" title="27.8.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：从缓冲语句结果集中返回行计数
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-param-count" title="27.8.11.19 mysql_stmt_param_count（）"><code class="literal">mysql_stmt_param_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回准备好的语句中的参数数量
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-param-metadata" title="27.8.11.20 mysql_stmt_param_metadata（）"><code class="literal">mysql_stmt_param_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:(以结果集的形式返回参数元数据）该函数不做任何事情
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：准备要执行的SQL语句字符串
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-reset" title="27.8.11.22 mysql_stmt_reset（）"><code class="literal">mysql_stmt_reset()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：重置服务器中的语句缓冲区
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以结果集的形式返回准备好的语句元数据
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-seek" title="27.8.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：使用从返回的值寻求在语句结果集中的行偏移量
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-tell" title="27.8.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-tell" title="27.8.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回语句行光标位置
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-send-long-data" title="27.8.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将大块数据以块的形式发送到服务器
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-sqlstate" title="27.8.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：返回上次语句执行的SQLSTATE错误代码
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：检索完整的结果集给客户端
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init" title="27.8.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以创建语句处理程序，然后
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备语句字符串，
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供参数数据以及
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行语句。</font><font style="vertical-align: inherit;">您可以</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过更改通过提供的相应缓冲区中的参数值
       </font><font style="vertical-align: inherit;">来重复此操作
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您可以使用块将文本或二进制数据以块的形式发送到服务器
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-send-long-data" title="27.8.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-send-long-data" title="27.8.11.26 mysql_stmt_send_long_data（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.26节“mysql_stmt_send_long_data（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果该语句是一个</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或产生一个结果集的任何其它陈述，
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还返回在一个形式的结果集的元数据信息
       </font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过设定结果
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      您可以使用提供结果缓冲区
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以便</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      自动将数据返回到这些缓冲区。</font><font style="vertical-align: inherit;">这是逐行读取。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      语句执行完成后，关闭语句处理程序，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以便与其关联的所有资源都可以被释放。</font><font style="vertical-align: inherit;">此时处理程序变为无效，不应再使用。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果您</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通过调用</font><font style="vertical-align: inherit;">获取</font><font style="vertical-align: inherit;">语句的结果集元数据
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则还应该使用释放元数据
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h4 class="title"><a name="c-api-prepared-statement-function-overview-execution-steps"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行步骤</font></font></h4>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        准备和执行一个声明，应用程序遵循以下步骤：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            创建一个准备好的语句的处理程序
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init" title="27.8.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要在服务器上准备语句，请调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并传递一个包含SQL语句的字符串。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果语句将产生结果集，则调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            以获取结果集元数据。</font><font style="vertical-align: inherit;">此元数据本身采用结果集的形式，尽管它与包含查询返回的行的元数据不同。</font><font style="vertical-align: inherit;">元数据结果集指示结果中有多少列，并包含有关每列的信息。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            使用设置任何参数的值
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">所有参数都必须设置。</font><font style="vertical-align: inherit;">否则，语句执行返回错误或产生意外的结果。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以执行该语句。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果语句生成结果集，则绑定数据缓冲区以便通过调用来检索行值
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            通过</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            反复</font><font style="vertical-align: inherit;">调用将数据逐行读取到缓冲区中，
             </font><font style="vertical-align: inherit;">直到找不到更多行。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            根据需要重复步骤3至6，通过更改参数值并重新执行语句。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        何时</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被调用，MySQL客户端/服务器协议执行这些操作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            服务器解析语句，并通过分配语句ID将可用状态发送回客户端。</font><font style="vertical-align: inherit;">如果它是面向结果集的语句，它还会发送参数的总数，列计数及其元数据。</font><font style="vertical-align: inherit;">在调用期间，服务器检查语句的所有语法和语义。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            客户端将此语句ID用于进一步的操作，以便服务器可以从其语句池中识别语句。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        何时</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被调用，MySQL客户端/服务器协议执行这些操作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            客户端使用语句处理程序并将参数数据发送到服务器。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            服务器使用客户端提供的ID标识语句，用新提供的数据替换参数标记，然后执行语句。</font><font style="vertical-align: inherit;">如果语句产生结果集，则服务器将数据发送回客户端。</font><font style="vertical-align: inherit;">否则，它发送一个好的状态和更改，删除或插入的行数。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        何时</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被调用，MySQL客户端/服务器协议执行这些操作：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            客户端从结果集的当前行读取数据，并通过进行必要的转换将其放入应用程序数据缓冲区中。</font><font style="vertical-align: inherit;">如果应用程序缓冲区类型与从服务器返回的字段类型相同，则转换非常简单。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果出现错误，你可以使用得到的语句错误号，错误消息和SQLSTATE代码
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-errno" title="27.8.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-error" title="27.8.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-sqlstate" title="27.8.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分别。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-prepared-statement-function-overview-prepared-statement-logging"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备好的声明记录</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C API函数</font><font style="vertical-align: inherit;">执行的预准备语句，
         </font><font style="vertical-align: inherit;">服务器会写入</font><font style="vertical-align: inherit;">一行查询日志</font></font><code class="literal">Prepare</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并将
         </font><font style="vertical-align: inherit;">其写入</font></font><code class="literal">Execute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行，以便您可以确定何时准备和执行语句。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        假设您准备并执行如下陈述：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以准备语句字符串</font></font><code class="literal">"SELECT ?"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            将值绑定</font></font><code class="literal">3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到准备语句中的参数。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行准备好的语句。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        作为上述调用的结果，服务器将以下行写入常规查询日志中：
      </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备[1] SELECT？</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
执行[1]选择3</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        每个</font></font><code class="literal">Prepare</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code class="literal">Execute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        在日志中线路标记有
         </font><font style="vertical-align: inherit;">声明的标识符，这样就可以跟踪哪些准备好的语句被记录下来。</font><font style="vertical-align: inherit;">是一个正整数。</font><font style="vertical-align: inherit;">如果有多个为客户端同时处于活动状态的预准备语句，则
         </font><font style="vertical-align: inherit;">可能大于1.每
         </font><font style="vertical-align: inherit;">行将数据值替换为</font><font style="vertical-align: inherit;">
        参数</font><font style="vertical-align: inherit;">后显示准备好的语句</font><font style="vertical-align: inherit;">。
</font></font><code class="literal">[<em class="replaceable"><code>N</code></em>]</code><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><em class="replaceable"><code>N</code></em><font style="vertical-align: inherit;"></font><code class="literal">Execute</code><font style="vertical-align: inherit;"></font><code class="literal">?</code><font style="vertical-align: inherit;"></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11 C API准备语句函数说明</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-affected-rows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.1 mysql_stmt_affected_rows（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-get"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.2 mysql_stmt_attr_get（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.3 mysql_stmt_attr_set（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.4 mysql_stmt_bind_param（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.5 mysql_stmt_bind_result（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.6 mysql_stmt_close（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-data-seek"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.7 mysql_stmt_data_seek（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-errno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.8 mysql_stmt_errno（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-error"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.9 mysql_stmt_error（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.10 mysql_stmt_execute（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.11 mysql_stmt_fetch（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch-column"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.12 mysql_stmt_fetch_column（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-field-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.13 mysql_stmt_field_count（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-free-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.14 mysql_stmt_free_result（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.15 mysql_stmt_init（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-insert-id"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.16 mysql_stmt_insert_id（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.17 mysql_stmt_next_result（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-num-rows"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.18 mysql_stmt_num_rows（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-param-count"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.19 mysql_stmt_param_count（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-param-metadata"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.20 mysql_stmt_param_metadata（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.21 mysql_stmt_prepare（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-reset"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.22 mysql_stmt_reset（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.23 mysql_stmt_result_metadata（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-seek"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.24 mysql_stmt_row_seek（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-tell"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.25 mysql_stmt_row_tell（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-send-long-data"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.26 mysql_stmt_send_long_data（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-sqlstate"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.27 mysql_stmt_sqlstate（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.28 mysql_stmt_store_result（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要准备和执行查询，请使用以下各节中详细介绍的功能。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      所有使用</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      结构</font><font style="vertical-align: inherit;">运行的函数都以</font><font style="vertical-align: inherit;">前缀开头</font></font><code class="literal">mysql_stmt_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要创建一个</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理程序，请使用该
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init" title="27.8.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-affected-rows"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.1 mysql_stmt_affected_rows（）</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140527958232224"></a><p>
        <code class="literal">my_ulonglong mysql_stmt_affected_rows(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-affected-rows-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-affected-rows" title="27.8.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会在执行语句后立即调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这就像</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备好的陈述。</font><font style="vertical-align: inherit;">有关此函数返回的受影响行值的说明，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.1节“mysql_affected_rows（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-affected-rows-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-affected-rows-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-attr-get"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.2 mysql_stmt_attr_get（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958218448"></a><p>
        <code class="literal">my_bool mysql_stmt_attr_get(MYSQL_STMT *stmt, enum
        enum_stmt_attr_type option, void *arg)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-get-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可用于获取语句属性的当前值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是你想要得到的选项; </font><font style="vertical-align: inherit;">对</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应指向应包含选项值的变量。</font><font style="vertical-align: inherit;">如果选项是一个整数，则</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该指向</font><font style="vertical-align: inherit;">整数</font><font style="vertical-align: inherit;">的值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关</font><font style="vertical-align: inherit;">选项和选项类型的列表，</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.3节“mysql_stmt_attr_set（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-get-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零如果</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未知。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-get-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-attr-set"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.3 mysql_stmt_attr_set（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958205360"></a><p>
        <code class="literal">my_bool mysql_stmt_attr_set(MYSQL_STMT *stmt, enum
        enum_stmt_attr_type option, const void *arg)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-set-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          可以用来影响准备好的语句的行为。</font><font style="vertical-align: inherit;">可以多次调用该函数来设置多个选项。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是您要设置的选项。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数是选项的值。</font></font><code class="literal">arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应指向一个设置为所需属性值的变量。</font><font style="vertical-align: inherit;">变量类型如下表所示。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下表显示了可能的
           </font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。
</font></font></p>
<div class="informaltable">
<table summary="Lists mysql_stmt_attr_set() option values and the argument type and function of each option."><colgroup><col width="42%"><col width="20%"><col width="38%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数类型</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">STMT_ATTR_UPDATE_MAX_LENGTH</code></td>
              <td><code class="literal">my_bool *</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果设置为1，则会导致
                 </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                更新元数据
                 </font></font><code class="literal">MYSQL_FIELD-&gt;max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">STMT_ATTR_CURSOR_TYPE</code></td>
              <td><code class="literal">unsigned long *</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">时为语句打开的游标类型
                 </font><font style="vertical-align: inherit;">。</font></font><code class="literal">*arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以
                 </font></font><code class="literal">CURSOR_TYPE_NO_CURSOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（默认）或</font></font><code class="literal">CURSOR_TYPE_READ_ONLY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">STMT_ATTR_PREFETCH_ROWS</code></td>
              <td><code class="literal">unsigned long *</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用游标时从服务器读取的行数。
                </font></font><code class="literal">*arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在1到最大值的范围内</font></font><code class="literal">unsigned long</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认值是1。</font></font></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果您使用该</font></font><code class="literal">STMT_ATTR_CURSOR_TYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font></font><code class="literal">CURSOR_TYPE_READ_ONLY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则在调用时会为该语句打开一个游标
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果以前的</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用中</font><font style="vertical-align: inherit;">已经有一个打开的光标
           </font><font style="vertical-align: inherit;">，它会在打开新光标之前关闭光标。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-reset" title="27.8.11.22 mysql_stmt_reset（）"><code class="literal">mysql_stmt_reset()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在准备重新执行的语句之前，还会关闭任何打开的光标。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-free-result" title="27.8.11.14 mysql_stmt_free_result（）"><code class="literal">mysql_stmt_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          关闭任何打开的光标。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果为预处理语句打开游标，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则不需要，因为该函数会导致将结果集缓存在客户端。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-set-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零如果</font></font><code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未知。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-set-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-attr-set-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例为预准备语句打开游标，并将要一次获取的行数设置为5：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_STMT * stmt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int rc;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无符号长整型;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned long prefetch_rows = 5;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
type =（unsigned long）CURSOR_TYPE_READ_ONLY;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rc = mysql_stmt_attr_set（stmt，STMT_ATTR_CURSOR_TYPE，（void *）＆type）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * ...检查返回值... * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rc = mysql_stmt_attr_set（stmt，STMT_ATTR_PREFETCH_ROWS，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                         （void *）＆prefetch_rows）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * ...检查返回值... * /</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-bind-param"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.4 mysql_stmt_bind_param（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958152864"></a><p>
        <code class="literal">my_bool mysql_stmt_bind_param(MYSQL_STMT *stmt,
        MYSQL_BIND *bind)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-param-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于绑定传递给SQL语句中参数标记的输入数据
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它使用
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构来提供数据。
          </font></font><code class="literal">bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">数组的地址
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">客户端库期望该数组包含</font></font><code class="literal">?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询中存在的</font><font style="vertical-align: inherit;">每个</font><font style="vertical-align: inherit;">参数标记的</font><font style="vertical-align: inherit;">一个元素
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          假设您准备了以下声明：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INSERT INTO mytbl VALUES（？，？，？）
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当你绑定这些参数时，</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">数组
           </font><font style="vertical-align: inherit;">必须包含三个元素，并且可以像这样声明：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_BIND绑定[3];
</font></font></pre><p>
          <a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures" title="27.8.9 C API编写的语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.9节“C API准备语句数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述了每个</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          元素</font><font style="vertical-align: inherit;">的成员</font><font style="vertical-align: inherit;">以及应该如何设置它们以提供输入值。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-param-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-param-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unsupported_param_type"><code class="literal">CR_UNSUPPORTED_PARAM_TYPE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              转换不受支持。</font><font style="vertical-align: inherit;">可能该
               </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是无效的或不是支持的类型之一。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-param-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-bind-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.5 mysql_stmt_bind_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958122720"></a><p>
        <code class="literal">my_bool mysql_stmt_bind_result(MYSQL_STMT *stmt,
        MYSQL_BIND *bind)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于将结果集中的输出列关联（即绑定）到数据缓冲区和长度缓冲区。</font><font style="vertical-align: inherit;">当
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用获取数据时，MySQL客户端/服务器协议将绑定列的数据放入指定的缓冲区。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用之前，所有列必须绑定到缓冲区
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><code class="literal">bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一个</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">数组的地址
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">客户端库期望该数组为结果集的每列包含一个元素。</font><font style="vertical-align: inherit;">如果您不将列绑定到</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构，
           </font><font style="vertical-align: inherit;">则会
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">忽略数据提取。</font><font style="vertical-align: inherit;">缓冲区应该足够大以容纳数据值，因为协议不会以块的形式返回数据值。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          即使在部分检索结果集之后，也可以随时绑定或反弹列。</font><font style="vertical-align: inherit;">下次</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">新绑定时生效
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">假设应用程序绑定结果集中的列和调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">客户端/服务器协议返回绑定缓冲区中的数据。</font><font style="vertical-align: inherit;">然后假设应用程序将列绑定到不同的缓冲区集。</font><font style="vertical-align: inherit;">下一次</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生</font><font style="vertical-align: inherit;">呼叫时，协议将数据放入新绑定的缓冲区
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要绑定列，应用程序会调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并传递值应该存储到其中的输出缓冲区的类型，地址和长度。
          </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures" title="27.8.9 C API编写的语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.9节“C API准备语句数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述了每个</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          元素</font><font style="vertical-align: inherit;">的成员</font><font style="vertical-align: inherit;">以及它们应该如何设置以接收输出值。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unsupported_param_type"><code class="literal">CR_UNSUPPORTED_PARAM_TYPE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              转换不受支持。</font><font style="vertical-align: inherit;">可能该
               </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是无效的或不是支持的类型之一。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-bind-result-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.11节“mysql_stmt_fetch（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-close"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.6 mysql_stmt_close（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958087488"></a><p>
        <code class="literal">my_bool mysql_stmt_close(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-close-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          关闭准备好的声明。
          </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也会释放所指向的语句处理程序</font></font><code class="literal">stmt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，该</font><font style="vertical-align: inherit;">处理程序
           </font><font style="vertical-align: inherit;">在那时变得无效，不应该再使用。</font><font style="vertical-align: inherit;">对于失败的
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通话，不叫</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-error" title="27.8.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-errno" title="27.8.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或者
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-sqlstate" title="27.8.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获得错误信息，因为
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使语句处理程序无效。</font><font style="vertical-align: inherit;">打电话
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate" title="27.8.7.72 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来代替。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果当前语句有未决或未读结果，则此函数将取消它们，以便可以执行下一个查询。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-close-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-close-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-close-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-data-seek"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.7 mysql_stmt_data_seek（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958059024"></a><p>
        <code class="literal">void mysql_stmt_data_seek(MYSQL_STMT *stmt,
        my_ulonglong offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-data-seek-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在语句结果集中搜索任意行。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是一个行号，应该在从</font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">至
           </font><font style="vertical-align: inherit;">的范围内</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-num-rows" title="27.8.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows(stmt)-1</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数要求语句结果集结构包含上次执行的查询的全部结果，因此
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-data-seek" title="27.8.11.7 mysql_stmt_data_seek（）"><code class="literal">mysql_stmt_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能仅与其结合使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-data-seek-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-data-seek-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-errno"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.8 mysql_stmt_errno（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958044640"></a><p>
        <code class="literal">unsigned int mysql_stmt_errno(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-errno-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于由...指定的语句</font></font><code class="literal">stmt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-errno" title="27.8.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将返回最近调用的可成功或失败的语句API函数的错误代码。</font><font style="vertical-align: inherit;">返回值为零意味着没有错误发生。</font><font style="vertical-align: inherit;">客户端错误消息编号在MySQL </font></font><code class="filename">errmsg.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">头文件</font><font style="vertical-align: inherit;">中列出</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">服务器错误消息编号列在中
           </font></font><code class="filename">mysqld_error.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><a class="xref" href="/mysql-5.7-google-zh/error-handling.html" title="附录B错误，错误代码和常见问题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录B</font></font><i><font style="vertical-align: inherit;"></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中列出了
           </font><a class="xref" href="/mysql-5.7-google-zh/error-handling.html" title="附录B错误，错误代码和常见问题"><i><font style="vertical-align: inherit;">错误，错误，错误代码和常见问题</font></i></a><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果失败的语句API函数是
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请不要调用或</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-errno" title="27.8.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取错误信息，因为
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使语句处理程序无效。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">打电话
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-errno-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          错误代码值。</font><font style="vertical-align: inherit;">如果没有错误发生则为零。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-errno-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-error"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.9 mysql_stmt_error（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958026224"></a><p>
        <code class="literal">const char *mysql_stmt_error(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-error-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于由...指定的语句</font></font><code class="literal">stmt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-error" title="27.8.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个以空字符结尾的字符串，其中包含最近调用的可能成功或失败的语句API函数的错误消息。</font></font><code class="literal">""</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有错误发生，则返回</font><font style="vertical-align: inherit;">空字符串（</font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">这两个测试中的任何一个都可以用来检查错误：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果（* mysql_stmt_errno（语句））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  //发生错误</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_error（stmt）[0]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  //发生错误</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果失败语句API函数是
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请不要调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-error" title="27.8.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以获取错误信息，因为
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使语句处理程序无效。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">打电话
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          客户端错误消息的语言可以通过重新编译MySQL客户端库来更改。</font><font style="vertical-align: inherit;">您可以选择几种不同语言的错误消息。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-error-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          描述错误的字符串。</font><font style="vertical-align: inherit;">如果没有发生错误，则为空字符串。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-error-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-execute"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.10 mysql_stmt_execute（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527958007664"></a><p>
        <code class="literal">int mysql_stmt_execute(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-execute-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行与语句处理程序相关联的准备好的查询。</font><font style="vertical-align: inherit;">当前绑定的参数标记值在此调用期间发送到服务器，并且服务器将用这个新提供的数据替换标记。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          处理以下语句
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于语句的类型：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于一个</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
               </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，改变，删除，或插入的行数可以通过调用发现
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-affected-rows" title="27.8.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于像</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这样</font><font style="vertical-align: inherit;">的语句
               </font><font style="vertical-align: inherit;">生成结果集，必须</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在调用导致查询处理的任何其他函数之前</font><font style="vertical-align: inherit;">调用
               </font><font style="vertical-align: inherit;">以获取数据。</font><font style="vertical-align: inherit;">有关如何获取结果的更多信息，请参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.11节“mysql_stmt_fetch（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              不要跟随调用
               </font><font style="vertical-align: inherit;">或
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些函数不适用于处理来自预处理语句的结果。
</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于生成结果集</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的语句，可以</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在执行语句之前</font><font style="vertical-align: inherit;">通过调用</font><font style="vertical-align: inherit;">来请求</font><font style="vertical-align: inherit;">为语句打开游标
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果您多次执行语句，请</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在打开新的光标之前关闭所有打开的光标。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对准备好的语句引用的表或视图的元数据更改会被检测到，并在下次执行时导致语句自动重新编译。</font><font style="vertical-align: inherit;">有关更多信息，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/optimization.html#statement-caching" title="8.10.4缓存准备好的语句和存储的程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.10.4节“准备好的语句和存储的程序的缓存”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-execute-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-execute-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-execute-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下面的示例演示如何创建和使用填充表
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init" title="27.8.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-param-count" title="27.8.11.19 mysql_stmt_param_count（）"><code class="literal">mysql_stmt_param_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-affected-rows" title="27.8.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量被假定为有效的连接处理程序。</font><font style="vertical-align: inherit;">有关如何检索数据的示例，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.11节“mysql_stmt_fetch（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define STRING_SIZE 50</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#define DROP_SAMPLE_TABLE“DROP TABLE IF EXISTS test_table”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#define CREATE_SAMPLE_TABLE“CREATE TABLE test_table（col1 INT，\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                                 col2 VARCHAR（40），\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                                 col3 SMALLINT，\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                                 col4 TIMESTAMP）“</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#define INSERT_SAMPLE“INSERT INTO \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                       test_table（col1，col2，col3）\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                       VALUES（？，？，？）”</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_STMT * stmt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_BIND绑定[3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
my_ulonglong affected_rows;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int param_count;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
短small_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int int_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
char str_data [STRING_SIZE];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
unsigned long str_length;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
my_bool is_null;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_query（mysql，DROP_SAMPLE_TABLE））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“DROP TABLE failed \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_query（mysql，CREATE_SAMPLE_TABLE））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“CREATE TABLE failed \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *准备带有3个参数的INSERT查询* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *（TIMESTAMP列未被命名;服务器* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *将其设置为当前的日期和时间）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！stmt）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_init（），内存不足\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_prepare（stmt，INSERT_SAMPLE，strlen（INSERT_SAMPLE）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_prepare（），INSERT失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（标准输出，“准备，插入成功\ n”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *从语句中获取参数计数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
param_count = mysql_stmt_param_count（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“INSERT中的全部参数：％d \ n”，param_count）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（param_count！= 3）/ *验证参数计数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL返回的无效参数数\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定所有3个参数的数据* /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
memset（bind，0，sizeof（bind））;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * INTEGER PARAM * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *这是一个数字类型，所以没有必要</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   指定buffer_length * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer =（char *）＆int_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .is_null = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .length = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * STRING PARAM * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer_type = MYSQL_TYPE_STRING;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer =（char *）str_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer_length = STRING_SIZE;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .is_null = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .length =＆str_length;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * SMALLINT PARAM * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .buffer_type = MYSQL_TYPE_SHORT;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .buffer =（char *）＆small_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .is_null =＆is_null;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .length = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_bind_param（stmt，bind））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_bind_param（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *指定第一行的数据值* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data = 10; </font><font style="vertical-align: inherit;">/* 整数 */</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
strncpy（str_data，“MySQL”，STRING_SIZE）; </font><font style="vertical-align: inherit;">/ * string * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
str_length = strlen（str_data）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * INSERT SMALLINT数据为NULL * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
is_null = 1;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *执行INSERT语句 -  1 * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_stmt_execute（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_execute（），1失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *获取受影响的行数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
affected_rows = mysql_stmt_affected_rows（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“受影响的行总数（插入1）：％lu \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                （unsigned long）affected_rows）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（affected_rows！= 1）/ *验证受影响的行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“受MySQL影响的行无效\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *为第二行指定数据值，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
   然后重新执行语句* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data = 1000;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
strncpy（str_data，“</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        最流行的开源数据库“，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        STRING_SIZE）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
str_length = strlen（str_data）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
small_data = 1000; </font><font style="vertical-align: inherit;">/ * smallint * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
is_null = 0; </font><font style="vertical-align: inherit;">/* 重启 */</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *执行INSERT语句 -  2 * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_stmt_execute（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_execute，2失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *获取受影响的行总数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
affected_rows = mysql_stmt_affected_rows（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“受影响的行总数（插入2）：％lu \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                （unsigned long）affected_rows）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（affected_rows！= 1）/ *验证受影响的行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“受MySQL影响的行无效\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *关闭声明* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_close（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * mysql_stmt_close（）使stmt无效，所以调用* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * mysql_error（mysql）而不是mysql_stmt_error（stmt）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“关闭语句时失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关使用预准备语句函数的完整示例，请参阅该文件
             </font></font><code class="filename">tests/mysql_client_test.c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该文件可以从MySQL源代码发布版本或源代码库获取（请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/installing.html#source-installation" title="2.9从源代码安装MySQL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.9节“从源代码安装MySQL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-fetch"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.11 mysql_stmt_fetch（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957936304"></a><p>
        <code class="literal">int mysql_stmt_fetch(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回结果集中的下一行。</font><font style="vertical-align: inherit;">只有在结果集存在的情况下才能调用它; </font><font style="vertical-align: inherit;">也就是说，在</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对诸如此类的语句</font><font style="vertical-align: inherit;">的调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">产生结果集之后。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用绑定的缓冲区返回行数据
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它将这些缓冲区中的数据返回到当前行集合中的所有列，并将长度返回给
           </font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针。</font><font style="vertical-align: inherit;">所有列在调用之前都必须由应用程序绑定
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          默认情况下，结果集每次从服务器缓冲取一行。</font><font style="vertical-align: inherit;">要缓冲客户端上的整个结果集，请
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在绑定数据缓冲区之后并在调用之前进行调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果提取的数据值是一个</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值，</font></font><code class="literal">*is_null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则相应</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">值
           </font><font style="vertical-align: inherit;">包含TRUE（1）。</font><font style="vertical-align: inherit;">否则，数据和它的长度在被返回
           </font></font><code class="literal">*buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code class="literal">*length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          基于由应用程序指定的缓冲型元件。</font><font style="vertical-align: inherit;">每个数字和时间类型都有一个固定长度，如下表所列。</font><font style="vertical-align: inherit;">字符串类型的长度取决于实际数据值的长度，如所示</font></font><code class="literal">data_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="informaltable">
<table summary="Numeric and temporal MySQL types and the fixed length of each type."><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">长度</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TINY</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_SHORT</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_LONG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_LONGLONG</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_FLOAT</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DOUBLE</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_TIME</code></td>
              <td><code class="literal">sizeof(MYSQL_TIME)</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DATE</code></td>
              <td><code class="literal">sizeof(MYSQL_TIME)</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_DATETIME</code></td>
              <td><code class="literal">sizeof(MYSQL_TIME)</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_STRING</code></td>
              <td><code class="literal">data length</code></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_TYPE_BLOB</code></td>
              <td><code class="literal">data_length</code></td>
</tr></tbody></table>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在某些情况下，您可能需要在获取列值之前确定列值的长度
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，该值可能是</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您想要知道必须分配多少空间</font><font style="vertical-align: inherit;">的长字符串或
           </font><font style="vertical-align: inherit;">值。</font><font style="vertical-align: inherit;">要做到这一点，你可以使用这些策略：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索单个行</font><font style="vertical-align: inherit;">之前
               </font><font style="vertical-align: inherit;">，传递
               </font></font><code class="literal">STMT_ATTR_UPDATE_MAX_LENGTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后调用
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              以在客户端缓冲整个结果。</font><font style="vertical-align: inherit;">设置</font></font><code class="literal">STMT_ATTR_UPDATE_MAX_LENGTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              属性会导致列值的最大长度由</font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回的结果集元数据</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">成员
               </font><font style="vertical-align: inherit;">指示</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为所讨论的列</font><font style="vertical-align: inherit;">
              调用</font><font style="vertical-align: inherit;">一个零长度缓冲区，并在其中存储实际长度的指针。</font><font style="vertical-align: inherit;">然后用真正的长度
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch-column" title="27.8.11.12 mysql_stmt_fetch_column（）"><code class="literal">mysql_stmt_fetch_column()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real_length = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer_length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .length =＆real_length</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_stmt_bind_result（stmt，bind）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
了mysql_stmt_fetch（语句）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（real_length&gt; 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  data = malloc（real_length）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .buffer = data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .buffer_length = real_length;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_stmt_fetch_column（stmt，bind，0，0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<div class="informaltable">
<table summary="Return values for mysql_stmt_fetch() and a description of each value."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功，数据已被提取到应用程序数据缓冲区。</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生了错误。</font><font style="vertical-align: inherit;">错误代码和消息可以通过调用
                 </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-errno" title="27.8.11.8 mysql_stmt_errno（）"><code class="literal">mysql_stmt_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
                 </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-error" title="27.8.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_NO_DATA</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有更多的行/数据存在</font></font></td>
            </tr><tr>
              <td scope="row"><code class="literal">MYSQL_DATA_TRUNCATED</code></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据截断发生</font></font></td>
</tr></tbody></table>
</div>
<p>
          <code class="literal">MYSQL_DATA_TRUNCATED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在启用截断报告时返回。</font><font style="vertical-align: inherit;">要确定返回此值时哪些列值被截断，请检查
           </font><font style="vertical-align: inherit;">用于提取值</font></font><code class="literal">error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">成员
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">截断报告在默认情况下处于启用状态，但可以通过</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该
           </font></font><code class="literal">MYSQL_REPORT_DATA_TRUNCATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">调用来控制
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unsupported_param_type"><code class="literal">CR_UNSUPPORTED_PARAM_TYPE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              缓冲型是</font></font><code class="literal">MYSQL_TYPE_DATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">MYSQL_TYPE_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><code class="literal">MYSQL_TYPE_DATETIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
               </font></font><code class="literal">MYSQL_TYPE_TIMESTAMP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是数据类型不是</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
               </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              所有其他不支持的转换错误都是从中返回的
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          下面的例子演示了如何使用获取从表中的数据
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（本例希望检索</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所示示例所插入的两行</font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;">）</font></a><font style="vertical-align: inherit;">。</font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假定</font><font style="vertical-align: inherit;">该
           </font><font style="vertical-align: inherit;">变量是有效的连接处理程序。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define STRING_SIZE 50</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#define SELECT_SAMPLE“SELECT col1，col2，col3，col4 \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                       FROM test_table“</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_STMT * stmt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_BIND绑定[4];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_RES * prepare_meta_result;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_TIME ts;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无符号长度[4];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int param_count，column_count，row_count;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
短small_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int int_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
char str_data [STRING_SIZE];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
my_bool is_null [4];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
my_bool错误[4];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *准备一个SELECT查询来从test_table * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！stmt）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_init（），内存不足\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_prepare（stmt，SELECT_SAMPLE，strlen（SELECT_SAMPLE）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_prepare（），SELECT失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（标准输出，“准备，选择成功\ n”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *从语句中获取参数计数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
param_count = mysql_stmt_param_count（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“SELECT中的全部参数：％d \ n”，param_count）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（param_count！= 0）/ *验证参数计数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL返回的无效参数数\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *取结果集元信息* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
prepare_meta_result = mysql_stmt_result_metadata（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！prepare_meta_result）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf中（错误，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
         “mysql_stmt_result_metadata（），\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           没有返回元信息\ n“）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *在查询中获取总列数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
column_count = mysql_num_fields（prepare_meta_result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf中（标准输出，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        “SELECT语句中的总列数：％d \ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        COLUMN_COUNT）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（column_count！= 4）/ *验证列计数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL返回的无效列数\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *执行SELECT查询* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_stmt_execute（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_execute（），失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *在获取所有4列时绑定结果缓冲区* /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
memset（bind，0，sizeof（bind））;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * INTEGER COLUMN * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .buffer =（char *）＆int_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .is_null =＆is_null [0];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .length =＆length [0];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [0] .error =＆error [0];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * STRING COLUMN * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer_type = MYSQL_TYPE_STRING;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer =（char *）str_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .buffer_length = STRING_SIZE;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .is_null =＆is_null [1];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .length =＆length [1];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [1] .error =＆error [1];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * SMALLINT COLUMN * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .buffer_type = MYSQL_TYPE_SHORT;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .buffer =（char *）＆small_data;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .is_null =＆is_null [2];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .length =＆length [2];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [2] .error =＆error [2];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * TIMESTAMP COLUMN * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [3] .buffer_type = MYSQL_TYPE_TIMESTAMP;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [3] .buffer =（char *）＆ts;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [3] .is_null =＆is_null [3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind [3] .length =＆length [3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
绑定[3] .error =＆error [3];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定结果缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_bind_result（stmt，bind））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_bind_result（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *现在将所有结果缓存到客户端（可选步骤）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_store_result（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_store_result（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *获取所有行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
row_count = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（stdout，“获取结果... \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
while（！mysql_stmt_fetch（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ROW_COUNT ++;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“row％d \ n”，row_count）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *第1列* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“column1（integer）：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（is_null [0]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“NULL \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“％d（％ld）\ n”，int_data，length [0]）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *第2列* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“column2（string）：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（is_null [1]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“NULL \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“％s（％ld）\ n”，str_data，length [1]）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *第3栏* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“column3（smallint）：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（is_null [2]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“NULL \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“％d（％ld）\ n”，small_data，length [2]）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *第4栏* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“column4（timestamp）：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  if（is_null [3]）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“NULL \ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stdout，“％04d-％02d-％02d％02d：％02d：％02d（％ld）\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     ts.year，ts.month，ts.day，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     ts.hour，ts.minute，ts.second，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     长度[3]）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stdout，“\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *验证提取的行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fprintf（标准输出，“获取的总行数：％d \ n”，row_count）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（row_count！= 2）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“MySQL无法返回所有行\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *释放准备好的结果元数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
了mysql_free_result（prepare_meta_result）;</font></font><font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *关闭声明* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_close（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * mysql_stmt_close（）使stmt无效，所以调用* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * mysql_error（mysql）而不是mysql_stmt_error（stmt）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“关闭语句时失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“％s \ n”，mysql_error（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-fetch-column"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.12 mysql_stmt_fetch_column（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957787344"></a><p>
        <code class="literal">int mysql_stmt_fetch_column(MYSQL_STMT *stmt,
        MYSQL_BIND *bind, unsigned int column, unsigned long
        offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-column-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          从当前结果集行中获取一列。
          </font></font><code class="literal">bind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供数据放置的缓冲区。</font><font style="vertical-align: inherit;">它的设置应该和以前一样
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font><code class="literal">column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示要提取哪一列。</font><font style="vertical-align: inherit;">第一列编号为0. </font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是开始检索数据的数据值内的偏移量。</font><font style="vertical-align: inherit;">这可以用于分片获取数据值。</font><font style="vertical-align: inherit;">该值的开始位置是偏移量0。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-column-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-fetch-column-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_invalid_parameter_no"><code class="literal">CR_INVALID_PARAMETER_NO</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无效的列号。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_no_data"><code class="literal">CR_NO_DATA</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              结果集的末尾已经达到。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-field-count"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.13 mysql_stmt_field_count（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957769984"></a><p>
        <code class="literal">unsigned int mysql_stmt_field_count(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-field-count-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回语句处理程序最近语句的列数。</font><font style="vertical-align: inherit;">对于诸如</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不产生结果集的</font><font style="vertical-align: inherit;">语句，此值为零</font><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-field-count" title="27.8.11.13 mysql_stmt_field_count（）"><code class="literal">mysql_stmt_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在您通过调用准备好声明后调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-field-count-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示结果集中列数的无符号整数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-field-count-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-free-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.14 mysql_stmt_free_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957755872"></a><p>
        <code class="literal">my_bool mysql_stmt_free_result(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-free-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          释放与执行准备语句所产生的结果集相关的内存。</font><font style="vertical-align: inherit;">如果为该语句打开了一个游标，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-free-result" title="27.8.11.14 mysql_stmt_free_result（）"><code class="literal">mysql_stmt_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          关闭它。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-free-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-init"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.15 mysql_stmt_init（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957747680"></a><p>
        <code class="literal">MYSQL_STMT *mysql_stmt_init(MYSQL *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-init-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          创建并返回一个</font></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理程序。</font><font style="vertical-align: inherit;">该处理程序应该被释放
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，此时处理程序变为无效，不应该再使用。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关</font><font style="vertical-align: inherit;">更多信息</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures" title="27.8.9 C API编写的语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另请参见
           </font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures" title="27.8.9 C API编写的语句数据结构"><font style="vertical-align: inherit;">第27.8.9节“C API准备语句数据结构”</font></a><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-init-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"></font><code class="literal">MYSQL_STMT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功时</font><font style="vertical-align: inherit;">
          指向</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针</font><font style="vertical-align: inherit;">。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果内存不足。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-init-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-insert-id"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.16 mysql_stmt_insert_id（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957732176"></a><p>
        <code class="literal">my_ulonglong mysql_stmt_insert_id(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-insert-id-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备好</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">为</font><font style="vertical-align: inherit;">列
           </font><font style="vertical-align: inherit;">生成的值
           </font><font style="vertical-align: inherit;">。</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在包含</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font><font style="vertical-align: inherit;">的表上</font><font style="vertical-align: inherit;">执行准备好的</font><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">后使用此函数
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关</font><font style="vertical-align: inherit;">更多信息</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请参见</font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><font style="vertical-align: inherit;">第27.8.7.38节“mysql_insert_id（）”</font></a><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-insert-id-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对值</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">柱上，自动生成的或明确地准备语句，或通过生成的值的执行过程中设置
           </font><font style="vertical-align: inherit;">
          的功能。</font><font style="vertical-align: inherit;">如果语句没有设置</font><font style="vertical-align: inherit;">值，</font><font style="vertical-align: inherit;">返回值是不确定的
           </font><font style="vertical-align: inherit;">。
</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID(<em class="replaceable"><code>expr</code></em>)</code></a><font style="vertical-align: inherit;"></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-insert-id-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-next-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.17 mysql_stmt_next_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957713088"></a><p>
        <code class="literal">int mysql_stmt_next_result(MYSQL_STMT *mysql)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-next-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当您使用预处理</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句执行存储过程</font><font style="vertical-align: inherit;">时可以使用此函数
           </font><font style="vertical-align: inherit;">，该过程可以返回多个结果集。</font><font style="vertical-align: inherit;">使用调用的循环
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result" title="27.8.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来确定是否有更多结果。</font><font style="vertical-align: inherit;">如果过程具有
           </font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，则它们的值将作为单行结果集在任何其他结果集之后返回。</font><font style="vertical-align: inherit;">这些值将按照它们在过程参数列表中声明的顺序显示。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result" title="27.8.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回状态以指示是否存在更多结果。</font><font style="vertical-align: inherit;">如果
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result" title="27.8.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回错误，则不会有更多结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在每次调用之前
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result" title="27.8.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-free-result" title="27.8.11.14 mysql_stmt_free_result（）"><code class="literal">mysql_stmt_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果产生结果集（而不仅仅是结果状态）</font><font style="vertical-align: inherit;">，则必须调用
           </font><font style="vertical-align: inherit;">当前结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result" title="27.8.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接的状态</font><font style="vertical-align: inherit;">之后
           </font><font style="vertical-align: inherit;">就好像你已经调用过了
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这意味着你可以打电话
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-affected-rows" title="27.8.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等等。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          也可以通过调用来测试是否有更多结果</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-more-results" title="27.8.7.46 mysql_more_results（）"><code class="literal">mysql_more_results()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，此函数不会更改连接状态，因此如果它返回true，则仍然必须调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result" title="27.8.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前进到下一个结果。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有关显示如何使用的示例
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result" title="27.8.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-call-statements" title="27.8.18 C API编写的CALL语句支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.18节“C API准备的CALL语句支持”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-next-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<div class="informaltable">
<table summary="Return values for mysql_stmt_next_result() and a description of each value."><colgroup><col width="35%"><col width="65%"></colgroup><thead><tr>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></th>
              <th scope="col"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th>
            </tr></thead><tbody><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功，并有更多的结果</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-1</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功，没有更多的结果</font></font></td>
            </tr><tr>
              <td scope="row"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; 0</font></font></td>
              <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生错误</font></font></td>
</tr></tbody></table>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-next-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-num-rows"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.18 mysql_stmt_num_rows（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957661072"></a><p>
        <code class="literal">my_ulonglong mysql_stmt_num_rows(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-num-rows-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回结果集中的行数。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-num-rows" title="27.8.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于您是否用来
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓冲语句处理程序中的整个结果集。</font><font style="vertical-align: inherit;">如果你使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-num-rows" title="27.8.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会立即被调用。</font><font style="vertical-align: inherit;">否则，行计数不可用，除非您在获取行时对其进行计数。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-num-rows" title="27.8.11.18 mysql_stmt_num_rows（）"><code class="literal">mysql_stmt_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">旨在用于返回结果集的语句，例如</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">对于语句如</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以与获得受影响的行的数量
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-affected-rows" title="27.8.11.1 mysql_stmt_affected_rows（）"><code class="literal">mysql_stmt_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-num-rows-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果集中的行数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-num-rows-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-param-count"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.19 mysql_stmt_param_count（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957638832"></a><p>
        <code class="literal">unsigned long mysql_stmt_param_count(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-param-count-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回准备好的语句中存在的参数标记的数量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-param-count-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          表示语句中参数个数的无符号长整数。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-param-count-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-param-count-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-param-metadata"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.20 mysql_stmt_param_metadata（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957627824"></a><p>
        <code class="literal">MYSQL_RES *mysql_stmt_param_metadata(MYSQL_STMT
        *stmt)</code>
      </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        这个功能目前什么都不做。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-prepare"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.21 mysql_stmt_prepare（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957623936"></a><p>
        <code class="literal">int mysql_stmt_prepare(MYSQL_STMT *stmt, const char
        *stmt_str, unsigned long length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-prepare-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          给定返回的语句处理程序
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-init" title="27.8.11.15 mysql_stmt_init（）"><code class="literal">mysql_stmt_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，准备字符串指向的SQL语句
           </font></font><code class="literal">stmt_str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并返回状态值。</font><font style="vertical-align: inherit;">字符串长度应该由</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          参数</font><font style="vertical-align: inherit;">给出</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该字符串必须由单个SQL语句组成。</font><font style="vertical-align: inherit;">您不应该添加终止分号（</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或</font></font><code class="literal">\g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通过将SQL Mark </font></font><code class="literal">?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符串中的</font><font style="vertical-align: inherit;">问号（</font><font style="vertical-align: inherit;">）字符</font><font style="vertical-align: inherit;">嵌入</font><font style="vertical-align: inherit;">适当的位置</font><font style="vertical-align: inherit;">，应用程序可以在SQL语句中包含一个或多个参数标记</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这些标记仅在SQL语句中的某些地方合法。</font><font style="vertical-align: inherit;">例如，它们可以在
           </font><font style="vertical-align: inherit;">语句</font></font><code class="literal">VALUES()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列表中
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（用于指定行的列值）或与</font></font><code class="literal">WHERE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">的列进行</font><font style="vertical-align: inherit;">比较以指定比较值。</font><font style="vertical-align: inherit;">但是，它们不允许用于标识符（例如表名或列名），也不能指定二进制运算符的两个操作数，例如</font></font><code class="literal">=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等号。</font><font style="vertical-align: inherit;">后一种限制是必要的，因为不可能确定参数类型。</font><font style="vertical-align: inherit;">通常，参数仅在数据操纵语言（DML）语句中合法，而不在数据定义语言（DDL）语句中合法。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在执行语句之前，</font><font style="vertical-align: inherit;">
          必须将参数标记绑定到应用程序变量</font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对准备好的语句引用的表或视图的元数据更改会被检测到，并在下次执行时导致语句自动重新编译。</font><font style="vertical-align: inherit;">有关更多信息，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/optimization.html#statement-caching" title="8.10.4缓存准备好的语句和存储的程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.10.4节“准备好的语句和存储的程序的缓存”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-prepare-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-prepare-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果准备操作不成功（即
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非零），则可以通过调用获得错误消息
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-error" title="27.8.11.9 mysql_stmt_error（）"><code class="literal">mysql_stmt_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-prepare-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.10节“mysql_stmt_execute（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-reset"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.22 mysql_stmt_reset（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957584576"></a><p>
        <code class="literal">my_bool mysql_stmt_reset(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-reset-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          准备好之后，将客户端和服务器上的准备好的语句重置为状态。</font><font style="vertical-align: inherit;">它会重置服务器上的语句，使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-send-long-data" title="27.8.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无缓冲的结果集和当前错误</font><font style="vertical-align: inherit;">发送的数据
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它不清除绑定或存储的结果集。</font><font style="vertical-align: inherit;">执行准备好的语句（或关闭它）时，存储的结果集将被清除。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要用另一个查询重新准备语句，请使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-reset-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-reset-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-result-metadata"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.23 mysql_stmt_result_metadata（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957562784"></a><p>
        <code class="literal">MYSQL_RES *mysql_stmt_result_metadata(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-result-metadata-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果传递的语句</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是生成结果集</font><font style="vertical-align: inherit;">的语句
           </font><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          则将结果集元数据以指针的形式返回到
           </font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于处理元信息（例如字段数和单个字段信息）的结构。</font><font style="vertical-align: inherit;">此结果集指针可作为参数传递给处理结果集元数据的任何基于字段的API函数，例如：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-fields" title="27.8.7.48 mysql_num_fields（）"><code class="literal">mysql_num_fields()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field" title="27.8.7.17 mysql_fetch_field（）"><code class="literal">mysql_fetch_field()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-field-direct" title="27.8.7.18 mysql_fetch_field_direct（）"><code class="literal">mysql_fetch_field_direct()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-fields" title="27.8.7.19 mysql_fetch_fields（）"><code class="literal">mysql_fetch_fields()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-seek" title="27.8.7.23 mysql_field_seek（）"><code class="literal">mysql_field_seek()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-tell" title="27.8.7.24 mysql_field_tell（）"><code class="literal">mysql_field_tell()</code></a>
            </p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a>
</p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          当你完成它的时候，结果集结构应该被释放，你可以通过传递它来完成
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-free-result" title="27.8.7.25 mysql_free_result（）"><code class="literal">mysql_free_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这与您从呼叫中获取结果集的方式类似</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回的结果集
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          仅包含元数据。</font><font style="vertical-align: inherit;">它不包含任何行结果。</font><font style="vertical-align: inherit;">这些行是通过使用语句处理程序获得的
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-result-metadata-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个</font></font><code class="literal">MYSQL_RES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果结构。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有准备好的查询的元信息。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-result-metadata-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-result-metadata-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.11节“mysql_stmt_fetch（）”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的示例</font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-row-seek"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.24 mysql_stmt_row_seek（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957519456"></a><p>
        <code class="literal">MYSQL_ROW_OFFSET mysql_stmt_row_seek(MYSQL_STMT *stmt,
        MYSQL_ROW_OFFSET offset)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-seek-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将行游标设置为语句结果集中的任意行。</font><font style="vertical-align: inherit;">该</font></font><code class="literal">offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值是一个行偏移量，应该是从</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-tell" title="27.8.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font><font style="vertical-align: inherit;">返回的值
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-seek" title="27.8.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值不是行号; </font><font style="vertical-align: inherit;">如果您想要通过数字查找结果集中的一行，请</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-data-seek" title="27.8.11.7 mysql_stmt_data_seek（）"><code class="literal">mysql_stmt_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          改为</font><font style="vertical-align: inherit;">使用
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数要求结果集结构包含查询的整个结果，因此
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-seek" title="27.8.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能仅与结合使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-seek-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行游标的前一个值。</font><font style="vertical-align: inherit;">该值可能会传递给后续的呼叫
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-seek" title="27.8.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-seek-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-row-tell"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.25 mysql_stmt_row_tell（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957502000"></a><p>
        <code class="literal">MYSQL_ROW_OFFSET mysql_stmt_row_tell(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-tell-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回最后一行的光标的当前位置
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该值可以用作参数
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-seek" title="27.8.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          你</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-tell" title="27.8.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只能在以后
           </font><font style="vertical-align: inherit;">使用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-tell-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          行光标的当前偏移量。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-row-tell-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-send-long-data"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.26 mysql_stmt_send_long_data（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957487904"></a><p>
        <code class="literal">my_bool mysql_stmt_send_long_data(MYSQL_STMT *stmt,
        unsigned int parameter_number, const char *data, unsigned long
        length)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-send-long-data-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          使应用程序能够将参数数据以块（或</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）的形式</font><font style="vertical-align: inherit;">发送到服务器</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">后调用该函数
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">之前</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">可以多次调用它来为某个列发送字符或二进制数据值的部分，该列必须是其中一种</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">BLOB</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据类型。
        </font></font></p><p>
          <code class="literal">parameter_number</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示将数据与哪个参数相关联。</font><font style="vertical-align: inherit;">参数从0开始编号。</font></font><code class="literal">data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是指向包含要发送的数据的缓冲区的指针，并</font></font><code class="literal">length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指示缓冲区中的字节数。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            下一次
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用忽略</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-send-long-data" title="27.8.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            自从last
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或之后
             </font><font style="vertical-align: inherit;">使用的所有参数的绑定缓冲区
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-reset" title="27.8.11.22 mysql_stmt_reset（）"><code class="literal">mysql_stmt_reset()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果你想重置/忘记发送的数据，你可以这样做
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-reset" title="27.8.11.22 mysql_stmt_reset（）"><code class="literal">mysql_stmt_reset()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-reset" title="27.8.11.22 mysql_stmt_reset（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.22节“mysql_stmt_reset（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所述</font></font><a class="link" href="/mysql-5.7-google-zh/server-administration.html#sysvar_max_allowed_packet"><code class="literal">max_allowed_packet</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">系统变量控制可以与发送参数值的最大大小
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-send-long-data" title="27.8.11.26 mysql_stmt_send_long_data（）"><code class="literal">mysql_stmt_send_long_data()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-send-long-data-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-send-long-data-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_invalid_buffer_use"><code class="literal">CR_INVALID_BUFFER_USE</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              该参数没有字符串或二进制类型。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_invalid_parameter_no"><code class="literal">CR_INVALID_PARAMETER_NO</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              无效的参数号码。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-send-long-data-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          以下示例演示如何以</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#blob" title="11.4.3 BLOB和TEXT类型"><code class="literal">TEXT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块</font><font style="vertical-align: inherit;">为单位发送</font><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的数据
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它将数据值</font></font><code class="literal">'MySQL - The most popular Open
          Source database'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">插入到
           </font></font><code class="literal">text_column</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中。</font><font style="vertical-align: inherit;">该
           </font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量被假定为有效的连接处理程序。
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#define INSERT_QUERY“INSERT INTO \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      test_long_data（text_column）VALUES（？）“</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_BIND bind [1];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
长度长;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！stmt）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“mysql_stmt_init（），内存不足\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_prepare（stmt，INSERT_QUERY，strlen（INSERT_QUERY）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n mysql_stmt_prepare（），INSERT failed”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 memset（bind，0，sizeof（bind））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 bind [0] .buffer_type = MYSQL_TYPE_STRING;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 bind [0] .length =＆length;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 bind [0] .is_null = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
if（mysql_stmt_bind_param（stmt，bind））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n param bind failed”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 / *以块的形式向服务器提供数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 如果（mysql_stmt_send_long_data（stmt，0，“MySQL”，5））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n send_long_data失败”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 / *提供下一条数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 如果（mysql_stmt_send_long_data（stmt，0，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
           “ - 最受欢迎的开源数据库”，40））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n send_long_data失败”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 / *现在，执行查询* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 如果（mysql_stmt_execute（stmt））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n mysql_stmt_execute failed”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-sqlstate"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.27 mysql_stmt_sqlstate（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957434672"></a><p>
        <code class="literal">const char *mysql_stmt_sqlstate(MYSQL_STMT
        *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-sqlstate-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于指定的语句</font></font><code class="literal">stmt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-sqlstate" title="27.8.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个以空字符结尾的字符串，其中包含最近调用的预准备语句API函数的SQLSTATE错误代码，该函数可以成功或失败。</font><font style="vertical-align: inherit;">错误代码由五个字符组成。</font></font><code class="literal">"00000"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">意味着</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有错误。</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些值由ANSI SQL和ODBC指定。</font><font style="vertical-align: inherit;">有关可能值的列表，请参阅
           </font></font><a class="xref" href="/mysql-5.7-google-zh/error-handling.html" title="附录B错误，错误代码和常见问题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录B，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误，错误代码和常见问题</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          并非所有的MySQL错误都被映射到SQLSTATE代码。</font><font style="vertical-align: inherit;">值
           </font></font><code class="literal">"HY000"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（一般错误）用于未映射的错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果失败语句API函数是
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请不要调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-sqlstate" title="27.8.11.27 mysql_stmt_sqlstate（）"><code class="literal">mysql_stmt_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以获取错误信息，因为
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-close" title="27.8.11.6 mysql_stmt_close（）"><code class="literal">mysql_stmt_close()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使语句处理程序无效。</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-sqlstate" title="27.8.7.72 mysql_sqlstate（）"><code class="literal">mysql_sqlstate()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改为</font><font style="vertical-align: inherit;">打电话
           </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-sqlstate-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          包含SQLSTATE错误代码的以空字符结尾的字符串。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-stmt-store-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.11.28 mysql_stmt_store_result（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957416912"></a><p>
        <code class="literal">int mysql_stmt_store_result(MYSQL_STMT *stmt)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-stmt-store-result-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          结果集通过调用产生
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于SQL语句如执行准备语句
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#show" title="13.7.5 SHOW语法"><code class="literal">SHOW</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#describe" title="13.8.1 DESCRIBE语法"><code class="literal">DESCRIBE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#explain" title="13.8.2 EXPLAIN语法"><code class="literal">EXPLAIN</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认情况下，成功执行的预准备语句的结果集不会在客户端上缓存，并且</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每次从服务器获取一个</font><font style="vertical-align: inherit;">结果集
           </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">为了使完整的结果集在客户端上被缓冲
           </font><font style="vertical-align: inherit;">，在调用</font><font style="vertical-align: inherit;">来获取行</font><font style="vertical-align: inherit;">之前调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          绑定数据缓冲区
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">之后进行调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><code class="literal">mysql_stmt_fetch()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（有关示例，请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-fetch" title="27.8.11.11 mysql_stmt_fetch（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.11节“mysql_stmt_fetch（）”）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是可选的结果集处理，除非你会打电话
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-data-seek" title="27.8.11.7 mysql_stmt_data_seek（）"><code class="literal">mysql_stmt_data_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-seek" title="27.8.11.24 mysql_stmt_row_seek（）"><code class="literal">mysql_stmt_row_seek()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-row-tell" title="27.8.11.25 mysql_stmt_row_tell（）"><code class="literal">mysql_stmt_row_tell()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些功能需要可搜索的结果集。
        </font></font></p><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在执行不产生结果集的SQL语句后</font><font style="vertical-align: inherit;">
          无需调用
           </font><font style="vertical-align: inherit;">，但如果这样做，它不会造成任何明显的性能问题。</font><font style="vertical-align: inherit;">您可以通过检查是否</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><code class="literal">mysql_stmt_result_metadata()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回</font><font style="vertical-align: inherit;">来检测语句是否产生结果集
           </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关更多信息，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-result-metadata" title="27.8.11.23 mysql_stmt_result_metadata（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.23节“mysql_stmt_result_metadata（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            MySQL默认情况下不会计算
             </font></font><code class="literal">MYSQL_FIELD-&gt;max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有列，
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            因为计算这会显着减慢
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-store-result" title="27.8.11.28 mysql_stmt_store_result（）"><code class="literal">mysql_stmt_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            ，大多数应用程序不需要
             </font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果你想
             </font></font><code class="literal">max_length</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新，你可以打电话
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><code class="literal">mysql_stmt_attr_set(MYSQL_STMT,
            STMT_ATTR_UPDATE_MAX_LENGTH, &amp;flag)</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来启用它。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-attr-set" title="27.8.11.3 mysql_stmt_attr_set（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.11.3节“mysql_stmt_attr_set（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-store-result-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-stmt-store-result-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_commands_out_of_sync"><code class="literal">CR_COMMANDS_OUT_OF_SYNC</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              命令以不正确的顺序执行。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_out_of_memory"><code class="literal">CR_OUT_OF_MEMORY</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              内存不足。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_gone_error"><code class="literal">CR_SERVER_GONE_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              MySQL服务器已经消失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_server_lost"><code class="literal">CR_SERVER_LOST</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在查询过程中与服务器的连接丢失。
            </font></font></p></li><li class="listitem"><p>
              <a class="link" href="/mysql-5.7-google-zh/error-handling.html#error_cr_unknown_error"><code class="literal">CR_UNKNOWN_ERROR</code></a>
            </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              出现未知错误。
</font></font></p></li></ul>
</div>

</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-thread-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12 C API线程化函数描述</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#my-init"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12.1 my_init（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-end"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12.2 mysql_thread_end（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12.3 mysql_thread_init（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-safe"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12.4 mysql_thread_safe（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要创建一个线程客户端，请使用以下各节中介绍的功能。</font><font style="vertical-align: inherit;">另请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-threaded-clients" title="27.8.4.3编写C API线程客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.4.3节“编写C API线程客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="my-init"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12.1 my_init（）</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140527957363568"></a><p>
        <code class="literal">void my_init(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="my-init-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#my-init" title="27.8.12.1 my_init（）"><code class="literal">my_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初始化MySQL需要的一些全局变量。</font><font style="vertical-align: inherit;">它也要求
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个线程。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          有必要</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#my-init" title="27.8.12.1 my_init（）"><code class="literal">my_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在程序使用MySQL客户端库的初始化阶段提前调用。</font><font style="vertical-align: inherit;">然而，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#my-init" title="27.8.12.1 my_init（）"><code class="literal">my_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会自动叫</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-init" title="27.8.13.2 mysql_server_init（）"><code class="literal">mysql_server_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect" title="27.8.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果确保程序在任何其他MySQL调用之前调用其中一个函数，则不需要</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#my-init" title="27.8.12.1 my_init（）"><code class="literal">my_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显式</font><font style="vertical-align: inherit;">调用
           </font><font style="vertical-align: inherit;">。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要访问原型
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#my-init" title="27.8.12.1 my_init（）"><code class="literal">my_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，你的程序应该包含这些头文件：
        </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include &lt;my_global.h&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#include &lt;my_sys.h&gt;</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="my-init-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-thread-end"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12.2 mysql_thread_end（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957342304"></a><p>
        <code class="literal">void mysql_thread_end(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-thread-end-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用</font></font><code class="literal">pthread_exit()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">释放分配的内存
           </font><font style="vertical-align: inherit;">之前调用此函数
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p><p>
          <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-end" title="27.8.12.2 mysql_thread_end（）"><code class="literal">mysql_thread_end()</code></a>
          <span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不会由客户端库自动调用</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于未启用调试支持的发布/生产版本，
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-end" title="27.8.12.2 mysql_thread_end（）"><code class="literal">mysql_thread_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不需要调用。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于调试版本，
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              为DBUG包分配调试信息（参见
               </font></font><a class="xref" href="/mysql-5.7-google-zh/extending-mysql.html#dbug-package" title="28.5.3 DBUG包"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.5.3节“DBUG包”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
              </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-end" title="27.8.12.2 mysql_thread_end（）"><code class="literal">mysql_thread_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须为每个
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用调用以避免内存泄漏。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-end-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-thread-init"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12.3 mysql_thread_init（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957323600"></a><p>
        <code class="literal">my_bool mysql_thread_init(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-thread-init-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该函数必须在每个创建的线程内尽早调用，以初始化线程特定的变量。</font><font style="vertical-align: inherit;">但是，您可能并不一定需要明确地调用它：
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自动被称为
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#my-init" title="27.8.12.1 my_init（）"><code class="literal">my_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这本身是通过自动调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-init" title="27.8.7.37 mysql_init（）"><code class="literal">mysql_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-init" title="27.8.13.2 mysql_server_init（）"><code class="literal">mysql_server_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-connect" title="27.8.7.7 mysql_connect（）"><code class="literal">mysql_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果你调用任何这些函数，都会
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-init" title="27.8.12.3 mysql_thread_init（）"><code class="literal">mysql_thread_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被调用。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-init-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-thread-safe"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.12.4 mysql_thread_safe（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957307824"></a><p>
        <code class="literal">unsigned int mysql_thread_safe(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-thread-safe-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数指示客户端库是否被编译为线程安全。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-thread-safe-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          1如果客户端库是线程安全的，否则为0。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-embedded-server-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.13 C API嵌入式服务器功能描述</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-end"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.13.1 mysql_server_end（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-init"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.13.2 mysql_server_init（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      可以编写MySQL应用程序来使用嵌入式服务器。</font><font style="vertical-align: inherit;">请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#libmysqld" title="27.7 libmysqld，嵌入式MySQL服务器库"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.7节“libmysqld，嵌入式MySQL服务器库”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要编写这样一个应用程序，您必须</font></font><code class="literal">libmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该</font></font><code class="option">-lmysqld</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志将其</font><font style="vertical-align: inherit;">链接到</font><font style="vertical-align: inherit;">库，</font><font style="vertical-align: inherit;">而不是</font><font style="vertical-align: inherit;">通过使用该</font><font style="vertical-align: inherit;">标志将其链接到</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端库</font></font><code class="option">-lmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是，无论您编写客户端应用程序还是使用嵌入式服务器的应用程序，初始化和确定库的调用都是相同的：调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以初始化库，以及
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何时完成。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-function-overview" title="27.8.6 C API函数概述"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.6节“C API函数概述”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-server-end"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.13.1 mysql_server_end（）</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140527957292832"></a><p>
        <code class="literal">void mysql_server_end(void)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-server-end-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个函数完成了MySQL库，当你使用库时应该完成这个工作。</font><font style="vertical-align: inherit;">但是，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-end" title="27.8.13.1 mysql_server_end（）"><code class="literal">mysql_server_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已被弃用，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应该使用。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.40节“mysql_library_end（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            为避免在使用该库完成应用程序之后（例如，在关闭与服务器的连接之后）内存泄漏，请务必</font><font style="vertical-align: inherit;">明确地</font><font style="vertical-align: inherit;">调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-end" title="27.8.13.1 mysql_server_end（）"><code class="literal">mysql_server_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">这使得执行内存管理来清理和释放库使用的资源。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-server-end-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          没有。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-server-init"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.13.2 mysql_server_init（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957279168"></a><p>
        <code class="literal">int mysql_server_init(int argc, char **argv, char
        **groups)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-server-init-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          此函数初始化MySQL客户端库，在调用任何其他MySQL函数之前必须完成此操作。</font><font style="vertical-align: inherit;">但是，
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-init" title="27.8.13.2 mysql_server_init（）"><code class="literal">mysql_server_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已弃用，您应该调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.41节“mysql_library_init（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            为避免在使用该库完成应用程序之后（例如，在关闭与服务器的连接之后）内存泄漏，请务必</font><font style="vertical-align: inherit;">明确地</font><font style="vertical-align: inherit;">调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-server-end" title="27.8.13.1 mysql_server_end（）"><code class="literal">mysql_server_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><code class="literal">mysql_library_end()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">这使得执行内存管理来清理和释放库使用的资源。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-end" title="27.8.7.40 mysql_library_end（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.40节“mysql_library_end（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-server-init-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          零成功。</font><font style="vertical-align: inherit;">非零，如果发生错误。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-plugin-functions"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14 C API客户端插件功能</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-client-find-plugin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.1 mysql_client_find_plugin（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-client-register-plugin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.2 mysql_client_register_plugin（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.3 mysql_load_plugin（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin-v"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.4 mysql_load_plugin_v（）</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#mysql-plugin-options"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.5 mysql_plugin_options（）</font></font></a></span></dt></dl>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍用于客户端插件API的函数。</font><font style="vertical-align: inherit;">它们支持客户端插件的管理。</font><font style="vertical-align: inherit;">有关</font></font><code class="literal">st_mysql_client_plugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些函数使用</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的描述</font><font style="vertical-align: inherit;">，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/extending-mysql.html#client-plugin-descriptors" title="28.2.4.2.3客户端插件描述符"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.2.4.2.3节“客户端插件描述符”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      客户端程序不太可能需要调用本节中的函数。</font><font style="vertical-align: inherit;">例如，支持使用身份验证插件的客户端通常会通过调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以设置
       </font></font><code class="literal">MYSQL_DEFAULT_AUTH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><code class="literal">MYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">来加载插件</font><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char * plugin_dir =“ </font></font><em class="replaceable"><code>path_to_plugin_dir</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
char * default_auth =“ </font></font><em class="replaceable"><code>plugin_name</code></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">”;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ * ...进程命令行选项... * /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（＆mysql，MYSQL_PLUGIN_DIR，plugin_dir）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（＆mysql，MYSQL_DEFAULT_AUTH，default_auth）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      通常情况下，该程序还将接受
       </font></font><code class="option">--plugin-dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="option">--default-auth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用户能够覆盖默认值的选项。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-client-find-plugin"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.1 mysql_client_find_plugin（）</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140527957254464"></a><p>
        <code class="literal">struct st_mysql_client_plugin
        *mysql_client_find_plugin(MYSQL *mysql, const char *name, int
        type)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-client-find-plugin-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回一个指向已加载插件的指针，如果需要的话首先加载插件。</font><font style="vertical-align: inherit;">如果类型无效或无法找到或加载插件，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">插件API不需要连接到MySQL服务器，但必须正确初始化此结构。</font><font style="vertical-align: inherit;">该结构用于获取连接相关的信息。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：插件名称。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：插件类型。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-find-plugin-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向成功插件的指针。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-find-plugin-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要检查错误，请调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.15节“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.14节“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-find-plugin-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL mysql;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
struct st_mysql_client_plugin * p;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（（p = mysql_client_find_plugin（＆mysql，“myplugin”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                                  MYSQL_CLIENT_AUTHENTICATION_PLUGIN，0）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“插件版本：％d。％d。％d \ n”，p-&gt; version [0]，p-&gt; version [1]，p-&gt; version [2]）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-client-register-plugin"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.2 mysql_client_register_plugin（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957231936"></a><p>
        <code class="literal">struct st_mysql_client_plugin
        *mysql_client_register_plugin(MYSQL *mysql, struct
        st_mysql_client_plugin *plugin)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-client-register-plugin-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将插件结构添加到加载的插件列表中。</font><font style="vertical-align: inherit;">如果该插件已被加载，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">插件API不需要连接到MySQL服务器，但必须正确初始化此结构。</font><font style="vertical-align: inherit;">该结构用于获取连接相关的信息。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">plugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向插件结构的指针。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-register-plugin-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向成功插件的指针。</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-client-register-plugin-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要检查错误，请调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.15节“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.14节“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-load-plugin"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.3 mysql_load_plugin（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957213744"></a><p>
        <code class="literal">struct st_mysql_client_plugin *mysql_load_plugin(MYSQL
        *mysql, const char *name, int type, int argc, ...)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          加载一个MySQL客户端插件，按名称和类型指定。</font><font style="vertical-align: inherit;">如果类型无效或插件无法加载，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          无法加载同一类型的多个插件。</font><font style="vertical-align: inherit;">如果您尝试加载已加载类型的插件，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向</font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的指针
               </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">插件API不需要连接到MySQL服务器，但必须正确初始化此结构。</font><font style="vertical-align: inherit;">该结构用于获取连接相关的信息。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：要加载的插件的名称。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：要加载的插件的类型，或-1以禁用类型检查。</font><font style="vertical-align: inherit;">如果type不是-1，则仅考虑与该类型匹配的插件进行加载。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">argc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：以下参数的数量（如果没有则为0）。</font><font style="vertical-align: inherit;">任何以下参数的解释取决于插件类型。
</font></font></p></li></ul>
</div>
<a class="indexterm" name="idm140527957200928"></a><a class="indexterm" name="idm140527957199840"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          导致插件被加载的另一种方法是将</font></font><code class="literal">LIBMYSQL_PLUGINS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量</font><font style="vertical-align: inherit;">设置
           </font><font style="vertical-align: inherit;">为以分号分隔的插件名称列表。</font><font style="vertical-align: inherit;">例如：
        </font></font></p><pre data-lang="terminal" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shell&gt; export LIBMYSQL_PLUGINS =“myplugin1; myplugin2”
</font></font></pre><p><font style="vertical-align: inherit;"></font><code class="literal">LIBMYSQL_PLUGINS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在客户端程序调用时加载
           </font><font style="vertical-align: inherit;">
          名为的插件</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-library-init" title="27.8.7.41 mysql_library_init（）"><code class="literal">mysql_library_init()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果加载这些插件时发生问题，则不报告错误。
        </font></font></p><a class="indexterm" name="idm140527957193504"></a><a class="indexterm" name="idm140527957192400"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><code class="literal">LIBMYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量可以设置的目录中查找客户端插件的路径名。</font><font style="vertical-align: inherit;">这个变量有两种使用方式：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              在客户端插件预加载期间，该</font></font><code class="option">--plugin-dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">的值
               </font><font style="vertical-align: inherit;">不可用，因此客户端插件加载失败，除非插件位于硬连线的默认目录中。</font><font style="vertical-align: inherit;">如果插件位于其他地方，则</font></font><code class="literal">LIBMYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              可以将环境变量设置为正确的目录以启用插件预加载成功。
            </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              对于显式客户端插件的加载，将
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin" title="27.8.14.3 mysql_load_plugin（）"><code class="literal">mysql_load_plugin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin-v" title="27.8.14.4 mysql_load_plugin_v（）"><code class="literal">mysql_load_plugin_v()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C API函数使用
               </font></font><code class="literal">LIBMYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果它存在和值</font></font><code class="option">--plugin-dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有给出选项。</font><font style="vertical-align: inherit;">如果</font></font><code class="option">--plugin-dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给出，
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin" title="27.8.14.3 mysql_load_plugin（）"><code class="literal">mysql_load_plugin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin-v" title="27.8.14.4 mysql_load_plugin_v（）"><code class="literal">mysql_load_plugin_v()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              忽略</font></font><code class="literal">LIBMYSQL_PLUGIN_DIR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指向插件的指针，如果它已成功加载。
          </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果发生错误。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-errors"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          要检查错误，请调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.15节“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.14节“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-example"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例</font></font></h5>

</div>

</div>

</div>
<pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL mysql;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！mysql_load_plugin（＆mysql，“myplugin”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      MYSQL_CLIENT_AUTHENTICATION_PLUGIN，0））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误：％s \ n”，mysql_error（＆mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（-1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-see-also"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也可以看看</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin" title="27.8.14.3 mysql_load_plugin（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.14.3节“mysql_load_plugin（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.15节“mysql_error（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.14节“mysql_errno（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-load-plugin-v"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.4 mysql_load_plugin_v（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957163024"></a><p>
        <code class="literal">struct st_mysql_client_plugin
        *mysql_load_plugin_v(MYSQL *mysql, const char *name, int type,
        int argc, va_list args)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-v-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          这个函数等同于
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin" title="27.8.14.3 mysql_load_plugin（）"><code class="literal">mysql_load_plugin()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但它接受一个</font></font><code class="literal">va_list</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数而不是一个变量列表。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-load-plugin-v-see-also"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也可以看看</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          另请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-load-plugin" title="27.8.14.3 mysql_load_plugin（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.14.3节“mysql_load_plugin（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mysql-plugin-options"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.14.5 mysql_plugin_options（）</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527957153488"></a><p>
        <code class="literal">int mysql_plugin_options(struct st_mysql_client_plugin
        *plugin, const char *option, const void *value)</code>
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="mysql-plugin-options-description"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></h5>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将选项类型和值传递给插件。</font><font style="vertical-align: inherit;">该功能可以多次调用以设置多个选项。</font><font style="vertical-align: inherit;">如果插件没有选项处理程序，则会发生错误。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          指定参数如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">plugin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向插件结构的指针。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">option</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：要设置的选项。
            </font></font></p></li><li class="listitem"><p>
              <code class="literal">value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：指向选项值的指针。
</font></font></p></li></ul>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="mysql-plugin-options-return-values"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值</font></font></h5>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          成功为零，如果发生错误则为1。</font><font style="vertical-align: inherit;">如果插件有一个选项处理程序，那么该处理程序也应该返回0表示成功，如果发生错误则返回1。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-encrypted-connections"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.15 C API加密连接支持</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍C应用程序如何使用C API功能进行加密连接。</font><font style="vertical-align: inherit;">默认情况下，如果服务器支持加密连接，则MySQL程序尝试使用加密进行连接，如果无法建立加密连接，则会回退到未加密连接（请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#using-encrypted-connections" title="6.4.1配置MySQL以使用加密连接"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.4.1节“配置MySQL以使用加密连接”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">对于需要控制超出加密连接建立的默认行为的应用程序，C API提供了以下功能：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能使应用程序能够在调用之前设置适当的SSL / TLS选项
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，要求使用加密连接，请参阅
           </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-enforcing-encrypted-connection" title="执行加密连接"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实施加密连接</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-ssl-cipher" title="27.8.7.34 mysql_get_ssl_cipher（）"><code class="literal">mysql_get_ssl_cipher()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          功能使应用程序能够在连接建立后确定连接是否使用加密。</font><font style="vertical-align: inherit;">一个</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回值表示不使用加密。</font><font style="vertical-align: inherit;">非</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          返回值表示加密连接并命名加密密码。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-get-ssl-cipher" title="27.8.7.34 mysql_get_ssl_cipher（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.34节“mysql_get_ssl_cipher（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-encrypted-connection-options" title="加密连接的C API选项"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加密连接的C API选项</font></font></a></p></li><li class="listitem"><p><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-enforcing-encrypted-connection" title="执行加密连接"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行加密连接</font></font></a></p></li><li class="listitem"><p><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-secure-encrypted-connection" title="提高加密连接的安全性"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提高加密连接的安全性</font></font></a></p></li></ul>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-encrypted-connection-options"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加密连接的C API选项</font></font></h4>

</div>

</div>

</div>
<p>
        <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供以下选项来控制加密连接的使用。</font><font style="vertical-align: inherit;">有关选项的详细信息，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.50节“mysql_options（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：证书颁发机构（CA）证书文件的路径名称。</font><font style="vertical-align: inherit;">该选项（如果使用）必须指定服务器使用的相同证书。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CAPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含可信SSL证书文件的目录的路径名。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户端公钥证书文件的路径名。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CIPHER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：SSL加密允许的密码列表。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CRL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含证书撤销列表的文件的路径名称。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_CRLPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：包含证书撤销列表文件的目录的路径名称。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_KEY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户机私钥文件的路径名称。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：连接安全状态。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_SSL_VERIFY_SERVER_CERT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：是否执行服务器证书通用名称的主机名身份验证。
          </font></font></p></li><li class="listitem"><p>
            <code class="literal">MYSQL_OPT_TLS_VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：客户端允许的加密协议。
</font></font></p></li></ul>
</div>
<p>
        <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><code class="literal">mysql_ssl_set()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以用作便捷例程，相当于一组</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定证书和密钥文件，加密密码等</font><font style="vertical-align: inherit;">的
         </font><font style="vertical-align: inherit;">调用。</font><font style="vertical-align: inherit;">请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ssl-set" title="27.8.7.73 mysql_ssl_set（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.73节“mysql_ssl_set（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-enforcing-encrypted-connection"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行加密连接</font></font></h4>

</div>

</div>

</div>
<p>
        <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL证书和密钥文件等信息选项用于建立加密连接（如果此类连接可用），但不强制要求加密连接。</font><font style="vertical-align: inherit;">要求加密连接，请使用以下技术：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据需要</font><font style="vertical-align: inherit;">
            调用</font><font style="vertical-align: inherit;">相应的SSL参数（证书和密钥文件，加密密码等）。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">传递</font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项的值</font></font><code class="literal">SSL_MODE_REQUIRED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或限制性较强的选项值之一。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接到服务器。</font><font style="vertical-align: inherit;">如果无法获得加密连接，则呼叫失败; </font><font style="vertical-align: inherit;">退出时出错。
</font></font></p></li></ol>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h4 class="title"><a name="c-api-secure-encrypted-connection"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提高加密连接的安全性</font></font></h4>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        相对于默认加密提供的安全性，客户端可以提供与服务器使用的证书相匹配的CA证书并启用主机名身份验证。</font><font style="vertical-align: inherit;">通过这种方式，服务器和客户端将他们的信任置于相同的CA证书中，并且客户端验证其连接的主机是否是预期的主机：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要指定CA证书，请调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以传递
             </font></font><code class="literal">MYSQL_OPT_SSL_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（或
             </font></font><code class="literal">MYSQL_OPT_SSL_CAPATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）选项，然后调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以传递</font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值为</font><font style="vertical-align: inherit;">的
             </font><font style="vertical-align: inherit;">选项
             </font></font><code class="literal">SSL_MODE_VERIFY_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            要启用主机名身份验证，请调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以</font></font><code class="literal">MYSQL_OPT_SSL_MODE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用值</font></font><code class="literal">SSL_MODE_VERIFY_IDENTITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是
             </font><font style="vertical-align: inherit;">传递
             </font><font style="vertical-align: inherit;">选项
             </font></font><code class="literal">SSL_MODE_VERIFY_CA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意
</font></font></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          主机名身份验证不适用于由服务器自动创建的自签名证书，或手动使用</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql-ssl-rsa-setup" title="4.4.5 mysql_ssl_rsa_setup  - 创建SSL / RSA文件"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql_ssl_rsa_setup</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#creating-ssl-rsa-files-using-mysql" title="6.4.3.1使用MySQL创建SSL和RSA证书和密钥"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.4.3.1节“使用MySQL创建SSL和RSA证书和密钥”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">这些自签名证书不包含作为通用名称值的服务器名称。
</font></font></p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-multiple-queries"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.16 C API多语句执行支持</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      默认情况下，</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解释他们的声明中字符串参数作为一个单独的语句来执行，您可以根据语句是否生成结果集的处理结果（一组行，作为
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）或受影响的行数（为</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等等）。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL还支持执行包含以分号（</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）字符</font><font style="vertical-align: inherit;">分隔的多个语句的字符串</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此功能是通过在连接到服务器时</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或通过调用连接后
       </font><font style="vertical-align: inherit;">指定的特殊选项启用的
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-server-option" title="27.8.7.70 mysql_set_server_option（）"><code class="literal">mysql_set_server_option()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      执行多语句字符串可以产生多个结果集或行计数指示符。</font><font style="vertical-align: inherit;">处理这些结果涉及的方法与单一语句的情况不同：在处理第一条语句的结果之后，有必要检查是否存在更多结果，如果存在，则依次处理它们。</font><font style="vertical-align: inherit;">为了支持多结果处理，C API包含
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-more-results" title="27.8.7.46 mysql_more_results（）"><code class="literal">mysql_more_results()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数。</font><font style="vertical-align: inherit;">只要有更多结果可用，循环结束时就会使用这些函数。</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果不以这种方式处理结果，可能会导致与服务器的连接断开。</font></font></em></span>
    </p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果您</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为存储过程</font><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">语句，</font><font style="vertical-align: inherit;">则也需要多结果处理
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">存储过程的结果具有以下特征：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          过程中的语句可能会产生结果集（例如，如果它执行</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          语句）。</font><font style="vertical-align: inherit;">这些结果集按照它们在过程执行时生成的顺序返回。
        </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          通常，调用者无法知道过程将返回多少个结果集。</font><font style="vertical-align: inherit;">过程执行可能依赖于循环或条件语句，这些语句会导致执行路径因调用而不同。</font><font style="vertical-align: inherit;">因此，您必须准备检索多个结果。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该过程的最终结果是一个不包含结果集的状态结果。</font><font style="vertical-align: inherit;">状态指示过程是成功还是发生错误。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      多语句和结果功能只能用于</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它们不能与准备好的语句接口一起使用。</font><font style="vertical-align: inherit;">准备好的语句处理程序被定义为仅与包含单个语句的字符串一起工作。</font><font style="vertical-align: inherit;">参见</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statements" title="27.8.8 C API准备的语句"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.8节“C API准备语句”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要启用多语句执行和结果处理，可以使用以下选项：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          该</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数具有</font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">两个选项值相关的参数：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使客户端程序能够处理多个结果。</font><font style="vertical-align: inherit;">如果您</font><font style="vertical-align: inherit;">为生成结果集的存储过程</font><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">语句，</font><font style="vertical-align: inherit;">则</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必须</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用
               </font><font style="vertical-align: inherit;">此选项
               </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，这些程序会导致错误</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在MySQL 5.7中，
               </font><font style="vertical-align: inherit;">默认是启用的。
            </font></font><code class="literal">Error 1312 (0A000):
              PROCEDURE <em class="replaceable"><code>proc_name</code></em> can't
              return a result set in the given context</code><font style="vertical-align: inherit;"></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p>
              <code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行包含以分号分隔的多个语句的语句字符串。</font><font style="vertical-align: inherit;">此选项也可启用
               </font></font><code class="literal">CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含蓄，所以
               </font></font><code class="literal">flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数
               </font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以
               </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相当于一个参数
               </font></font><code class="literal">CLIENT_MULTI_STATEMENTS |
              CLIENT_MULTI_RESULTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">也就是说，
               </font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">足以启用多语句执行和所有多重结果处理。
</font></font></p></li></ul>
</div>
</li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          与服务器建立连接后，您可以使用该
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-set-server-option" title="27.8.7.70 mysql_set_server_option（）"><code class="literal">mysql_set_server_option()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          函数通过传递参数</font></font><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_ON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or
           </font><font style="vertical-align: inherit;">来启用或禁用多语句执行
           </font></font><code class="literal">MYSQL_OPTION_MULTI_STATEMENTS_OFF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使多语句执行与该功能还允许的处理</font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><span class="quote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简单</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为其中每个语句产生一个结果，但是多语句字符串结果</font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">足以允许产生结果集的存储过程的处理。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下过程概述了处理多条语句的建议策略：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          传递</font></font><code class="literal">CLIENT_MULTI_STATEMENTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-connect" title="27.8.7.54 mysql_real_connect（）"><code class="literal">mysql_real_connect()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全启用多语句执行和多重结果处理。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-real-query" title="27.8.7.57 mysql_real_query（）"><code class="literal">mysql_real_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">验证成功之后，进入一个循环，在该循环中处理语句结果。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          对于循环的每次迭代，处理当前语句结果，检索结果集或受影响的行数。</font><font style="vertical-align: inherit;">如果发生错误，请退出循环。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在循环结束时，调用
           </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以检查是否存在其他结果并且如果存在则启动检索。</font><font style="vertical-align: inherit;">如果没有更多结果可用，请退出循环。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      下面显示了上述策略的一种可能的实现。</font><font style="vertical-align: inherit;">循环的最后部分可以简化为</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-next-result" title="27.8.7.47 mysql_next_result（）"><code class="literal">mysql_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非零</font><font style="vertical-align: inherit;">的简单测试
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">所写入的代码区分了没有更多的结果和错误，这使得在后一种情况下可以打印消息。
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ *使用CLIENT_MULTI_STATEMENTS选项连接到服务器* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（mysql_real_connect（mysql，host_name，user_name，password，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    db_name，port_num，socket_name，CLIENT_MULTI_STATEMENTS）== NULL）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“mysql_real_connect（）失败\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_close（MySQL的）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *执行多个语句* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_query（mysql，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     “DROP TABLE IF EXISTS test_table; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      CREATE TABLE test_table（id INT）; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      INSERT INTO test_table VALUES（10）; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      UPDATE test_table SET id = 20 WHERE id = 10; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      SELECT * FROM test_table; \</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                      DROP TABLE test_table“）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（状态）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“无法执行语句”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_close（MySQL的）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *处理每个语句结果* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
做{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *当前语句返回数据？</font><font style="vertical-align: inherit;">* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  结果= mysql_store_result（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（结果）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *是; </font><font style="vertical-align: inherit;">处理行并释放结果集* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    process_result_set（mysql，result）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    了mysql_free_result（结果）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他/ *没有结果集或错误* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    如果（mysql_field_count（mysql）== 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“受影响的％lld行\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            mysql_affected_rows（MySQL的））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    其他/ *发生一些错误* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“无法检索结果集\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      打破;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  /* 更多结果？</font><font style="vertical-align: inherit;">-1 =否，&gt; 0 =错误，0 =是（保持循环）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（（status = mysql_next_result（mysql））&gt; 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“无法执行语句\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} while（status == 0）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_close（MySQL的）;</font></font><font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-date-handling"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.17 C API预处理日期和时间值的语句处理</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      二进制（预处理语句）协议使您能够发送和接收日期和时间值（</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），使用
       </font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构。</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-statement-data-structures" title="27.8.9 C API编写的语句数据结构"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.9节“C API准备语句数据结构”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中介绍了此结构的成员
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      要发送时态数据值，请使用以下命令创建预准备语句
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-prepare" title="27.8.11.21 mysql_stmt_prepare（）"><code class="literal">mysql_stmt_prepare()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后，在调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行语句之前，使用以下过程设置每个时态参数：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          在</font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与数据值关联</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构中，将</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员</font><font style="vertical-align: inherit;">设置为</font><font style="vertical-align: inherit;">指示您要发送什么样的时间值的类型。</font><font style="vertical-align: inherit;">为</font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值，设定
           </font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到
           </font></font><code class="literal">MYSQL_TYPE_DATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">MYSQL_TYPE_DATETIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或
           </font></font><code class="literal">MYSQL_TYPE_TIMESTAMP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，分别。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员</font><font style="vertical-align: inherit;">设置为</font><font style="vertical-align: inherit;">传递时间值</font><font style="vertical-align: inherit;">的
           </font></font><code class="literal">MYSQL_BIND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结构的地址
           </font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          填写</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          适合要传递的时间值类型</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">成员</font><font style="vertical-align: inherit;">。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-param" title="27.8.11.4 mysql_stmt_bind_param（）"><code class="literal">mysql_stmt_bind_param()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的参数数据绑定到语句。</font><font style="vertical-align: inherit;">然后你可以打电话
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      为了检索时间值，除了将</font></font><code class="literal">buffer_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员</font><font style="vertical-align: inherit;">设置为</font><font style="vertical-align: inherit;">您希望接收的值的类型以及将</font></font><code class="literal">buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      成员</font></font><code class="literal">MYSQL_TIME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">放置到返回值应放置到</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构</font><font style="vertical-align: inherit;">的地址</font><font style="vertical-align: inherit;">之外，过程与此类似</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">用于
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-bind-result" title="27.8.11.5 mysql_stmt_bind_result（）"><code class="literal">mysql_stmt_bind_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在调用之后</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-execute" title="27.8.11.10 mysql_stmt_execute（）"><code class="literal">mysql_stmt_execute()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并在获取结果之前</font><font style="vertical-align: inherit;">将缓冲区绑定到语句
       </font><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      下面是插入一个简单的例子
       </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据。</font><font style="vertical-align: inherit;">该
       </font></font><code class="literal">mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变量被假定为有效的连接处理程序。
    </font></font></p><pre data-lang="c" class="programlisting"><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_TIME ts;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_BIND绑定[3];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_STMT * stmt;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  strmov（查询，“INSERT INTO test_table（date_field，time_field，\</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                               timestamp_field）VALUES（？，？，？“）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（！stmt）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“mysql_stmt_init（），内存不足\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（mysql_stmt_prepare（mysql，query，strlen（query）））</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“\ n mysql_stmt_prepare（），INSERT failed”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“\ n％s”，mysql_stmt_error（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（0）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *为所有3个参数设置输入缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .buffer_type = MYSQL_TYPE_DATE;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .buffer =（char *）＆ts;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .is_null = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [0] .length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ...</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  bind [1] = bind [2] = bind [0];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ...</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  mysql_stmt_bind_param（stmt，bind）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *提供要在ts结构中发送的数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.year = 2002;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.month = 02;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.day = 03;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.hour = 10;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.minute = 45;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ts.second = 20;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  在mysql_stmt_execute（语句）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ..</font></font><font></font>
<font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-call-statements"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.18 C API编写的CALL语句支持</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      本节介绍C API中使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">执行的存储过程的准备语句支持
       </font><font style="vertical-align: inherit;">：
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      使用预处理</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">执行的存储过程
       </font><font style="vertical-align: inherit;">可以通过以下方式使用：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          存储过程可以生成任意数量的结果集。</font><font style="vertical-align: inherit;">所有结果集的列数和列数据类型不必相同。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">程序返回后，调用应用程序可以使用</font><font style="vertical-align: inherit;">
          最终的值</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数。</font><font style="vertical-align: inherit;">这些参数将作为一个额外的单行结果集返回到该过程本身生成的任何结果集之后。</font><font style="vertical-align: inherit;">该行</font><font style="vertical-align: inherit;">按照它们在过程参数列表中声明的顺序</font><font style="vertical-align: inherit;">包含</font><font style="vertical-align: inherit;">参数</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">的值</font><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下讨论显示了如何通过C API使用这些功能来准备语句。</font><font style="vertical-align: inherit;">要</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#prepare" title="13.5.1 PREPARE语法"><code class="literal">PREPARE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#execute" title="13.5.2 EXECUTE语法"><code class="literal">EXECUTE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">使用准备
       </font><font style="vertical-align: inherit;">语句
       </font><font style="vertical-align: inherit;">，请参见
       </font></font><a class="xref" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第13.2.1节“CALL语法”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      执行预处理</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">的应用程序
       </font><font style="vertical-align: inherit;">应使用一个循环来获取结果，然后调用
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-stmt-next-result" title="27.8.11.17 mysql_stmt_next_result（）"><code class="literal">mysql_stmt_next_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以确定是否有更多结果。</font><font style="vertical-align: inherit;">结果包含由存储过程生成的任何结果集，后跟最终状态值，指示过程是否成功终止。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果过程具有</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
       </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，则最终状态值之前的结果集包含它们的值。</font><font style="vertical-align: inherit;">要确定结果集是否包含参数值，请测试该
       </font></font><code class="literal">SERVER_PS_OUT_PARAMS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">位是否在</font><font style="vertical-align: inherit;">连接处理程序</font><font style="vertical-align: inherit;">的</font></font><code class="literal">server_status</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成员中
       </font><font style="vertical-align: inherit;">设置
       </font></font><code class="literal">MYSQL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql-&gt; server_status＆SERVER_PS_OUT_PARAMS
</font></font></pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      以下示例使用预准备
       </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句来执行一个存储过程，该存储过程生成多个结果集，并通过</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">将参数值提供给调用方
       </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该过程采用所有三种类型的参数（</font></font><code class="literal">IN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
       </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），显示它们的初始值，分配新的值，显示该更新的值，并返回。</font><font style="vertical-align: inherit;">因此，程序的预期回报信息由多个结果集和最终状态组成：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个结果从设置</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          显示的初始参数值：
           </font></font><code class="literal">10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">30</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数由调用者分配一个值，但是这种分配预期是无效的：</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数被视为</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在过程中，直到在过程中分配了一个值。）
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个结果从设置</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#select" title="13.2.9 SELECT语法"><code class="literal">SELECT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          显示所述修改后的参数值：
           </font></font><code class="literal">100</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">200</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><code class="literal">300</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          一个包含最终</font><font style="vertical-align: inherit;">值</font></font><code class="literal">OUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
           </font></font><code class="literal">INOUT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数值的</font><font style="vertical-align: inherit;">结果集</font><font style="vertical-align: inherit;">：
           </font></font><code class="literal">200</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="literal">300</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          最后的状态包。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      执行过程的代码：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MYSQL_STMT * stmt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MYSQL_BIND ps_params [3]; </font><font style="vertical-align: inherit;">/ *输入参数缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int int_data [3]; </font><font style="vertical-align: inherit;">/ *输入/输出值* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
my_bool is_null [3]; </font><font style="vertical-align: inherit;">/ *输出值可空性* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int状态;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *设置存储过程* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_query（mysql，“DROP PROCEDURE IF EXISTS p1”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_error（mysql，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_query（mysql，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “CREATE PROCEDURE p1（”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “IN p_in INT”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “OUT p_out INT”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “INOUT p_inout INT）”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “开始 ”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “SELECT p_in，p_out，p_inout;”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “SET p_in = 100，p_out = 200，p_inout = 300;”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “SELECT p_in，p_out，p_inout;”</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  “结束”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_error（mysql，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *用参数占位符初始化和准备CALL语句* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stmt = mysql_stmt_init（mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果（！stmt）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  printf（“无法初始化语句\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_stmt_prepare（stmt，“CALL p1（？，？，？）”，16）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_stmt_error（stmt，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *初始化参数：p_in，p_out，p_inout（全部INT）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
memset（ps_params，0，sizeof（ps_params））;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [0] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [0] .buffer =（char *）＆int_data [0];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [0] .length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [0] .is_null = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [1] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [1] .buffer =（char *）＆int_data [1];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [1] .length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [1] .is_null = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [2] .buffer_type = MYSQL_TYPE_LONG;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [2] .buffer =（char *）＆int_data [2];</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [2] .length = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ps_params [2] .is_null = 0;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *绑定参数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_stmt_bind_param（stmt，ps_params）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_stmt_error（stmt，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *为参数赋值并执行语句* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data [0] = 10; </font><font style="vertical-align: inherit;">/ * p_in * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data [1] = 20; </font><font style="vertical-align: inherit;">/ * p_out * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
int_data [2] = 30; </font><font style="vertical-align: inherit;">/ * p_inout * /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
status = mysql_stmt_execute（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
test_stmt_error（stmt，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ *处理结果，直到没有更多* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
做{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  int i;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  int num_fields; </font><font style="vertical-align: inherit;">/ *结果中的列数* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_FIELD *字段; </font><font style="vertical-align: inherit;">/ *结果集元数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  MYSQL_BIND * rs_bind; </font><font style="vertical-align: inherit;">/ *用于输出缓冲区* /</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / *如果存在结果集，则列计数大于0 * /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  / * 0如果结果只是最终的状态包* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  num_fields = mysql_stmt_field_count（stmt）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（num_fields&gt; 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *有一个结果集要获取* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“结果中的列数：％d \ n”，（int）num_fields）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *这是什么样的结果集？</font><font style="vertical-align: inherit;">* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“Data：”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    如果（mysql-&gt; server_status＆SERVER_PS_OUT_PARAMS）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“这个结果集包含OUT / INOUT参数\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“这个结果集是由程序生成的\ n”）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MYSQL_RES * rs_metadata = mysql_stmt_result_metadata（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    test_stmt_error（stmt，rs_metadata == NULL）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fields = mysql_fetch_fields（rs_metadata）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    rs_bind =（MYSQL_BIND *）malloc（sizeof（MYSQL_BIND）* num_fields）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    如果（！rs_bind）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      printf（“无法分配输出缓冲区\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    memset（rs_bind，0，sizeof（MYSQL_BIND）* num_fields）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *设置并绑定结果集输出缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for（i = 0; i &lt;num_fields; ++ i）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      rs_bind [i] .buffer_type = fields [i] .type;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      rs_bind [i] .is_null =＆is_null [i];</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      开关（字段[i] .type）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        情况MYSQL_TYPE_LONG：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          rs_bind [i] .buffer =（char *）＆（int_data [i]）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          rs_bind [i] .buffer_length = sizeof（int_data）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          打破;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        默认：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          fprintf（stderr，“ERROR：unexpected type：％d。\ n”，fields [i] .type）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    status = mysql_stmt_bind_result（stmt，rs_bind）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    test_stmt_error（stmt，status）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *获取并显示结果集行* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    而（1）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      status = mysql_stmt_fetch（stmt）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果（状态== 1 ||状态== MYSQL_NO_DATA）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        打破;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      for（i = 0; i &lt;num_fields; ++ i）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        开关（rs_bind [i] .buffer_type）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          情况MYSQL_TYPE_LONG：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            如果（* rs_bind [i] .is_null）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              printf（“val [％d] = NULL;”，i）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              printf（“val [％d] =％ld;”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                     我，（长）*（（int *）rs_bind [i] .buffer））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            打破;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          默认：</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            printf（“意外类型（％d）\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              rs_bind [I] .buffer_type）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      的printf（ “\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    了mysql_free_result（rs_metadata）; </font><font style="vertical-align: inherit;">/ *免费元数据* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    自由（rs_bind）; </font><font style="vertical-align: inherit;">/ *空闲输出缓冲区* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  其他</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    / *无列=最终状态包* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    printf（“程序结束输出\ n”）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  /* 更多结果？</font><font style="vertical-align: inherit;">-1 =否，&gt; 0 =错误，0 =是（继续看）* /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  status = mysql_stmt_next_result（stmt）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（状态&gt; 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    test_stmt_error（stmt，status）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
} while（status == 0）;</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_stmt_close（语句）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      程序的执行应该产生以下输出：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果列数：3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数据：这个结果集是由程序产生的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 val [0] = 10; </font><font style="vertical-align: inherit;">val [1] = NULL; </font><font style="vertical-align: inherit;">val [2] = 30;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果列数：3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数据：这个结果集是由程序产生的</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 val [0] = 100; </font><font style="vertical-align: inherit;">val [1] = 200; </font><font style="vertical-align: inherit;">val [2] = 300;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果列数：2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数据：该结果集包含OUT / INOUT参数</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 val [0] = 200; </font><font style="vertical-align: inherit;">val [1] = 300;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
程序结束输出</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      该代码使用两个实用程序例程，
       </font></font><code class="literal">test_error()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并
       </font></font><code class="literal">test_stmt_error()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在出现错误时检查错误并在打印诊断信息后终止：
    </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">static void test_error（MYSQL * mysql，int status）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（状态）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误：％s（errno：％d）\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            mysql_error（mysql），mysql_errno（mysql））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
static void test_stmt_error（MYSQL_STMT * stmt，int status）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果（状态）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    fprintf（stderr，“错误：％s（errno：％d）\ n”，</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            mysql_stmt_error（stmt），mysql_stmt_errno（stmt））;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    出口（1）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  }</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-prepared-statement-problems"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.19 C API准备声明问题</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      下面列出了当前已知的准备好的语句问题：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/data-types.html#time" title="11.3.2时间类型"><code class="literal">TIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">TIMESTAMP</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
           </font></font><a class="link" href="/mysql-5.7-google-zh/data-types.html#datetime" title="11.3.1 DATE，DATETIME和TIMESTAMP类型"><code class="literal">DATETIME</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持秒的部分（例如，from
           </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_date-format"><code class="literal">DATE_FORMAT()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
        </font></font></p></li><li class="listitem"><p>
          <a class="indexterm" name="idm140527956898352"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

          在将整数转换为字符串时，</font></font><code class="literal">ZEROFILL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在MySQL服务器不打印前导零的某些情况下</font><font style="vertical-align: inherit;">，
           </font><font style="vertical-align: inherit;">可以使用预处理语句。</font><font style="vertical-align: inherit;">（例如，带
           </font><font style="vertical-align: inherit;">）。
        </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_min"><code class="literal">MIN(<em class="replaceable"><code>number-with-zerofill</code></em>)</code></a><font style="vertical-align: inherit;"></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          将浮点数转换为客户端中的字符串时，转换后的值的最右边的数字可能与原始值的最右边的数字略有不同。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          Prepared语句在</font></font><a class="xref" href="/mysql-5.7-google-zh/optimization.html#query-cache-operation" title="8.10.3.1查询缓存如何操作"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第8.10.3.1节“查询缓存如何操作”中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述的条件下使用查询缓存</font><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          已准备好的语句不支持多语句（即单个字符串中的多个语句由</font></font><code class="literal">;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符</font><font style="vertical-align: inherit;">分隔
           </font><font style="vertical-align: inherit;">）。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          准备好的</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#call" title="13.2.1 CALL语法"><code class="literal">CALL</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font><font style="vertical-align: inherit;">的功能
           </font><font style="vertical-align: inherit;">在</font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#c-api-prepared-call-statements" title="27.8.18 C API编写的CALL语句支持"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.18节“C API准备的CALL语句支持”中进行了描述</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-auto-reconnect"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.20 C API自动重新连接控制</font></font></h3>

</div>

</div>

</div>
<a class="indexterm" name="idm140527956886080"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果在尝试将语句发送到要执行的服务器时发现连接已关闭，则MySQL客户端库可以执行到服务器的自动重新连接。</font><font style="vertical-align: inherit;">如果启用自动重新连接，库会尝试一次重新连接到服务器并再次发送语句。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      自动重新连接在默认情况下被禁用。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果您的应用程序知道连接已断开（以便其可以退出或采取措施调整状态信息丢失），请确保禁用自动重新连接。</font><font style="vertical-align: inherit;">要确保这一点，请</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用以下
       </font></font><code class="literal">MYSQL_OPT_RECONNECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项进行
     </font><font style="vertical-align: inherit;">调用
      </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">my_bool reconnect = 0;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mysql_options（＆mysql，MYSQL_OPT_RECONNECT，＆reconnect）;</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果连接断开，其效果
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于自动重新连接状态。</font><font style="vertical-align: inherit;">如果启用自动重新连接，则
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行重新连接。</font><font style="vertical-align: inherit;">否则，它会返回一个错误。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      某些客户端程序可能提供控制自动重新连接的功能。</font><font style="vertical-align: inherit;">例如，</font><font style="vertical-align: inherit;">
      默认情况下</font><font style="vertical-align: inherit;">，</font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#mysql" title="4.5.1 mysql  -  MySQL命令行工具"><span class="command"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql会</font></font></strong></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重新连接，但该
       </font></font><a class="link" href="/mysql-5.7-google-zh/programs.html#option_mysql_reconnect"><code class="option">--skip-reconnect</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      选项可用于抑制此行为。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果发生自动重新连接（例如，由于呼叫</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），则没有明确的指示。</font><font style="vertical-align: inherit;">要检查重新连接，请
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-id" title="27.8.7.76 mysql_thread_id（）"><code class="literal">mysql_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在调用之前调用以获取原始连接标识符
       </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-ping" title="27.8.7.52 mysql_ping（）"><code class="literal">mysql_ping()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-thread-id" title="27.8.7.76 mysql_thread_id（）"><code class="literal">mysql_thread_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再次</font><font style="vertical-align: inherit;">调用
       </font><font style="vertical-align: inherit;">以查看标识符是否更改。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      自动重新连接可能很方便，因为您不需要实现自己的重新连接代码，但是如果发生重新连接，连接状态的几个方面将在服务器端重置，您的应用程序将不会收到通知。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      与连接有关的状态受影响如下：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          任何活动的事务都回滚并且自动提交模式被重置。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所有表锁都被释放。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          所有</font></font><code class="literal">TEMPORARY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表格都关闭（并丢弃）。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          会话系统变量重新初始化为相应全局系统变量的值，包括系统变量，这些系统变量由语句（例如）隐式设置
           </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#set-names" title="13.7.4.3 SET NAMES语法"><code class="literal">SET NAMES</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          用户变量设置丢失。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          已准备好的声明已发布。
        </font></font></p></li><li class="listitem"><p>
          <a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#handler" title="13.2.4 HANDLER语法"><code class="literal">HANDLER</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 变量被关闭。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          值</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          被重置为0。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          获得的锁</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          被释放。
        </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          客户端与</font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#threads-table" title="25.11.16.3线程表"><code class="literal">threads</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确定连接线程检测</font><font style="vertical-align: inherit;">的性能架构
           </font><font style="vertical-align: inherit;">表行的关联已丢失。</font><font style="vertical-align: inherit;">如果客户端在断开连接后重新连接，则会话与</font></font><a class="link" href="/mysql-5.7-google-zh/performance-schema.html#threads-table" title="25.11.16.3线程表"><code class="literal">threads</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表中</font><font style="vertical-align: inherit;">的新行关联，</font><font style="vertical-align: inherit;">并且线程监视状态可能不同。</font><font style="vertical-align: inherit;">请参见
           </font></font><a class="xref" href="/mysql-5.7-google-zh/performance-schema.html#threads-table" title="25.11.16.3线程表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第25.11.16.3节“线程表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果发生重新连接，则通过</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-options" title="27.8.7.50 mysql_options（）"><code class="literal">mysql_options()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该
       </font></font><code class="literal">MYSQL_INIT_COMMAND</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">调用指定的任何SQL语句
       </font><font style="vertical-align: inherit;">都会重新执行。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      如果连接断开，如果服务器尚未检测到客户端不再连接，则与服务器端连接相关的会话仍可能正在运行。</font><font style="vertical-align: inherit;">在这种情况下，原始连接持有的任何锁仍然属于该会话，因此您可能希望通过调用来终止它</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-kill" title="27.8.7.39 mysql_kill（）"><code class="literal">mysql_kill()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="c-api-common-issues"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.21 C API常见问题</font></font></h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#null-mysql-store-result"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.21.1为什么mysql_store_result（）有时在mysql_query（）返回成功后返回NULL</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#query-results"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.21.2您可以从查询中获得哪些结果</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#getting-unique-id"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.21.3如何获取最后插入的行的唯一ID</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140527956842784"></a><a class="indexterm" name="idm140527956841296"></a>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="null-mysql-store-result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.21.1为什么mysql_store_result（）有时在mysql_query（）返回成功后返回NULL</font></font></h4>
</div>
</div>
</div>
<a class="indexterm" name="idm140527956838656"></a><a class="indexterm" name="idm140527956837616"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼叫成功后
         </font><font style="vertical-align: inherit;">
        可能
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会返回
         </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">发生这种情况时，表示发生以下情况之一：
</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            出现</font></font><code class="literal">malloc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">故障（例如，如果结果集太大）。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            数据无法读取（连接发生错误）。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            该查询返回任何数据（例如，它是一个
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您可以随时通过调用来检查语句是否应该产生非空结果
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回0，则结果为空，最后一个查询是不返回值的语句（例如，an
         </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或a
         </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">如果
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回非零值，则该语句应该产生非空结果。</font><font style="vertical-align: inherit;">有关</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-field-count" title="27.8.7.22 mysql_field_count（）"><code class="literal">mysql_field_count()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例，</font><font style="vertical-align: inherit;">请参阅该
         </font><font style="vertical-align: inherit;">函数的说明。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您可以通过调用</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-error" title="27.8.7.15 mysql_error（）"><code class="literal">mysql_error()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
         </font><font style="vertical-align: inherit;">测试错误
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-errno" title="27.8.7.14 mysql_errno（）"><code class="literal">mysql_errno()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="query-results"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.21.2您可以从查询中获得哪些结果</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527956812992"></a><a class="indexterm" name="idm140527956811952"></a><a class="indexterm" name="idm140527956810880"></a><a class="indexterm" name="idm140527956809808"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        除查询返回的结果集外，您还可以获得以下信息：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-affected-rows" title="27.8.7.1 mysql_affected_rows（）"><code class="literal">mysql_affected_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            做一个当返回受上一查询的行数</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#delete" title="13.2.2 DELETE语法"><code class="literal">DELETE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            为了快速重新创建，请使用</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#truncate-table" title="13.1.34 TRUNCATE TABLE语法"><code class="literal">TRUNCATE
            TABLE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回结果集中的行数。</font><font style="vertical-align: inherit;">随着
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能会尽快
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-store-result" title="27.8.7.75 mysql_store_result（）"><code class="literal">mysql_store_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            返回。</font><font style="vertical-align: inherit;">与
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-use-result" title="27.8.7.77 mysql_use_result（）"><code class="literal">mysql_use_result()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-num-rows" title="27.8.7.49 mysql_num_rows（）"><code class="literal">mysql_num_rows()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能只有在你已经获取所有行后调用
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-fetch-row" title="27.8.7.21 mysql_fetch_row（）"><code class="literal">mysql_fetch_row()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p>
            <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将由插入行的最后一个查询生成的ID返回到包含</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引</font><font style="vertical-align: inherit;">的表中</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.38节“mysql_insert_id（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            某些查询（</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE语法"><code class="literal">LOAD DATA INFILE
            ...</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT语法"><code class="literal">INSERT INTO
            ... SELECT ...</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
             </font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#update" title="13.2.11更新语法"><code class="literal">UPDATE</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）返回的附加信息。</font><font style="vertical-align: inherit;">结果由返回
             </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-info" title="27.8.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请参阅描述以</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-info" title="27.8.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            了解它返回的字符串格式。
            </font><font style="vertical-align: inherit;">如果没有附加信息，则</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-info" title="27.8.7.36 mysql_info（）"><code class="literal">mysql_info()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个
             </font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指针。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="getting-unique-id"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.8.21.3如何获取最后插入的行的唯一ID</font></font></h4>

</div>

</div>

</div>
<a class="indexterm" name="idm140527956776896"></a><a class="indexterm" name="idm140527956775856"></a><a class="indexterm" name="idm140527956774784"></a><a class="indexterm" name="idm140527956773712"></a><a class="indexterm" name="idm140527956772224"></a><a class="indexterm" name="idm140527956770768"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果将记录插入到包含</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font><font style="vertical-align: inherit;">的表中
         </font><font style="vertical-align: inherit;">，则可以通过调用该</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数</font><font style="vertical-align: inherit;">来获取存储在该列中的值
         </font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您可以</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过执行以下代码（假定您已检查语句是否成功），</font><font style="vertical-align: inherit;">从C应用程序中检查值是否存储在</font><font style="vertical-align: inherit;">列中。</font><font style="vertical-align: inherit;">它确定查询是否是</font></font><a class="link" href="/mysql-5.7-google-zh/sql-syntax.html#insert" title="13.2.5 INSERT语法"><code class="literal">INSERT</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个
         </font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引：
      </font></font></p><pre data-lang="c" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if（（result = mysql_store_result（＆mysql））== 0 &amp;&amp;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    mysql_field_count（＆mysql）== 0 &amp;&amp;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    mysql_insert_id（＆mysql）！= 0）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    used_id = mysql_insert_id（＆mysql）;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font><font></font>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        当生成新</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值时，还可以通过执行</font></font><code class="literal">SELECT
        LAST_INSERT_ID()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句
         </font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-query" title="27.8.7.53 mysql_query（）"><code class="literal">mysql_query()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并从语句返回的结果集中检索值来</font><font style="vertical-align: inherit;">获取它</font><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        插入多个值时，会返回最后一次自动递增的值。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        因为</font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最近生成的ID在服务器上以每个连接为基础进行维护。</font><font style="vertical-align: inherit;">它不会被另一个客户更改。</font><font style="vertical-align: inherit;">如果</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用非魔术值</font><font style="vertical-align: inherit;">更新另一</font><font style="vertical-align: inherit;">列（即不是</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和非
         </font><font style="vertical-align: inherit;">的值），</font><font style="vertical-align: inherit;">它甚至不会更改
         </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">多个客户端同时</font><font style="vertical-align: inherit;">使用
         </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列是完全有效的。</font><font style="vertical-align: inherit;">每个客户端将收到最后插入的ID为最后一条语句
         </font></font><span class="emphasis"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font></em></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端执行。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        如果要使用为一个表生成的ID并将其插入到第二个表中，则可以使用如下所示的SQL语句：
      </font></font></p><pre data-lang="sql" class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INSERT INTO foo（自动，文本）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    VALUES（NULL， '文本'）; </font><font style="vertical-align: inherit;">＃通过插入NULL生成ID</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INSERT INTO foo2（id，text）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    VALUES（LAST_INSERT_ID（）， '文本'）; </font><font style="vertical-align: inherit;">＃在第二个表中使用ID</font></font><font></font>
</pre><p>
        <a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回存储到</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中的值，无论该值是通过存储</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还是</font><font style="vertical-align: inherit;">自动生成的，
         </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还是被指定为显式值。
        </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅返回自动生成的</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        值。</font><font style="vertical-align: inherit;">如果您存储除</font></font><code class="literal">NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font><font style="vertical-align: inherit;">之外的显式值
         </font></font><code class="literal">0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则不会影响返回的值
         </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关获取</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列中</font><font style="vertical-align: inherit;">最后一个ID的更多信息
         </font><font style="vertical-align: inherit;">：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关
             </font></font><a class="link" href="/mysql-5.7-google-zh/functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在SQL语句中使用的信息，请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/functions.html#information-functions" title="12.14信息功能"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第12.14节“信息函数”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关</font></font><a class="link" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><code class="literal">mysql_insert_id()</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您在C API中使用的函数的</font><font style="vertical-align: inherit;">信息
             </font><font style="vertical-align: inherit;">，请参见
             </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#mysql-insert-id" title="27.8.7.38 mysql_insert_id（）"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.8.7.38节“mysql_insert_id（）”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关使用Connector / J时获取自动递增值的信息，请参阅
             </font><a class="ulink" href="http://dev.mysql.com/doc/connector-j/5.1/en/connector-j-usagenotes-last-insert-id.html" target="_top"><font style="vertical-align: inherit;">通过JDBC </font></a></font><a class="ulink" href="http://dev.mysql.com/doc/connector-j/5.1/en/connector-j-usagenotes-last-insert-id.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索</font></font><code class="literal">AUTO_INCREMENT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列值</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
          </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            有关使用Connector / ODBC时</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-odbc/en/connector-odbc-usagenotes-functionality-last-insert-id.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取自动递增值的信息</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，请参阅
             </font><a class="ulink" href="http://dev.mysql.com/doc/connector-odbc/en/connector-odbc-usagenotes-functionality-last-insert-id.html" target="_top"><font style="vertical-align: inherit;">获取自动递增值</font></a><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-php-info"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.9 MySQL PHP API</font></font></h2>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    MySQL PHP API手册现在以独立形式发布，而不是作为MySQL参考手册的一部分。</font><font style="vertical-align: inherit;">查看</font></font><a class="ulink" href="http://dev.mysql.com/doc/apis-php/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL和PHP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-perl"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.10 MySQL Perl API</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527956725856"></a><a class="indexterm" name="idm140527956724400"></a><a class="indexterm" name="idm140527956723328"></a><a class="indexterm" name="idm140527956722256"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Perl </font></font><code class="literal">DBI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块为数据库访问提供了一个通用接口。</font><font style="vertical-align: inherit;">您可以编写一个DBI脚本，该脚本可以与许多不同的数据库引擎一起工作而不用更改 </font><font style="vertical-align: inherit;">要在MySQL中使用DBI，请安装以下内容：
</font></font></p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><code class="literal">DBI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        该</font></font><code class="literal">DBD::mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块。</font><font style="vertical-align: inherit;">这是Perl的数据库驱动程序（DBD）模块。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        可选地，DBD模块用于您想要访问的任何其他类型的数据库服务器。
</font></font></p></li></ol>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Perl DBI是推荐的Perl界面。</font><font style="vertical-align: inherit;">它取代了一个旧的界面</font></font><code class="literal">mysqlperl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这个</font><font style="vertical-align: inherit;">界面</font><font style="vertical-align: inherit;">应该被认为是过时的。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    这些部分包含有关在Perl中使用Perl并在Perl中编写MySQL应用程序的信息：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关Perl DBI支持的安装说明，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/installing.html#perl-support" title="2.12 Perl安装说明"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.12节“Perl安装说明”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关从选项文件读取选项的示例，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/server-administration.html#multiple-server-clients" title="5.6.4在多服务器环境中使用客户端程序"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第5.6.4节“在多服务器环境中使用客户端程序”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关安全编码技巧，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/security.html#security-guidelines" title="6.1.1安全指南"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6.1.1节“安全指南”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关调试技​​巧，请参见</font></font><a class="xref" href="/mysql-5.7-google-zh/extending-mysql.html#using-gdb-on-mysqld" title="28.5.1.4在gdb下调试mysqld"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28.5.1.4节“在gdb下调试mysqld”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于一些特定于Perl的环境变量，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/programs.html#environment-variables" title="4.9 MySQL程序环境变量"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4.9节“MySQL程序环境变量”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关在OS X上运行的注意事项，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/installing.html#osx-installation" title="2.4在macOS上安装MySQL"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2.4节“在macOS上安装MySQL”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关引用字符串文字的方法，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/language-structure.html#string-literals" title="9.1.1字符串文字"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第9.1.1节“字符串文字”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    DBI信息可通过命令行，联机或打印形式获得：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        一旦你拥有了</font></font><code class="literal">DBI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
         </font></font><code class="literal">DBD::mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装的模块，你可以用命令行中获得关于它们的信息
         </font></font><code class="literal">perldoc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令：
      </font></font></p><pre class="programlisting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shell&gt; </font></font><strong class="userinput"><code>perldoc DBI</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
shell&gt; </font></font><strong class="userinput"><code>perldoc DBI::FAQ</code></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
shell&gt;</font></font><strong class="userinput"><code>perldoc DBD::mysql</code></strong>
</pre><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        您也可以使用</font></font><code class="literal">pod2man</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
         </font></font><code class="literal">pod2html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等等将这些信息翻译成其他格式。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        有关Perl DBI的在线信息，请访问DBI网站
         </font></font><a class="ulink" href="http://dbi.perl.org/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://dbi.perl.org/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该网站托管一般的DBI邮件列表。</font><font style="vertical-align: inherit;">甲骨文公司专门提供一份清单</font></font><code class="literal">DBD::mysql</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/introduction.html#mailing-lists" title="1.6.2 MySQL邮件列表"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1.6.2节“MySQL邮件列表”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        对于印刷的信息，官方的DBI书籍是
         </font></font><em class="citetitle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编程Perl DBI</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Alligator Descartes和Tim Bunce，O'Reilly＆Associates，2000）。</font><font style="vertical-align: inherit;">关于这本书的信息可以在DBI网站
         </font></font><a class="ulink" href="http://dbi.perl.org/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://dbi.perl.org/上找到</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-python"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.11 MySQL Python API</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527956685936"></a><p>
    <code class="literal">MySQLdb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是提供MySQL对Python的支持的第三方驱动程序，符合Python DB API 2.0版。</font><font style="vertical-align: inherit;">它可以在</font></font><a class="ulink" href="http://sourceforge.net/projects/mysql-python/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://sourceforge.net/projects/mysql-python/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到
     </font><font style="vertical-align: inherit;">。
  </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    新的MySQL Connector / Python组件为同一个Python API提供了一个接口，并被内置到MySQL服务器中并受Oracle支持。</font><font style="vertical-align: inherit;">有关</font></font><a class="ulink" href="http://dev.mysql.com/doc/connector-python/en/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的详细信息，</font><font style="vertical-align: inherit;">请参阅</font><a class="ulink" href="http://dev.mysql.com/doc/connector-python/en/" target="_top"><font style="vertical-align: inherit;">MySQL连接器/ Python开发人员指南</font></a><font style="vertical-align: inherit;">，以及Python应用程序和示例Python代码的编码指南。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-ruby"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.12 MySQL Ruby API</font></font></h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-ruby-mysqlruby"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.12.1 MySQL / Ruby API</font></font></a></span></dt><dt><span class="section"><a href="/mysql-5.7-google-zh/connectors-apis.html#apis-ruby-rubymysql"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.12.2 Ruby / MySQL API</font></font></a></span></dt></dl>
</div>
<a class="indexterm" name="idm140527956679696"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    开发MySQL应用程序的Ruby程序员可以使用两种API：
</font></font></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MySQL / Ruby API基于
         </font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API库。</font><font style="vertical-align: inherit;">有关安装和使用MySQL / Ruby API的信息，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#apis-ruby-mysqlruby" title="27.12.1 MySQL / Ruby API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.12.1节“MySQL / Ruby API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p></li><li class="listitem"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        Ruby / MySQL API被编写为使用本地MySQL网络协议（本地驱动程序）。</font><font style="vertical-align: inherit;">有关安装和使用Ruby / MySQL API的信息，请参见
         </font></font><a class="xref" href="/mysql-5.7-google-zh/connectors-apis.html#apis-ruby-rubymysql" title="27.12.2 Ruby / MySQL API"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第27.12.2节“Ruby / MySQL API”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p></li></ul>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    有关Ruby语言的背景和语法信息，请参阅
     </font></font><a class="ulink" href="http://www.ruby-lang.org/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ruby编程语言</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="apis-ruby-mysqlruby"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.12.1 MySQL / Ruby API</font></font></h3>
</div>
</div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      MySQL / Ruby模块使用Ruby通过提供对MySQL数据库的访问</font></font><code class="literal">libmysqlclient</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关安装模块的信息以及公开的功能，请参阅
       </font></font><a class="ulink" href="http://tmtm.org/en/mysql/ruby/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL / Ruby</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="apis-ruby-rubymysql"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.12.2 Ruby / MySQL API</font></font></h3>

</div>

</div>

</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      Ruby / MySQL模块通过使用MySQL网络协议的本地驱动程序接口使用Ruby提供对MySQL数据库的访问。
    </font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      有关安装模块的信息以及公开的功能，请参阅
       </font></font><a class="ulink" href="http://tmtm.org/en/ruby/mysql/README_en.html" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ruby / MySQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-tcl"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.13 MySQL Tcl API</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527956664336"></a><p>
    <code class="literal">MySQLtcl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一种用于从</font></font><a class="ulink" href="http://en.wikipedia.org/wiki/Tcl" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tcl编程语言</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">访问MySQL数据库服务器的简单API
     </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它可以在</font></font><a class="ulink" href="http://www.xdobry.de/mysqltcl/" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.xdobry.de/mysqltcl/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到
     </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="apis-eiffel"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.14 MySQL埃菲尔包装</font></font></h2>

</div>

</div>

</div>
<a class="indexterm" name="idm140527956659296"></a><a class="indexterm" name="idm140527956658256"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Eiffel MySQL是</font><font style="vertical-align: inherit;">由Michael Ravits编写的</font><font style="vertical-align: inherit;">使用</font></font><a class="ulink" href="http://en.wikipedia.org/wiki/Eiffel_(programming_language)" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eiffel编程语言</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的MySQL数据库服务器的接口
     </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它可以在</font></font><a class="ulink" href="http://efsa.sourceforge.net/archive/ravits/mysql.htm" target="_top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://efsa.sourceforge.net/archive/ravits/mysql.htm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到
     </font><font style="vertical-align: inherit;">。
</font></font></p>
</div>

</div>
<div class="copyright-footer">

</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tbody><tr>
<td width="40%" align="left"><a accesskey="p" href="/mysql-5.7-google-zh/sys-schema.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一页</font></font></a></td>
<td width="20%" align="center"><a accesskey="u" href="/mysql-5.7-google-zh/connectors-apis.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向上</font></font></a></td>
<td width="40%" align="right">&nbsp;<a accesskey="n" href="/mysql-5.7-google-zh/extending-mysql.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个</font></font></a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第26章MySQL sys模式</font></font></td>
<td width="20%" align="center"><a accesskey="h" href="/mysql-5.7-google-zh/index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">家</font></font></a></td>
<td width="40%" align="right" valign="top"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第28章扩展MySQL</font></font></td>
</tr>
</tbody></table>
</div><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./images/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>


<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>